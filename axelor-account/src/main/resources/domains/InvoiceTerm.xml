<?xml version="1.0" encoding="UTF-8"?>
<domain-models xmlns="http://axelor.com/xml/ns/domain-models" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/domain-models http://axelor.com/xml/ns/domain-models/domain-models_5.4.xsd">

  <module name="account" package="com.axelor.apps.account.db" />

  <entity name="InvoiceTerm" lang="java">

    <many-to-one name="invoice" ref="com.axelor.apps.account.db.Invoice" title="Invoice"/>
    <integer name="sequence" required="true"/>
    <integer name="discountBaseSelect" title="Discount base" selection="account.financial.discount.discount.base.select"/>
    <date name="dueDate" title="Due date" required="true"/>
    <date name="finDiscountDeadlineDate" title="Financial discount deadline date" />
    <boolean name="isPaid" title="Paid" default="false" />
    <boolean name="isHoldBack" title="Holdback" default="false" />
    <decimal name="amount" title="Amount" />
    <decimal name="amountRemaining" title="Amount remaining" />
    <decimal name="discountRate" title="Discount rate" />
    <many-to-one name="paymentMode" ref="com.axelor.apps.account.db.PaymentMode" title="Payment mode"/>
    <many-to-one name="financialDiscount" ref="com.axelor.apps.account.db.FinancialDiscount" title="Financial discount"/>
    <many-to-one name="paymentConditionLine" ref="com.axelor.apps.account.db.PaymentConditionLine" title="Payment condition line" required="true" />
    <many-to-one name="moveLine" ref="com.axelor.apps.account.db.MoveLine" title="Move line" readonly="true" />

    <string name="name" namecolumn="true" search="invoice,dueDate,amount" title="Name" required="true">
            <![CDATA[
            if( invoice != null ){
               if (dueDate != null) {
            	 return invoice.getInvoiceId() + "_" + dueDate + "_" + amount;
               }
               else {
                 return invoice.getInvoiceId() + "_" + amount;
               }
            } else { 
            return null; 
            }
	    ]]>
    </string>
    
    <track>
      <field name="invoice" on="UPDATE"/>
      <field name="dueDate" on="UPDATE"/>
      <field name="amount" on="UPDATE"/>
      <field name="amountRemaining" on="UPDATE"/>
      <field name="isPaid" on="UPDATE"/>
      <field name="isHoldBack" on="UPDATE"/>
      <field name="paymentMode" on="UPDATE"/>
      <field name="financialDiscount" on="UPDATE"/>
      <field name="findDiscountDeadineDate" on="UPDATE"/>
      <field name="discountBaseSelect" on="UPDATE"/>
      <field name="discountRate" on="UPDATE"/>
      <field name="moveLine" on="UPDATE"/>
    </track>

  </entity>

</domain-models> 