<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_5.4.xsd">

  <grid name="move-line-grid" orderBy="-date,-name" title="Move lines"
    model="com.axelor.apps.account.db.MoveLine" canArchive="false" canDelete="false" canNew="false">
    <toolbar>
      <button name="accountingReconcileBtn" title="Accounting Reconcile"
        onClick="action-method-accounting-reconcile"/>
      <button name="calculateBtn" title="Calculation of totals"
        onClick="action-account-move-line-method-calculate-balance"/>
    </toolbar>
    <hilite color="info" if="$get('move.statusSelect') == 1"/>
    <hilite color="danger" if="$get('move.statusSelect') == 4"/>
    <field name="name" width="135"/>
    <field name="date" width="90" onChange="account-move-line-group-date-onchange"/>
    <field name="move.period" width="100" canView="false"/>
    <field name="move.journal" width="140"/>
    <field name="partner" form-view="partner-form" grid-view="partner-grid"/>
    <field name="account" form-view="account-form" grid-view="account-grid"
      onChange="action-move-line-method-compute-analytic-distribution"/>
    <field name="account.analyticDistributionAuthorized" hidden="true"/>
    <field name="account.analyticDistributionRequiredOnMoveLines" hidden="true"/>
    <field name="move.company" form-view="company-form" grid-view="company-grid" width="120"
      if="__config__.app.getApp('base')?.getEnableMultiCompany()"/>
    <field name="debit" aggregate="sum" width="100"/>
    <field name="credit" aggregate="sum" width="100"/>
    <field name="amountRemaining" aggregate="sum" width="100"/>
    <field name="taxLine" domain="self.endDate > :date OR self.endDate IS NULL"/>
    <field name="analyticDistributionTemplate"
      if="__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.getManageAnalyticAccounting()"
      grid-view="analytic-distribution-template-grid"
      form-view="analytic-distribution-template-form"
      onChange="action-move-line-method-create-analytic-distribution"
      requiredIf="(!analyticMoveLineList || !analyticMoveLineList.length > 0) &amp;&amp; account.analyticDistributionAuthorized &amp;&amp; account.analyticDistributionRequiredOnMoveLines"/>
    <field name="move.statusSelect" width="90"/>
    <field name="reconcileGroup" width="120"/>
    <field name="origin" width="120"/>
    <field name="description"/>
    <field name="dueDate"/>
    <field name="analyticMoveLineList" hidden="true"/>
  </grid>

  <grid name="move-line-move-grid" model="com.axelor.apps.account.db.MoveLine"
    title="Move lines" canArchive="false" onNew="action-account-move-line-onnew-group">
    <field name="counter" hidden="true" width="80"/>
    <field name="account.isTaxRequiredOnMoveLine" hidden="true"/>
    <field name="account.isTaxAuthorizedOnMoveLine" hidden="true"/>
    <field name="account.analyticDistributionAuthorized" hidden="true"/>
    <field name="account.analyticDistributionRequiredOnMoveLines" hidden="true"/>
    <field name="date" width="100" onChange="account-move-line-group-date-onchange"
      hidden="true"/>
    <field name="partner" form-view="partner-form" grid-view="partner-grid"
      onSelect="action-account-move-line-partner-group"
      onChange="action-move-line-record-reset-partner-details" width="120" canEdit="false"
      readonly="false"/>
    <field name="account" form-view="account-form" grid-view="account-grid"
      onSelect="action-move-line-attrs-domain-account" width="200" canEdit="false"
      readonlyIf="amountPaid &gt; 0" onChange="action-account-move-line-account-group-on-change"/>
    <field name="currencyAmount" onChange="action-move-line-record-set-debitcredit"
      readonlyIf="!isOtherCurrency"/>
    <field name="currencyRate" onChange="action-move-line-record-set-debitcredit"
      readonlyIf="!isOtherCurrency"/>
    <field name="debit"
      onChange="action-record-account-moveline-debit-onchange,action-group-account-moveline-debitcredit-onchange"
      width="90" readonlyIf="amountPaid &gt; 0"/>
    <field name="credit"
      onChange="action-record-account-moveline-credit-onchange,action-group-account-moveline-debitcredit-onchange"
      width="90" readonlyIf="amountPaid &gt; 0"/>
    <field name="amountRemaining" hidden="true" width="150"/>
    <field name="amountPaid" hidden="true"/>
    <field name="taxLine" readonlyIf="!account.isTaxAuthorizedOnMoveLine"
      requiredIf="account.isTaxRequiredOnMoveLine"
      domain="self.endDate > :date OR self.endDate IS NULL"/>
    <field name="analyticDistributionTemplate"
      if="__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.getManageAnalyticAccounting()"
      grid-view="analytic-distribution-template-grid"
      form-view="analytic-distribution-template-form"
      onChange="action-move-line-method-create-analytic-distribution"
      onSelect="action-move-line-attrs-set-domain-analytic-distribution-template"
      readonlyIf="!account || !account.analyticDistributionAuthorized || axis1AnalyticAccount || axis2AnalyticAccount || axis3AnalyticAccount || axis4AnalyticAccount || axis5AnalyticAccount"
      requiredIf="account.analyticDistributionAuthorized &amp;&amp; account.analyticDistributionRequiredOnMoveLines &amp;&amp; (axis1AnalyticAccount == null &amp;&amp; axis2AnalyticAccount == null &amp;&amp; axis3AnalyticAccount == null &amp;&amp; axis4AnalyticAccount == null &amp;&amp; axis5AnalyticAccount == null)"/>
    <field name="axis1AnalyticAccount" grid-view="analytic-account-grid"
      form-view="analytic-account-form"
      readonlyIf="account.analyticDistributionAuthorized == false || !account"
      onSelect="action-attrs-move-line-set-domain-axis"
      onChange="action-group-analytic-axis-onchange"/>
    <field name="axis2AnalyticAccount" grid-view="analytic-account-grid"
      form-view="analytic-account-form"
      readonlyIf="account.analyticDistributionAuthorized == false || !account"
      onSelect="action-attrs-move-line-set-domain-axis"
      onChange="action-group-analytic-axis-onchange"/>
    <field name="axis3AnalyticAccount" grid-view="analytic-account-grid"
      form-view="analytic-account-form"
      readonlyIf="account.analyticDistributionAuthorized == false || !account"
      onSelect="action-attrs-move-line-set-domain-axis"
      onChange="action-group-analytic-axis-onchange"/>
    <field name="axis4AnalyticAccount" grid-view="analytic-account-grid"
      form-view="analytic-account-form"
      readonlyIf="account.analyticDistributionAuthorized == false || !account"
      onSelect="action-attrs-move-line-set-domain-axis"
      onChange="action-group-analytic-axis-onchange"/>
    <field name="axis5AnalyticAccount" grid-view="analytic-account-grid"
      form-view="analytic-account-form"
      readonlyIf="account.analyticDistributionAuthorized == false || !account"
      onSelect="action-attrs-move-line-set-domain-axis"
      onChange="action-group-analytic-axis-onchange"/>
    <field name="origin" width="120" hidden="true"/>
    <field name="description"
      requiredIf="$isDescriptionRequired || move.company.accountConfig.isDescriptionRequired"/>
    <field name="analyticMoveLineList" grid-view="analytic-move-line-move-line-grid"
      form-view="analytic-move-line-move-line-form"/>
    <field name="reconcileGroup" hidden="true"/>
    <field name="$isDescriptionRequired" type="boolean" hidden="true"/>
    <field name="move.company.accountConfig.isDescriptionRequired" hidden="true"/>
    <field name="isOtherCurrency" hidden="true"/>
  </grid>

  <grid name="move-line-journal-grid" orderBy="account,-date" title="Move lines"
    model="com.axelor.apps.account.db.MoveLine" canDelete="false" canNew="false" groupBy="account"
    expandable="true" canArchive="false">
    <hilite color="info" if="$get('move.statusSelect') == 1"/>
    <hilite color="danger" if="$get('move.statusSelect') == 4"/>
    <field name="name" width="135"/>
    <field name="date" onChange="account-move-line-group-date-onchange"/>
    <field name="move.period" canView="false"/>
    <field name="partner" form-view="partner-form" grid-view="partner-grid"/>
    <field name="account" form-view="account-form" grid-view="account-grid"
      onChange="action-move-line-method-compute-analytic-distribution"/>
    <field name="account.analyticDistributionAuthorized" hidden="true"/>
    <field name="account.analyticDistributionRequiredOnMoveLines" hidden="true"/>
    <field name="move.company" form-view="company-form" grid-view="company-grid"
      if="__config__.app.getApp('base')?.getEnableMultiCompany()"/>
    <field name="debit" aggregate="sum"/>
    <field name="credit" aggregate="sum"/>
    <field name="amountRemaining" aggregate="sum"/>
    <field name="taxLine"
      requiredIf="account.accountType.technicalTypeSelect == 'income' || account.accountType.technicalTypeSelect == 'charge' || account.accountType.technicalTypeSelect == 'tax' || account.accountType.technicalTypeSelect == 'immobilisation'"
      domain="self.endDate > :date OR self.endDate IS NULL"/>
    <field name="analyticDistributionTemplate"
      if="__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.getManageAnalyticAccounting()"
      grid-view="analytic-distribution-template-grid"
      form-view="analytic-distribution-template-form"
      onChange="action-move-line-method-create-analytic-distribution"
      requiredIf="(!analyticMoveLineList || !analyticMoveLineList.length > 0) &amp;&amp; account.analyticDistributionAuthorized &amp;&amp; account.analyticDistributionRequiredOnMoveLines"/>
    <field name="move.statusSelect"/>
    <field name="reconcileGroup" width="120"/>
    <field name="origin" width="120"/>
    <field name="description"/>
    <field name="analyticMoveLineList" hidden="true"/>
  </grid>

  <grid name="move-line-accounting-situation-grid" orderBy="-date" title="Move lines"
    model="com.axelor.apps.account.db.MoveLine" canDelete="false" canNew="false" canArchive="false">
    <hilite color="info" if="$get('move.statusSelect') == 1"/>
    <hilite color="danger" if="$get('move.statusSelect') == 4"/>
    <field name="name" width="135"/>
    <field name="date" onChange="account-move-line-group-date-onchange"/>
    <field name="move.period" canView="false"/>
    <field name="move.journal"/>
    <field name="description"/>
    <field name="account" form-view="account-form" grid-view="account-grid"
      onChange="action-move-line-method-compute-analytic-distribution"/>
    <field name="account.analyticDistributionAuthorized" hidden="true"/>
    <field name="account.analyticDistributionRequiredOnMoveLines" hidden="true"/>
    <field name="debit" aggregate="sum"/>
    <field name="credit" aggregate="sum"/>
    <field name="amountRemaining" aggregate="sum"/>
    <field name="taxLine"
      requiredIf="account.accountType.technicalTypeSelect == 'income' || account.accountType.technicalTypeSelect == 'charge' || account.accountType.technicalTypeSelect == 'tax' || account.accountType.technicalTypeSelect == 'immobilisation'"
      domain="self.endDate > :date OR self.endDate IS NULL"/>
    <field name="analyticDistributionTemplate"
      if="__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.getManageAnalyticAccounting()"
      grid-view="analytic-distribution-template-grid"
      form-view="analytic-distribution-template-form"
      onChange="action-move-line-method-create-analytic-distribution"
      requiredIf="(!analyticMoveLineList || !analyticMoveLineList.length > 0) &amp;&amp; account.analyticDistributionAuthorized &amp;&amp; account.analyticDistributionRequiredOnMoveLines"/>
    <field name="move.statusSelect"/>
    <field name="reconcileGroup" width="120"/>
    <field name="origin" width="120"/>
    <field name="dueDate"/>
    <field name="description"/>
    <field name="analyticMoveLineList" hidden="true"/>
  </grid>

  <grid name="move-line-move-simplifiee-grid" title="Move lines"
    model="com.axelor.apps.account.db.MoveLine" onNew="action-account-move-line-onnew-group"
    canArchive="false" edit-icon="true">
    <field name="partner" readonly="false" width="120" canEdit="false"
      onSelect="action-account-move-line-partner-group" form-view="partner-form"
      grid-view="partner-grid"/>
    <field name="account" readonlyIf="amountPaid > 0" width="400" canEdit="false"
      onChange="action-account-move-line-account-group-on-change"
      onSelect="action-move-line-attrs-domain-account" form-view="account-form"
      grid-view="account-grid"/>
    <field name="currencyAmount" hidden="true" readonlyIf="!isOtherCurrency"
      onChange="action-move-line-record-set-debitcredit"/>
    <field name="currencyRate" hidden="true" readonlyIf="!isOtherCurrency"
      onChange="action-move-line-record-set-debitcredit"/>
    <field name="debit" readonlyIf="amountPaid > 0" width="120"
      onChange="action-record-account-moveline-debit-onchange,action-group-account-moveline-debitcredit-onchange"/>
    <field name="credit" readonlyIf="amountPaid > 0" width="120"
      onChange="action-record-account-moveline-credit-onchange,action-group-account-moveline-debitcredit-onchange"/>
    <field name="taxLine" hidden="true" readonlyIf="!account.isTaxAuthorizedOnMoveLine"
      domain="self.endDate > :date OR self.endDate IS NULL"
      requiredIf="account.isTaxRequiredOnMoveLine || account.accountType.technicalTypeSelect == 'income' || account.accountType.technicalTypeSelect == 'charge' || account.accountType.technicalTypeSelect == 'tax' || account.accountType.technicalTypeSelect == 'immobilisation'"/>
    <field name="description"
      requiredIf="$isDescriptionRequired || move.company.accountConfig.isDescriptionRequired"/>
    <field name="$isDescriptionRequired" hidden="true" type="boolean"/>
    <field name="move.company.accountConfig.isDescriptionRequired" hidden="true"/>
    <field name="isOtherCurrency" hidden="true"/>
    <field name="account.isTaxRequiredOnMoveLine" hidden="true"/>
    <field name="account.isTaxAuthorizedOnMoveLine" hidden="true"/>
  </grid>

  <form name="incl-analytic-distribution-move-line-form"
    model="com.axelor.apps.account.db.MoveLine" title="Move line" canArchive="false"
    onLoad="action-record-initialize-permission-validation-move-line">
    <panel name="analyticDistributionPanel" title="Analytic distribution"
      if="__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.getManageAnalyticAccounting()"
      showIf="account.analyticDistributionAuthorized"
      readonlyIf="move.period.statusSelect == 2 || $validatePeriod">
      <field name="analyticDistributionTemplate"
        grid-view="analytic-distribution-template-grid" colSpan="12"
        form-view="analytic-distribution-template-form"
        onChange="action-move-line-method-create-analytic-distribution,action-method-move-line-set-required-analytic-accounts"
        onSelect="action-move-line-attrs-set-domain-analytic-distribution-template"
        readonlyIf="!account.analyticDistributionAuthorized || axis1AnalyticAccount || axis2AnalyticAccount || axis3AnalyticAccount || axis4AnalyticAccount || axis5AnalyticAccount"
        requiredIf="account.analyticDistributionAuthorized &amp;&amp; account.analyticDistributionRequiredOnMoveLines &amp;&amp; (axis1AnalyticAccount == null &amp;&amp; axis2AnalyticAccount == null &amp;&amp; axis3AnalyticAccount == null &amp;&amp; axis4AnalyticAccount == null &amp;&amp; axis5AnalyticAccount == null)"/>
      <field name="axis1AnalyticAccount" grid-view="analytic-account-grid"
        form-view="analytic-account-form"
        readonlyIf="account.analyticDistributionAuthorized == false || !account"
        onSelect="action-attrs-move-line-set-domain-axis"
        onChange="action-move-line-group-analytic-axis-onchange"/>
      <field name="axis2AnalyticAccount" grid-view="analytic-account-grid"
        form-view="analytic-account-form"
        readonlyIf="account.analyticDistributionAuthorized == false || !account"
        onSelect="action-attrs-move-line-set-domain-axis"
        onChange="action-move-line-group-analytic-axis-onchange"/>
      <field name="axis3AnalyticAccount" grid-view="analytic-account-grid"
        form-view="analytic-account-form"
        readonlyIf="account.analyticDistributionAuthorized == false || !account"
        onSelect="action-attrs-move-line-set-domain-axis"
        onChange="action-move-line-group-analytic-axis-onchange"/>
      <field name="axis4AnalyticAccount" grid-view="analytic-account-grid"
        form-view="analytic-account-form"
        readonlyIf="account.analyticDistributionAuthorized == false || !account"
        onSelect="action-attrs-move-line-set-domain-axis"
        onChange="action-move-line-group-analytic-axis-onchange"/>
      <field name="axis5AnalyticAccount" grid-view="analytic-account-grid"
        form-view="analytic-account-form"
        readonlyIf="account.analyticDistributionAuthorized == false || !account"
        onSelect="action-move-line-attrs-move-line-set-domain-axis"
        onChange="action-group-analytic-axis-onchange"/>
      <panel-related name="analyticMoveLineListPanelCanNew"
        field="analyticMoveLineList" grid-view="analytic-move-line-distribution-grid"
        form-view="analytic-move-line-distribution-form" colSpan="12"
        onChange="action-analytic-move-line-group-analytic-move-line-list-onchange" hidden="true"
        showIf="$analyticDistributionTypeSelect == 1"/>
      <panel-related name="analyticMoveLineListPanel" field="analyticMoveLineList"
        canNew="false" grid-view="analytic-move-line-distribution-grid"
        form-view="analytic-move-line-distribution-form" colSpan="12"
        onChange="action-analytic-move-line-group-analytic-move-line-list-onchange" hidden="true"
        showIf="$analyticDistributionTypeSelect != 1"/>
      <field name="$analyticDistributionTypeSelect" type="integer" hidden="true"/>

      <field name="$isValidAnalyticMoveLineList" type="boolean" hidden="true"/>
      <panel colSpan="12" hidden="true">
        <field name="account.analyticDistributionAuthorized"/>
        <field name="account.analyticDistributionRequiredOnMoveLines"/>
        <field name="$validatePeriod"/>
        <field name="move.period.statusSelect"/>
      </panel>
    </panel>
  </form>

  <action-record name="action-record-analytic-distribution-type-select"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="$analyticDistributionTypeSelect"
      expr="eval: __repo__(AccountConfig).all().filter('self.company = ?', move?.company ? move.company : __parent__.company)?.fetchOne().analyticDistributionTypeSelect"/>
  </action-record>

  <form name="move-line-form" title="Move line" model="com.axelor.apps.account.db.MoveLine"
    onNew="action-account-move-line-onnew-group" canNew="false" canDelete="false"
    onLoad="action-account-moveline-onload-group" canArchive="false">
    <panel name="mainPanel" readonly="true">
      <field name="name" colSpan="8" showTitle="false">
        <viewer depends="name">
					<![CDATA[
						<h3>
							<span  style="margin: 5px 0 !important; display: inline-table; line-height: initial;"><span x-translate>Move line</span> {{record.name}}</span>
						</h3>
					]]>
        </viewer>
      </field>
      <field name="reconcileGroup.code" colSpan="4" showTitle="false">
        <viewer depends="reconcileGroup.code">
					<![CDATA[
						<h3>
							<span  style="margin: 5px 0 !important; display: inline-table; line-height: initial; text-align:right; display:block; width:100%;">{{record.reconcileGroup.code}}</span>
						</h3>
					]]>
        </viewer>
      </field>
      <panel name="datesPanel" colSpan="12">
        <field name="date" onChange="account-move-line-group-date-onchange"/>
        <field name="dueDate" showIf="dueDate"/>
        <field name="originDate"/>
      </panel>
      <field name="partner" readonlyIf="amountPaid &gt; 0" form-view="partner-form"
        grid-view="partner-grid" onSelect="action-account-move-line-partner-group" canEdit="false"/>
      <field name="account" readonlyIf="amountPaid &gt; 0" form-view="account-form"
        grid-view="account-grid" onSelect="action-move-line-attrs-domain-account" canEdit="false"
        onChange="action-account-move-line-account-group-on-change"/>
      <field name="debit"
        readonlyIf="credit &gt; 0 || amountPaid &gt; 0 || reconcileGroup != null"
        css="label-bold bold" onChange="action-group-account-moveline-debitcredit-onchange"
        colSpan="3"/>
      <field name="credit"
        readonlyIf="debit &gt; 0 || amountPaid &gt; 0 || reconcileGroup != null"
        css="label-bold bold" onChange="action-group-account-moveline-debitcredit-onchange"
        colSpan="3"/>
      <field name="amountRemaining" colSpan="3"/>
      <field name="amountPaid" colSpan="3"
        hideIf="!account.reconcileOk || move.statusSelect == 1 || move.statusSelect == 4"/>
      <field name="origin" colSpan="12"/>
      <field name="description" colSpan="12"/>
      <field name="taxAmount" hidden="true"/>
      <field name="account.reconcileOk" hidden="true"/>
      <field name="serviceType" form-view="service-type-form" grid-view="service-type-grid"/>
      <field name="das2Activity" form-view="das2-activity-form" grid-view="das2-activity-grid"/>
    </panel>
    <panel-tabs name="mainPanelTab">
      <panel name="generateFixedAssetPanel" title="Generate fixed asset">
        <field name="$generateFixedAsset" title="Generate a fixed asset from this line ?"
          hideIf="fixedAssetCategory != null" type="boolean" widget="boolean"/>
        <field name="fixedAssetCategory"
          showIf="fixedAssetCategory != null || $generateFixedAsset" canNew="false"/>
      </panel>
      <panel-include view="incl-analytic-distribution-move-line-form"/>
      <panel-related name="debitReconcileListPanel"
        showIf="id &amp;&amp; (account.reconcileOk &amp;&amp; (move.statusSelect == 2 || move.statusSelect == 3)) &amp;&amp; $number(debit) &gt; 0.00"
        field="debitReconcileList" form-view="reconcile-form" grid-view="move-line-reconcile-grid"
        canNew="false" canRemove="false"/>
      <panel-related name="creditReconcileListPanel"
        showIf="id &amp;&amp; (account.reconcileOk &amp;&amp; (move.statusSelect == 2 || move.statusSelect == 3)) &amp;&amp; $number(credit) &gt; 0.00"
        field="creditReconcileList" form-view="reconcile-form" grid-view="move-line-reconcile-grid"
        canNew="false" canRemove="false"/>
      <panel-related name="taxPaymentMoveLinePanel"
        showIf="taxPaymentMoveLineList != null &amp;&amp; taxPaymentMoveLineList.length > 0"
        readonlyIf="move.statusSelect &gt; 2" field="taxPaymentMoveLineList" canNew="false"
        canRemove="false" onChange="account-move-line-compute-tax-amount-method-on-change"/>
      <panel name="irrecoverablePanel" title="Irrecoverable"
        showIf="id &amp;&amp; (move.statusSelect == 2 || move.statusSelect == 3)" colSpan="12">
        <panel name="irrecoverableDetailsPanel" colSpan="12">
          <field name="passageReason" showIf="$number(debit) > 0.00" colSpan="6"/>
          <field name="usherPassageOk"
            onChange="action-group-account-moveline-usher-process-onchange" colSpan="6"/>
          <field name="interbankCodeLine" showIf="interbankCodeLine"
            form-view="interbank-code-line-form" grid-view="interbank-code-line-grid"
            canEdit="false" colSpan="6"/>
          <field name="irrecoverableStatusSelect" colSpan="12"/>
          <field name="managementObject" form-view="management-object-form"
            grid-view="management-object-grid" colSpan="12"/>
        </panel>
        <panel name="irrecoverableActionPanel" colSpan="12">
          <button name="passInIrrecoverableBtn" title="Shift into irrecoverable"
            onClick="com.axelor.apps.account.web.MoveLineController:passInIrrecoverable" colSpan="6"
            showIf="irrecoverableStatusSelect == 0"/>
          <button name="notPassInIrrecoverableBtn" title="Do not shift into irrecoverable"
            onClick="com.axelor.apps.account.web.MoveLineController:notPassInIrrecoverable"
            colSpan="6" showIf="irrecoverableStatusSelect == 1"/>
        </panel>
      </panel>
      <panel name="currency" title="Currency">
        <field name="currency" title="Currency and exchange rate">
          <viewer>
						<![CDATA[
							<span>{{ record.currencyRate }} </span> x <span>{{ record.currencyAmount }}</span> <span>{{ record.move.currencyCode }} </span>
						]]>
          </viewer>
          <editor colSpan="12" layout="table" x-show-titles="false">
            <field name="currencyRate" readonly="true"/>
            <field name="currencyAmount" readonly="true"/>
            <field name="move.currencyCode" readonly="true"/>
          </editor>
        </field>
      </panel>
      <panel name="othersPanel" title="Others"
        showIf="move.statusSelect == 2 || move.statusSelect == 3 || taxLine != null" readonly="true">
        <field name="taxLine" canEdit="false"
          showIf="account.accountType.technicalTypeSelect == 'income' || account.accountType.technicalTypeSelect == 'charge' || account.accountType.technicalTypeSelect == 'tax' || account.accountType.technicalTypeSelect == 'immobilisation'"
          colSpan="6" form-view="tax-line-form" grid-view="tax-line-grid"
          domain="self.endDate > :date OR self.endDate IS NULL"
          readonlyIf="!account.isTaxAuthorizedOnMoveLine || move.statusSelect == 3"/>
        <field name="account.accountType.technicalTypeSelect" hidden="true"/>
        <field name="reimbursementStatusSelect"
          showIf="id &amp;&amp; move.statusSelect > 1 &amp;&amp; reimbursementStatusSelect != 0"
          readonly="true" selection="move.line.reimbursement.status.select"/>
        <field name="exportedDirectDebitOk" hidden="true" readonly="true"/>
        <field name="bankReconciledAmount" if-module="axelor-bank-payment" readonly="true"/>
        <field name="account.isTaxAuthorizedOnMoveLine" hidden="true"/>
      </panel>
      <panel-dashlet name="bankReconciliationLinePanel"
        title="Bank reconciliation lines" action="action-move-line-view-bank-reconciliation-lines"
        showIf="account.accountType.technicalTypeSelect == 'cash'" canAttach="false" colSpan="12"/>
    </panel-tabs>
    <panel name="movePanel" title="Move" sidebar="true" canCollapse="true">
      <field name="$viewerTags" showTitle="false" colSpan="6" readonly="true">
        <viewer depends="move.statusSelect">
					<![CDATA[
						<h4>
							<span class="label label-info" style="margin: 0 !important; display: inline-table; line-height: initial;" ng-show="record.move.statusSelect == 1" x-translate>Move.New</span>
							<span class="label label-warning" style="margin: 0 !important; display: inline-table; line-height: initial;" ng-show="record.move.statusSelect == 2" x-translate>DayBook</span>
							<span class="label label-success" style="margin: 0 !important; display: inline-table; line-height: initial;" ng-show="record.move.statusSelect == 3" x-translate>Move.Accounted</span>
							<span class="label label-important" style="margin: 0 !important; display: inline-table; line-height: initial;" ng-show="record.move.statusSelect == 4" x-translate>Move.Canceled</span>
							<span class="label label-info" style="margin: 0 !important; display: inline-table; line-height: initial;" ng-show="record.move.statusSelect == 5" x-translate>Simulated</span>
						</h4>
					]]>
        </viewer>
      </field>
      <field name="$functionalOriginTags" showTitle="false" colSpan="6" readonly="true">
        <viewer depends="move.functionalOriginSelect">
          <![CDATA[
                      <h4>
	                      <span class="label label-important" style="margin: 0 !important; display: inline-table; line-height: initial;" ng-show="record.move.functionalOriginSelect == 1" x-translate>Opening</span>
	                      <span class="label label-important" style="margin: 0 !important; display: inline-table; line-height: initial;" ng-show="record.move.functionalOriginSelect == 2" x-translate>Closure</span>
	                      <span class="label label-important" style="margin: 0 !important; display: inline-table; line-height: initial;" ng-show="record.move.functionalOriginSelect == 3" x-translate>Sale</span>
	                      <span class="label label-important" style="margin: 0 !important; display: inline-table; line-height: initial;" ng-show="record.move.functionalOriginSelect == 4" x-translate>Purchase</span>
	                      <span class="label label-important" style="margin: 0 !important; display: inline-table; line-height: initial;" ng-show="record.move.functionalOriginSelect == 5" x-translate>Payment</span>
	                      <span class="label label-important" style="margin: 0 !important; display: inline-table; line-height: initial;" ng-show="record.move.functionalOriginSelect == 6" x-translate>Cut Off</span>
	                      <span class="label label-important" style="margin: 0 !important; display: inline-table; line-height: initial;" ng-show="record.move.functionalOriginSelect == 7" x-translate>Fixed asset</span>

                      	  <span class="label label-important" style="margin: 0 !important; display: inline-table; line-height: initial;" ng-show="record.move.functionalOriginSelect == 9" x-translate>Irrecoverable</span>
                      </h4>
                    ]]>
        </viewer>
      </field>
      <field name="move" readonly="true" form-view="move-form" grid-view="move-grid"
        colSpan="6"/>
      <field name="move.company" colSpan="6"/>
      <field name="move.journal" colSpan="6"/>
      <field name="move.period" canView="false" colSpan="6"/>
    </panel>
  </form>

  <form name="move-line-move-form" title="Move line"
    model="com.axelor.apps.account.db.MoveLine" onNew="action-account-move-line-onnew-group"
    onLoad="action-account-moveline-move-onload-group" width="large">
    <panel name="informationsPanel" title="Information" colSpan="12" canArchive="false">
      <field name="$validatePeriod" hidden="true"/>
      <field name="name" colSpan="8" showTitle="false">
        <viewer depends="name">
					<![CDATA[
						<h3>
							<span  style="margin: 5px 0 !important; display: inline-table; line-height: initial;"><span x-translate>Move line</span> {{record.name}}</span>
						</h3>
					]]>
        </viewer>
      </field>
      <field name="reconcileGroup.code" colSpan="4" showTitle="false">
        <viewer depends="reconcileGroup.code">
					<![CDATA[
						<h3>
							<span  style="margin: 5px 0 !important; display: inline-table; line-height: initial; text-align:right; display:block; width:100%;">{{record.reconcileGroup.code}}</span>
						</h3>
					]]>
        </viewer>
      </field>
      <panel name="datesPanel" colSpan="12">
        <field name="date" onChange="account-move-line-group-date-onchange"/>
        <field name="dueDate" showIf="dueDate"/>
        <field name="originDate"/>
      </panel>
      <field name="account" form-view="account-form" grid-view="account-grid"
        onSelect="action-move-line-attrs-domain-account" canEdit="false"
        readonlyIf="amountPaid &gt; 0"
        onChange="action-move-line-method-compute-analytic-distribution,action-move-line-attrs-show-tax-amount"/>
      <field name="partner" form-view="partner-form" grid-view="partner-grid"
        onSelect="action-account-move-line-partner-group"
        onChange="action-move-line-record-reset-partner-details" canEdit="false"
        readonlyIf="amountPaid &gt; 0"/>
      <field name="currencyAmount" onChange="action-move-line-record-set-amount"
        readonlyIf="!isOtherCurrency" colSpan="3"/>
      <field name="currencyRate" onChange="action-move-line-record-set-currencyAmount"
        readonlyIf="!isOtherCurrency" colSpan="3"/>
      <field name="isOtherCurrency" hidden="true"/>
      <field name="debit" onChange="action-group-account-moveline-debitcredit-onchange"
        readonlyIf="credit &gt; 0 || amountPaid &gt; 0 || reconcileGroup != null"
        css="label-bold bold" colSpan="3"/>
      <field name="credit" onChange="action-group-account-moveline-debitcredit-onchange"
        readonlyIf="debit &gt; 0 || amountPaid &gt; 0 || reconcileGroup != null"
        css="label-bold bold" colSpan="3"/>
      <field name="amountRemaining" colSpan="3"/>
      <field name="amountPaid" colSpan="3"
        hideIf="!account.reconcileOk || move.statusSelect == 1 || move.statusSelect == 4"/>
      <field name="origin" colSpan="6"/>
      <field name="serviceType" form-view="service-type-form" grid-view="service-type-grid"
        colSpan="3"/>
      <field name="das2Activity" form-view="das2-activity-form" grid-view="das2-activity-grid"
        colSpan="3"/>
      <field name="taxAmount" hidden="true"/>
      <field name="move.statusSelect" hidden="true"/>
      <field name="account.reconcileOk" hidden="true"/>
    </panel>
    <panel name="detailsPanel">
      <field name="description" colSpan="6" requiredIf="$isDescriptionRequired"
        readonlyIf="move.period.statusSelect == 2 || $validatePeriod"/>
      <field name="move.period.statusSelect" hidden="true"/>
      <field name="$isDescriptionRequired" type="boolean" hidden="true"/>
    </panel>
    <panel-tabs name="mainPanelTab">
      <panel name="generateFixedAssetPanel" title="Generate fixed asset">
        <field name="$generateFixedAsset" title="Generate a fixed asset from this line ?"
          hideIf="fixedAssetCategory != null" type="boolean" widget="boolean"/>
        <field name="fixedAssetCategory"
          showIf="fixedAssetCategory != null || $generateFixedAsset" canNew="false"/>
      </panel>
      <panel-include view="incl-analytic-distribution-move-line-form"/>
      <panel-related name="debitReconcileListPanel"
        showIf="id &amp;&amp; (account.reconcileOk &amp;&amp; (move.statusSelect == 2 || move.statusSelect == 3)) &amp;&amp; $number(debit) &gt; 0.00"
        field="debitReconcileList" form-view="reconcile-form" grid-view="move-line-reconcile-grid"
        canNew="false" canRemove="false"/>
      <panel-related name="creditReconcileListPanel"
        showIf="id &amp;&amp; (account.reconcileOk &amp;&amp; (move.statusSelect == 2 || move.statusSelect == 3)) &amp;&amp; $number(credit) &gt; 0.00"
        field="creditReconcileList" form-view="reconcile-form" grid-view="move-line-reconcile-grid"
        canNew="false" canRemove="false"/>
      <panel-related name="taxPaymentMoveLinePanel"
        showIf="taxPaymentMoveLineList != null &amp;&amp; taxPaymentMoveLineList.length > 0"
        readonlyIf="move.statusSelect &gt; 2" field="taxPaymentMoveLineList" canNew="false"
        canRemove="false" onChange="account-move-line-compute-tax-amount-method-on-change"/>
      <panel name="irrecoverablePanel" title="Irrecoverable"
        showIf="id &amp;&amp; (move.statusSelect == 2 || move.statusSelect == 3)" colSpan="12">
        <panel name="irrecoverableDetailsPanel" colSpan="12">
          <field name="passageReason" showIf="$number(debit) > 0.00" colSpan="6"/>
          <field name="usherPassageOk"
            onChange="action-group-account-moveline-usher-process-onchange" colSpan="6"/>
          <field name="interbankCodeLine" showIf="interbankCodeLine"
            form-view="interbank-code-line-form" grid-view="interbank-code-line-grid"
            canEdit="false" colSpan="6"/>
          <field name="irrecoverableStatusSelect" colSpan="12"/>
          <field name="managementObject" form-view="management-object-form"
            grid-view="management-object-grid" colSpan="12"/>
        </panel>
        <panel name="irrecoverableActionPanel" colSpan="12">
          <button name="passInIrrecoverableBtn" title="Shift into irrecoverable"
            onClick="com.axelor.apps.account.web.MoveLineController:passInIrrecoverable" colSpan="6"
            showIf="irrecoverableStatusSelect == 0"/>
          <button name="notPassInIrrecoverableBtn" title="Do not shift into irrecoverable"
            onClick="com.axelor.apps.account.web.MoveLineController:notPassInIrrecoverable"
            showIf="irrecoverableStatusSelect == 1" colSpan="6"/>
        </panel>
      </panel>
      <panel name="currency" title="Currency">
        <field name="currency" title="Currency and exchange rate">
          <viewer>
						<![CDATA[
							<span>{{ record.currencyRate }} </span> x <span>{{ record.currencyAmount }}</span> <span>{{ record.move.currencyCode }} </span>
						]]>
          </viewer>
          <editor colSpan="12" layout="table" x-show-titles="false">
            <field name="currencyRate" onChange="action-move-line-record-set-currencyAmount"
              readonly="true"/>
            <field name="currencyAmount" onChange="action-move-line-record-set-amount"
              readonly="true"/>
            <field name="move.currencyCode" readonly="true"/>
          </editor>
        </field>
      </panel>
      <panel name="othersPanel" title="Others">
        <field name="taxLine" canEdit="false"
          readonlyIf="!account.isTaxAuthorizedOnMoveLine || move.statusSelect == 3"
          showIf="account.isTaxRequiredOnMoveLine" requiredIf="account.isTaxRequiredOnMoveLine"
          colSpan="6" form-view="tax-line-form" grid-view="tax-line-grid"
          domain="self.endDate > :date OR self.endDate IS NULL"/>
        <field name="account.accountType.technicalTypeSelect" hidden="true"/>
        <field name="reimbursementStatusSelect"
          showIf="id &amp;&amp; move.statusSelect > 1 &amp;&amp; reimbursementStatusSelect != 0"
          readonly="true" selection="move.line.reimbursement.status.select"/>
        <field name="exportedDirectDebitOk" hidden="true" readonly="true"/>
        <field name="bankReconciledAmount" if-module="axelor-bank-payment"
          onChange="action-account-group-move-line-check-bank-reconcile-amount-on-change"
          readonly="true"/>
        <field name="account.isTaxRequiredOnMoveLine" hidden="true"/>
        <field name="account.isTaxAuthorizedOnMoveLine" hidden="true"/>
      </panel>
      <panel-dashlet name="bankReconciliationLinePanel"
        title="Bank reconciliation lines" action="action-move-line-view-bank-reconciliation-lines"
        showIf="account.accountType.technicalTypeSelect == 'cash'" canAttach="false" colSpan="12"/>
    </panel-tabs>

    <panel-mail name="mailPanel">
      <mail-messages limit="4"/>
      <mail-followers/>
    </panel-mail>
  </form>

  <form name="account-move-line-calculation-wizard-form" title="Calculation"
    model="com.axelor.apps.base.db.Wizard" onNew="action-account-move-line-record-calculate-balance"
    canArchive="false">
    <panel name="mainPanel" colSpan="12" title="Total of the selected lines :">
      <field name="$debit" title="Debit :" readonly="true" colSpan="4"/>
      <field name="$credit" title="Credit :" readonly="true" colSpan="4"/>
      <field name="$balance" title="Balance :" readonly="true" colSpan="4"/>
    </panel>
  </form>

  <action-method name="action-method-accounting-reconcile">
    <call class="com.axelor.apps.account.web.MoveLineController" method="accountingReconcile"/>
  </action-method>

  <action-method name="account-move-line-compute-tax-amount-method-on-change"
    model="com.axelor.apps.account.db.MoveLine">
    <call class="com.axelor.apps.account.web.MoveLineController" method="computeTaxAmount"/>
  </action-method>

  <action-method name="action-move-line-method-set-is-other-currency"
    model="com.axelor.apps.account.db.MoveLine">
    <call class="com.axelor.apps.account.web.MoveLineController" method="setIsOtherCurrency"/>
  </action-method>

  <action-group name="action-account-move-line-onnew-group">
    <action name="action-move-line-record-get-move-informations"/>
    <action name="action-move-line-method-get-account-informations"/>
    <action name="action-move-line-method-compute-analytic-distribution"/>
    <action name="action-method-move-line-hide-axis-analytic-account"/>
    <action name="action-move-line-record-get-first-move-line-informations"/>
    <action name="action-move-line-method-get-creditdebit-balance"/>
    <action name="action-move-line-attrs-hidden-reconcileLists"/>
    <action name="action-move-line-record-set-partner"/>
    <action name="action-move-line-method-set-is-other-currency"/>
    <action name="action-move-line-method-set-currencyRate"/>
    <action name="action-move-line-record-set-currencyAmount"/>
    <action name="action-move-line-method-description-required"/>
  </action-group>

  <action-group name="action-group-account-moveline-debitcredit-onchange">
    <action name="action-move-line-debit-credit-validate"/>
    <action name="action-move-line-debit-credit-clean"/>
    <action name="action-move-line-method-compute-analytic-distribution"/>
    <action name="action-move-line-method-set-currencyRate"/>
    <action name="action-move-line-record-set-currencyAmount"/>
  </action-group>

  <action-group name="action-account-moveline-onload-group">
    <action name="action-record-analytic-distribution-type-select"/>
    <action name="action-move-line-attrs-readonly"/>
    <action name="action-move-line-attrs-show-tax-amount"/>
    <action name="action-move-line-method-description-required"
      if="__parent__ != null &amp;&amp; __parent__._model == 'com.axelor.apps.account.db.Move'"/>
  </action-group>

  <action-group name="action-account-moveline-move-onload-group">
    <action name="action-move-line-attrs-readonly"/>
    <action name="action-move-line-attrs-show-tax-amount"/>
    <action name="action-move-line-method-description-required"/>
    <action name="action-method-move-line-hide-axis-analytic-account"/>
    <action name="action-move-line-account-method-get-validate-period"/>
    <action name="action-record-analytic-distribution-type-select"/>
  </action-group>

  <action-group name="action-group-account-moveline-usher-process-onchange">
    <action name="save"/>
    <action name="action-method-account-moveline-usher-process"/>
  </action-group>

  <action-group name="action-account-move-line-partner-group">
    <action name="action-account-move-line-method-filter-partner"
      if="__parent__ != null &amp;&amp; __parent__._model == 'com.axelor.apps.account.db.Move'"/>
    <action name="action-move-line-attrs-domain-partner"
      if="__parent__ == null || __parent__._model != 'com.axelor.apps.account.db.Move'"/>
    <action name="action-account-move-line-method-set-partner-readonly"/>
  </action-group>

  <action-group name="action-account-move-line-account-group-on-change">
    <action name="action-move-line-method-compute-analytic-distribution"/>
    <action name="action-account-move-line-method-set-partner-readonly"/>
    <action name="action-move-line-method-refresh-account-informations"/>
    <action name="action-method-move-line-hide-axis-analytic-account"/>
    <action name="action-method-change-account-set-default-distribution-template"/>
    <action name="action-method-move-line-set-required-analytic-accounts"/>
  </action-group>

  <action-group name="action-group-analytic-axis-onchange">
    <action name="action-method-move-line-axis-create-analytic-line"/>
    <action name="action-method-move-line-set-required-analytic-accounts"/>
  </action-group>

  <action-record name="action-move-line-record-get-creditdebit-balance"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="debit"
      expr="eval: __parent__?.moveLineList.collect{new BigDecimal(it.credit)}.sum() - __parent__?.moveLineList.collect{new BigDecimal(it.debit)}.sum()"
      if="eval: __parent__?.moveLineList.collect{new BigDecimal(it.credit)}.sum() &gt; __parent__?.moveLineList.collect{new BigDecimal(it.debit)}.sum()"/>
    <field name="credit"
      expr="eval: __parent__?.moveLineList.collect{new BigDecimal(it.debit)}.sum() - __parent__?.moveLineList.collect{new BigDecimal(it.credit)}.sum()"
      if="eval: __parent__?.moveLineList.collect{new BigDecimal(it.credit)}.sum() &lt; __parent__?.moveLineList.collect{new BigDecimal(it.debit)}.sum()"/>
  </action-record>

  <action-record name="action-move-line-record-reset-partner-details"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="partnerFullName,partnerSeq,partnerId" expr="eval: null" if="!partner"/>
  </action-record>

  <action-group name="account-move-line-group-date-onchange">
    <action name="account-move-line-record-date-onchange"/>
    <action name="action-move-line-method-compute-analytic-distribution"/>
    <action name="action-move-line-validate-check-date-in-period"/>
  </action-group>

  <action-method name="action-move-line-method-compute-analytic-distribution">
    <call class="com.axelor.apps.account.web.MoveLineController"
      method="computeAnalyticDistribution"/>
  </action-method>

  <action-method name="action-move-line-method-create-analytic-distribution">
    <call class="com.axelor.apps.account.web.MoveLineController"
      method="createAnalyticDistributionWithTemplate"/>
  </action-method>

  <action-method name="action-method-account-moveline-usher-process">
    <call class="com.axelor.apps.account.web.MoveLineController" method="usherProcess"/>
  </action-method>
  <action-method name="action-account-move-line-method-calculate-balance">
    <call class="com.axelor.apps.account.web.MoveLineController" method="showCalculatedBalance"/>
  </action-method>

  <action-method name="action-move-line-method-get-account-informations">
    <call class="com.axelor.apps.account.web.MoveLineController"
      method="loadAccountInformation"/>
  </action-method>

  <action-method name="action-move-line-method-refresh-account-informations">
    <call class="com.axelor.apps.account.web.MoveLineController"
      method="refreshAccountInformation"/>
  </action-method>

  <action-method name="action-move-line-account-method-get-validate-period">
    <call class="com.axelor.apps.account.web.MoveLineController" method="getValidatePeriod"/>
  </action-method>

  <action-attrs name="action-move-line-attrs-readonly">
    <attribute name="readonly" for="informationsPanel"
      expr="eval: move?.statusSelect == 3 || move?.statusSelect == 4"/>
    <attribute name="readonly" for="analyticDistributionPanel"
      expr="eval: move?.statusSelect == 3 || move?.statusSelect == 4"/>
    <attribute name="readonly" for="irrecoverableDetailsPanel,currency,othersPanel"
      expr="eval: move?.statusSelect == 3 "/>
  </action-attrs>

  <action-attrs name="action-move-line-attrs-domain-account">
    <attribute for="account" name="domain"
      if="__parent__ == null || __parent__?._model != 'com.axelor.apps.account.db.Move'"
      expr="eval: &quot; self.statusSelect = 1 AND self.company.id = ${move?.company?.id} AND (self.accountType.id IN (${(move?.journal?.validAccountTypeSet?.collect{it.id}+[0]).join(',')}) OR self.id IN (${(move?.journal?.validAccountSet?.collect{it.id}+[0]).join(',')})) &quot;"/>
    <attribute for="account" name="domain"
      if="__parent__ != null &amp;&amp; __parent__._model == 'com.axelor.apps.account.db.Move'"
      expr="eval: &quot; self.statusSelect = 1 AND self.company.id = ${__parent__?.company?.id} AND (self.accountType.id IN (${(__parent__?.journal?.validAccountTypeSet?.collect{it.id}+[0]).join(',')}) OR self.id IN (${(__parent__?.journal?.validAccountSet?.collect{it.id}+[0]).join(',')})) &quot;"/>
  </action-attrs>

  <action-attrs name="action-move-line-attrs-domain-partner">
    <attribute name="domain" for="partner"
      expr="eval: &quot;self.isContact = false AND ${move?.company?.id} MEMBER OF self.companySet&quot;"
      if="__parent__ == null || __parent__._model != 'com.axelor.apps.account.db.Move'"/>
  </action-attrs>

  <action-attrs name="action-move-line-attrs-set-domain-analytic-distribution-template">
    <attribute name="domain" for="analyticDistributionTemplate"
      expr="eval: &quot; self.company.id = ${__parent__?.company.id} AND self.isSpecific=false &quot;"/>
  </action-attrs>

  <action-record name="action-record-initialize-permission-validation-move-line"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="$validatePeriod"
      expr="call:com.axelor.apps.account.service.move.MoveToolService:isTemporarilyClosurePeriodManage(__this__.move?.period,__user__)"/>
  </action-record>

  <action-record name="action-account-move-line-record-calculate-balance"
    model="com.axelor.apps.base.db.Wizard">
    <field name="$credit" expr="eval: _credit" if="_credit != null"/>
    <field name="$debit" expr="eval: _debit" if="_debit != null"/>
    <field name="$balance" expr="eval: _balance" if="_balance != null"/>
  </action-record>

  <action-record name="action-move-line-record-get-move-informations"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="partner" expr="eval: __parent__?.partner"/>
    <field name="date" expr="eval: __parent__?.date"/>
    <field name="dueDate" expr="eval: __parent__?.date"/>
    <field name="originDate" expr="eval: __parent__?.originDate"/>
    <field name="origin" expr="eval: __parent__?.origin"/>
    <field name="description" expr="eval: __parent__?.description"/>
  </action-record>

  <action-record name="action-move-line-record-update-due-date"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="dueDate" expr="eval: date"/>
  </action-record>

  <action-record name="action-move-line-record-get-first-move-line-informations"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="interbankCodeLine"
      expr="eval: __parent__?.moveLineList.get(0).interbankCodeLine"
      if="eval: __parent__?.getInfoFromFirstMoveLineOk == true &amp;&amp; __parent__?.moveLineList != null &amp;&amp; __parent__?.moveLineList.size() != 0"/>
    <field name="description" expr="eval: __parent__?.moveLineList.get(0).description"
      if="eval: __parent__?.getInfoFromFirstMoveLineOk == true &amp;&amp; __parent__?.moveLineList != null &amp;&amp; __parent__?.moveLineList.size() != 0"/>
    <field name="exportedDirectDebitOk"
      expr="eval: __parent__?.moveLineList.get(0).exportedDirectDebitOk"
      if="eval: __parent__?.getInfoFromFirstMoveLineOk == true &amp;&amp; __parent__?.moveLineList != null &amp;&amp; __parent__?.moveLineList.size() != 0"/>
    <field name="partner" expr="eval: __parent__?.moveLineList.get(0).partner"
      if="eval: __parent__?.getInfoFromFirstMoveLineOk == true &amp;&amp; __parent__?.moveLineList != null &amp;&amp; __parent__?.moveLineList.size() != 0"/>
    <field name="origin" expr="eval: __parent__?.moveLineList.get(0).origin"
      if="eval: __parent__?.getInfoFromFirstMoveLineOk == true &amp;&amp; __parent__?.moveLineList != null &amp;&amp; __parent__?.moveLineList.size() != 0"/>
  </action-record>

  <action-method name="action-move-line-method-get-creditdebit-balance">
    <call class="com.axelor.apps.account.web.MoveLineController" method="balanceCreditDebit"/>
  </action-method>

  <action-method name="action-move-line-method-set-currencyRate"
    model="com.axelor.apps.account.db.MoveLine">
    <call class="com.axelor.apps.account.web.MoveLineController" method="computeCurrentRate"/>
  </action-method>

  <action-record name="action-move-line-record-set-currencyAmount"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="currencyAmount" expr="eval: (debit + credit) / currencyRate"
      if="debit + credit != 0"/>
  </action-record>

  <action-record name="action-move-line-record-set-amount"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="debit" expr="eval: currencyRate * currencyAmount" if="debit != 0"/>
    <field name="credit" expr="eval: currencyRate * currencyAmount" if="credit != 0"/>
  </action-record>

  <action-attrs name="action-move-line-attrs-hidden-reconcileLists">
    <attribute name="hidden" for="reconcileLists"
      expr="eval: __parent__?.statusSelect == 1" if="eval: __parent__?.statusSelect != null"/>
  </action-attrs>

  <action-validate name="action-move-line-debit-credit-validate">
    <alert message="An accounting moveline must have either a credit value or a debit value."
      if="debit &gt; 0 &amp;&amp; credit &gt; 0"/>
    <alert message="Debit and credit value cannot be negative."
      if="(debit != null &amp;&amp; debit &lt; 0)||(credit != null &amp;&amp; credit &lt; 0)"/>
  </action-validate>

  <action-record name="action-move-line-debit-credit-clean"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="debit" expr="0" if="debit &lt; 0"/>
    <field name="credit" expr="0" if="credit &lt; 0"/>
  </action-record>

  <action-record name="action-record-account-moveline-debit-onchange"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="credit" expr="0" if="credit != 0 &amp;&amp; debit != 0"/>
  </action-record>

  <action-record name="action-record-account-moveline-credit-onchange"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="debit" expr="0" if="credit != 0 &amp;&amp; debit != 0"/>
  </action-record>

  <action-record name="account-move-line-record-date-onchange"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="originDate" expr="eval: date"/>
  </action-record>

  <action-record name="action-move-line-record-set-debitcredit"
    model="com.axelor.apps.account.db.MoveLine">
    <field name="debit" expr="eval: currencyAmount * currencyRate"
      if="account?.commonPosition == 2"/>
    <field name="credit" expr="eval: currencyAmount * currencyRate"
      if="account?.commonPosition == 1"/>
  </action-record>

  <action-view name="action-account-view-show-move-lines" title="${label} move lines"
    model="com.axelor.apps.account.db.MoveLine">
    <view type="grid" name="move-line-grid"/>
    <view type="form" name="move-line-form"/>
    <domain>self.account.id = :_id</domain>
  </action-view>

  <action-view name="action-move-line-view-bank-reconciliation-lines"
    title="Bank reconciliation lines" model="com.axelor.apps.bankpayment.db.BankReconciliationLine">
    <view type="grid" name="bank-reconciliation-line-grid"/>
    <view type="form" name="bank-reconciliation-line-form"/>
    <domain>self.moveLine = :_id</domain>
    <context name="_id" expr="eval: id"/>
  </action-view>

  <action-attrs name="action-move-line-attrs-show-tax-amount"
    model="com.axelor.apps.account.db.MoveLine">
    <attribute name="hidden" for="taxAmount"
      expr="eval: !( account?.reconcileOk &amp;&amp; account?.useForPartnerBalance)"/>
  </action-attrs>

  <action-method name="action-account-move-line-method-filter-partner">
    <call class="com.axelor.apps.account.web.MoveLineController" method="filterPartner"/>
  </action-method>

  <action-method name="action-move-line-method-description-required">
    <call class="com.axelor.apps.account.web.MoveLineController" method="descriptionRequired"/>
  </action-method>

  <action-method name="action-account-move-line-method-update-tax-move-line">
    <call class="com.axelor.apps.account.web.MoveLineController" method="updateTaxMoveLine"/>
  </action-method>

  <search-filters name="move-line-filters"
    model="com.axelor.apps.account.db.MoveLine" title="Move line filters">
    <field name="move.period" title="Period"/>
    <field name="move.journal" title="Journal"/>
    <field name="move.statusSelect" title="Status"/>
    <field name="move.company" title="Company" hidden="true"
      if="!__config__.app.getApp('base')?.getEnableMultiCompany()"/>
    <field name="account.reconcileOk" title="Reconcilable"/>
    <field name="analyticMoveLineList" hidden="true"
      if="!__config__.app.getApp('account')?.getManageAnalyticAccounting()"/>
    <field name="analyticDistributionTemplate" hidden="true"
      if="!__config__.app.getApp('account')?.getManageAnalyticAccounting()"/>
    <filter title="Sale Entries">
      <domain>self.move.invoice.operationTypeSelect = 3 OR self.move.invoice.operationTypeSelect = 4</domain>
    </filter>
    <filter title="Due Sale Entries">
      <domain>(self.move.invoice.operationTypeSelect = 3 OR self.move.invoice.operationTypeSelect =
        4) AND self.dueDate &lt; CURRENT_DATE AND self.amountRemaining &gt; 0</domain>
    </filter>
    <filter title="Purchase Entries">
      <domain>self.move.invoice.operationTypeSelect = 1 OR self.move.invoice.operationTypeSelect = 2</domain>
    </filter>
    <filter title="Simulated Move Lines">
      <domain>self.move.statusSelect = 5</domain>
    </filter>
  </search-filters>

  <action-method name="action-move-line-validate-check-date-in-period">
    <call class="com.axelor.apps.account.web.MoveLineController" method="checkDateInPeriod"/>
  </action-method>

  <action-method name="action-account-move-line-method-set-partner-readonly">
    <call class="com.axelor.apps.account.web.MoveLineController" method="setPartnerReadonlyIf"/>
  </action-method>

  <action-method name="action-method-move-line-axis-create-analytic-line">
    <call class="com.axelor.apps.account.web.MoveLineController"
      method="createAnalyticAccountLines"/>
  </action-method>

  <action-method name="action-attrs-move-line-set-domain-axis">
    <call class="com.axelor.apps.account.web.MoveLineController" method="setAxisDomains"/>
  </action-method>

  <action-method name="action-method-move-line-set-required-analytic-accounts">
    <call class="com.axelor.apps.account.web.MoveLineController"
      method="setRequiredAnalyticAccount"/>
  </action-method>

  <action-method name="action-method-change-account-set-default-distribution-template">
    <call class="com.axelor.apps.account.web.MoveLineController"
      method="selectDefaultDistributionTemplate"/>
  </action-method>

  <action-method name="action-method-move-line-hide-axis-analytic-account">
    <call class="com.axelor.apps.account.web.MoveLineController" method="manageAxis"/>
  </action-method>

</object-views>
