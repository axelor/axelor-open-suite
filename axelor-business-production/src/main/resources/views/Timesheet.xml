<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_7.4.xsd">

  <form id="business-production-timesheet-form" name="timesheet-form" title="Timesheet"
    model="com.axelor.apps.hr.db.Timesheet" extension="true">
    <extend target="//field[@name='employee']">
      <insert position="after">
        <field if-module="axelor-business-production"
          if=" __config__.app.getApp('production')?.getManageBusinessProduction()"
          name="employee.timesheetImputationSelect" hidden="true"/>
      </insert>
    </extend>

    <extend target="//panel-dashlet[@name='timesheetLineEditorPanel']">
      <insert position="after">
        <panel-related name="timesheetLineListPanel" field="timesheetLineList"
          colSpan="12" height="20" grid-view="timesheet-line-timesheet-manuf-order-grid"
          editable="true" form-view="timesheet-line-timesheet-manuf-order-form" hidden="true"
          showIf="!showEditor &amp;&amp; !$readonly() &amp;&amp; $enableTimesheetManufOrder &amp;&amp; employee.timesheetImputationSelect == 2"
          x-can-copy="true" if-module="axelor-business-production"
          if=" __config__.app.getApp('production')?.getManageBusinessProduction()"/>
        <panel-related name="timesheetLineListPanel" field="timesheetLineList"
          colSpan="12" height="20" grid-view="timesheet-line-timesheet-readonly-manuf-order-grid"
          form-view="timesheet-line-timesheet-manuf-order-form" hidden="true"
          showIf="!showEditor &amp;&amp; $readonly() &amp;&amp; $enableTimesheetManufOrder &amp;&amp; employee.timesheetImputationSelect == 2"
          x-can-copy="true" if-module="axelor-business-production"
          if=" __config__.app.getApp('production')?.getManageBusinessProduction()"/>
      </insert>
    </extend>
  </form>

  <action-attrs name="action-timesheet-attrs-enable-timesheet-manuforder">
    <attribute for="$enableTimesheetManufOrder" name="value"
      expr="eval: __config__.app.getApp('production')?.getEnableTimesheetOnManufOrder()"/>
  </action-attrs>

  <action-method name="action-timesheet-method-update-operation-order">
    <call class="com.axelor.apps.businessproduction.web.TimesheetController"
      method="updateOperationOrders"/>
  </action-method>

  <action-group id="business-production-action-timesheet-group-onload"
    name="action-timesheet-group-onload">
    <action name="action-timesheet-method-set-show-activity"/>
    <action name="action-timesheet-attrs-enable-timesheet-manuforder"
      if="__config__.app.getApp('production')?.getManageBusinessProduction()"/>
    <action name="action-timesheet-group-buttons"/>
    <action name="action-timesheet-attrs-set-visible-duration-title"/>
    <action name="action-timesheet-attrs-title-project"/>
    <action name="action-timesheet-attrs-from-date"/>
    <action name="action-timesheet-attrs-panels"/>
    <action name="action-timesheet-attrs-refresh-editor"/>
    <action name="action-timesheet-method-timesheet-compute-period-total"/>
    <action name="action-timesheet-method-init-project-planning"/>
  </action-group>

  <action-group id="business-production-action-timesheet-group-onsave"
    name="action-timesheet-group-onsave">
    <action name="action-timesheet-validate-toDate"/>
    <action name="action-timesheet-method-update-operation-order"
      if="__config__.app.getApp('production')?.getManageBusinessProduction()"/>
  </action-group>

  <action-group id="business-production-action-timesheet-group-employee-onchange"
    name="action-timesheet-group-employee-onchange">
    <action name="action-timesheet-record-default"/>
    <action name="action-timesheet-method-set-show-activity"/>
    <action name="action-timesheet-attrs-enable-timesheet-manuforder"
      if="__config__.app.getApp('production')?.getManageBusinessProduction()"/>
    <action name="action-timesheet-group-buttons"/>
    <action name="action-timesheet-attrs-set-visible-duration-title"/>
    <action name="action-timesheet-record-from-period-date"/>
    <action name="action-timesheet-record-to-date" if="fromDate != null"/>
    <action name="action-timesheet-prefill-lines"
      if="toDate != null &amp;&amp; (__config__.app.getApp('timesheet')?.getCreateLinesForLeaves() || __config__.app.getApp('timesheet')?.getCreateLinesForHolidays())"/>
    <action name="action-timesheet-attrs-title-project"/>
    <action name="action-timesheet-attrs-from-date-on-new"/>
    <action name="action-timesheet-attrs-panels"/>
    <action name="action-validate-check-user-employee"/>
    <action name="action-timesheet-method-timesheet-compute-period-total"/>
    <action name="action-timesheet-method-init-project-planning"/>
  </action-group>

  <search-filters id="business-production-timesheet-filters" name="timesheet-filters"
    model="com.axelor.apps.hr.db.Timesheet" title="Timesheet filters">
    <field name="company" hidden="true"
      if="!__config__.app.getApp('base')?.getEnableMultiCompany()"/>
    <field name="showEditor" hidden="true"
      if="!(__config__.app.isApp('timesheet') &amp;&amp; __config__.app.getApp('timesheet')?.getTimesheetEditor())"/>
    <field name="employee.timesheetImputationSelect" hidden="true"
      if="!(__config__.app.isApp('production') &amp;&amp; __config__.app.getApp('production')?.getManageBusinessProduction())"/>
    <field name="timesheetLineList" hidden="true"
      if="!(__config__.app.isApp('production') &amp;&amp; __config__.app.getApp('production')?.getManageBusinessProduction())"/>
  </search-filters>

</object-views>