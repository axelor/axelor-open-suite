<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_6.1.xsd">

  <grid name="product-reservation-grid" title="Product reservation"
    model="com.axelor.apps.production.db.ProductReservation" orderBy="product.code">
    <field name="productReservationType" selection="stock.product.reservation.type.select"
      required="true" title="Request type"/>
    <field name="product" ref="com.axelor.apps.base.db.Product" required="true"
      title="Product"/>
    <field name="qty" required="true" title="Quantity"/>
    <field name="requestedReservedType" selection="stock.requested.reservation.type.select"
      title="Type of reservation"/><!-- TODO traduire -->
    <field name="priorityReservationDateTime" title="Reservation priority date"/><!-- TODO traduire -->
    <field name="stockLocation" ref="com.axelor.apps.stock.db.StockLocation"
      title="Stock Location"/>
    <field name="trackingNumber" ref="com.axelor.apps.stock.db.TrackingNumber"
      title="Tracking number"/>
    <field name="originSaleOrderLine" ref="com.axelor.apps.sale.db.SaleOrderLine"
      title="Sale order lines"/>
    <field name="originManufOrder" ref="com.axelor.apps.production.db.ManufOrder"
      title="Manuf order"/>
    <field name="productReservationStatus" selection="stock.product.reservation.status.select"
      readonly="true" required="true" title="Status"/>
  </grid>

  <form name="product-reservation-form" title="Reservations / allocations"
    model="com.axelor.apps.production.db.ProductReservation" width="large"
    onSave="action-method-product-reservation-update-status">
    <panel name="mainPanel">
      <panel name="general" showFrame="true" colSpan="12">
        <field name="productReservationType" title="Request type" required="true"
          selection="stock.product.reservation.type.select" colSpan="6"/>
        <field name="productReservationStatus" title="Status" colSpan="6"/>
        <field name="product" title="Product"
          domain="self.productTypeSelect = 'storable' AND self.dtype = 'Product'" required="true"
          ref="com.axelor.apps.base.db.Product" colSpan="6"/>
        <field name="qty" title="Quantity" required="true" colSpan="6"/>
        <field name="description" title="Description" colSpan="12" widget="html" large="true"/>
      </panel>
      <panel name="reservation" showIf="productReservationType == 1" colSpan="12"
        title="Reservation">
        <field name="priorityReservationDateTime" title="Reservation priority date"
          widget="date-time" colSpan="6"/>
        <field name="requestedReservedType" title="Type of reservation"
          showIf="productReservationType == 1" requiredIf="productReservationType == 1"
          selection="stock.requested.reservation.type.select" colSpan="6"/>
        <field name="originSaleOrderLine" title="Sale order lines"
          requiredIf="originManufOrder == null" colSpan="6"/>
        <field name="originManufOrder" title="Manuf order"
          requiredIf="originSaleOrderLine == null" colSpan="6"/>
      </panel>
      <panel name="allocation" showIf="productReservationType == 2" colSpan="12"
        title="Allocation">
        <field name="stockLocation" title="Stock Location" colSpan="6"/>
        <field name="trackingNumber" title="Tracking number"
          showIf="product.trackingNumberConfiguration != null" colSpan="6"/>
        <field name="product.trackingNumberConfiguration" showIf="false"/>
      </panel>
    </panel>
  </form>


  <action-method name="action-method-product-reservation-update-status">
    <call class="com.axelor.apps.production.web.ProductReservationController"
      method="updateStatus"/>
  </action-method>

</object-views>
