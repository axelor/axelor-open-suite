/*
 * Axelor Business Solutions
 *
 * Copyright (C) 2019 Axelor (<http://axelor.com>).
 *
 * This program is free software: you can redistribute it and/or  modify
 * it under the terms of the GNU Affero General Public License, version 3,
 * as published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
webpackJsonp([1],{0:function(e,t,n){n(501),e.exports=n(622)},59:function(e,t){"use strict";function n(e){return window._t&&"string"==typeof e?window._t(e):e}Object.defineProperty(t,"__esModule",{value:!0}),t.translate=n;t.camleCaseString=function(e){var t=e.replace(/([A-Z])/g," $1").replace(/^./,function(e){return e.toUpperCase()});return t}},137:function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r={Accept:"application/json","Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},o=function(){function e(t){n(this,e),this.state={restURL:"../../ws/rest/"}}return a(e,[{key:"doLogin",value:function(e,t){fetch(this.state.baseURL+"login.jsp",{method:"POST",credentials:"include",headers:r,body:JSON.stringify({username:e,password:t})}).then(function(e){})}},{key:"info",value:function(){fetch(this.state.baseURL+"ws/app/info",{method:"GET",credentials:"include",headers:r}).then(function(e){return console.log(e)})}},{key:"updateModel",value:function(e,t){return fetch(""+this.state.restURL+t,{method:"POST",credentials:"include",headers:r,body:JSON.stringify({data:e})}).then(function(e){return e.json()}).then(function(e){return e})}},{key:"fetchModel",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],this),n=arguments[2],a=arguments[3];return fetch(""+this.state.restURL+n+"/"+e+"/fetch",{method:"POST",credentials:"include",headers:r,body:JSON.stringify({})}).then(function(e){return e.json()}).then(function(e){var n=e.data[0],r=[],o=n.fields||n.metaFields,i="com.axelor.meta.db."+a,l=[];o.forEach(function(e){var t=e.id;return l.push(t)});var s=["sequence"];return r.push({fieldName:"id",operator:"in",value:l}),t.search(i,r,0,-1,s).then(function(e){var t=e.data;return n.fields=t,n})})}},{key:"delete",value:function(e,t){return fetch(""+this.state.restURL+e+"/"+t,{method:"DELETE",credentials:"include",headers:r}).then(function(e){return e.json()}).then(function(e){return e})}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2],a=arguments[3],o=arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=JSON.stringify({data:{_domain:l,criteria:t,operator:"and"},offset:n,limit:a,sortBy:o});if(i.length>0){var d=JSON.parse(s);d.fields=i,s=JSON.stringify(d)}return fetch(""+this.state.restURL+e+"/search",{method:"POST",credentials:"include",headers:r,body:s}).then(function(e){return e.json()}).then(function(e){return e})}}]),e}();t.default=o},240:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={CONTAINER:"panel",ROOTCONTAINER:"root-container",ITEM:"item",DUMMY:"dummy"}},241:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.colspanElemetList=["panel","oneToMany","jsonManyToMany","jsonOneToMany","manyToMany"],t.convertCamleToDashedString=function(e){return e.split(/(?=[A-Z])/).map(function(e){return e.toLowerCase()}).join("-")}},278:function(e,t){},501:function(e,t,n){"use strict";"undefined"==typeof Promise&&(n(873).enable(),window.Promise=n(872)),n(1137),Object.assign=n(9)},613:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(1),d=a(s);n(772),n(1135);var u=n(614),c=a(u),f=n(38),p=f.Layout.Content,h=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return d.default.createElement(f.Layout,null,d.default.createElement(p,null,d.default.createElement("div",{className:"App",style:{marginTop:25}},d.default.createElement(c.default,null))))}}]),t}(s.Component);t.default=h},614:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function l(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.sequenceChild=t.sequenceArrayElements=t.reorderArrayElements=void 0;var s=function(){function e(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(a=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{!a&&l.return&&l.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(1),c=a(u),f=n(190),p=n(1025),h=a(p),m=n(38),y=n(240),v=a(y),g=n(618),b=a(g),E=n(619),S=a(E),D=n(616),M=a(D),O=n(615),w=a(O),I=n(59),N=n(137),T=a(N),C=n(241),k=m.Select.Option,F=m.Modal.confirm,x=[],j=1,R=[],_={},P=[],J="com.axelor.meta.db.MetaJsonModel",A="MetaJsonField",L=["one-to-many","many-to-many","many-to-one"],q=["json-many-to-many","json-many-to-one","json-one-to-many"],W=function(e){return e.split(/(?=[A-Z])/).map(function(e){return e.toLowerCase()}).join("-")},B=t.reorderArrayElements=function(e){var t=e.containers,n=void 0===t?[]:t,a=e.size;if(n.length===a)return n;for(var r=[],o=Math.max.apply(Math,l(n.map(function(e){return e.length}))),i=[],s=function(e){e&&i.push(e)},d=0;d<o;d++)for(var u=0;u<n.length;u++)s(n[u][d]);for(var c=0;c<a;c++)r.push([]);for(var f=0;f<i.length;)for(var p=0;p<r.length;p++)if(i[f]){var h=i[f++];h.column=p+1,r[p].push(h)}return r},U=t.sequenceArrayElements=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=1,a=Math.max.apply(Math,l(e.map(function(e){return e.length})));a=t?e.length:a;for(var r=function(a){if(t){var r=e[a];r&&r.nodeId!==v.default.DUMMY&&(r.nodeData.properties.sequence=n,n++)}else e.forEach(function(e){var t=e[a];t&&t.nodeId!==v.default.DUMMY&&(t.nodeData.properties.sequence=n,n++)})},o=0;o<a;o++)r(o);return e},Y=t.sequenceChild=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Math.max.apply(Math,l(e.map(function(e){return e.length}))),n=0;n<t;n++)for(var a=0;a<e.length;a++){var r=e[a][n];r&&r.nodeId!==v.default.DUMMY&&(e[a][n].nodeData.properties.sequence=j,j++)}return e},H={onNew:null,onSave:null,name:"",title:"",appBuilder:null,menuParent:null,menuTop:!1,menuTitle:"",menuBackground:"",menuIcon:"",menuOrder:null},V=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.propertiesForm=null,n.state={spinner:!1,isNew:!0,elements:[{name:"string",type:v.default.ITEM,image:"integer.png"},{name:"integer",type:v.default.ITEM,image:"integer.png"},{name:"decimal",type:v.default.ITEM,image:"integer.png"},{name:"boolean",type:v.default.ITEM,image:"integer.png"},{name:"datetime",type:v.default.ITEM,image:"integer.png"},{name:"date",type:v.default.ITEM,image:"integer.png"},{name:"time",type:v.default.ITEM,image:"integer.png"},{name:"button",type:v.default.ITEM,image:"integer.png"},{name:"separator",type:v.default.ITEM,image:"integer.png"},{name:"manyToOne",type:v.default.ITEM,image:"integer.png"},{name:"manyToMany",type:v.default.ITEM,image:"integer.png"},{name:"oneToMany",type:v.default.ITEM,image:"integer.png"},{name:"jsonManyToOne",type:v.default.ITEM,image:"integer.png"},{name:"jsonManyToMany",type:v.default.ITEM,image:"integer.png"},{name:"jsonOneToMany",type:v.default.ITEM,image:"integer.png"},{name:"panel",type:v.default.CONTAINER,image:"panel.png"}],editor:{nodeData:{name:"Form",type:v.default.ROOTCONTAINER,properties:H},column:1,nodeId:"root"},customFieldRemoveList:[],modelList:[],metaModelList:[],customJsonFieldList:[],activeJsonModel:void 0,activeMetaModel:void 0,activeJsonField:void 0,activeEntity:"",dropData:{nodeId:"root",column:1,nodeData:{name:"Form",type:v.default.ROOTCONTAINER,properties:H,children:[[n.getDummyNode()]]}},counter:1,windowHeight:200,windowWidth:200,formTitle:"Custom Model"},n.updateWindowDimensions=n.updateWindowDimensions.bind(n),n}return i(t,e),d(t,[{key:"createNewForm",value:function(){var e=this;this.setState({isNew:!0,activeEntity:"MetaJsonModel",counter:1},function(){e.resetState()})}},{key:"getModelForm",value:function(e,t,n){var a=this;this.setState({spinner:!0});var r=new T.default;this.getModelList(r),r.fetchModel(e,[],t,n).then(function(e){Object.keys(H).forEach(function(t){H[t]=e[t]});var t={nodeId:"root",column:1,nodeData:{type:v.default.ROOTCONTAINER,properties:Object.assign({},H,{version:e.version,id:e.id}),children:[]}},n=a.listToColumn(JSON.parse(JSON.stringify(e.fields))),r=n.fieldData,o=n.counter;t.nodeData.children=r,a.selectItem({nodeData:t.nodeData,nodeId:t.nodeId}),a.setState({dropData:t,counter:o,spinner:!1})})}},{key:"getModelList",value:function(e){var t=this,n=[];n.push(e.search("com.axelor.meta.db.MetaJsonModel",[],0,null,["name"]).then(function(e){var t=e.data,n=void 0===t?[]:t;return n}));var a="self.metaFields.json = true AND self.fullName NOT LIKE 'com.axelor.meta.db%'";n.push(e.search("com.axelor.meta.db.MetaModel",[],0,null,["name"],[],a).then(function(e){var t=e.data,n=void 0===t?[]:t;return n})),Promise.all(n).then(function(e){var n=s(e,2),a=n[0],r=n[1];t.setState({modelList:a,metaModelList:r})})}},{key:"error",value:function(e,t){m.Modal.error({title:e,content:t})}},{key:"validateData",value:function(e){var t=e.nodeData.properties;if(""!==t.name&&""!==t.title){var n=e.nodeData.children,a=!1;return n.forEach(function(e){e.length>=1&&e[0].nodeId!==v.default.DUMMY&&(a=!0)}),a?{valid:!0}:{valid:!1,message:"Form Requires at least one Element"}}return{valid:!1,message:"Form Properties Required"}}},{key:"prepareList",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=e.nodeData,r=e.nodeId;if("root"===r)_=Object.assign({},a.properties,{fields:[]});else{var o=a.properties;if(r===v.default.DUMMY)return;var i=JSON.parse(o.widgetAttrs);i=Object.assign({},i,{col:n}),a.children&&(i=Object.assign({},i,{itemSpan:12/a.children.length})),o.widgetAttrs=JSON.stringify(i);var l=Object.assign({},o);R.push(l)}a.children&&a.children.forEach(function(e,n){e.forEach(function(e){t.prepareList(e,n+1)})})}},{key:"makeSequence",value:function(e){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++){var a=e[t][n];a.nodeId!==v.default.DUMMY&&(a.nodeData.properties.sequence=j,j++,a.nodeData.children&&(a.nodeData.children=Y(a.nodeData.children)))}return e}},{key:"saveFormData",value:function(e){var t=this;j=0,e.nodeData.children=this.makeSequence(e.nodeData.children),R.splice(0,R.length),this.prepareList(e);var n=new T.default;"MetaJsonModel"===this.state.activeEntity?(_.fields=R,n.updateModel(_,"com.axelor.meta.db.MetaJsonModel").then(function(n){200===n.status&&m.Modal.success({title:"Success",content:"Form saved successfully"});var a=e.nodeData.properties.id||n.data[0].id;t.getModelForm(a,J,A)})):R.length>0?Promise.all(R.map(function(e){return n.updateModel(e,"com.axelor.meta.db.MetaJsonField")})).then(function(e){Promise.all(t.state.customFieldRemoveList.map(function(e){return n.delete("com.axelor.meta.db.MetaJsonField",e.properties.id)})).then(function(e){t.loadCustomFieldModel(t.state.activeJsonField)})}):this.state.customFieldRemoveList.length&&Promise.all(this.state.customFieldRemoveList.map(function(e){return n.delete("com.axelor.meta.db.MetaJsonField",e.properties.id)})).then(function(e){t.loadCustomFieldModel(t.state.activeJsonField)})}},{key:"convertFormToList",value:function(){var e=this,t=JSON.parse(JSON.stringify(this.state.dropData));null!==this.propertiesForm&&null!==this.state.editor.nodeId&&"root"===this.state.editor.nodeId?this.propertiesForm.validateFieldsAndScroll(function(n,a){n||(Object.keys(a).forEach(function(e){a[e]=""===a[e]||void 0===a[e]?null:a[e]}),t=Object.assign({},t,{nodeData:Object.assign({},t.nodeData,{properties:Object.assign({},t.nodeData.properties,a)})}),e.saveFormData(t))}):null!==this.propertiesForm&&null!==this.state.editor.nodeId&&"root"!==this.state.editor.nodeId?this.propertiesForm.validateFieldsAndScroll(function(t,n){t||(Object.keys(n).forEach(function(e){n[e]=""===n[e]||void 0===n[e]?null:n[e]}),e.changeProperty(n))}):this.saveFormData(t)}},{key:"createChildColumns",value:function(e){for(var t=[],n=0;n<e;n++)t.push([]);return t}},{key:"getDummyNode",value:function(e){return{nodeId:v.default.DUMMY,nodeData:{name:"",type:v.default.ITEM},parentId:e}}},{key:"checkEmptyColumns",value:function(e,t){var n=this;e.forEach(function(e){e.push(n.getDummyNode(t))})}},{key:"allocateChildren",value:function(e,t){for(var n=0;e.length>n;)for(var a=0;a<t.length;a++)e[n]&&t[a].push(e[n]),n++;return t}},{key:"listToColumn",value:function(e){var t=[],n=1,a=!0,r=[],o=[],i={};r=this.createChildColumns(1);for(var l=0;l<e.length;l++){var s=e[l];if(s.type!==v.default.CONTAINER||s.isWkf){var d={nodeId:n,isExists:!0,nodeData:{type:s.type!==v.default.CONTAINER?v.default.ITEM:v.default.CONTAINER,properties:s}};o.push(d)}else{a?(a=!1,t.push(o),o=[],r=[]):(r=this.allocateChildren(o,r),this.checkEmptyColumns(r,i.nodeId),i.nodeData.children=r,t[0].push(i),i={},o=[],r=[]);var u=JSON.parse(s.widgetAttrs),c=parseInt(null!==u&&u.itemSpan?u.itemSpan:6,10);r=this.createChildColumns(12/c),i={nodeId:n,column:parseInt(null!==u&&u.itemSpan?u.col:1,10),isExists:!0,nodeData:{type:v.default.CONTAINER,properties:s,children:[]}}}n++}return a?(a=!1,t.push(o),o=[],r=[]):(r=this.allocateChildren(o,r),this.checkEmptyColumns(r,i.nodeId),i.nodeData.children=r,t[0].push(i),i={},o=[],r=[]),t[0].push(this.getDummyNode("root")),{fieldData:t,counter:n}}},{key:"componentDidMount",value:function(){var e=new T.default;this.getModelList(e),this.createNewForm(),window.addEventListener("resize",this.updateWindowDimensions),this.updateWindowDimensions()}},{key:"updateWindowDimensions",value:function(){this.setState({windowHeight:window.innerHeight,windowWidth:window.innerWidth})}},{key:"updateNodeId",value:function(e){var t=1;return e.forEach(function(e,n){e.nodeId=t,t++}),e}},{key:"trashNode",value:function(e,t){var n=this,a=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],t.nodeData),r=t.nodeId;return r===e||(a.children&&a.children.forEach(function(t,o){t.forEach(function(o,i){var l=n.trashNode(e,o);l===!0&&(t.splice(i,1),0===t.length&&t.push({nodeId:v.default.DUMMY,nodeData:{name:"",type:v.default.ITEM},parentId:r}),a.children=U(a.children))})},this),t)}},{key:"getRemoveList",value:function(e){var t=this,n=e.nodeData;e.nodeId;n.properties&&n.properties.id&&P.push(n),n.children&&n.children.length&&n.children.forEach(function(e){e.forEach(function(e){t.getRemoveList({nodeData:e.nodeData,nodeId:e.nodeId})})},this)}},{key:"onTrashDrop",value:function(e){var t=this,n=e.nodeData,a=e.nodeId;if(a){var r=this.trashNode(a,JSON.parse(JSON.stringify(this.state.dropData))),o={nodeData:{name:"Form",type:v.default.ROOTCONTAINER,properties:H},column:1,nodeId:"root"},i=this.state.customFieldRemoveList;P.splice(0,P.length),this.getRemoveList({nodeData:n,nodeId:a}),i=i.concat(P),this.setState({customFieldRemoveList:i,dropData:r,editor:o},function(){var e=t.state.dropData;t.selectItem({nodeId:e.nodeId,nodeData:e.nodeData})})}}},{key:"onDropNode",value:function(e){var t=e.nodeData,n=e.nodeId,a=this.state.dropData;if(null===n){var r=JSON.parse(JSON.stringify(t));if(r.name=t.name+" "+this.state.counter,r.properties=M.default,r.type===v.default.CONTAINER){var o={nodeId:v.default.DUMMY,nodeData:{name:"",type:v.default.ITEM},parentId:r.nodeId};r.children=[[o]]}a.push({nodeData:r,nodeId:this.state.counter}),a=U(a),this.setState({dropData:a,counter:this.state.counter+1})}}},{key:"updateNodeData",value:function(e,t,n,a){var r=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=null;if(o)n.forEach(function(n,a){var o=r.updateNodeData(e,t,n,1);o===!0&&(i=a)}),null!==i&&(1===n.length&&n[0].nodeId===v.default.DUMMY&&n.splice(0,1),"panel"===t.nodeData.type&&(i=0===i?i:i-1),n.splice(i,0,e),i=null,n=U(n));else{var l=n,s=l.nodeData,d=l.nodeId;if(d===t.nodeId&&a===t.col)return!0;s.children&&s.children.forEach(function(n,a){n.forEach(function(n,o){var l=r.updateNodeData(e,t,n,a);l===!0&&(i=o)}),null!==i&&t.parent===d&&(e.column=a+1,"panel"===t.nodeData.type&&(i=0===i?i:i-1),e.parent=d,n.splice(i,0,e),i=null,s.children=U(s.children))},this)}return n}},{key:"deleteNodeData",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(a)t.forEach(function(a,r){var o=n.deleteNodeData(e,a);o===!0&&(t.splice(r,1),0===t.length&&t.push({nodeId:v.default.DUMMY,nodeData:{name:"",type:v.default.ITEM},parentId:"root"}),t=U(t))});else{var r=t,o=r.nodeData,i=r.nodeId;if(i===e)return!0;o.children&&o.children.forEach(function(t,a){t.forEach(function(a,r){var l=n.deleteNodeData(e,a);l===!0&&(t.splice(r,1),0===t.length&&t.push({nodeId:v.default.DUMMY,nodeData:{name:"",type:v.default.ITEM},parentId:i}),o.children=U(o.children))},n)})}return t}},{key:"isHoverItemChildren",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=e.nodeData,r=e.nodeId;if(r===t.nodeId&&r!==v.default.DUMMY)return!0;if(r===v.default.DUMMY&&n===t.parent)return!0;if(a.children)for(var o=a.children,i=0;i<o.length;i++)for(var l=o[i],s=0;s<l.length;s++)if(this.isHoverItemChildren(l[s],t,r))return!0;return!1}},{key:"getSubChildrenArray",value:function(e){var t=[{nodeId:v.default.DUMMY,nodeData:{name:"",type:v.default.ITEM},parentId:e}];return t}},{key:"createNewPanelChild",value:function(e){var t=[];return t.push(this.getSubChildrenArray(e)),t.push(this.getSubChildrenArray(e)),t}},{key:"swapNodes",value:function(e,t,n){var a=this;if(t&&n){var r=e.nodeData,o=e.nodeId;if(o===t.parent){var i=null,l=null,s=r.children[t.column-1];if(s.forEach(function(e,a){e.nodeId===t.nodeId&&(i=a),e.nodeId===n.nodeId&&(l=a)}),null!==i&&null!==l){var d=s[i];return s[i]=s[l],s[l]=d,r.children[t.column-1]=s,e.nodeData=r,e}}r.children&&r.children.forEach(function(e,r){for(var o=0;o<e.length;o++)e[o]=a.swapNodes(e[o],t,n)})}return e}},{key:"isBeforePanel",value:function(e,t){var n=!0;return"root"===e.parent&&this.state.dropData.nodeData.children.forEach(function(a){for(var r=0;r<a.length;r++){var o=a[r];if(o.nodeId===e.nodeId){var i=a[r-1];i&&"panel"===i.nodeData.type&&"panel"!==t.nodeData.type?n=!1:"panel"===t.nodeData.type&&"panel"!==e.nodeData.type&&e.nodeId!==v.default.DUMMY&&(n=!1)}}}),n}},{key:"setIsExists",value:function(e,t){var n=e.nodeData,a=e.nodeId;if(a===t.nodeId&&(e.isExists=!0),n.children&&n.children.length)for(var r=0;r<n.children.length;r++)for(var o=n.children[r],i=0;i<o.length;i++)o[i]=this.setIsExists(o[i],t);return e}},{key:"getNameAndTitle",value:function(e){for(var t=1,n=""+e+t,a=(0,I.translate)((0,I.camleCaseString)(e))+" "+t;this.existsCheck(this.state.dropData,"name",n);)t++,n=""+e+t,a=(0,I.translate)((0,I.camleCaseString)(e))+" "+t;return{name:n,title:a}}},{key:"moveNode",value:function(e,t,n){var a=this;if(this.isBeforePanel(t,e))if(e.parent===t.parent&&e.column===t.column&&t.nodeId!==v.default.DUMMY){if("panel"===t.nodeData.type&&"panel"!==e.nodeData.type)return;var r=this.swapNodes(JSON.parse(JSON.stringify(this.state.dropData)),e,t);this.setState({dropData:r})}else{var o=JSON.parse(JSON.stringify(this.state.dropData)),i=o,l=this.state.counter;if(!this.isHoverItemChildren(e,t)){if(null!==e.nodeId)i=this.deleteNodeData(e.nodeId,o);else{var s=Object.assign({},M.default),d=this.state.metaModelList.filter(function(e){return e.id===a.state.activeMetaModel})[0],u=this.state.customJsonFieldList.filter(function(e){return e.id===a.state.activeJsonField})[0];e=JSON.parse(JSON.stringify(e)),e.nodeId=l;var c={};c.tab="false","panel"===e.nodeData.name&&(c.width="default",delete s.widget),"panel"!==e.nodeData.name&&(c.showTitle="true"),["oneToMany","manyToMany","jsonManyToMany","jsonOneToMany"].indexOf(e.nodeData.name)>=0&&(s.visibleInGrid="false");var f=C.colspanElemetList.findIndex(function(t){return t===e.nodeData.name});f!==-1&&(c.colSpan=12);var p=this.getNameAndTitle(e.nodeData.name);e.nodeData.properties=Object.assign({},s,{model:"MetaJsonField"===this.state.activeEntity&&d?d.fullName:M.default.model,modelField:"MetaJsonField"===this.state.activeEntity&&u?u.name:M.default.modelField,title:p.title,name:p.name,widgetAttrs:JSON.stringify(c),type:W(e.nodeData.name)}),e.nodeData.name=e.nodeData.name+" "+l,e.nodeData.type===v.default.CONTAINER&&(e.nodeData.children=this.createNewPanelChild(l))}var h=this.updateNodeData(e,t,i,1);return this.setState({dropData:h}),{nodeId:e.nodeId,nodeData:e.nodeData}}}}},{key:"selectItem",value:function(e){var t=e.nodeData,n=e.nodeId,a={nodeData:t,nodeId:n,column:t.children?t.children.length:null};this.setState({editor:a})}},{key:"updateColumns",value:function(e,t,n){e.forEach(function(e){1===e.length&&e[0].nodeId===v.default.DUMMY&&e.splice(0,1)});var a=B({containers:e,size:t});return a.forEach(function(e){0===e.length&&e.push({nodeId:v.default.DUMMY,nodeData:{name:"",type:v.default.ITEM},parentId:n})}),a}},{key:"changeNodeData",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(a)e.forEach(function(e,a){e=n.changeNodeData(e,t)});else{var r=e.nodeData,o=e.nodeId;if(o===t.nodeId){var i=parseInt(t.column,10);r.children&&i===parseInt(i,10)&&(r.children=this.updateColumns(r.children,i,o)),r.name=t.nodeData.name}r.children&&r.children.forEach(function(e,a){e.forEach(function(e,a){e=n.changeNodeData(e,t)})},this)}return e}},{key:"updateNodeColumn",value:function(){var e=JSON.parse(JSON.stringify(this.state.dropData)),t=this.changeNodeData(e,this.state.editor);this.setState({dropData:t})}},{key:"updateProperties",value:function(e,t,n){var a=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(r)e.forEach(function(e,r){e=a.updateProperties(e,t,n)});else{var o=e.nodeData,i=e.nodeId;i===n&&(o.properties=Object.assign({},o.properties,t)),o.children&&o.children.forEach(function(e,r){e.forEach(function(e,r){e=a.updateProperties(e,t,n)})},this)}return e}},{key:"changeProperty",value:function(e){var t=JSON.parse(JSON.stringify(this.state.dropData)),n=this.state.editor.nodeId,a=JSON.parse(this.state.editor.nodeData.properties.widgetAttrs||"{}");if(e.tab&&(a.tab=e.tab),e.width&&(a.width=e.width),e.colSpan&&(a.colSpan=e.colSpan),e.showTitle&&"panel"!==e.type&&(a.showTitle=e.showTitle),e.widgetAttrs=JSON.stringify(a),Object.keys(e).forEach(function(t){e[t]=""===e[t]||void 0===e[t]?null:e[t]}),n){var r=this.updateProperties(t,e,n);this.setState({dropData:r,editor:Object.assign({},this.state.editor,{nodeData:Object.assign({},this.state.editor.nodeData,{properties:Object.assign({},this.state.editor.nodeData.properties,e)})})})}else{var o=this.state.FormProperties;o[e.field]=e.value,this.setState({FormProperties:o})}}},{key:"isFieldHasNullProperty",value:function(e,t){return null!==e[t]}},{key:"validateFields",value:function(e){var t=0;R.splice(0,R.length),this.prepareList(e);for(var n=R.filter(function(e){return L.indexOf(e.type)>=0}),a=0;a<n.length;a++){var r=n[a];this.isFieldHasNullProperty(r,"targetModel")||t++}for(var o=R.filter(function(e){return q.indexOf(e.type)>=0}),i=0;i<o.length;i++){var l=o[i];this.isFieldHasNullProperty(l,"targetJsonModel")||t++}return t>0}},{key:"isSaveDisable",value:function(){var e=!1;"MetaJsonModel"===this.state.activeEntity||void 0!==this.state.activeMetaModel&&void 0!==this.state.activeJsonField||(e=!0);var t=this.state.dropData,n=t.nodeData.children.filter(function(e){return e.filter(function(e){return e.nodeId!==v.default.DUMMY}).length>0}).length>0,a=t.nodeData.properties,r=a.name&&""!==a,o=a.title&&""!==a;return"MetaJsonModel"!==this.state.activeEntity||n&&r&&o||(e=!0),e=this.validateFields(this.state.dropData)}},{key:"isNewDisable",value:function(){var e=!1;return"MetaJsonModel"!==this.state.activeEntity&&(e=!0),e}},{key:"isSelectDisable",value:function(){var e=!1;return"MetaJsonModel"!==this.state.activeEntity&&(e=!0),e}},{key:"removeModel",value:function(){var e=new T.default,t=this.state.dropData.nodeData.properties,n={name:null,onNew:null,title:null,onSave:null},a=this;t.id&&F({title:""+(0,I.translate)("Remove Model"),content:(0,I.translate)("Do you really want to delete the selected record(s)?")+"?",okText:""+(0,I.translate)("Yes"),okType:"danger",cancelText:""+(0,I.translate)("No"),onOk:function(){e.delete(J,t.id).then(function(t){t&&t.data&&(a.getModelList(e),a.setState({activeJsonModel:void 0,dropData:{nodeId:"root",column:1,nodeData:{name:"Form",type:v.default.ROOTCONTAINER,properties:n,children:[[a.getDummyNode()]]}},editor:{nodeData:{name:"Form",type:v.default.ROOTCONTAINER,properties:n},column:1,nodeId:"root"}}))})},onCancel:function(){}})}},{key:"showRemoveModel",value:function(){return"MetaJsonModel"===this.state.activeEntity}},{key:"renderJSON",value:function(e,t,n){var a=this,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=function(e){var t=e.nodeData,n=e.nodeId,a=e.colspan,r=e.column;return{nodeData:t,nodeId:n,colspan:a,column:r}},i=r?r.nodeId:null,l=!1,s=e.nodeData;if(s){var d=s.properties;l=!(!d||!d.isWkf)&&d.isWkf}return l?null:"root"===e.nodeId?c.default.createElement(w.default,Object.assign({},o(e),{key:t,parent:i,formTitle:this.state.formTitle,col:n,column:n+1,moveCard:this.moveCard,itemTypes:x,saveItem:function(){return a.convertFormToList()},createNew:function(){return a.createNewForm()},removeModel:function(){return a.removeModel()},moveNode:function(e,t){return a.moveNode(e,t)},selectItem:function(e){return a.selectItem(e)},selected:this.state.editor.nodeId===e.nodeId,removeNode:function(e){return a.onTrashDrop(e)},disableSave:this.isSaveDisable(),disableNew:this.isNewDisable(),disableSelect:this.isSelectDisable(),showRemoveModel:this.showRemoveModel(),windowHeight:this.state.windowHeight,spinner:this.state.spinner}),e.nodeData.children&&e.nodeData.children.map(function(t,n){return t.map(function(t,r){return a.renderJSON(t,n+"_"+r,n,e)})})):c.default.createElement("li",{key:t},c.default.createElement(w.default,Object.assign({},o(e),{key:t,isExists:e.isExists,parent:i,col:n,column:n+1,moveCard:this.moveCard,itemTypes:x,moveNode:function(e,t){return a.moveNode(e,t)},selectItem:function(e){return a.selectItem(e)},selected:this.state.editor.nodeId===e.nodeId,removeNode:function(e){a.onTrashDrop(e),a.selectItem(a.state.dropData)}}),e.nodeData.children&&e.nodeData.children.map(function(t,n){return t.map(function(t,r){return a.renderJSON(t,n+"_"+r,n,e)})})))}},{key:"loadModel",value:function(e){var t=this.state.modelList.filter(function(t){return t.modelListId===e})[0];this.getModelForm(t);var n=this.state.editor;n.nodeData.properties.name=t.name,this.setState({editor:n,isNew:!1})}},{key:"loadJsonFields",value:function(e){var t=new T.default,n="self.json = true AND self.metaModel.id = "+e;return t.search("com.axelor.meta.db.MetaField",[],0,null,["name"],["name"],n).then(function(e){var t=e.data,n=void 0===t?[]:t;return n})}},{key:"loadCustomFieldModel",value:function(e){var t=this;this.setState({spinner:!0});var n=new T.default,a=this.state.customJsonFieldList.filter(function(t){return e===t.id})[0],r=this.state.metaModelList.filter(function(e){return e.id===t.state.activeMetaModel})[0],o="model = '"+(r?r.fullName:"com.axelor.meta.db.MetaJsonRecord")+"' AND modelField = '"+(a?a.name:"attrs")+"'",i=[];n.search("com.axelor.meta.db.MetaJsonField",i,0,null,["sequence"],[],o).then(function(e){var n=e.data,o=void 0===n?[]:n,i={nodeId:"root",column:1,nodeData:{type:v.default.ROOTCONTAINER,properties:Object.assign({},H,{name:r.name,title:r.name+" ("+a.name+")"}),children:[]}},l=t.listToColumn(JSON.parse(JSON.stringify(o))),s=l.fieldData,d=l.counter;i.nodeData.children=s,t.setState({dropData:i,counter:d,spinner:!1})})}},{key:"resetState",value:function(){this.setState({formTitle:"MetaJsonModel"===this.state.activeEntity?"Custom Model":"Custom Field",activeJsonModel:void 0,activeMetaModel:void 0,activeJsonField:void 0,dropData:{nodeId:"root",column:1,nodeData:{name:"Form",type:v.default.ROOTCONTAINER,properties:Object.assign({},H,{name:"",title:""}),children:[[this.getDummyNode()]]}},editor:{nodeData:{name:"Form",type:v.default.ROOTCONTAINER,properties:{onSave:null,onNew:null,name:"",title:""}},column:1,nodeId:"root"}})}},{key:"existsCheck",value:function(e,t,n){var a=e.nodeData,r=a.properties;if(r&&r[t]===n)return!0;if(a.children&&a.children.length)for(var o=0;o<a.children.length;o++)for(var i=a.children[o],l=0;l<i.length;l++)if(this.existsCheck(i[l],t,n))return!0;return!1}},{key:"changeEditorProperty",value:function(e){var t=this,n=this.state.editor;n[e.fieldName]=e.value,this.setState(Object.assign({},n),function(){t.updateNodeColumn()})}},{key:"render",value:function(){var e=this,t=this.state.editor;return 0===x.length&&Object.keys(v.default).forEach(function(e,t){x.push(v.default[e])}),c.default.createElement("div",null,c.default.createElement(m.Row,{type:"flex",justify:"center",style:{height:this.state.windowHeight-25,overflow:"hidden"}},c.default.createElement(m.Col,{span:5,style:{position:"fixed",left:0}},c.default.createElement(m.Card,{title:""+(0,I.translate)("Models"),bodyStyle:{display:"flex",flexDirection:"column",overflowY:"auto",maxHeight:.2*this.state.windowHeight}},c.default.createElement(m.Radio.Group,{style:{marginBottom:10,textAlign:"left"},value:this.state.activeEntity,onChange:function(t){e.setState({activeEntity:t.target.value,customFieldRemoveList:[],activeMetaModel:void 0,activeJsonField:void 0},function(){e.resetState()})}},c.default.createElement(m.Radio,{style:{display:"block",textAlign:"left"},value:"MetaJsonModel"},(0,I.translate)("Custom model")),c.default.createElement(m.Radio,{style:{display:"block",textAlign:"left"},value:"MetaJsonField"},(0,I.translate)("Custom field"))),"MetaJsonModel"===this.state.activeEntity&&c.default.createElement(m.Select,{showSearch:!0,style:{width:"100%"},placeholder:""+(0,I.translate)("Custom Model"),optionFilterProp:"children",value:this.state.activeJsonModel,
filterOption:function(e,t){if(null!==t.props.children)return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0},onChange:function(t){e.getModelForm(t,J,A),e.setState({activeJsonModel:t,activeEntity:"MetaJsonModel",customFieldRemoveList:[],counter:0})}},this.state.modelList.map(function(e){return c.default.createElement(k,{key:e.id,value:""+e.id},(0,I.translate)(e.name))})),"MetaJsonField"===this.state.activeEntity&&c.default.createElement(m.Select,{showSearch:!0,style:{width:"100%",marginBottom:10},placeholder:""+(0,I.translate)("Meta Model"),optionFilterProp:"children",filterOption:function(e,t){if(null!==t.props.children)return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0},value:this.state.activeMetaModel,onChange:function(t){e.loadJsonFields(t).then(function(n){e.setState({activeMetaModel:t,activeEntity:"MetaJsonField",customJsonFieldList:n,customFieldRemoveList:[],activeJsonField:n[0].id}),e.loadCustomFieldModel(n[0].id)})}},this.state.metaModelList.map(function(e,t){return c.default.createElement(m.Select.Option,{key:t,value:e.id},(0,I.translate)(e.name))})),this.state.activeMetaModel&&c.default.createElement(m.Select,{showSearch:!0,style:{width:"100%"},placeholder:""+(0,I.translate)("Custom Field"),optionFilterProp:"children",filterOption:function(e,t){if(null!==t.props.children)return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0},value:this.state.activeJsonField,onChange:function(t){e.loadCustomFieldModel(t),e.setState({activeJsonField:t,customFieldRemoveList:[]})}},this.state.customJsonFieldList.map(function(e,t){return c.default.createElement(k,{key:t,value:e.id},(0,I.translate)(e.name))}))),c.default.createElement(m.Card,{title:""+(0,I.translate)("Fields"),bodyStyle:{overflowY:"auto",height:this.state.windowHeight-250}},c.default.createElement("ul",{style:{display:"block",listStyle:"none"}},this.state.elements.map(function(t,n){return c.default.createElement(b.default,{key:n,nodeData:t,isSample:!0,setIsExists:function(t){return e.setState({counter:e.state.counter+1,dropData:e.setIsExists(e.state.dropData,t)})},removeNode:function(t){return e.onTrashDrop(t)}})})))),c.default.createElement(m.Col,{span:14},this.renderJSON(this.state.dropData,0,1,null)),c.default.createElement(m.Col,{span:5,style:{position:"fixed",right:0}},c.default.createElement("div",null,c.default.createElement(S.default,{values:t.nodeData.properties,extraProperty:{column:t.column},updateValue:function(t,n){n===!1?e.changeEditorProperty(t):e.changeProperty(t)},isNew:this.state.isNew,activeEntity:this.state.activeEntity,selected:null!==this.state.editor.nodeId&&"root"!==this.state.editor.nodeId,nodeData:this.state.dropData,windowHeight:this.state.windowHeight})))))}}]),t}(u.Component),z=m.Form.create()(V);t.default=(0,f.DragDropContext)(h.default)(z)},615:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(1),d=a(s),u=n(190),c=n(11);n(278);var f=n(240),p=a(f),h=n(59),m=n(38),y=function(e){var t=e.selectItem,n=e.saveItem,a=e.createNew,r=e.removeModel,o=e.props;return d.default.createElement("div",null,d.default.createElement(m.Button,{icon:"file-add",type:"primary",shape:"circle",title:""+(0,h.translate)("New"),onClick:function(){return a()},disabled:o.disableNew,style:{marginRight:10,cursor:"pointer",width:30,height:30}}),o.showRemoveModel&&d.default.createElement(m.Button,{icon:"delete",type:"danger",shape:"circle",title:""+(0,h.translate)("Remove"),onClick:function(){return r()},style:{marginRight:10,cursor:"pointer",width:30,height:30}}),d.default.createElement(m.Button,{icon:"save",type:"primary",shape:"circle",title:""+(0,h.translate)("Save"),onClick:function(){return n()},disabled:o.disableSave,style:{marginRight:10,cursor:"pointer",width:30,height:30}}),d.default.createElement(m.Button,{icon:"select",type:"primary",shape:"circle",title:""+(0,h.translate)("Select"),onClick:function(){return t()},disabled:o.disableSelect,style:{marginRight:10,cursor:"pointer",width:30,height:30}}))},v={beginDrag:function(e){return{nodeData:e.nodeData,nodeId:e.nodeId?e.nodeId:null,index:void 0!==e.index?e.index:null,col:e.col,parent:e.parent,column:e.column,isExists:!!e.isExists&&e.isExists}},canDrag:function(e,t){return e.nodeId!==p.default.DUMMY&&"root"!==e.nodeId}},g={hover:function(e,t,n){var a=t.getItem().nodeId,r=e.nodeId;if(t.isOver({shallow:!0})){if(a===r)return;if("root"===e.nodeId)return;if("panel"===t.getItem().nodeData.type&&"panel"!==e.nodeData.type&&"root"!==e.parent)return;var o=(0,c.findDOMNode)(n).getBoundingClientRect(),i=(o.bottom-o.top)/3,l=t.getClientOffset(),s=l.y-o.top;if("panel"===e.nodeData.type&&s>i)return;var d=e.moveNode(t.getItem(),e);d&&null===t.getItem().nodeId&&(t.getItem().nodeId=d.nodeId,t.getItem().nodeData=d.nodeData)}}},b=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.nodeData,n=e.isOver,a=t.type;a===p.default.ROOTCONTAINER&&(!this.props.isOver||n||e.isDrop||null===e.dragItem||e.dragItem.isExists||e.removeNode(Object.assign({},e.dragItem)))}},{key:"render",value:function(){var e=this,t=this.props,n=t.nodeData,a=t.isDragging,r=t.isOverCurrent,o=t.selected,i=t.nodeId,l=t.connectDragSource,s=t.connectDropTarget,u=n.type,c=n.properties,f=a?0:1,v="100%",g="";if(o&&(g={backgroundColor:"#ABB9D3",border:"1px solid #DFF0D8",backgroundImage:"none"}),u===p.default.CONTAINER||u===p.default.ROOTCONTAINER){var b=this.props.children.length;v=100/b+"%"}return l(s(u===p.default.CONTAINER?d.default.createElement("div",{className:"panel",style:{minHeight:r&&"50px",backgroundColor:r&&"#EFEFEF",color:r&&"#EFEFEF"}},d.default.createElement("h3",{style:Object.assign({marginTop:0,marginBottom:0,paddingRight:5,backgroundColor:r&&"#EFEFEF",color:r&&"#EFEFEF"},g),onClick:function(){return e.props.selectItem({nodeData:n,nodeId:i})}},(0,h.translate)(c.title?c.title:c.name),o&&d.default.createElement(m.Icon,{type:"close",style:{float:"right",color:"red",fontSize:15,cursor:"pointer"},onClick:function(){e.props.removeNode({nodeData:n,nodeId:i})}})),d.default.createElement("div",{className:"panel-content"},this.props.children.map(function(e,t){return d.default.createElement("ul",{key:t,style:{display:"inline",float:"left",width:v,listStyle:"none",padding:0}},e)}))):u===p.default.ROOTCONTAINER?d.default.createElement("div",{style:{position:"relative"}},d.default.createElement(m.Spin,{spinning:this.props.spinner,className:"form-spin"}),d.default.createElement(m.Card,{title:(0,h.translate)(c.title&&c.title.length>0?c.title:this.props.formTitle),className:"form-content",bodyStyle:{overflowY:"auto",maxHeight:this.props.windowHeight-80},extra:y({saveItem:function(){return e.props.saveItem()},selectItem:function(){return e.props.selectItem({nodeData:n,nodeId:i})},createNew:function(){return e.props.createNew()},removeModel:function(){return e.props.removeModel()},props:this.props}),style:{border:"1px solid gray"}},d.default.createElement("div",{className:"panel-content"},this.props.children.map(function(e,t){return d.default.createElement("ul",{key:t,style:{display:"inline",float:"left",width:v,listStyle:"none",padding:0}},e)})))):i!==p.default.DUMMY?d.default.createElement("div",{className:"item",style:Object.assign({backgroundColor:r&&"#EFEFEF",color:r&&"#EFEFEF"},g),onClick:function(){return e.props.selectItem({nodeData:n,nodeId:i})}},(0,h.translate)(c.title?c.title:c.name),o&&d.default.createElement(m.Icon,{type:"close",style:{float:"right",color:"red",fontSize:15,cursor:"pointer",fontWeight:"bold"},onClick:function(){return e.props.removeNode({nodeData:n,nodeId:i})}})):d.default.createElement("div",{style:{border:"0px solid",minHeight:"1px",opacity:f,padding:10}})))}}]),t}(s.Component);t.default=(0,u.DragSource)(function(e){return e.nodeData.type},v,function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})((0,u.DropTarget)(function(e){return e.itemTypes},g,function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver(),isDrop:t.didDrop(),isOverCurrent:t.isOver({shallow:!0}),canDrop:t.canDrop(),dragItem:t.getItem()}})(b))},616:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:null,title:null,type:null,defaultValue:null,model:"com.axelor.meta.db.MetaJsonRecord",modelField:"attrs",selection:null,widget:null,help:null,showIf:null,hideIf:null,requiredIf:null,hidden:"false",required:"false",nameField:"false",visibleInGrid:"true",minSize:null,maxSize:null,precision:0,scale:0,regex:null,targetModel:null,targetJsonModel:null,formView:null,gridView:null,domain:null,sequence:0,onChange:null,onClick:"save",width:null,tab:"false",widgetAttrs:JSON.stringify({}),appBuilder:null,valueExpr:null,readonly:"false",readonlyIf:null}},617:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=[{value:"string",title:"String"},{value:"integer",title:"Integer"},{value:"decimal",title:"Decimal"},{value:"boolean",title:"Boolean"},{value:"datetime",title:"DateTime"},{value:"date",title:"Date"},{value:"time",title:"Time"},{value:"panel",title:"Panel"},{value:"button",title:"Button"},{value:"separator",title:"Separator"},{value:"many-to-one",title:"ManyToOne"},{value:"many-to-many",title:"ManyToMany"},{value:"one-to-many",title:"OneToMany"},{value:"json-many-to-one",title:"Custom-ManyToOne"},{value:"json-many-to-many",title:"Custom-ManyToMany"},{value:"json-one-to-many",title:"Custom-OneToMany"}];t.default=n},618:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(1),d=a(s),u=n(190);n(278);var c=n(59),f=n(38),p={beginDrag:function(e){return{nodeData:e.nodeData,nodeId:e.nodeId?e.nodeId:null}},endDrag:function(e,t,n){t.didDrop()?e.setIsExists(Object.assign({},t.getItem())):e.removeNode(Object.assign({},t.getItem()))}},h=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),l(t,[{key:"render",value:function(){var e=this.props,t=e.nodeData,n=e.isDragging,a=e.connectDragSource,r=t.name,o=t.image,i=n?.4:1,l="./images/"+o;return a(d.default.createElement("div",null,d.default.createElement(f.Card,{style:{opacity:i,padding:5,margin:5,border:"1px solid black"},bodyStyle:{padding:3}},d.default.createElement("img",{src:l,height:12,width:12,style:{marginRight:4},alt:"field icon"}),(0,c.translate)((0,c.camleCaseString)(r)))))}}]),t}(s.Component);t.default=(0,u.DragSource)(function(e){return e.nodeData.type},p,function(e,t){return{connectDragSource:e.dragSource(),isDragging:t.isDragging()}})(h)},619:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=n(1),u=a(d),c=n(38),f=n(617),p=a(f),h=n(59),m=n(621),y=a(m),v=n(620),g=a(v),b=n(241),E=n(623),S=a(E),D=c.Select.Option,M=p.default.filter(function(e){var t=e.value;return"panel"!==t&&"button"!==t}).map(function(e){var t=e.value;return t}),O=p.default.filter(function(e){var t=e.value;return"panel"!==t}).map(function(e){var t=e.value;return t}),w=["string","integer","decimal"],I=[].concat(w),N=["decimal"],T=["json-many-to-one","json-many-to-many","json-one-to-many"],C=["many-to-one","many-to-many","one-to-many","json-many-to-one","json-many-to-many","json-one-to-many"],k=["many-to-one","many-to-many","one-to-many"],F=["boolean","datetime","time","separator","string","integer","decimal","many-to-one","many-to-many","one-to-many","json-many-to-one","json-many-to-many","json-one-to-many"],x=["default","large","medium","mini"],j=p.default.filter(function(e){var t=e.value;return"panel"!==t&&"button"!==t}).map(function(e){var t=e.value;return t}),R=[{name:"appBuilder",fieldType:"objectSelection",translate:!0,required:!0,ref:"com.axelor.studio.db.AppBuilder",valueField:"id",displayField:"name"},{name:"name",required:!0,fieldType:"string",existsCheck:!0},{name:"targetJsonModel",fieldType:"objectSelection",required:!0,ref:"com.axelor.meta.db.MetaJsonModel",valueField:"id",displayField:"name",displayWhen:T},{name:"targetModel",fieldType:"select",translate:!0,required:!0,ref:"com.axelor.meta.db.MetaModel",valueField:"fullName",displayField:"name",displayWhen:k},{name:"title",fieldType:"string"},{name:"type",column:"type_name",required:"true",selection:"json.field.type",fieldType:"string",readonly:"true",displayWhen:M},{name:"defaultValue",fieldType:"string"},{name:"selection",translate:!1,fieldType:"select",ref:"com.axelor.meta.db.MetaSelect",valueField:"name",displayField:"name",displayWhen:I},{name:"model",fieldType:"string",displayWhen:["MetaJsonField"]},{name:"widget",fieldType:"staticSelect",data:S.default,displayWhen:O},{name:"help",fieldType:"string"},{name:"modelField",required:"true",fieldType:"string",displayWhen:["MetaJsonField"]},{name:"required",fieldType:"boolean",displayWhen:M},{name:"showIf",fieldType:"string"},{name:"hideIf",fieldType:"string"},{name:"requiredIf",fieldType:"string",displayWhen:M},{name:"hidden",fieldType:"boolean"},{name:"readonly",fieldType:"boolean"},{name:"readonlyIf",fieldType:"string"},{name:"visibleInGrid",fieldType:"boolean",displayWhen:M},{name:"nameField",fieldType:"boolean",displayWhen:M},{name:"minSize",fieldType:"integer",displayWhen:w},{name:"maxSize",fieldType:"integer",displayWhen:w},{name:"regex",fieldType:"string",displayWhen:["string"]},{name:"precision",default:6,fieldType:"integer",displayWhen:N},{name:"scale",default:2,fieldType:"integer",displayWhen:N},{name:"gridView",fieldType:"string",displayWhen:k},{name:"formView",fieldType:"string",displayWhen:k},{name:"domain",fieldType:"string",displayWhen:C},{name:"onClick",translate:!1,fieldType:"autoComplete",ref:"com.axelor.meta.db.MetaAction",displayField:"name",displayWhen:["button"],required:!0},{name:"onChange",translate:!1,fieldType:"autoComplete",ref:"com.axelor.meta.db.MetaAction",displayField:"name",displayWhen:F},{name:"width",fieldType:"staticSelect",data:x,displayWhen:["panel"],parentField:"widgetAttrs"},{name:"tab",fieldType:"boolean",data:x,displayWhen:["panel"],parentField:"widgetAttrs"},{name:"colSpan",fieldType:"string",parentField:"widgetAttrs"},{name:"showTitle",fieldType:"boolean",parentField:"widgetAttrs",displayWhen:O},{name:"valueExpr",fieldType:"text",displayWhen:j},{name:"column",title:"Columns",fieldType:"integer",displayWhen:["panel"],isProperty:!1}],_=[{name:"name",required:!0,fieldType:"string"},{name:"title",required:!0,fieldType:"string"},{name:"onNew",fieldType:"string"},{name:"onSave",fieldType:"string"},{name:"appBuilder",fieldType:"objectSelection",translate:!0,required:!0,ref:"com.axelor.studio.db.AppBuilder",valueField:"id",displayField:"name"},{name:"menuTitle",fieldType:"string"},{name:"menuIcon",fieldType:"string",title:"Icon"},{name:"menuBackground",fieldType:"string",title:"Icon background"},{name:"menuOrder",fieldType:"integer",title:"Order"},{name:"menuTop",fieldType:"boolean",title:"Show in top menu"},{name:"menuParent",fieldType:"objectSelection",ref:"com.axelor.meta.db.MetaMenu",refDomain:"self.action is null",displayField:"title",valueField:"id",title:"Parent menu"}],P=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={spinning:!1,isNew:!0,type:"string",editor:{},errorStatus:{}},n.validateData=n.validateData.bind(n),n}return l(t,e),s(t,[{key:"getObjectSelectField",value:function(e,t){var n=this,a=e.name,o=e.displayField,i=e.valueField,l=e.ref,s=e.required,d=e.title?(0,h.translate)((0,h.camleCaseString)(e.title)):(0,h.translate)((0,h.camleCaseString)(a));return u.default.createElement("div",{key:t,className:"fieldContainer"},u.default.createElement("span",{className:"ant-col-xs-24 ant-col-sm-6",style:{textAlign:"right",paddingRight:3,marginTop:5}},s&&u.default.createElement("span",{style:{paddingRight:2,fontSize:12,color:"red"}},(0,h.translate)("*")),d,":"),u.default.createElement("div",{className:"ant-col-xs-24 ant-col-sm-14"},u.default.createElement(y.default,{entity:l,displayMember:o,valueMember:i,searchOnText:!0,placeholder:d,selectedValue:this.state.editor[a]?this.state.editor[a][i]:null,domain:e.refDomain,handleChange:function(e){var t=n.state.editor;t[a]=null===e?null:r({},i,e),n.props.updateValue(t)}})))}},{key:"getFormSelectionField",value:function(e,t){var n=this,a=e.name,r=(0,h.translate)((0,h.camleCaseString)(this.props.placeholder));return this.state.isNew?u.default.createElement(c.Input,{key:t,addonAfter:u.default.createElement(c.Icon,{type:"search",style:{cursor:"pointer"},onClick:function(){return n.setState({isNew:!1})}})}):u.default.createElement("div",{key:t},u.default.createElement(c.Select,{showSearch:!0,value:""+this.props.form.getFieldValue(a),searchPlaceholder:r,optionFilterProp:"children",onChange:function(e){return n.props.loadModel(parseInt(e,10))},style:{width:"90%"}},this.props.modelList.map(function(e,t){return u.default.createElement(D,{key:t,value:e.id.toString()},e.name)})),u.default.createElement(c.Icon,{type:"close-square",style:{float:"right",marginTop:10,fontSize:"1.4em",cursor:"pointer"},onClick:function(){return n.setState({isNew:!0})}}))}},{key:"getSelectField",value:function(e,t){var n=this,a=e.name,r=e.displayField,o=e.valueField,i=e.ref,l=e.required,s=(0,h.translate)((0,h.camleCaseString)(a));return u.default.createElement("div",{key:t,className:"fieldContainer"},u.default.createElement("span",{className:"ant-col-xs-24 ant-col-sm-6",style:{textAlign:"right",paddingRight:3,marginTop:5}},l&&u.default.createElement("span",{style:{paddingRight:2,fontSize:12,color:"red"}},"*"),s,":"),u.default.createElement("div",{className:"ant-col-xs-24 ant-col-sm-14"},u.default.createElement(y.default,{entity:i,required:l,displayMember:r,valueMember:o,placeholder:s,selectedValue:this.state.editor[a],translate:e.translate,handleChange:function(e){var t=n.state.editor;t[a]=e,n.props.updateValue(t)}})))}},{key:"getAutoComplete",value:function(e,t){var n=this,a=e.name,r=e.displayField,o=e.ref,i=e.required,l=(0,h.translate)((0,h.camleCaseString)(a));return u.default.createElement("div",{key:t,className:"fieldContainer"},u.default.createElement("span",{className:"ant-col-xs-24 ant-col-sm-6",style:{textAlign:"right",paddingRight:3,marginTop:5}},i&&u.default.createElement("span",{style:{paddingRight:2,fontSize:12,color:"red"}},"*"),l,":"),u.default.createElement("div",{className:"ant-col-xs-24 ant-col-sm-14",style:{textAlign:"left"}},u.default.createElement(g.default,{entity:o,required:i,fieldName:r,placeholder:l,value:this.state.editor[a],translate:e.translate,handleChange:function(e){var t=n.state.errorStatus,r=!0;i&&""===e&&(r=!1);var o=n.state.editor;r?(o[a]=e,t[a]=""+(0,h.translate)("")):t[a]=(0,h.translate)((0,h.camleCaseString)(a))+" "+(0,h.translate)("field required!!!"),o[a]=e,n.setState({editor:o,errorStatus:t})},onBlur:function(e){var t=n.state.editor,r=n.state.errorStatus,o=!0;i&&""===e&&(o=!1),o?n.props.updateValue(t):(t[a]=n.props.values[a],r[a]=""+(0,h.translate)(""),n.setState({editor:t,errorStatus:r}))}}),""!==this.state.errorStatus[a]&&u.default.createElement("span",{style:{color:"red",display:"block"}},(0,h.translate)(this.state.errorStatus[a]))))}},{key:"getNumberField",value:function(e,t){var n=this,a=e.name,o=e.required,i=e.isProperty,l=(0,h.translate)((0,h.camleCaseString)(e.title||a));return u.default.createElement("div",{key:t,className:"fieldContainer"},u.default.createElement("span",{className:"ant-col-xs-24 ant-col-sm-6",style:{textAlign:"right",paddingRight:3,marginTop:5}},o&&u.default.createElement("span",{style:{paddingRight:2,fontSize:12,color:"red"}},"*"),l,":"),u.default.createElement("div",{className:"ant-col-xs-24 ant-col-sm-14"},u.default.createElement(c.InputNumber,{min:1,max:10,style:{width:"100%"},value:this.state.editor[a],onBlur:function(e){var t=n.state.editor;isNaN(t[a])||(i===!1?n.props.updateValue({fieldName:a,value:n.state.editor[a]},i):n.props.updateValue(t))},onChange:function(e){var t=n.state.errorStatus;isNaN(e)?t[a]=(0,h.translate)((0,h.camleCaseString)(a))+" "+(0,h.translate)("field contains only number!!!"):t[a]="",n.setState({editor:Object.assign({},n.state.editor,r({},a,e)),errorStatus:t})}}),""!==this.state.errorStatus[a]&&u.default.createElement("span",{style:{color:"red",display:"block"}},(0,h.translate)(this.state.errorStatus[a]))))}},{key:"getBooleanSelection",value:function(e,t){var n=this,a=e.name,o=e.title,i=e.required,l=this.state.editor[a]||!1;return u.default.createElement("div",{key:t,className:"fieldContainer"},u.default.createElement("span",{className:"ant-col-xs-24 ant-col-sm-6",style:{textAlign:"right",paddingRight:3,marginTop:5}},i&&u.default.createElement("span",{style:{paddingRight:2,fontSize:12,color:"red"}},""+(0,h.translate)("*")),(0,h.translate)((0,h.camleCaseString)(o||a)),":"),u.default.createElement("div",{className:"ant-col-xs-24 ant-col-sm-14"},u.default.createElement(c.Select,{optionFilterProp:"children",value:l.toString(),style:{width:"100%"},onChange:function(e){n.setState({editor:Object.assign({},n.state.editor,r({},a,e))})},onBlur:function(e){var t=n.state.editor;t[a]=e,n.props.updateValue(t)}},u.default.createElement(D,{value:"true"},""+(0,h.translate)("True")),u.default.createElement(D,{value:"false"},""+(0,h.translate)("False")))))}},{key:"getStaticSelection",value:function(e,t){var n=this,a=e.name,o=e.required,i=e.data;return u.default.createElement("div",{key:t,className:"fieldContainer"},u.default.createElement("span",{className:"ant-col-xs-24 ant-col-sm-6",style:{textAlign:"right",paddingRight:3,marginTop:5}},o&&u.default.createElement("span",{style:{paddingRight:2,fontSize:12,color:"red"}},"*"),(0,h.translate)((0,h.camleCaseString)(a)),":"),u.default.createElement("div",{className:"ant-col-xs-24 ant-col-sm-14"},u.default.createElement(c.Select,{optionFilterProp:"children",filterOption:function(e,t){if(null!==t.props.children)return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0},value:this.state.editor[a],style:{width:"100%"},onChange:function(e){n.setState({editor:Object.assign({},n.state.editor,r({},a,e))})},onBlur:function(e){var t=n.state.editor;t[a]=e,n.props.updateValue(t)}},i.map(function(e,t){return u.default.createElement(D,{key:t,value:e},e)}))))}},{key:"getTextField",value:function(e,t){var n=this,a=e.name,o=e.required,i=e.readonly,l=e.existsCheck,s=(0,h.translate)((0,h.camleCaseString)(a));return u.default.createElement("div",{key:t,className:"fieldContainer"},u.default.createElement("span",{className:"ant-col-xs-24 ant-col-sm-6",style:{textAlign:"right",paddingRight:3,marginTop:5}},o&&u.default.createElement("span",{style:{paddingRight:2,fontSize:12,color:"red"}},""+(0,h.translate)("*")),s,":"),u.default.createElement("div",{className:"ant-col-xs-24 ant-col-sm-14",style:{textAlign:"left"}},u.default.createElement("textarea",{className:"ant-input",style:{width:"100%"},rows:3,placeholder:s,value:this.state.editor[a]||"",disabled:!!i,onBlur:function(e){var t=Object.assign({},n.state.editor),r=!0;o&&""===e.target.value&&(r=!1),l&&n.existsCheck(n.state.nodeData,a,e.target.value)&&(r=!1),r?(t[a]=e.target.value,n.props.updateValue(t)):(t[a]=n.props.values[a],n.setState({editor:t}));var i=n.state.errorStatus;i[a]="",n.setState({errorStatus:i})},onChange:function(e){var t=n.state.errorStatus;o&&""===e.target.value?t[a]=(0,h.translate)((0,h.camleCaseString)(a))+" "+(0,h.translate)("field required!!!"):l&&n.existsCheck(n.state.nodeData,a,e.target.value)?t[a]=(0,h.translate)((0,h.camleCaseString)(a))+" "+(0,h.translate)("field already exists"):t[a]="",n.setState({editor:Object.assign({},n.state.editor,r({},a,e.target.value)),errorStatus:t})}}),""!==this.state.errorStatus[a]&&u.default.createElement("span",{style:{color:"red",display:"block"}},(0,h.translate)(this.state.errorStatus[a]))))}},{key:"getField",value:function(e,t){var n=this,a=e.title,o=e.name,i=e.required,l=e.readonly,s=e.existsCheck,d=a?(0,h.translate)((0,h.camleCaseString)(a)):(0,h.translate)((0,h.camleCaseString)(o));return u.default.createElement("div",{key:t,className:"fieldContainer"},u.default.createElement("span",{className:"ant-col-xs-24 ant-col-sm-6",style:{textAlign:"right",paddingRight:3,marginTop:5}},i&&u.default.createElement("span",{style:{paddingRight:2,fontSize:12,color:"red"}},""+(0,h.translate)("*")),d,":"),u.default.createElement("div",{className:"ant-col-xs-24 ant-col-sm-14",style:{textAlign:"left"}},u.default.createElement(c.Input,{rows:2,placeholder:d,value:this.state.editor[o],disabled:!!l,onBlur:function(e){var t=Object.assign({},n.state.editor),a=!0;i&&""===e.target.value&&(a=!1),s&&n.existsCheck(n.state.nodeData,o,e.target.value)&&(a=!1),a?(t[o]=e.target.value,n.props.updateValue(t)):(t[o]=n.props.values[o],n.setState({editor:t}));var r=n.state.errorStatus;r[o]="",n.setState({errorStatus:r})},onChange:function(e){var t=n.state.errorStatus;i&&""===e.target.value?t[o]=(0,h.translate)((0,h.camleCaseString)(o))+" "+(0,h.translate)("field required!!!"):s&&n.existsCheck(n.state.nodeData,o,e.target.value)?t[o]=(0,h.translate)((0,h.camleCaseString)(o))+" "+(0,h.translate)("field already exists"):t[o]="",n.setState({editor:Object.assign({},n.state.editor,r({},o,e.target.value)),errorStatus:t})}}),""!==this.state.errorStatus[o]&&u.default.createElement("span",{style:{color:"red",display:"block"}},(0,h.translate)(this.state.errorStatus[o]))))}},{key:"getJsonFieldTypeSelection",value:function(e,t){var n=this,a=e.name,r=e.required;return u.default.createElement("div",{className:"fieldContainer",key:t},u.default.createElement("span",{className:"ant-col-xs-24 ant-col-sm-6",style:{textAlign:"right",paddingRight:3,marginTop:5}},r&&u.default.createElement("span",{style:{paddingRight:2,fontSize:12,color:"red"}},""+(0,h.translate)("*")),(0,h.translate)((0,h.camleCaseString)(a)),":"),u.default.createElement("div",{className:"ant-col-xs-24 ant-col-sm-14"},u.default.createElement(c.Select,{optionFilterProp:"children",filterOption:function(e,t){if(null!==t.props.children)return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0},onChange:function(e){return n.setState({type:e})}},p.default.map(function(e,t){return u.default.createElement(D,{key:t,value:e.value},e.title)}))))}},{key:"existsCheck",value:function(e,t,n){var a=e.nodeData,r=a.properties;if(r&&""+r[t]==""+n)return!0;if(a.children&&a.children.length)for(var o=0;o<a.children.length;o++)for(var i=a.children[o],l=0;l<i.length;l++)if(this.existsCheck(i[l],t,n))return!0;return!1}},{key:"componentWillReceiveProps",value:function(e){if(e.values){var t=Object.assign({},e.values),n=JSON.parse(""+e.values.widgetAttrs!="null"&&e.values.widgetAttrs?e.values.widgetAttrs:"{}");t.tab=n.tab||"false",t.showTitle=n.showTitle||"true","panel"===t.type&&(t.width=n.width||"default");var a=b.colspanElemetList.findIndex(function(e){return(0,b.convertCamleToDashedString)(e)===t.type&&"panel"!==t.type});t.colSpan=n.colSpan?n.colSpan:a!==-1?12:null,e.extraProperty&&(t=Object.assign({},t,Object.assign({},e.extraProperty))),this.setState({editor:t})}var r={};Object.keys(e.values).forEach(function(e){r[e]=""}),this.setState({errorStatus:r,type:e.values.type,isNew:e.isNew,nodeData:this.props.nodeData})}},{key:"validateData",value:function(e){this.props.form.validateFieldsAndScroll(e)}},{key:"handleSubmit",value:function(){var e=this;this.props.form.validateFieldsAndScroll(function(t,n){t||(Object.keys(n).forEach(function(e){n[e]=""===n[e]||void 0===n[e]?null:n[e]}),e.props.updateValue(n))})}},{key:"render",value:function(){var e=this,t=this.props.selected?R:_,n=!0,a=!0;"MetaJsonField"!==this.props.activeEntity||this.props.selected||(a=!1);var r=Number(this.props.windowHeight);return r-="panel"===this.state.type?205:77,a&&u.default.createElement(c.Spin,{style:{width:"auto"},spinning:this.state.spinning},u.default.createElement(c.Card,{title:""+(0,h.translate)("Properties"),bodyStyle:{overflowY:"auto",height:r},extra:this.props.selected&&u.default.createElement(c.Button,{type:"primary",shape:"circle",icon:"check",style:{display:"none"},onClick:function(){e.handleSubmit()}})},t.map(function(t,a){if(t.displayWhen&&!t.displayWhen.includes(e.state.type)&&(n=!1),n)switch(t.fieldType){case"string":return e.getField(t,a);case"integer":return e.getNumberField(t,a);case"boolean":return e.getBooleanSelection(t,a);case"jsonFieldType":return e.getJsonFieldTypeSelection(t,a);case"select":return e.getSelectField(t,a);case"autoComplete":return e.getAutoComplete(t,a);case"objectSelection":return e.getObjectSelectField(t,a);case"staticSelect":return e.getStaticSelection(t,a);case"formSelection":return e.getFormSelectionField(t,a);case"text":return e.getTextField(t,a);default:return e.getField(t,a)}else n=!0})))}}]),t}(d.Component);t.default=P},620:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,
configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),s=n(1),d=a(s),u=n(38),c=n(137),f=a(c),p=n(59),h=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={dataSource:[],value:"",errorStatus:""},n}return i(t,e),l(t,[{key:"fetchRecords",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=new f.default,a=[],r=[];a.push(this.props.fieldName),null!==t&&r.push({fieldName:this.props.fieldName,operator:"like",value:t}),n.search(this.props.entity,r,0,null,["name"],a).then(function(t){for(var n=t.data||[],a=[],r=0;r<n.length;r++){var o=n[r];a.push(o)}var i=n.map(function(t){return t[e.props.fieldName]});e.setState({children:a,dataSource:i})})}},{key:"componentDidMount",value:function(){this.setState({value:this.props.value})}},{key:"getText",value:function(e){var t=e;return this.props.translate&&(t=(0,p.translate)(e)),t}},{key:"render",value:function(){var e=this;return d.default.createElement("div",null,d.default.createElement(u.AutoComplete,{value:this.props.value,dataSource:this.state.dataSource,onSelect:function(t){var n=e.state.value,a=n.substring(0,n.lastIndexOf(",")+1),r=""+a+t;e.props.handleChange(r)},onBlur:function(t){e.props.onBlur&&e.props.onBlur(t)},onSearch:function(t){var n=t.split(","),a=n[n.length-1];e.fetchRecords(a),e.setState({value:t}),e.props.handleChange(t)},placeholder:this.props.placeholder,filterOption:function(e,t){var n=e.split(","),a=n[n.length-1];return t.props.children.toUpperCase().indexOf(a.toUpperCase())!==-1},style:{width:"100%"}}))}}]),t}(d.default.Component);t.default=h},621:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=n(1),u=a(d),c=n(38),f=n(137),p=a(f),h=n(59),m=c.Select.Option,y=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={children:[]},n}return l(t,e),s(t,[{key:"fetchRecords",value:function(){var e=this,t=new p.default,n=[];n.push(this.props.valueMember),this.props.displayMember!==this.props.valueMember&&n.push(this.props.displayMember),t.search(this.props.entity,[],0,null,["name"],n,this.props.domain).then(function(t){for(var n=t.data||[],a=[],r=0;r<n.length;r++){var o=n[r];a.push(o)}e.setState({children:a})})}},{key:"handleChange",value:function(e){this.props.manyToOne?this.props.handleChange(r({},this.props.valueMember,e)):this.props.handleChange(e)}},{key:"componentDidMount",value:function(){this.fetchRecords(),this.setState({selectedValue:this.props.selectedValue})}},{key:"getOption",value:function(){this.fetchRecords()}},{key:"getText",value:function(e){var t=e;return this.props.translate&&(t=(0,h.translate)(e)),t}},{key:"render",value:function(){var e=this;return this.state.children&&u.default.createElement(c.Select,{showSearch:!0,value:""+(this.props.selectedValue||0),searchPlaceholder:this.props.placeholder,optionFilterProp:"children",filterOption:function(t,n){if(e.props.searchOnText){if(null!==n.props.children)return n.props.children.toLowerCase().indexOf(t.toLowerCase())>=0}else if(null!==n.props.value)return n.props.value.toLowerCase().indexOf(t.toLowerCase())>=0},onChange:function(t){return e.handleChange(""+t=="0"?null:t)},style:{width:"100%"}},u.default.createElement(m,{key:-1,value:"0"},"Select Option"),this.state.children.map(function(t,n){return u.default.createElement(m,{key:n,value:t[e.props.valueMember].toString()},e.getText(t[e.props.displayMember]))}))}}]),t}(u.default.Component);t.default=y},622:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r=n(1),o=a(r),i=n(11),l=a(i),s=n(613),d=a(s);n(773);var u=n(38),c=n(545),f=a(c);l.default.render(o.default.createElement(u.LocaleProvider,{locale:f.default},o.default.createElement(d.default,null)),document.getElementById("root"))},623:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=["InlineCheckbox","Toggle","BooleanSelect","BooleanRadio","BooleanSwitch","Email","Url","Password","Html","RelativeTime","Duration","ImageSelect","MultiSelect","RadioSelect","CheckboxSelect","NavSelect","Progress","SelectProgress","ImageLink","Image","BinaryLink","SuggestBox","RefSelect","RefLink","RefText","TagSelect","CodeEditor"];t.default=n},772:278,773:278,1135:function(e,t){e.exports="data:application/octet-stream;base64,QGltcG9ydCAifmFudGQvZGlzdC9hbnRkLmxlc3MiOwpAaW1wb3J0ICJjdXN0b20ubGVzcyI7Cg=="}});