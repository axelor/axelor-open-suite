/*
 * Axelor Business Solutions
 *
 * Copyright (C) 2022 Axelor (<http://axelor.com>).
 *
 * This program is free software: you can redistribute it and/or  modify
 * it under the terms of the GNU Affero General Public License, version 3,
 * as published by the Free Software Foundation.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
(this["webpackJsonpbaml-editor"]=this["webpackJsonpbaml-editor"]||[]).push([[0],{274:function(e,t,n){},290:function(e,t,n){},291:function(e,t,n){},292:function(e,t,n){},293:function(e,t,n){},294:function(e,t,n){"use strict";n.r(t);var a,i=n(2),r=n(0),o=n.n(r),c=n(33),s=n.n(c),l=n(5),u=n(10),p=n(18),d=n(9),m=n.n(d),f=n(16),b=n(386),h=n(357),v=n(243),y=n(397),g=n(111),j=n(390),x=n(224),O=n(149),w=n(150),E={};var N=new(function(){function e(){Object(O.a)(this,e);var t=new Headers;t.append("Accept","application/json"),t.append("Content-Type","application/json"),t.append("X-Requested-With","XMLHttpRequest"),t.append("X-CSRF-Token",function(e){var t=document.cookie||"";return t!==a&&(a=t,E=t.split("; ").reduce((function(e,t){var n=t.split("=");return e[n[0]]=n[1],e}),{})),E[e]}("CSRF-TOKEN")),this.baseURL="..",this.headers=t}return Object(w.a)(e,[{key:"fetch",value:function(e){function t(t,n,a){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,n){return fetch(e,n).then((function(e){return-1!==["head","delete"].indexOf(t.toLowerCase())?e:e.headers.get("content-type").includes("application/json")?e.json():e})).catch((function(e){}))}))},{key:"request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=Object.assign({method:"POST",credentials:"include",headers:this.headers,mode:"cors",body:JSON.stringify(n)},t);return"GET"===t.method&&delete a.body,this.fetch("".concat(this.baseURL).concat(0===e.indexOf("/")?e:"/".concat(e)),t.method,a)}},{key:"get",value:function(e){return this.request(e,{method:"GET"})}},{key:"post",value:function(e,t){return this.request(e,{method:"POST"},t)}},{key:"add",value:function(e,t){var n={data:t},a="ws/rest/".concat(e);return this.post(a,n)}},{key:"fetchId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="ws/rest/".concat(e,"/").concat(t,"/fetch");return this.post(a,n)}},{key:"search",value:function(e,t){var n=Object(l.a)({offset:0},t),a="ws/rest/".concat(e,"/search");return this.post(a,n)}},{key:"action",value:function(e){return this.post("ws/action",e)}},{key:"fields",value:function(e){return this.post("/ws/meta/view/fields",e)}},{key:"view",value:function(e){return this.post("/ws/meta/view",e)}},{key:"fetchFields",value:function(e){var t="/ws/meta/fields/".concat(e);return this.get(t)}},{key:"fetchRecord",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a="ws/rest/".concat(e,"/").concat(t,"/fetch");return this.post(a,n)}}]),e}()),C=n(13),S=n.n(C),_=n(114),k=n(1),M=n(8),P=n(4),T=n(381);function R(){}function A(e,t){this.model=e,this.properties=t}R.prototype.get=function(e){return this.$model.properties.get(this,e)},R.prototype.set=function(e,t){this.$model.properties.set(this,e,t)},A.prototype.createType=function(e){var t=this.model,n=this.properties,a=Object.create(R.prototype);Object(k.i)(e.properties,(function(e){e.isMany||void 0===e.default||(a[e.name]=e.default)})),n.defineModel(a,t),n.defineDescriptor(a,e);var i=e.ns.name;function r(e){n.define(this,"$type",{value:i,enumerable:!0}),n.define(this,"$attrs",{value:{}}),n.define(this,"$parent",{writable:!0}),Object(k.i)(e,Object(k.b)((function(e,t){this.set(t,e)}),this))}return r.prototype=a,r.hasType=a.$instanceOf=this.model.hasType,n.defineModel(r,t),n.defineDescriptor(r,e),r};var F={String:!0,Boolean:!0,Integer:!0,Real:!0,Element:!0},B={String:function(e){return e},Boolean:function(e){return"true"===e},Integer:function(e){return parseInt(e,10)},Real:function(e){return parseFloat(e,10)}};function D(e,t){var n=B[e];return n?n(t):t}function L(e){return!!F[e]}function I(e){return!!B[e]}function V(e,t){var n,a,i=e.split(/:/);if(1===i.length)n=e,a=t;else{if(2!==i.length)throw new Error("expected <prefix:localName> or <localName>, got "+e);n=i[1],a=i[0]}return{name:e=(a?a+":":"")+n,prefix:a,localName:n}}function $(e){this.ns=e,this.name=e.name,this.allTypes=[],this.allTypesByName={},this.properties=[],this.propertiesByName={}}function z(e,t){this.packageMap={},this.typeMap={},this.packages=[],this.properties=t,Object(k.i)(e,Object(k.b)(this.registerPackage,this))}function W(e,t,n){var a=t[n];if(a in e)throw new Error("package with "+n+" <"+a+"> already defined")}function G(e){this.model=e}function H(e,t,n){Object.defineProperty(e,t.name,{enumerable:!t.isReference,writable:!0,value:n,configurable:!0})}function U(e){this.properties=new G(this),this.factory=new A(this,this.properties),this.registry=new z(e,this.properties),this.typeCache={}}$.prototype.build=function(){return Object(k.x)(this,["ns","name","allTypes","allTypesByName","properties","propertiesByName","bodyProperty","idProperty"])},$.prototype.addProperty=function(e,t,n){"boolean"===typeof t&&(n=t,t=void 0),this.addNamedProperty(e,!1!==n);var a=this.properties;void 0!==t?a.splice(t,0,e):a.push(e)},$.prototype.replaceProperty=function(e,t,n){var a=e.ns,i=this.properties,r=this.propertiesByName,o=e.name!==t.name;if(e.isId){if(!t.isId)throw new Error("property <"+t.ns.name+"> must be id property to refine <"+e.ns.name+">");this.setIdProperty(t,!1)}if(e.isBody){if(!t.isBody)throw new Error("property <"+t.ns.name+"> must be body property to refine <"+e.ns.name+">");this.setBodyProperty(t,!1)}var c=i.indexOf(e);if(-1===c)throw new Error("property <"+a.name+"> not found in property list");i.splice(c,1),this.addProperty(t,n?void 0:c,o),r[a.name]=r[a.localName]=t},$.prototype.redefineProperty=function(e,t,n){var a=e.ns.prefix,i=t.split("#"),r=V(i[0],a),o=V(i[1],r.prefix).name,c=this.propertiesByName[o];if(!c)throw new Error("refined property <"+o+"> not found");this.replaceProperty(c,e,n),delete e.redefines},$.prototype.addNamedProperty=function(e,t){var n=e.ns,a=this.propertiesByName;t&&(this.assertNotDefined(e,n.name),this.assertNotDefined(e,n.localName)),a[n.name]=a[n.localName]=e},$.prototype.removeNamedProperty=function(e){var t=e.ns,n=this.propertiesByName;delete n[t.name],delete n[t.localName]},$.prototype.setBodyProperty=function(e,t){if(t&&this.bodyProperty)throw new Error("body property defined multiple times (<"+this.bodyProperty.ns.name+">, <"+e.ns.name+">)");this.bodyProperty=e},$.prototype.setIdProperty=function(e,t){if(t&&this.idProperty)throw new Error("id property defined multiple times (<"+this.idProperty.ns.name+">, <"+e.ns.name+">)");this.idProperty=e},$.prototype.assertNotDefined=function(e,t){var n=e.name,a=this.propertiesByName[n];if(a)throw new Error("property <"+n+"> already defined; override of <"+a.definedBy.ns.name+"#"+a.ns.name+"> by <"+e.definedBy.ns.name+"#"+e.ns.name+"> not allowed without redefines")},$.prototype.hasProperty=function(e){return this.propertiesByName[e]},$.prototype.addTrait=function(e,t){var n=this.allTypesByName,a=this.allTypes,i=e.name;i in n||(Object(k.i)(e.properties,Object(k.b)((function(n){n=Object(k.a)({},n,{name:n.ns.localName,inherited:t}),Object.defineProperty(n,"definedBy",{value:e});var a=n.replaces,i=n.redefines;a||i?this.redefineProperty(n,a||i,a):(n.isBody&&this.setBodyProperty(n),n.isId&&this.setIdProperty(n),this.addProperty(n))}),this)),a.push(e),n[i]=e)},z.prototype.getPackage=function(e){return this.packageMap[e]},z.prototype.getPackages=function(){return this.packages},z.prototype.registerPackage=function(e){e=Object(k.a)({},e);var t=this.packageMap;W(t,e,"prefix"),W(t,e,"uri"),Object(k.i)(e.types,Object(k.b)((function(t){this.registerType(t,e)}),this)),t[e.uri]=t[e.prefix]=e,this.packages.push(e)},z.prototype.registerType=function(e,t){var n=V((e=Object(k.a)({},e,{superClass:(e.superClass||[]).slice(),extends:(e.extends||[]).slice(),properties:(e.properties||[]).slice(),meta:Object(k.a)(e.meta||{})})).name,t.prefix),a=n.name,i={};Object(k.i)(e.properties,Object(k.b)((function(e){var t=V(e.name,n.prefix),a=t.name;L(e.type)||(e.type=V(e.type,t.prefix).name),Object(k.a)(e,{ns:t,name:a}),i[a]=e}),this)),Object(k.a)(e,{ns:n,name:a,propertiesByName:i}),Object(k.i)(e.extends,Object(k.b)((function(e){var t=this.typeMap[e];t.traits=t.traits||[],t.traits.push(a)}),this)),this.definePackage(e,t),this.typeMap[a]=e},z.prototype.mapTypes=function(e,t,n){var a=L(e.name)?{name:e.name}:this.typeMap[e.name],i=this;function r(e){return o(e,!0)}function o(n,a){var r=V(n,L(n)?"":e.prefix);i.mapTypes(r,t,a)}if(!a)throw new Error("unknown type <"+e.name+">");Object(k.i)(a.superClass,n?r:o),t(a,!n),Object(k.i)(a.traits,r)},z.prototype.getEffectiveDescriptor=function(e){var t=V(e),n=new $(t);this.mapTypes(t,(function(e,t){n.addTrait(e,t)}));var a=n.build();return this.definePackage(a,a.allTypes[a.allTypes.length-1].$pkg),a},z.prototype.definePackage=function(e,t){this.properties.define(e,"$pkg",{value:t})},G.prototype.set=function(e,t,n){var a=this.model.getPropertyDescriptor(e,t),i=a&&a.name;"undefined"===typeof n?a?delete e[i]:delete e.$attrs[t]:a?i in e?e[i]=n:H(e,a,n):e.$attrs[t]=n},G.prototype.get=function(e,t){var n=this.model.getPropertyDescriptor(e,t);if(!n)return e.$attrs[t];var a=n.name;return!e[a]&&n.isMany&&H(e,n,[]),e[a]},G.prototype.define=function(e,t,n){Object.defineProperty(e,t,n)},G.prototype.defineDescriptor=function(e,t){this.define(e,"$descriptor",{value:t})},G.prototype.defineModel=function(e,t){this.define(e,"$model",{value:t})},U.prototype.create=function(e,t){var n=this.getType(e);if(!n)throw new Error("unknown type <"+e+">");return new n(t)},U.prototype.getType=function(e){var t=this.typeCache,n=Object(k.r)(e)?e:e.ns.name,a=t[n];return a||(e=this.registry.getEffectiveDescriptor(n),a=t[n]=this.factory.createType(e)),a},U.prototype.createAny=function(e,t,n){var a=V(e),i={$type:e,$instanceOf:function(e){return e===this.$type}},r={name:e,isGeneric:!0,ns:{prefix:a.prefix,localName:a.localName,uri:t}};return this.properties.defineDescriptor(i,r),this.properties.defineModel(i,this),this.properties.define(i,"$parent",{enumerable:!1,writable:!0}),Object(k.i)(n,(function(e,t){Object(k.q)(e)&&void 0!==e.value?i[e.name]=e.value:i[t]=e})),i},U.prototype.getPackage=function(e){return this.registry.getPackage(e)},U.prototype.getPackages=function(){return this.registry.getPackages()},U.prototype.getElementDescriptor=function(e){return e.$descriptor},U.prototype.hasType=function(e,t){return void 0===t&&(t=e,e=this),t in e.$model.getElementDescriptor(e).allTypesByName},U.prototype.getPropertyDescriptor=function(e,t){return this.getElementDescriptor(e).propertiesByName[t]},U.prototype.getTypeDescriptor=function(e){return this.registry.typeMap[e]};var K=n(203);function q(e){return e.xml&&"lowerCase"===e.xml.tagAlias}var J={xsi:"http://www.w3.org/2001/XMLSchema-instance"},Y="xsi:type";function X(e){return e.xml&&e.xml.serialize}function Q(e){return X(e)===Y}function Z(e,t){return q(t)?e.prefix+":"+((n=e.localName).charAt(0).toUpperCase()+n.slice(1)):e.name;var n}function ee(e){return new Error(e)}function te(e){return e.$descriptor}function ne(e){Object(k.a)(this,e),this.elementsById={},this.references=[],this.warnings=[],this.addReference=function(e){this.references.push(e)},this.addElement=function(e){if(!e)throw ee("expected element");var t,n=this.elementsById,a=te(e).idProperty;if(a&&(t=e.get(a.name))){if(!/^([a-z][\w-.]*:)?[a-z_][\w-.]*$/i.test(t))throw new Error("illegal ID <"+t+">");if(n[t])throw ee("duplicate ID <"+t+">");n[t]=e}},this.addWarning=function(e){this.warnings.push(e)}}function ae(){}function ie(){}function re(){}function oe(e,t){this.property=e,this.context=t}function ce(e,t){this.element=t,this.propertyDesc=e}function se(){}function le(e,t,n){this.model=e,this.type=e.getType(t),this.context=n}function ue(e,t,n){le.call(this,e,t,n)}function pe(e,t,n){this.model=e,this.context=n}function de(e){e instanceof U&&(e={model:e}),Object(k.a)(this,{lax:!1},e)}ae.prototype.handleEnd=function(){},ae.prototype.handleText=function(){},ae.prototype.handleNode=function(){},ie.prototype=Object.create(ae.prototype),ie.prototype.handleNode=function(){return this},re.prototype=Object.create(ae.prototype),re.prototype.handleText=function(e){this.body=(this.body||"")+e},oe.prototype=Object.create(re.prototype),oe.prototype.handleNode=function(e){if(this.element)throw ee("expected no sub nodes");return this.element=this.createReference(e),this},oe.prototype.handleEnd=function(){this.element.id=this.body},oe.prototype.createReference=function(e){return{property:this.property.ns.name,id:""}},ce.prototype=Object.create(re.prototype),ce.prototype.handleEnd=function(){var e=this.body||"",t=this.element,n=this.propertyDesc;e=D(n.type,e),n.isMany?t.get(n.name).push(e):t.set(n.name,e)},se.prototype=Object.create(re.prototype),se.prototype.handleNode=function(e){var t=this,n=this.element;return n?t=this.handleChild(e):(n=this.element=this.createElement(e),this.context.addElement(n)),t},le.prototype=Object.create(se.prototype),le.prototype.addReference=function(e){this.context.addReference(e)},le.prototype.handleText=function(e){if(!te(this.element).bodyProperty)throw ee("unexpected body text <"+e+">");re.prototype.handleText.call(this,e)},le.prototype.handleEnd=function(){var e=this.body,t=this.element,n=te(t).bodyProperty;n&&void 0!==e&&(e=D(n.type,e),t.set(n.name,e))},le.prototype.createElement=function(e){var t,n=e.attributes,a=this.type,i=te(a),r=this.context,o=new a({}),c=this.model;return Object(k.i)(n,(function(e,n){var a,s=i.propertiesByName[n];s&&s.isReference?s.isMany?(a=e.split(" "),Object(k.i)(a,(function(e){r.addReference({element:o,property:s.ns.name,id:e})}))):r.addReference({element:o,property:s.ns.name,id:e}):(s?e=D(s.type,e):"xmlns"!==n&&(t=V(n,i.ns.prefix),c.getPackage(t.prefix)&&r.addWarning({message:"unknown attribute <"+n+">",element:o,property:n,value:e})),o.set(n,e))})),o},le.prototype.getPropertyForNode=function(e){var t,n,a=V(e.name),i=this.type,r=this.model,o=te(i),c=a.name,s=o.propertiesByName[c];if(s&&!s.isAttr)return Q(s)&&(t=e.attributes[Y])?(t=function(e,t){var n=V(e);return function(e,t){var n=e.name,a=e.localName,i=t.xml&&t.xml.typePrefix;return i&&0===a.indexOf(i)?e.prefix+":"+a.slice(i.length):n}(n,t.getPackage(n.prefix))}(t,r),n=r.getType(t),Object(k.a)({},s,{effectiveType:te(n).name})):s;var l=r.getPackage(a.prefix);if(l){if(t=Z(a,l),n=r.getType(t),s=Object(k.f)(o.properties,(function(e){return!e.isVirtual&&!e.isReference&&!e.isAttribute&&n.hasType(e.type)})))return Object(k.a)({},s,{effectiveType:te(n).name})}else if(s=Object(k.f)(o.properties,(function(e){return!e.isReference&&!e.isAttribute&&"Element"===e.type})))return s;throw ee("unrecognized element <"+a.name+">")},le.prototype.toString=function(){return"ElementDescriptor["+te(this.type).name+"]"},le.prototype.valueHandler=function(e,t){return new ce(e,t)},le.prototype.referenceHandler=function(e){return new oe(e,this.context)},le.prototype.handler=function(e){return"Element"===e?new pe(this.model,e,this.context):new le(this.model,e,this.context)},le.prototype.handleChild=function(e){var t,n,a,i;if(t=this.getPropertyForNode(e),a=this.element,I(n=t.effectiveType||t.type))return this.valueHandler(t,a);var r=(i=t.isReference?this.referenceHandler(t).handleNode(e):this.handler(n).handleNode(e)).element;return void 0!==r&&(t.isMany?a.get(t.name).push(r):a.set(t.name,r),t.isReference?(Object(k.a)(r,{element:a}),this.context.addReference(r)):r.$parent=a),i},ue.prototype=Object.create(le.prototype),ue.prototype.createElement=function(e){var t=e.name,n=V(t),a=this.model,i=this.type,r=a.getPackage(n.prefix),o=r&&Z(n,r)||t;if(!i.hasType(o))throw ee("unexpected element <"+e.originalName+">");return le.prototype.createElement.call(this,e)},pe.prototype=Object.create(se.prototype),pe.prototype.createElement=function(e){var t=e.name,n=V(t).prefix,a=e.ns[n+"$uri"],i=e.attributes;return this.model.createAny(t,a,i)},pe.prototype.handleChild=function(e){var t=new pe(this.model,"Element",this.context).handleNode(e),n=this.element,a=t.element;return void 0!==a&&((n.$children=n.$children||[]).push(a),a.$parent=n),t},pe.prototype.handleEnd=function(){this.body&&(this.element.$body=this.body)},de.prototype.fromXML=function(e,t,n){var a=t.rootHandler;t instanceof le?(a=t,t={}):"string"===typeof t?(a=this.handler(t),t={}):"string"===typeof a&&(a=this.handler(a));var i=this.model,r=this.lax,o=new ne(Object(k.a)({},t,{rootHandler:a})),c=new K.a({proxy:!0}),s=function(){var e=[];return Object.defineProperty(e,"peek",{value:function(){return this[this.length-1]}}),e}();function l(e,t,n){var a=t(),i=a.line,r=a.column,c=a.data;"<"===c.charAt(0)&&-1!==c.indexOf(" ")&&(c=c.slice(0,c.indexOf(" "))+">");var s="unparsable content "+(c?c+" ":"")+"detected\n\tline: "+i+"\n\tcolumn: "+r+"\n\tnested error: "+e.message;if(n)return o.addWarning({message:s,error:e}),!0;throw ee(s)}function u(e,t){return l(e,t,!0)}a.context=o,s.push(a);var p=/^<\?xml /i,d=/ encoding="([^"]+)"/i,m=/^utf-8$/i;function f(e,t){try{s.peek().handleText(e)}catch(n){u(n,t)}}var b=i.getPackages().reduce((function(e,t){return e[t.uri]=t.prefix,e}),{});c.ns(b).on("openTag",(function(e,t,n,a){var i=e.attrs||{},o=Object.keys(i).reduce((function(e,n){var a=t(i[n]);return e[n]=a,e}),{});!function(e,t){var n=s.peek();try{s.push(n.handleNode(e))}catch(a){l(a,t,r)&&s.push(new ie)}}({name:e.name,originalName:e.originalName,attributes:o,ns:e.ns},a)})).on("question",(function(e){if(p.test(e)){var t=d.exec(e),n=t&&t[1];n&&!m.test(n)&&o.addWarning({message:"unsupported document encoding <"+n+">, falling back to UTF-8"})}})).on("closeTag",(function(){s.pop().handleEnd()})).on("cdata",f).on("text",(function(e,t,n){!function(e,t){(e=e.trim())&&f(e,t)}(t(e),n)})).on("error",l).on("warn",u),setTimeout((function(){var t;try{c.parse(e),function(){var e,t,n=o.elementsById,a=o.references;for(e=0;t=a[e];e++){var i=t.element,r=n[t.id],c=te(i).propertiesByName[t.property];if(r||o.addWarning({message:"unresolved reference <"+t.id+">",element:t.element,property:t.property,value:t.id}),c.isMany){var s=i.get(c.name),l=s.indexOf(t);-1===l&&(l=s.length),r?s[l]=r:s.splice(l,1)}else i.set(c.name,r)}}()}catch(r){t=r}var i=a.element;t||i||(t=ee("failed to parse document as <"+a.type.$descriptor.name+">")),n(t,t?void 0:i,o)}),0)},de.prototype.handler=function(e){return new ue(this.model,e)};var me=/<|>|'|"|&|\n\r|\n/g,fe=/<|>|&/g;function be(e){var t={},n={},a={},i=[],r=[];this.byUri=function(t){return n[t]||e&&e.byUri(t)},this.add=function(e,t){n[e.uri]=e,t?i.push(e):r.push(e),this.mapPrefix(e.prefix,e.uri)},this.uriByPrefix=function(e){return t[e||"xmlns"]},this.mapPrefix=function(e,n){t[e||"xmlns"]=n},this.logUsed=function(e){var t=e.uri;a[t]=this.byUri(t)},this.getUsed=function(e){return[].concat(i,r).filter((function(e){return a[e.uri]}))}}function he(e,t){return q(t)?(n=e).charAt(0).toLowerCase()+n.slice(1):e;var n}function ve(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function ye(e){return Object(k.r)(e)?e:(e.prefix?e.prefix+":":"")+e.localName}var ge={"\n":"#10","\n\r":"#10",'"':"#34","'":"#39","<":"#60",">":"#62","&":"#38"},je={"<":"lt",">":"gt","&":"amp"};function xe(e,t,n){return(e=Object(k.r)(e)?e:""+e).replace(t,(function(e){return"&"+n[e]+";"}))}function Oe(e){this.tagName=e}function we(){}function Ee(e){this.tagName=e}function Ne(e,t){this.body=[],this.attrs=[],this.parent=e,this.propertyDescriptor=t}function Ce(e,t){Ne.call(this,e,t)}function Se(){this.value="",this.write=function(e){this.value+=e}}function _e(e,t){var n=[""];this.append=function(t){return e.write(t),this},this.appendNewLine=function(){return t&&e.write("\n"),this},this.appendIndent=function(){return t&&e.write(n.join("  ")),this},this.indent=function(){return n.push(""),this},this.unindent=function(){return n.pop(),this}}function ke(e){return e=Object(k.a)({format:!1,preamble:!0},e||{}),{toXML:function(t,n){var a=n||new Se,i=new _e(a,e.format);if(e.preamble&&i.append('<?xml version="1.0" encoding="UTF-8"?>\n'),(new Ne).build(t).serializeTo(i),!n)return a.value}}}function Me(e,t){U.call(this,e,t)}Oe.prototype.build=function(e){return this.element=e,this},Oe.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"+this.element.id+"</"+this.tagName+">").appendNewLine()},we.prototype.serializeValue=we.prototype.serializeTo=function(e){e.append(this.escape?xe(this.value,fe,je):this.value)},we.prototype.build=function(e,t){return this.value=t,"String"===e.type&&-1!==t.search(fe)&&(this.escape=!0),this},ve(Ee,we),Ee.prototype.serializeTo=function(e){e.appendIndent().append("<"+this.tagName+">"),this.serializeValue(e),e.append("</"+this.tagName+">").appendNewLine()},Ne.prototype.build=function(e){this.element=e;var t,n,a,i=e.$descriptor,r=this.propertyDescriptor,o=i.isGeneric;return t=o?this.parseGeneric(e):this.parseNsAttributes(e),this.ns=r?this.nsPropertyTagName(r):this.nsTagName(i),this.tagName=this.addTagName(this.ns),o||(n=function(e){var t=e.$descriptor;return Object(k.e)(t.properties,(function(t){var n=t.name;if(t.isVirtual)return!1;if(!e.hasOwnProperty(n))return!1;var a=e[n];return a!==t.default&&null!==a&&(!t.isMany||a.length)}))}(e),this.parseAttributes((a=n,Object(k.e)(a,(function(e){return e.isAttr})))),this.parseContainments(function(e){return Object(k.e)(e,(function(e){return!e.isAttr}))}(n))),this.parseGenericAttributes(e,t),this},Ne.prototype.nsTagName=function(e){return function(e,t){return t.isGeneric?Object(k.a)({localName:t.ns.localName},e):Object(k.a)({localName:he(t.ns.localName,t.$pkg)},e)}(this.logNamespaceUsed(e.ns),e)},Ne.prototype.nsPropertyTagName=function(e){return function(e,t){return Object(k.a)({localName:t.ns.localName},e)}(this.logNamespaceUsed(e.ns),e)},Ne.prototype.isLocalNs=function(e){return e.uri===this.ns.uri},Ne.prototype.nsAttributeName=function(e){var t;if(t=Object(k.r)(e)?V(e):e.ns,e.inherited)return{localName:t.localName};var n=this.logNamespaceUsed(t);return this.getNamespaces().logUsed(n),this.isLocalNs(n)?{localName:t.localName}:Object(k.a)({localName:t.localName},n)},Ne.prototype.parseGeneric=function(e){var t=this,n=this.body,a=[];return Object(k.i)(e,(function(i,r){"$body"===r?n.push((new we).build({type:"String"},i)):"$children"===r?Object(k.i)(i,(function(e){n.push(new Ne(t).build(e))})):0!==r.indexOf("$")&&t.parseNsAttribute(e,r,i)&&a.push({name:r,value:i})})),a},Ne.prototype.parseNsAttribute=function(e,t,n){var a,i=e.$model,r=V(t);if("xmlns"===r.prefix&&(a={prefix:r.localName,uri:n}),r.prefix||"xmlns"!==r.localName||(a={uri:n}),!a)return{name:t,value:n};if(i&&i.getPackage(n))this.logNamespace(a,!0,!0);else{var o=this.logNamespaceUsed(a,!0);this.getNamespaces().logUsed(o)}},Ne.prototype.parseNsAttributes=function(e,t){var n=this,a=e.$attrs,i=[];return Object(k.i)(a,(function(t,a){var r=n.parseNsAttribute(e,a,t);r&&i.push(r)})),i},Ne.prototype.parseGenericAttributes=function(e,t){var n=this;Object(k.i)(t,(function(t){if(t.name!==Y)try{n.addAttribute(n.nsAttributeName(t.name),t.value)}catch(a){console.warn("missing namespace information for ",t.name,"=",t.value,"on",e,a)}}))},Ne.prototype.parseContainments=function(e){var t=this,n=this.body,a=this.element;Object(k.i)(e,(function(e){var i=a.get(e.name),r=e.isReference;if(e.isMany||(i=[i]),e.isBody)n.push((new we).build(e,i[0]));else if(I(e.type))Object(k.i)(i,(function(a){n.push(new Ee(t.addTagName(t.nsPropertyTagName(e))).build(e,a))}));else if(r)Object(k.i)(i,(function(a){n.push(new Oe(t.addTagName(t.nsPropertyTagName(e))).build(a))}));else{var o=Q(e),c=function(e){return"property"===X(e)}(e);Object(k.i)(i,(function(a){var i;i=o?new Ce(t,e):c?new Ne(t,e):new Ne(t),n.push(i.build(a))}))}}))},Ne.prototype.getNamespaces=function(e){var t,n=this.namespaces,a=this.parent;return n||(t=a&&a.getNamespaces(),e||!t?this.namespaces=n=new be(t):n=t),n},Ne.prototype.logNamespace=function(e,t,n){var a=this.getNamespaces(n),i=e.uri,r=e.prefix;return a.byUri(i)||a.add(e,t),a.mapPrefix(r,i),e},Ne.prototype.logNamespaceUsed=function(e,t){var n,a,i,r=this.element.$model,o=this.getNamespaces(t),c=e.prefix,s=e.uri;if(!c&&!s)return{localName:e.localName};if(i=J[c]||r&&(r.getPackage(c)||{}).uri,!(s=s||i||o.uriByPrefix(c)))throw new Error("no namespace uri given for prefix <"+c+">");if(!(e=o.byUri(s))){for(n=c,a=1;o.uriByPrefix(n);)n=c+"_"+a++;e=this.logNamespace({prefix:n,uri:s},i===s)}return c&&o.mapPrefix(c,s),e},Ne.prototype.parseAttributes=function(e){var t=this,n=this.element;Object(k.i)(e,(function(e){var a=n.get(e.name);if(e.isReference)if(e.isMany){var i=[];Object(k.i)(a,(function(e){i.push(e.id)})),a=i.join(" ")}else a=a.id;t.addAttribute(t.nsAttributeName(e),a)}))},Ne.prototype.addTagName=function(e){var t=this.logNamespaceUsed(e);return this.getNamespaces().logUsed(t),ye(e)},Ne.prototype.addAttribute=function(e,t){var n=this.attrs;Object(k.r)(t)&&(t=xe(t,me,ge)),n.push({name:e,value:t})},Ne.prototype.serializeAttributes=function(e){var t=this.attrs,n=this.namespaces;n&&(t=function(e){return Object(k.u)(e.getUsed(),(function(e){return{name:"xmlns"+(e.prefix?":"+e.prefix:""),value:e.uri}}))}(n).concat(t)),Object(k.i)(t,(function(t){e.append(" ").append(ye(t.name)).append('="').append(t.value).append('"')}))},Ne.prototype.serializeTo=function(e){var t=this.body[0],n=t&&t.constructor!==we;e.appendIndent().append("<"+this.tagName),this.serializeAttributes(e),e.append(t?">":" />"),t&&(n&&e.appendNewLine().indent(),Object(k.i)(this.body,(function(t){t.serializeTo(e)})),n&&e.unindent().appendIndent(),e.append("</"+this.tagName+">")),e.appendNewLine()},ve(Ce,Ne),Ce.prototype.parseNsAttributes=function(e){var t=Ne.prototype.parseNsAttributes.call(this,e),n=e.$descriptor;if(n.name===this.propertyDescriptor.type)return t;var a=this.typeNs=this.nsTagName(n);this.getNamespaces().logUsed(this.typeNs);var i=e.$model.getPackage(a.uri),r=i.xml&&i.xml.typePrefix||"";return this.addAttribute(this.nsAttributeName(Y),(a.prefix?a.prefix+":":"")+r+n.ns.localName),t},Ce.prototype.isLocalNs=function(e){return e.uri===(this.typeNs||this.ns).uri},Me.prototype=Object.create(U.prototype),Me.prototype.fromXML=function(e,t,n,a){Object(k.r)(t)||(a=n,n=t,t="bpmn:Process-actions"),Object(k.n)(n)&&(a=n,n={});var i=new de(Object(k.a)({model:this,lax:!0},n)),r=i.handler(t);i.fromXML(e,r,a)},Me.prototype.toXML=function(e,t,n){Object(k.n)(t)&&(n=t,t={});var a,i,r=new ke(t);try{a=r.toXML(e)}catch(o){i=o}return n(i,a)};var Pe={bpmn:{name:"BPMN20",uri:"http://www.omg.org/spec/BPMN/20100524/MODEL",associations:[],types:[{name:"Interface",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"operations",type:"Operation",isMany:!0},{name:"implementationRef",type:"String",isAttr:!0}]},{name:"Operation",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"inMessageRef",type:"Message",isReference:!0},{name:"outMessageRef",type:"Message",isReference:!0},{name:"errorRef",type:"Error",isMany:!0,isReference:!0},{name:"implementationRef",type:"String",isAttr:!0}]},{name:"EndPoint",superClass:["RootElement"]},{name:"Auditing",superClass:["BaseElement"]},{name:"GlobalTask",superClass:["CallableElement"],properties:[{name:"resources",type:"ResourceRole",isMany:!0}]},{name:"Monitoring",superClass:["BaseElement"]},{name:"Performer",superClass:["ResourceRole"]},{name:"Process-action",superClass:["FlowElementsContainer","CallableElement"],properties:[{name:"targetModel",isAttr:!0,type:"String"},{name:"sourceModel",isAttr:!0,type:"String"}]},{name:"Gateway",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"gatewayDirection",type:"GatewayDirection",default:"Unspecified",isAttr:!0}]},{name:"EventBasedGateway",superClass:["Gateway"],properties:[{name:"instantiate",default:!1,isAttr:!0,type:"Boolean"},{name:"eventGatewayType",type:"EventBasedGatewayType",isAttr:!0,default:"Exclusive"}]},{name:"Parameter",superClass:["Element"],meta:{allowedIn:["bpmn:Function","bpmn:Query"]},properties:[{name:"id",isAttr:!0,type:"String"},{name:"target",isAttr:!0,type:"String"},{name:"expression",isAttr:!0,type:"String"}]},{name:"Query",superClass:["Gateway"],properties:[{name:"target",isAttr:!0,type:"String"},{name:"expression",isAttr:!0,type:"String"},{name:"expressionValue",isAttr:!0,type:"String"},{name:"model",isAttr:!0,type:"String"},{name:"isJson",isAttr:!0,type:"Boolean",default:!1},{name:"returnType",isAttr:!0,type:"String"},{name:"values",type:"Element",isMany:!0}]},{name:"RootElement",isAbstract:!0,superClass:["BaseElement"]},{name:"Relationship",superClass:["BaseElement"],properties:[{name:"type",isAttr:!0,type:"String"},{name:"direction",type:"RelationshipDirection",isAttr:!0},{name:"source",isMany:!0,isReference:!0,type:"Element"},{name:"target",isMany:!0,isReference:!0,type:"Element"}]},{name:"BaseElement",isAbstract:!0,properties:[{name:"id",isAttr:!0,type:"String",isId:!0},{name:"documentation",type:"Documentation",isMany:!0},{name:"extensionDefinitions",type:"ExtensionDefinition",isMany:!0,isReference:!0},{name:"assignElements",type:"AssignElements"},{name:"parameters",type:"Parameters"}]},{name:"Extension",properties:[{name:"mustUnderstand",default:!1,isAttr:!0,type:"Boolean"},{name:"definition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"ExtensionDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"extensionAttributeDefinitions",type:"ExtensionAttributeDefinition",isMany:!0}]},{name:"ExtensionAttributeDefinition",properties:[{name:"name",isAttr:!0,type:"String"},{name:"type",isAttr:!0,type:"String"},{name:"isReference",default:!1,isAttr:!0,type:"Boolean"},{name:"extensionDefinition",type:"ExtensionDefinition",isAttr:!0,isReference:!0}]},{name:"AssignElements",properties:[{name:"valueRef",isAttr:!0,isReference:!0,type:"Element"},{name:"values",type:"Element",isMany:!0},{name:"extensionAttributeDefinition",type:"ExtensionAttributeDefinition",isAttr:!0,isReference:!0}]},{name:"Parameters",properties:[{name:"values",type:"Element",isMany:!0}]},{name:"FlowElement",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"auditing",type:"Auditing"},{name:"monitoring",type:"Monitoring"},{name:"categoryValueRef",type:"CategoryValue",isMany:!0,isReference:!0}]},{name:"SequenceFlow",superClass:["FlowElement"],properties:[{name:"isImmediate",isAttr:!0,type:"Boolean"},{name:"conditionExpression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"sourceRef",type:"FlowNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"FlowNode",isAttr:!0,isReference:!0}]},{name:"FlowElementsContainer",isAbstract:!0,superClass:["BaseElement"],properties:[{name:"laneSets",type:"LaneSet",isMany:!0},{name:"flowElements",type:"FlowElement",isMany:!0}]},{name:"CallableElement",isAbstract:!0,superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"supportedInterfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"ioBinding",type:"InputOutputBinding",isMany:!0,xml:{serialize:"property"}}]},{name:"FlowNode",isAbstract:!0,superClass:["FlowElement"],properties:[{name:"lanes",type:"Lane",isVirtual:!0,isMany:!0,isReference:!0}]},{name:"CorrelationPropertyRetrievalExpression",superClass:["BaseElement"],properties:[{name:"messagePath",type:"FormalExpression"},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"CorrelationPropertyBinding",superClass:["BaseElement"],properties:[{name:"dataPath",type:"FormalExpression"},{name:"correlationPropertyRef",type:"CorrelationProperty",isAttr:!0,isReference:!0}]},{name:"Resource",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"resourceParameters",type:"ResourceParameter",isMany:!0}]},{name:"ResourceParameter",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isRequired",isAttr:!0,type:"Boolean"},{name:"type",type:"ItemDefinition",isAttr:!0,isReference:!0}]},{name:"CorrelationSubscription",superClass:["BaseElement"],properties:[{name:"correlationKeyRef",type:"CorrelationKey",isAttr:!0,isReference:!0},{name:"correlationPropertyBinding",type:"CorrelationPropertyBinding",isMany:!0}]},{name:"MessageFlow",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"sourceRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"targetRef",type:"InteractionNode",isAttr:!0,isReference:!0},{name:"messageRef",type:"Message",isAttr:!0,isReference:!0}]},{name:"MessageFlowAssociation",superClass:["BaseElement"],properties:[{name:"innerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0},{name:"outerMessageFlowRef",type:"MessageFlow",isAttr:!0,isReference:!0}]},{name:"InteractionNode",isAbstract:!0,properties:[{name:"incomingConversationLinks",type:"ConversationLink",isVirtual:!0,isMany:!0,isReference:!0},{name:"outgoingConversationLinks",type:"ConversationLink",isVirtual:!0,isMany:!0,isReference:!0}]},{name:"Participant",superClass:["InteractionNode","BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"interfaceRef",type:"Interface",isMany:!0,isReference:!0},{name:"participantMultiplicity",type:"ParticipantMultiplicity"},{name:"endPointRefs",type:"EndPoint",isMany:!0,isReference:!0},{name:"processRef",type:"Process-action",isAttr:!0,isReference:!0}]},{name:"ParticipantAssociation",superClass:["BaseElement"],properties:[{name:"innerParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"outerParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"ParticipantMultiplicity",properties:[{name:"minimum",default:0,isAttr:!0,type:"Integer"},{name:"maximum",default:1,isAttr:!0,type:"Integer"}],superClass:["BaseElement"]},{name:"Collaboration",superClass:["RootElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"isClosed",isAttr:!0,type:"Boolean"},{name:"participants",type:"Participant",isMany:!0},{name:"messageFlows",type:"MessageFlow",isMany:!0},{name:"artifacts",type:"Artifact",isMany:!0},{name:"conversations",type:"ConversationNode",isMany:!0},{name:"conversationAssociations",type:"ConversationAssociation"},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0},{name:"messageFlowAssociations",type:"MessageFlowAssociation",isMany:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"choreographyRef",type:"Choreography",isMany:!0,isReference:!0},{name:"conversationLinks",type:"ConversationLink",isMany:!0}]},{name:"ChoreographyActivity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"participantRef",type:"Participant",isMany:!0,isReference:!0},{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0},{name:"correlationKeys",type:"CorrelationKey",isMany:!0},{name:"loopType",type:"ChoreographyLoopType",default:"None",isAttr:!0}]},{name:"CallChoreography",superClass:["ChoreographyActivity"],properties:[{name:"calledChoreographyRef",type:"Choreography",isAttr:!0,isReference:!0},{name:"participantAssociations",type:"ParticipantAssociation",isMany:!0}]},{name:"SubChoreography",superClass:["ChoreographyActivity","FlowElementsContainer"],properties:[{name:"artifacts",type:"Artifact",isMany:!0}]},{name:"ChoreographyTask",superClass:["ChoreographyActivity"],properties:[{name:"messageFlowRef",type:"MessageFlow",isMany:!0,isReference:!0}]},{name:"Choreography",superClass:["Collaboration","FlowElementsContainer"]},{name:"GlobalChoreographyTask",superClass:["Choreography"],properties:[{name:"initiatingParticipantRef",type:"Participant",isAttr:!0,isReference:!0}]},{name:"TextAnnotation",superClass:["Artifact"],properties:[{name:"text",type:"String"},{name:"textFormat",default:"text/plain",isAttr:!0,type:"String"}]},{name:"Activity",isAbstract:!0,superClass:["FlowNode"],properties:[{name:"isForCompensation",default:!1,isAttr:!0,type:"Boolean"},{name:"ioSpecification",type:"InputOutputSpecification",xml:{serialize:"property"}},{name:"boundaryEventRefs",type:"BoundaryEvent",isMany:!0,isReference:!0},{name:"properties",type:"Property",isMany:!0},{name:"dataInputAssociations",type:"DataInputAssociation",isMany:!0},{name:"dataOutputAssociations",type:"DataOutputAssociation",isMany:!0},{name:"startQuantity",default:1,isAttr:!0,type:"Integer"},{name:"resources",type:"ResourceRole",isMany:!0},{name:"completionQuantity",default:1,isAttr:!0,type:"Integer"}]},{name:"Conditional",superClass:["Activity","FlowElementsContainer","InteractionNode"],properties:[{name:"triggeredByEvent",default:!1,isAttr:!0,type:"Boolean"},{name:"artifacts",type:"Artifact",isMany:!0},{name:"expression",isAttr:!0,type:"String"},{name:"expressionValue",isAttr:!0,type:"String"}]},{name:"Loop",superClass:["Activity","FlowElementsContainer","InteractionNode"],properties:[{name:"triggeredByEvent",default:!1,isAttr:!0,type:"Boolean"},{name:"artifacts",type:"Artifact",isMany:!0},{name:"target",isAttr:!0,type:"String"},{name:"expression",isAttr:!0,type:"String"},{name:"expressionValue",isAttr:!0,type:"String"}]},{name:"Task",superClass:["Activity","InteractionNode"]},{name:"Mapper",superClass:["Task"],properties:[{name:"script",type:"Script"},{name:"scriptMeta",type:"ScriptMeta"},{name:"sourceField",isAttr:!0,type:"String"},{name:"targetField",isAttr:!0,type:"String"}]},{name:"Script",superClass:["BaseElement"],properties:[{name:"value",isBody:!0,type:"String"}]},{name:"ScriptMeta",superClass:["BaseElement"],properties:[{name:"value",isBody:!0,type:"String"}]},{name:"Function",superClass:["Task"],properties:[{name:"returnType",isAttr:!0,type:"String"},{name:"functionName",isAttr:!0,type:"String"},{name:"values",type:"Element",isMany:!0}]},{name:"GlobalScriptTask",superClass:["GlobalTask"],properties:[{name:"scriptLanguage",isAttr:!0,type:"String"},{name:"script",isAttr:!0,type:"String"}]},{name:"GlobalBusinessRuleTask",superClass:["GlobalTask"],properties:[{name:"implementation",isAttr:!0,type:"String"}]},{name:"ComplexBehaviorDefinition",superClass:["BaseElement"],properties:[{name:"condition",type:"FormalExpression"},{name:"event",type:"ImplicitThrowEvent"}]},{name:"ResourceRole",superClass:["BaseElement"],properties:[{name:"resourceRef",type:"Resource",isReference:!0},{name:"resourceParameterBindings",type:"ResourceParameterBinding",isMany:!0},{name:"resourceAssignmentExpression",type:"ResourceAssignmentExpression"},{name:"name",isAttr:!0,type:"String"}]},{name:"ResourceParameterBinding",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}},{name:"parameterRef",type:"ResourceParameter",isAttr:!0,isReference:!0}],superClass:["BaseElement"]},{name:"ResourceAssignmentExpression",properties:[{name:"expression",type:"Expression",xml:{serialize:"xsi:type"}}],superClass:["BaseElement"]},{name:"Import",properties:[{name:"importType",isAttr:!0,type:"String"},{name:"location",isAttr:!0,type:"String"},{name:"namespace",isAttr:!0,type:"String"}]},{name:"Process-actions",superClass:["BaseElement"],properties:[{name:"name",isAttr:!0,type:"String"},{name:"targetNamespace",isAttr:!0,type:"String"},{name:"expressionLanguage",default:"http://www.w3.org/1999/XPath",isAttr:!0,type:"String"},{name:"typeLanguage",default:"http://www.w3.org/2001/XMLSchema",isAttr:!0,type:"String"},{name:"imports",type:"Import",isMany:!0},{name:"extensions",type:"Extension",isMany:!0},{name:"rootElements",type:"RootElement",isMany:!0},{name:"diagrams",isMany:!0,type:"bpmndi:BPMNDiagram"},{name:"exporter",isAttr:!0,type:"String"},{name:"relationships",type:"Relationship",isMany:!0},{name:"exporterVersion",isAttr:!0,type:"String"}]}],enumerations:[{name:"ProcessType",literalValues:[{name:"None"},{name:"Public"},{name:"Private"}]},{name:"GatewayDirection",literalValues:[{name:"Unspecified"},{name:"Converging"},{name:"Diverging"},{name:"Mixed"}]},{name:"EventBasedGatewayType",literalValues:[{name:"Parallel"},{name:"Exclusive"}]},{name:"RelationshipDirection",literalValues:[{name:"None"},{name:"Forward"},{name:"Backward"},{name:"Both"}]},{name:"ItemKind",literalValues:[{name:"Physical"},{name:"Information"}]},{name:"ChoreographyLoopType",literalValues:[{name:"None"},{name:"Standard"},{name:"MultiInstanceSequential"},{name:"MultiInstanceParallel"}]},{name:"AssociationDirection",literalValues:[{name:"None"},{name:"One"},{name:"Both"}]},{name:"MultiInstanceBehavior",literalValues:[{name:"None"},{name:"One"},{name:"All"},{name:"Complex"}]},{name:"AdHocOrdering",literalValues:[{name:"Parallel"},{name:"Sequential"}]}],prefix:"bpmn",xml:{tagAlias:"lowerCase",typePrefix:"t"}},bpmndi:{name:"BPMNDI",uri:"http://www.omg.org/spec/BPMN/20100524/DI",types:[{name:"BPMNDiagram",properties:[{name:"plane",type:"BPMNPlane",redefines:"di:Diagram#rootElement"},{name:"labelStyle",type:"BPMNLabelStyle",isMany:!0}],superClass:["di:Diagram"]},{name:"BPMNPlane",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"}],superClass:["di:Plane"]},{name:"BPMNShape",properties:[{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"isHorizontal",isAttr:!0,type:"Boolean"},{name:"isExpanded",isAttr:!0,type:"Boolean"},{name:"isMarkerVisible",isAttr:!0,type:"Boolean"},{name:"label",type:"BPMNLabel"},{name:"isMessageVisible",isAttr:!0,type:"Boolean"},{name:"participantBandKind",type:"ParticipantBandKind",isAttr:!0},{name:"choreographyActivityShape",type:"BPMNShape",isAttr:!0,isReference:!0}],superClass:["di:LabeledShape"]},{name:"BPMNEdge",properties:[{name:"label",type:"BPMNLabel"},{name:"bpmnElement",isAttr:!0,isReference:!0,type:"bpmn:BaseElement",redefines:"di:DiagramElement#modelElement"},{name:"sourceElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#source"},{name:"targetElement",isAttr:!0,isReference:!0,type:"di:DiagramElement",redefines:"di:Edge#target"},{name:"messageVisibleKind",type:"MessageVisibleKind",isAttr:!0,default:"initiating"}],superClass:["di:LabeledEdge"]},{name:"BPMNLabel",properties:[{name:"labelStyle",type:"BPMNLabelStyle",isAttr:!0,isReference:!0,redefines:"di:DiagramElement#style"}],superClass:["di:Label"]},{name:"BPMNLabelStyle",properties:[{name:"font",type:"dc:Font"}],superClass:["di:Style"]}],enumerations:[{name:"ParticipantBandKind",literalValues:[{name:"top_initiating"},{name:"middle_initiating"},{name:"bottom_initiating"},{name:"top_non_initiating"},{name:"middle_non_initiating"},{name:"bottom_non_initiating"}]},{name:"MessageVisibleKind",literalValues:[{name:"initiating"},{name:"non_initiating"}]}],associations:[],prefix:"bpmndi"},dc:{name:"DC",uri:"http://www.omg.org/spec/DD/20100524/DC",types:[{name:"Boolean"},{name:"Integer"},{name:"Real"},{name:"String"},{name:"Font",properties:[{name:"name",type:"String",isAttr:!0},{name:"size",type:"Real",isAttr:!0},{name:"isBold",type:"Boolean",isAttr:!0},{name:"isItalic",type:"Boolean",isAttr:!0},{name:"isUnderline",type:"Boolean",isAttr:!0},{name:"isStrikeThrough",type:"Boolean",isAttr:!0}]},{name:"Point",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0}]},{name:"Bounds",properties:[{name:"x",type:"Real",default:"0",isAttr:!0},{name:"y",type:"Real",default:"0",isAttr:!0},{name:"width",type:"Real",isAttr:!0},{name:"height",type:"Real",isAttr:!0}]}],prefix:"dc",associations:[]},di:{name:"DI",uri:"http://www.omg.org/spec/DD/20100524/DI",types:[{name:"DiagramElement",isAbstract:!0,properties:[{name:"id",type:"String",isAttr:!0,isId:!0},{name:"extension",type:"Extension"},{name:"owningDiagram",type:"Diagram",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"owningElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"modelElement",isReadOnly:!0,isVirtual:!0,isReference:!0,type:"Element"},{name:"style",type:"Style",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"ownedElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isMany:!0}]},{name:"Node",isAbstract:!0,superClass:["DiagramElement"]},{name:"Edge",isAbstract:!0,superClass:["DiagramElement"],properties:[{name:"source",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"target",type:"DiagramElement",isReadOnly:!0,isVirtual:!0,isReference:!0},{name:"waypoint",isUnique:!1,isMany:!0,type:"dc:Point",xml:{serialize:"xsi:type"}}]},{name:"Diagram",isAbstract:!0,properties:[{name:"id",type:"String",isAttr:!0,isId:!0},{name:"rootElement",type:"DiagramElement",isReadOnly:!0,isVirtual:!0},{name:"name",isAttr:!0,type:"String"},{name:"documentation",isAttr:!0,type:"String"},{name:"resolution",isAttr:!0,type:"Real"},{name:"ownedStyle",type:"Style",isReadOnly:!0,isVirtual:!0,isMany:!0}]},{name:"Shape",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Plane",isAbstract:!0,superClass:["Node"],properties:[{name:"planeElement",type:"DiagramElement",subsettedProperty:"DiagramElement-ownedElement",isMany:!0}]},{name:"LabeledEdge",isAbstract:!0,superClass:["Edge"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isVirtual:!0,isMany:!0}]},{name:"LabeledShape",isAbstract:!0,superClass:["Shape"],properties:[{name:"ownedLabel",type:"Label",isReadOnly:!0,subsettedProperty:"DiagramElement-ownedElement",isVirtual:!0,isMany:!0}]},{name:"Label",isAbstract:!0,superClass:["Node"],properties:[{name:"bounds",type:"dc:Bounds"}]},{name:"Style",isAbstract:!0,properties:[{name:"id",type:"String",isAttr:!0,isId:!0}]},{name:"Extension",properties:[{name:"values",type:"Element",isMany:!0}]}],associations:[],prefix:"di",xml:{tagAlias:"lowerCase"}},bioc:{name:"bpmn.io colors for BPMN",uri:"http://bpmn.io/schema/bpmn/biocolor/1.0",prefix:"bioc",types:[{name:"ColoredShape",extends:["bpmndi:BPMNShape"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]},{name:"ColoredEdge",extends:["bpmndi:BPMNEdge"],properties:[{name:"stroke",isAttr:!0,type:"String"},{name:"fill",isAttr:!0,type:"String"}]}],enumerations:[],associations:[]}};var Te=function(e,t){return new Me(Object(k.a)({},Pe,e),t)},Re=n(101);function Ae(e){return e?"<"+e.$type+(e.id?' id="'+e.id:"")+'" />':"<null>"}var Fe=new(n.n(Re).a)({name:"bpmnElement",enumerable:!0},{name:"di",configurable:!0});function Be(e,t){return e.$instanceOf(t)}function De(e,t){var n={},a=[];function i(e,t){return function(n){e(n,t)}}function r(e){n[e.id]=e}function o(n,a){try{var i=n.di&&function(n,a){if(n.gfx)throw new Error(t("already rendered {element}",{element:Ae(n)}));return e.element(n,a)}(n,a);return r(n),i}catch(o){c(o.message,{element:n,error:o}),console.error(t("failed to import {element}",{element:Ae(n)})),console.error(o)}}function c(t,n){e.error(t,n)}function s(e){var n=e.bpmnElement;n?n.di?c(t("multiple DI elements defined for {element}",{element:Ae(n)}),{element:n}):(Fe.bind(n,"di"),n.di=e):c(t("no bpmnElement referenced in {element}",{element:Ae(e)}),{element:e})}function l(e){var t;s(t=e.plane),Object(k.i)(t.planeElement,u)}function u(e){s(e)}function p(){for(;a.length;)a.shift()()}function d(e,t){N(e,t),g(e.ioSpecification,t),y(e.artifacts,t),r(e)}function m(e,t){o(e,t)}function f(e,t){o(e,t)}function b(e,t){o(e,t)}function h(e,t){o(e,t)}function v(e,t){o(e,t)}function y(e,t){Object(k.i)(e,(function(e){Be(e,"bpmn:Association")?a.push((function(){v(e,t)})):v(e,t)}))}function g(e,t){e&&(Object(k.i)(e.dataInputs,i(b,t)),Object(k.i)(e.dataOutputs,i(h,t)))}function j(e,t){N(e,t),y(e.artifacts,t)}function x(e,t){var n=o(e,t);Be(e,"bpmn:Loop")&&j(e,n||t),Be(e,"bpmn:Conditional")&&j(e,n||t),Be(e,"bpmn:Activity")&&g(e.ioSpecification,t),a.push((function(){Object(k.i)(e.dataInputAssociations,i(f,t)),Object(k.i)(e.dataOutputAssociations,i(f,t))}))}function O(e,t){o(e,t)}function w(e,t){a.push((function(){var n=o(e,t);e.childLaneSet&&E(e.childLaneSet,n||t),function(e){Object(k.i)(e.flowNodeRef,(function(t){var n=t.get("lanes");n&&n.push(e)}))}(e)}))}function E(e,t){Object(k.i)(e.lanes,i(w,t))}function N(e,n){!function(e,n){Object(k.i)(e,(function(e){Be(e,"bpmn:SequenceFlow")?a.push((function(){!function(e,t){o(e,t)}(e,n)})):Be(e,"bpmn:BoundaryEvent")?a.unshift((function(){x(e,n)})):Be(e,"bpmn:FlowNode")?x(e,n):Be(e,"bpmn:DataObject")||(Be(e,"bpmn:DataStoreReference")||Be(e,"bpmn:DataObjectReference")?O(e,n):c(t("unrecognized flowElement {element} in context {context}",{element:Ae(e),context:n?Ae(n.businessObject):"null"}),{element:e,context:n}))}))}(e.flowElements,n),e.laneSets&&function(e,t){Object(k.i)(e,i(E,t))}(e.laneSets,n)}function C(e,t){var n=o(e,t),a=e.processRef;a&&d(a,n||t)}return{handleDeferred:p,handleDefinitions:function(r,o){var u=r.diagrams;if(o&&-1===u.indexOf(o))throw new Error(t("diagram not part of bpmn:Process-actions"));if(!o&&u&&u.length&&(o=u[0]),!o)throw new Error(t("no diagram to display"));l(o);var f=o.plane;if(!f)throw new Error(t("no plane for {element}",{element:Ae(o)}));var b=f.bpmnElement;if(!b){if(!(b=function(e){return Object(k.f)(e.rootElements,(function(e){return Be(e,"bpmn:Process-action")||Be(e,"bpmn:Collaboration")}))}(r)))throw new Error(t("no process or collaboration to display"));c(t("correcting missing bpmnElement on {plane} to {rootElement}",{plane:Ae(f),rootElement:Ae(b)})),f.bpmnElement=b,s(f)}var h,v=function(t,n){return e.root(t,n)}(b,f);if(Be(b,"bpmn:Process-action"))d(b,v);else{if(!Be(b,"bpmn:Collaboration"))throw new Error(t("unsupported bpmnElement for {plane}: {rootElement}",{plane:Ae(f),rootElement:Ae(b)}));h=b,Object(k.i)(h.participants,i(C)),y(h.artifacts),a.push((function(){var e,t;e=h.messageFlows,Object(k.i)(e,i(m,t))})),function(e,t){Object(k.e)(e,(function(e){return!n[e.id]&&Be(e,"bpmn:Process-action")&&e.laneSets})).forEach(i(d,t))}(r.rootElements,v)}p()},handleLoop:j,registerDi:s}}function Le(e){e=Object(k.a)({},Ie,e),this._moddle=this._createModdle(e),this._container=this._createContainer(e),this._init(this._container,this._moddle,e)}S()(Le,T.a),Le.prototype.importXML=function(e,t,n){Object(k.n)(t)&&(n=t,t=null),n=n||function(){};var a=this;e=this._emit("import.parse.start",{xml:e})||e,this._moddle.fromXML(e,"bpmn:Process-actions",(function(e,i,r){i=a._emit("import.parse.complete",{error:e,definitions:i,context:r})||i;var o=r.warnings;if(e)return e=function(e){var t=/unparsable content <([^>]+)> detected([\s\S]*)$/.exec(e.message);t&&(e.message="unparsable content <"+t[1]+"> detected; this may indicate an invalid BPMN 2.0 diagram file"+t[2]);return e}(e),a._emit("import.done",{error:e,warnings:o}),n(e,o);a.importDefinitions(i,t,(function(e,t){var i=[].concat(o,t||[]);a._emit("import.done",{error:e,warnings:i}),n(e,i)}))}))},Le.prototype.importDefinitions=function(e,t,n){return Object(k.n)(t)&&(n=t,t=null),n=n||function(){},this._setDefinitions(e),this.open(t,n)},Le.prototype.open=function(e,t){Object(k.n)(e)&&(t=e,e=null);var n=this._definitions,a=e;if(t=t||function(){},!n)return t(new Error("no XML imported"));if("string"===typeof e&&!(a=function(e,t){if(!t)return null;return Object(k.f)(e.diagrams,(function(e){return e.id===t}))||null}(n,e)))return t(new Error("BPMNDiagram <"+e+"> not found"));try{this.clear()}catch(i){return t(i)}return function(e,t,n,a){var i,r,o;Object(k.n)(n)&&(a=n,n=null);var c,s=[];try{i=e.get("bpmnImporter"),r=e.get("eventBus"),o=e.get("translate"),r.fire("import.render.start",{definitions:t}),function(e,t){new De({root:function(e){return i.add(e)},element:function(e,t){return i.add(e,t)},error:function(e,t){s.push({message:e,context:t})}},o).handleDefinitions(e,t)}(t,n),r.fire("import.render.complete",{error:c,warnings:s})}catch(l){c=l}a(c,s)}(this,n,a,t)},Le.prototype.saveXML=function(e,t){t||(t=e,e={});var n=this,a=this._definitions;if(!a)return t(new Error("no definitions loaded"));a=this._emit("saveXML.start",{definitions:a})||a,this._moddle.toXML(a,e,(function(e,a){try{a=n._emit("saveXML.serialized",{error:e,xml:a})||a,n._emit("saveXML.done",{error:e,xml:a})}catch(i){console.error("error in saveXML life-cycle listener",i)}t(e,a)}))},Le.prototype.saveSVG=function(e,t){var n,a;t||(t=e,e={}),this._emit("saveSVG.start");try{var i=this.get("canvas"),r=i.getDefaultLayer(),o=Object(M.i)("defs",i._svg),c=Object(P.i)(r),s=o?"<defs>"+Object(P.i)(o)+"</defs>":"",l=r.getBBox();n='<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- created with bpmn-js / http://bpmn.io --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+l.width+'" height="'+l.height+'" viewBox="'+l.x+" "+l.y+" "+l.width+" "+l.height+'" version="1.1">'+s+c+"</svg>"}catch(u){a=u}this._emit("saveSVG.done",{error:a,svg:n}),t(a,n)},Le.prototype._setDefinitions=function(e){this._definitions=e},Le.prototype.getModules=function(){return this._modules},Le.prototype.clear=function(){this.getDefinitions()&&(this.get("elementRegistry").forEach((function(e){var t=e.businessObject;t&&t.di&&delete t.di})),T.a.prototype.clear.call(this))},Le.prototype.destroy=function(){T.a.prototype.destroy.call(this),Object(M.k)(this._container)},Le.prototype.on=function(e,t,n,a){return this.get("eventBus").on(e,t,n,a)},Le.prototype.off=function(e,t){this.get("eventBus").off(e,t)},Le.prototype.attachTo=function(e){if(!e)throw new Error("parentNode required");this.detach(),e.get&&e.constructor.prototype.jquery&&(e=e.get(0)),"string"===typeof e&&(e=Object(M.i)(e)),e.appendChild(this._container),this._emit("attach",{}),this.get("canvas").resized()},Le.prototype.getDefinitions=function(){return this._definitions},Le.prototype.detach=function(){var e=this._container,t=e.parentNode;t&&(this._emit("detach",{}),t.removeChild(e))},Le.prototype._init=function(e,t,n){var a=n.modules||this.getModules(),i=n.additionalModules||[],r=[].concat([{bpmnjs:["value",this],moddle:["value",t]}],a,i),o=Object(k.a)(Object(k.w)(n,["additionalModules"]),{canvas:Object(k.a)({},n.canvas,{container:e}),modules:r});T.a.call(this,o),n&&n.container&&this.attachTo(n.container)},Le.prototype._emit=function(e,t){return this.get("eventBus").fire(e,t)},Le.prototype._createContainer=function(e){var t=Object(M.f)('<div class="bjs-container"></div>');return Object(k.a)(t.style,{width:Ve(e.width),height:Ve(e.height),position:e.position}),t},Le.prototype._createModdle=function(e){var t=Object(k.a)({},this._moddleExtensions,e.moddleExtensions);return new Te(t)},Le.prototype._modules=[];var Ie={width:"100%",height:"100%",position:"relative"};function Ve(e){return e+(Object(k.p)(e)?"px":"")}function $e(e){Le.call(this,e),this.on("import.parse.complete",(function(e){e.error||this._collectIds(e.definitions,e.context)}),this),this.on("diagram.destroy",(function(){this.get("moddle").ids.clear()}),this)}S()($e,Le),$e.prototype._createModdle=function(e){var t=Le.prototype._createModdle.call(this,e);return t.ids=new _.a([32,36,1]),t},$e.prototype._collectIds=function(e,t){var n,a=e.$model.ids;for(n in a.clear(),t.elementsById)a.claim(n,t.elementsById[n])};var ze=n(123),We=n(57),Ge=n(35);function He(e,t){var n=Ue(e);return n&&"function"===typeof n.$instanceOf&&n.$instanceOf(t)}function Ue(e){return e&&e.businessObject||e}function Ke(e){return!He(e,"bpmn:CallActivity")&&(He(e,"bpmn:Loop")||He(e,"bpmn:Conditional")?!!Ue(e).di.isExpanded:!He(e,"bpmn:Participant")||!!Ue(e).processRef)}function qe(e){return e&&!!Ue(e).triggeredByEvent}function Je(e,t){var n=Ue(e),a=!1;return n.eventDefinitions&&Object(k.i)(n.eventDefinitions,(function(e){He(e,t)&&(a=!0)})),a}function Ye(e){return He(e,"bpmn:FlowElement")||He(e,"bpmn:Participant")||He(e,"bpmn:Lane")||He(e,"bpmn:SequenceFlow")||He(e,"bpmn:MessageFlow")||He(e,"bpmn:DataInput")||He(e,"bpmn:DataOutput")?"name":He(e,"bpmn:TextAnnotation")?"text":He(e,"bpmn:Group")?"categoryValueRef":void 0}function Xe(e){var t=e.businessObject,n=Ye(t);if(n)return"categoryValueRef"===n?function(e){var t=e.categoryValueRef;return t&&t.value||""}(t):t[n]||""}function Qe(e,t,n){return Object(k.A)(e.eventDefinitions,(function(a){return a.$type===t&&function(e,t){return Object(k.d)(t,(function(t,n){return e[n]===t}))}(e,n)}))}function Ze(e){return e.businessObject.di}function et(e){return e.businessObject}function tt(e,t){return Ze(e).get("bioc:fill")||t||"white"}function nt(e,t){return Ze(e).get("bioc:stroke")||t||"black"}var at=new _.a,it=.95;function rt(e,t,n,a,i,r,o){ze.a.call(this,t,o);var c=e&&e.defaultFillColor,s=e&&e.defaultStrokeColor,l=at.next(),u={},p=n.computeStyle;function d(e,t){var n=Object(k.a)({fill:"black",strokeWidth:1,strokeLinecap:"round",strokeDasharray:"none"},t.attrs),a=t.ref||{x:0,y:0},r=t.scale||1;"none"===n.strokeDasharray&&(n.strokeDasharray=[1e4,1]);var o=Object(P.f)("marker");Object(P.b)(t.element,n),Object(P.a)(o,t.element),Object(P.b)(o,{id:e,viewBox:"0 0 20 20",refX:a.x,refY:a.y,markerWidth:20*r,markerHeight:20*r,orient:"auto"});var c=Object(M.i)("defs",i._svg);c||(c=Object(P.f)("defs"),Object(P.a)(i._svg,c)),Object(P.a)(c,o),u[e]=o}function m(e){return e.replace(/[^0-9a-zA-z]+/g,"_")}function f(e,t,n){var a=e+"-"+m(t)+"-"+m(n)+"-"+l;return u[a]||function(e,t,n,a){if("sequenceflow-end"===t){var i=Object(P.f)("path");Object(P.b)(i,{d:"M 1 5 L 11 10 L 1 15 Z"}),d(e,{element:i,ref:{x:11,y:10},scale:.5,attrs:{fill:a,stroke:a}})}if("messageflow-start"===t){var r=Object(P.f)("circle");Object(P.b)(r,{cx:6,cy:6,r:3.5}),d(e,{element:r,attrs:{fill:n,stroke:a},ref:{x:6,y:6}})}if("messageflow-end"===t){var o=Object(P.f)("path");Object(P.b)(o,{d:"m 1 5 l 0 -3 l 7 3 l -7 3 z"}),d(e,{element:o,attrs:{fill:n,stroke:a,strokeLinecap:"butt"},ref:{x:8.5,y:5}})}if("association-start"===t){var c=Object(P.f)("path");Object(P.b)(c,{d:"M 11 5 L 1 10 L 11 15"}),d(e,{element:c,attrs:{fill:"none",stroke:a,strokeWidth:1.5},ref:{x:1,y:10},scale:.5})}if("association-end"===t){var s=Object(P.f)("path");Object(P.b)(s,{d:"M 1 5 L 11 10 L 1 15"}),d(e,{element:s,attrs:{fill:"none",stroke:a,strokeWidth:1.5},ref:{x:12,y:10},scale:.5})}if("conditional-flow-marker"===t){var l=Object(P.f)("path");Object(P.b)(l,{d:"M 0 10 L 8 6 L 16 10 L 8 14 Z"}),d(e,{element:l,attrs:{fill:n,stroke:a},ref:{x:-1,y:10},scale:.5})}if("conditional-default-flow-marker"===t){var u=Object(P.f)("path");Object(P.b)(u,{d:"M 6 4 L 10 16"}),d(e,{element:u,attrs:{stroke:a},ref:{x:0,y:10},scale:.5})}}(a,e,t,n),"url(#"+a+")"}function b(e,t,n,a,i){Object(k.q)(a)&&(i=a,a=0),a=a||0,"none"===(i=p(i,{stroke:"black",strokeWidth:2,fill:"white"})).fill&&delete i.fillOpacity;var r=t/2,o=n/2,c=Object(P.f)("circle");return Object(P.b)(c,{cx:r,cy:o,r:Math.round((t+n)/4-a)}),Object(P.b)(c,i),Object(P.a)(e,c),c}function h(e,t,n,a,i,r){Object(k.q)(i)&&(r=i,i=0),i=i||0,r=p(r,{stroke:"black",strokeWidth:2,fill:"white"});var o=Object(P.f)("rect");return Object(P.b)(o,{x:i,y:i,width:t-2*i,height:n-2*i,rx:a,ry:a}),Object(P.b)(o,r),Object(P.a)(e,o),o}function v(e,t,n){n=p(n,["no-fill"],{stroke:"black",strokeWidth:2,fill:"none"});var a=Object(We.b)(t,n);return Object(P.a)(e,a),a}function y(e,t,n){n=p(n,["no-fill"],{strokeWidth:2,stroke:"black"});var a=Object(P.f)("path");return Object(P.b)(a,{d:t}),Object(P.b)(a,n),Object(P.a)(e,a),a}function g(e,t,n,a){return y(t,n,Object(k.a)({"data-marker":e},a))}function j(e){return function(t,n){return S[e](t,n)}}function x(e){return S[e]}function O(e,t){var n=et(e),a=function(e){return"bpmn:IntermediateThrowEvent"===e.$type||"bpmn:EndEvent"===e.$type}(n);return n.eventDefinitions&&n.eventDefinitions.length>1?n.parallelMultiple?x("bpmn:ParallelMultipleEventDefinition")(t,e,a):x("bpmn:MultipleEventDefinition")(t,e,a):Qe(n,"bpmn:MessageEventDefinition")?x("bpmn:MessageEventDefinition")(t,e,a):Qe(n,"bpmn:TimerEventDefinition")?x("bpmn:TimerEventDefinition")(t,e,a):Qe(n,"bpmn:ConditionalEventDefinition")?x("bpmn:ConditionalEventDefinition")(t,e):Qe(n,"bpmn:SignalEventDefinition")?x("bpmn:SignalEventDefinition")(t,e,a):Qe(n,"bpmn:EscalationEventDefinition")?x("bpmn:EscalationEventDefinition")(t,e,a):Qe(n,"bpmn:LinkEventDefinition")?x("bpmn:LinkEventDefinition")(t,e,a):Qe(n,"bpmn:ErrorEventDefinition")?x("bpmn:ErrorEventDefinition")(t,e,a):Qe(n,"bpmn:CancelEventDefinition")?x("bpmn:CancelEventDefinition")(t,e,a):Qe(n,"bpmn:CompensateEventDefinition")?x("bpmn:CompensateEventDefinition")(t,e,a):Qe(n,"bpmn:TerminateEventDefinition")?x("bpmn:TerminateEventDefinition")(t,e,a):null}function w(e,t,n){n=Object(k.a)({size:{width:100}},n);var a=r.createText(t||"",n);return Object(P.c)(a).add("djs-label"),Object(P.a)(e,a),a}function E(e,t,n){return w(e,et(t).name,{box:t,align:n,padding:5,style:{fill:nt(t,s)}})}function N(e,t,n){var a=w(e,t,{box:{height:30,width:n.height},align:"center-middle",style:{fill:nt(n,s)}}),i=-1*n.height;Object(Ge.b)(a,0,-i,270)}function C(e){for(var t=e.waypoints,n="m  "+t[0].x+","+t[0].y,a=1;a<t.length;a++)n+="L"+t[a].x+","+t[a].y+" ";return n}var S=this.handlers={"bpmn:Event":function(e,t,n){return"fillOpacity"in n||(n.fillOpacity=it),b(e,t.width,t.height,n)},"bpmn:StartEvent":function(e,t){var n={fill:tt(t,c),stroke:nt(t,s)};et(t).isInterrupting||(n={strokeDasharray:"6",strokeLinecap:"round",fill:tt(t,c),stroke:nt(t,s)});var a=x("bpmn:Event")(e,t,n);return O(t,e),a},"bpmn:MessageEventDefinition":function(e,t,n){return y(e,a.getScaledPath("EVENT_MESSAGE",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:t.width,containerHeight:t.height,position:{mx:.235,my:.315}}),{strokeWidth:1,fill:n?nt(t,s):tt(t,c),stroke:n?tt(t,c):nt(t,s)})},"bpmn:TimerEventDefinition":function(e,t){var n=b(e,t.width,t.height,.2*t.height,{strokeWidth:2,fill:tt(t,c),stroke:nt(t,s)});y(e,a.getScaledPath("EVENT_TIMER_WH",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.5}}),{strokeWidth:2,strokeLinecap:"square",stroke:nt(t,s)});for(var i=0;i<12;i++){var r=a.getScaledPath("EVENT_TIMER_LINE",{xScaleFactor:.75,yScaleFactor:.75,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.5}}),o=t.width/2;y(e,r,{strokeWidth:1,strokeLinecap:"square",transform:"rotate("+30*i+","+t.height/2+","+o+")",stroke:nt(t,s)})}return n},"bpmn:EscalationEventDefinition":function(e,t,n){return y(e,a.getScaledPath("EVENT_ESCALATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:n?nt(t,s):"none",stroke:nt(t,s)})},"bpmn:ConditionalEventDefinition":function(e,t){return y(e,a.getScaledPath("EVENT_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.222}}),{strokeWidth:1,stroke:nt(t,s)})},"bpmn:LinkEventDefinition":function(e,t,n){return y(e,a.getScaledPath("EVENT_LINK",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.57,my:.263}}),{strokeWidth:1,fill:n?nt(t,s):"none",stroke:nt(t,s)})},"bpmn:ErrorEventDefinition":function(e,t,n){return y(e,a.getScaledPath("EVENT_ERROR",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:t.width,containerHeight:t.height,position:{mx:.2,my:.722}}),{strokeWidth:1,fill:n?nt(t,s):"none",stroke:nt(t,s)})},"bpmn:CancelEventDefinition":function(e,t,n){var i=y(e,a.getScaledPath("EVENT_CANCEL_45",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.638,my:-.055}}),{strokeWidth:1,fill:n?nt(t,s):"none",stroke:nt(t,s)});return Object(Ge.a)(i,45),i},"bpmn:CompensateEventDefinition":function(e,t,n){return y(e,a.getScaledPath("EVENT_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.22,my:.5}}),{strokeWidth:1,fill:n?nt(t,s):"none",stroke:nt(t,s)})},"bpmn:SignalEventDefinition":function(e,t,n){return y(e,a.getScaledPath("EVENT_SIGNAL",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:t.width,containerHeight:t.height,position:{mx:.5,my:.2}}),{strokeWidth:1,fill:n?nt(t,s):"none",stroke:nt(t,s)})},"bpmn:MultipleEventDefinition":function(e,t,n){return y(e,a.getScaledPath("EVENT_MULTIPLE",{xScaleFactor:1.1,yScaleFactor:1.1,containerWidth:t.width,containerHeight:t.height,position:{mx:.222,my:.36}}),{strokeWidth:1,fill:n?nt(t,s):"none"})},"bpmn:ParallelMultipleEventDefinition":function(e,t){return y(e,a.getScaledPath("EVENT_PARALLEL_MULTIPLE",{xScaleFactor:1.2,yScaleFactor:1.2,containerWidth:t.width,containerHeight:t.height,position:{mx:.458,my:.194}}),{strokeWidth:1,fill:nt(t,s),stroke:nt(t,s)})},"bpmn:EndEvent":function(e,t){var n=x("bpmn:Event")(e,t,{strokeWidth:4,fill:tt(t,c),stroke:nt(t,s)});return O(t,e),n},"bpmn:TerminateEventDefinition":function(e,t){return b(e,t.width,t.height,8,{strokeWidth:4,fill:nt(t,s),stroke:nt(t,s)})},"bpmn:IntermediateEvent":function(e,t){var n=x("bpmn:Event")(e,t,{strokeWidth:1,fill:tt(t,c),stroke:nt(t,s)});return b(e,t.width,t.height,3,{strokeWidth:1,fill:tt(t,"none"),stroke:nt(t,s)}),O(t,e),n},"bpmn:IntermediateCatchEvent":j("bpmn:IntermediateEvent"),"bpmn:IntermediateThrowEvent":j("bpmn:IntermediateEvent"),"bpmn:Activity":function(e,t,n){return"fillOpacity"in(n=n||{})||(n.fillOpacity=it),h(e,t.width,t.height,10,n)},"bpmn:Task":function(e,t){var n={fill:tt(t,c),stroke:nt(t,s)},a=x("bpmn:Activity")(e,t,n);return E(e,t,"center-middle"),_(e,t),a},"bpmn:Mapper":function(e,t){var n={fill:tt(t,c),stroke:nt(t,s)},a=x("bpmn:Activity")(e,t,n);return E(e,t,"center-middle"),_(e,t),a},"bpmn:Function":function(e,t){var n={fill:tt(t,c),stroke:"#00b0ff"},a=x("bpmn:Activity")(e,t,n);return E(e,t,"center-middle"),_(e,t),a},"bpmn:ServiceTask":function(e,t){var n=x("bpmn:Task")(e,t);return y(e,a.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:12,y:18}}),{strokeWidth:1,fill:tt(t,c),stroke:nt(t,s)}),y(e,a.getScaledPath("TASK_TYPE_SERVICE_FILL",{abspos:{x:17.2,y:18}}),{strokeWidth:0,fill:tt(t,c)}),y(e,a.getScaledPath("TASK_TYPE_SERVICE",{abspos:{x:17,y:22}}),{strokeWidth:1,fill:tt(t,c),stroke:nt(t,s)}),n},"bpmn:UserTask":function(e,t){var n=x("bpmn:Task")(e,t);return y(e,a.getScaledPath("TASK_TYPE_USER_1",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:tt(t,c),stroke:nt(t,s)}),y(e,a.getScaledPath("TASK_TYPE_USER_2",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:tt(t,c),stroke:nt(t,s)}),y(e,a.getScaledPath("TASK_TYPE_USER_3",{abspos:{x:15,y:12}}),{strokeWidth:.5,fill:nt(t,s),stroke:nt(t,s)}),n},"bpmn:ManualTask":function(e,t){var n=x("bpmn:Task")(e,t);return y(e,a.getScaledPath("TASK_TYPE_MANUAL",{abspos:{x:17,y:15}}),{strokeWidth:.5,fill:tt(t,c),stroke:nt(t,s)}),n},"bpmn:SendTask":function(e,t){var n=x("bpmn:Task")(e,t);return y(e,a.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:1,yScaleFactor:1,containerWidth:21,containerHeight:14,position:{mx:.285,my:.357}}),{strokeWidth:1,fill:nt(t,s),stroke:tt(t,c)}),n},"bpmn:ReceiveTask":function(e,t){var n,i=et(t),r=x("bpmn:Task")(e,t);return i.instantiate?(b(e,28,28,4.4,{strokeWidth:1}),n=a.getScaledPath("TASK_TYPE_INSTANTIATING_SEND",{abspos:{x:7.77,y:9.52}})):n=a.getScaledPath("TASK_TYPE_SEND",{xScaleFactor:.9,yScaleFactor:.9,containerWidth:21,containerHeight:14,position:{mx:.3,my:.4}}),y(e,n,{strokeWidth:1,fill:tt(t,c),stroke:nt(t,s)}),r},"bpmn:ScriptTask":function(e,t){var n=x("bpmn:Task")(e,t);return y(e,a.getScaledPath("TASK_TYPE_SCRIPT",{abspos:{x:15,y:20}}),{strokeWidth:1,stroke:nt(t,s)}),n},"bpmn:BusinessRuleTask":function(e,t){var n=x("bpmn:Task")(e,t),i=y(e,a.getScaledPath("TASK_TYPE_BUSINESS_RULE_HEADER",{abspos:{x:8,y:8}}));Object(P.b)(i,{strokeWidth:1,fill:tt(t,"#aaaaaa"),stroke:nt(t,s)});var r=y(e,a.getScaledPath("TASK_TYPE_BUSINESS_RULE_MAIN",{abspos:{x:8,y:8}}));return Object(P.b)(r,{strokeWidth:1,stroke:nt(t,s)}),n},"bpmn:Loop":function(e,t,n){n=Object(k.a)({fill:tt(t,c),stroke:nt(t,s)},n);var a=x("bpmn:Activity")(e,t,n);return qe(t)&&Object(P.b)(a,{strokeDasharray:"1,2"}),E(e,t,"center-top"),_(e,t,["LoopProcessMarker"]),a},"bpmn:Conditional":function(e,t,n){n=Object(k.a)({fill:tt(t,c),stroke:nt(t,s)},n);var a=x("bpmn:Activity")(e,t,n);return qe(t)&&Object(P.b)(a,{strokeDasharray:"1,2"}),E(e,t,"center-top"),_(e,t,["ConditionalMarker"]),a},"bpmn:AdHocSubProcess":function(e,t){return x("bpmn:Loop")(e,t)},"bpmn:Transaction":function(e,t){var a=x("bpmn:Loop")(e,t),i=n.style(["no-fill","no-events"],{stroke:nt(t,s)});return h(e,t.width,t.height,8,3,i),a},"bpmn:CallActivity":function(e,t){return x("bpmn:Loop")(e,t,{strokeWidth:5})},"bpmn:Participant":function(e,t){var n={fillOpacity:it,fill:tt(t,c),stroke:nt(t,s)},a=x("bpmn:Lane")(e,t,n);Ke(t)?(v(e,[{x:30,y:0},{x:30,y:t.height}],{stroke:nt(t,s)}),N(e,et(t).name,t)):w(e,et(t).name,{box:t,align:"center-middle",style:{fill:nt(t,s)}});return!!et(t).participantMultiplicity&&x("ParticipantMultiplicityMarker")(e,t),a},"bpmn:Lane":function(e,t,n){var a=h(e,t.width,t.height,0,Object(k.a)({fill:tt(t,c),fillOpacity:.35,stroke:nt(t,s)},n)),i=et(t);"bpmn:Lane"===i.$type&&N(e,i.name,t);return a},"bpmn:InclusiveGateway":function(e,t){var n=x("bpmn:Gateway")(e,t);return b(e,t.width,t.height,.24*t.height,{strokeWidth:2.5,fill:tt(t,c),stroke:nt(t,s)}),n},"bpmn:ExclusiveGateway":function(e,t){var n=x("bpmn:Gateway")(e,t),i=a.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:t.width,containerHeight:t.height,position:{mx:.32,my:.3}});return Ze(t).isMarkerVisible&&y(e,i,{strokeWidth:1,fill:nt(t,s),stroke:nt(t,s)}),n},"bpmn:Query":function(e,t){var n=x("bpmn:Gateway")(e,t),i=a.getScaledPath("GATEWAY_EXCLUSIVE",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:t.width,containerHeight:t.height,position:{mx:.32,my:.3}});return Ze(t).isMarkerVisible&&y(e,i,{strokeWidth:1,fill:nt(t,s),stroke:nt(t,s)}),n},"bpmn:ComplexGateway":function(e,t){var n=x("bpmn:Gateway")(e,t);return y(e,a.getScaledPath("GATEWAY_COMPLEX",{xScaleFactor:.5,yScaleFactor:.5,containerWidth:t.width,containerHeight:t.height,position:{mx:.46,my:.26}}),{strokeWidth:1,fill:nt(t,s),stroke:nt(t,s)}),n},"bpmn:ParallelGateway":function(e,t){var n=x("bpmn:Gateway")(e,t);return y(e,a.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.6,yScaleFactor:.6,containerWidth:t.width,containerHeight:t.height,position:{mx:.46,my:.2}}),{strokeWidth:1,fill:nt(t,s),stroke:nt(t,s)}),n},"bpmn:EventBasedGateway":function(e,t){var n=et(t),i=x("bpmn:Gateway")(e,t);b(e,t.width,t.height,.2*t.height,{strokeWidth:1,fill:"none",stroke:nt(t,s)});var r=n.eventGatewayType,o=!!n.instantiate;if("Parallel"===r){var c=a.getScaledPath("GATEWAY_PARALLEL",{xScaleFactor:.4,yScaleFactor:.4,containerWidth:t.width,containerHeight:t.height,position:{mx:.474,my:.296}}),l=y(e,c);Object(P.b)(l,{strokeWidth:1,fill:"none"})}else if("Exclusive"===r){if(!o){var u=b(e,t.width,t.height,.26*t.height);Object(P.b)(u,{strokeWidth:1,fill:"none",stroke:nt(t,s)})}!function(){var n=a.getScaledPath("GATEWAY_EVENT_BASED",{xScaleFactor:.18,yScaleFactor:.18,containerWidth:t.width,containerHeight:t.height,position:{mx:.36,my:.44}}),i={strokeWidth:2,fill:tt(t,"none"),stroke:nt(t,s)};y(e,n,i)}()}return i},"bpmn:Gateway":function(e,t){var n={fill:tt(t,c),fillOpacity:it,stroke:nt(t,s)};return function(e,t,n,a){var i=t/2,r=n/2,o=[{x:i,y:0},{x:t,y:r},{x:i,y:n},{x:0,y:r}].map((function(e){return e.x+","+e.y})).join(" ");a=p(a,{stroke:"black",strokeWidth:2,fill:"white"});var c=Object(P.f)("polygon");return Object(P.b)(c,{points:o}),Object(P.b)(c,a),Object(P.a)(e,c),c}(e,t.width,t.height,n)},"bpmn:SequenceFlow":function(e,t){var n,a=C(t),i=tt(t,c),r=nt(t,s),o=y(e,a,{strokeLinejoin:"round",markerEnd:f("sequenceflow-end",i,r),stroke:nt(t,s)}),l=et(t);return t.source&&(n=t.source.businessObject,l.conditionExpression&&n.$instanceOf("bpmn:Activity")&&Object(P.b)(o,{markerStart:f("conditional-flow-marker",i,r)}),n.default&&(n.$instanceOf("bpmn:Gateway")||n.$instanceOf("bpmn:Activity"))&&n.default===l&&Object(P.b)(o,{markerStart:f("conditional-default-flow-marker",i,r)})),o},"bpmn:Association":function(e,t,n){var a=et(t),i=tt(t,c),r=nt(t,s);return n=Object(k.a)({strokeDasharray:"0.5, 5",strokeLinecap:"round",strokeLinejoin:"round",stroke:nt(t,s)},n||{}),"One"!==a.associationDirection&&"Both"!==a.associationDirection||(n.markerEnd=f("association-end",i,r)),"Both"===a.associationDirection&&(n.markerStart=f("association-start",i,r)),v(e,t.waypoints,n)},"bpmn:DataInputAssociation":function(e,t){var n=tt(t,c),a=nt(t,s);return x("bpmn:Association")(e,t,{markerEnd:f("association-end",n,a)})},"bpmn:DataOutputAssociation":function(e,t){var n=tt(t,c),a=nt(t,s);return x("bpmn:Association")(e,t,{markerEnd:f("association-end",n,a)})},"bpmn:MessageFlow":function(e,t){var n=et(t),i=Ze(t),r=tt(t,c),o=nt(t,s),l=y(e,C(t),{markerEnd:f("messageflow-end",r,o),markerStart:f("messageflow-start",r,o),strokeDasharray:"10, 12",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5px",stroke:nt(t,s)});if(n.messageRef){var u=l.getPointAtLength(l.getTotalLength()/2),p=a.getScaledPath("MESSAGE_FLOW_MARKER",{abspos:{x:u.x,y:u.y}}),d={strokeWidth:1};"initiating"===i.messageVisibleKind?(d.fill="white",d.stroke="black"):(d.fill="#888",d.stroke="white"),y(e,p,d)}return l},"bpmn:DataObject":function(e,t){var n=y(e,a.getScaledPath("DATA_OBJECT_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.474,my:.296}}),{fill:tt(t,c),fillOpacity:it,stroke:nt(t,s)});return function(e){var t=e.dataObjectRef;return e.isCollection||t&&t.isCollection}(et(t))&&function(e,t){var n=(t.height-16)/t.height,i=a.getScaledPath("DATA_OBJECT_COLLECTION_PATH",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:.451,my:n}});y(e,i,{strokeWidth:2})}(e,t),n},"bpmn:DataObjectReference":j("bpmn:DataObject"),"bpmn:DataInput":function(e,t){var n=a.getRawPath("DATA_ARROW"),i=x("bpmn:DataObject")(e,t);return y(e,n,{strokeWidth:1}),i},"bpmn:DataOutput":function(e,t){var n=a.getRawPath("DATA_ARROW"),i=x("bpmn:DataObject")(e,t);return y(e,n,{strokeWidth:1,fill:"black"}),i},"bpmn:DataStoreReference":function(e,t){return y(e,a.getScaledPath("DATA_STORE",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:.133}}),{strokeWidth:2,fill:tt(t,c),fillOpacity:it,stroke:nt(t,s)})},"bpmn:BoundaryEvent":function(e,t){var n=et(t).cancelActivity,a={strokeWidth:1,fill:tt(t,c),stroke:nt(t,s)};n||(a.strokeDasharray="6",a.strokeLinecap="round");var i=Object(k.a)({},a,{fillOpacity:1}),r=Object(k.a)({},a,{fill:"none"}),o=x("bpmn:Event")(e,t,i);return b(e,t.width,t.height,3,r),O(t,e),o},"bpmn:Group":function(e,t){return h(e,t.width,t.height,10,{stroke:nt(t,s),strokeWidth:1,strokeDasharray:"8,3,1,3",fill:"none",pointerEvents:"none"})},label:function(e,t){return function(e,t){var n={width:90,height:30,x:t.width/2+t.x,y:t.height/2+t.y};return w(e,Xe(t),{box:n,fitBox:!0,style:Object(k.a)({},r.getExternalStyle(),{fill:nt(t,s)})})}(e,t)},"bpmn:TextAnnotation":function(e,t){var n=h(e,t.width,t.height,0,0,{fill:"none",stroke:"none"});return y(e,a.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:0,my:0}}),{stroke:nt(t,s)}),w(e,et(t).text||"",{box:t,align:"left-top",padding:5,style:{fill:nt(t,s)}}),n},ParticipantMultiplicityMarker:function(e,t){g("participant-multiplicity",e,a.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:t.width/2/t.width,my:(t.height-15)/t.height}}),{strokeWidth:1,fill:tt(t,c),stroke:nt(t,s)})},SubProcessMarker:function(e,t){var n=h(e,14,14,0,{strokeWidth:1,fill:tt(t,c),stroke:nt(t,s)});Object(Ge.c)(n,t.width/2-7.5,t.height-20),g("sub-process",e,a.getScaledPath("MARKER_SUB_PROCESS",{xScaleFactor:1.5,yScaleFactor:1.5,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2-7.5)/t.width,my:(t.height-20)/t.height}}),{fill:tt(t,c),stroke:nt(t,s)})},ConditionalMarker:function(e,t){var n=h(e,20,20,0,{strokeWidth:1,fill:tt(t,c),stroke:nt(t,s)});Object(Ge.c)(n,t.width/2-7.5,t.height-25),g("sub-process",e,a.getScaledPath("MARKER_CONDITIONAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2-4.5)/t.width,my:(t.height-22)/t.height}}),{fill:tt(t,c),stroke:nt(t,s)})},LoopProcessMarker:function(e,t,n){var i=h(e,20,20,0,{strokeWidth:1,fill:tt(t,c),stroke:nt(t,s)});Object(Ge.c)(i,t.width/2-7.5,t.height-25),g("loop",e,a.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.loop+2)/t.width,my:(t.height-9)/t.height}}),{strokeWidth:1.5,fill:tt(t,c),stroke:nt(t,s),strokeLinecap:"round",strokeMiterlimit:.5})},ParallelMarker:function(e,t,n){g("parallel",e,a.getScaledPath("MARKER_PARALLEL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.parallel)/t.width,my:(t.height-20)/t.height}}),{fill:tt(t,c),stroke:nt(t,s)})},SequentialMarker:function(e,t,n){g("sequential",e,a.getScaledPath("MARKER_SEQUENTIAL",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.seq)/t.width,my:(t.height-19)/t.height}}),{fill:tt(t,c),stroke:nt(t,s)})},CompensationMarker:function(e,t,n){g("compensation",e,a.getScaledPath("MARKER_COMPENSATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.compensation)/t.width,my:(t.height-13)/t.height}}),{strokeWidth:1,fill:tt(t,c),stroke:nt(t,s)})},LoopMarker:function(e,t,n){g("loop",e,a.getScaledPath("MARKER_LOOP",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.loop)/t.width,my:(t.height-7)/t.height}}),{strokeWidth:1,fill:tt(t,c),stroke:nt(t,s),strokeLinecap:"round",strokeMiterlimit:.5})},AdhocMarker:function(e,t,n){g("adhoc",e,a.getScaledPath("MARKER_ADHOC",{xScaleFactor:1,yScaleFactor:1,containerWidth:t.width,containerHeight:t.height,position:{mx:(t.width/2+n.adhoc)/t.width,my:(t.height-15)/t.height}}),{strokeWidth:1,fill:nt(t,s),stroke:nt(t,s)})}};function _(e,t,n){var a,i=et(t),r=n&&-1!==n.indexOf("SubProcessMarker");a=r?{seq:-21,parallel:-22,compensation:-42,loop:-18,adhoc:10}:{seq:-3,parallel:-6,compensation:-27,loop:0,adhoc:10},Object(k.i)(n,(function(n){x(n)(e,t,a)})),i.isForCompensation&&x("CompensationMarker")(e,t,a),"bpmn:AdHocSubProcess"===i.$type&&x("AdhocMarker")(e,t,a);var o=i.loopCharacteristics,c=o&&o.isSequential;o&&(void 0===c&&x("LoopMarker")(e,t,a),!1===c&&x("ParallelMarker")(e,t,a),!0===c&&x("SequentialMarker")(e,t,a))}this._drawPath=y}S()(rt,ze.a),rt.$inject=["config.bpmnRenderer","eventBus","styles","pathMap","canvas","textRenderer"],rt.prototype.canRender=function(e){return He(e,"bpmn:BaseElement")},rt.prototype.drawShape=function(e,t){var n=t.type;return(0,this.handlers[n])(e,t)},rt.prototype.drawConnection=function(e,t){var n=t.type;return(0,this.handlers[n])(e,t)},rt.prototype.getShapePath=function(e){return He(e,"bpmn:Event")?function(e){var t=e.x+e.width/2,n=e.y+e.height/2,a=e.width/2,i=[["M",t,n],["m",0,-a],["a",a,a,0,1,1,0,2*a],["a",a,a,0,1,1,0,-2*a],["z"]];return Object(We.a)(i)}(e):He(e,"bpmn:Activity")?function(e,t){var n=e.x,a=e.y,i=e.width,r=e.height,o=[["M",n+t,a],["l",i-2*t,0],["a",t,t,0,0,1,t,t],["l",0,r-2*t],["a",t,t,0,0,1,-t,t],["l",2*t-i,0],["a",t,t,0,0,1,-t,-t],["l",0,2*t-r],["a",t,t,0,0,1,t,-t],["z"]];return Object(We.a)(o)}(e,10):He(e,"bpmn:Gateway")?function(e){var t=e.width/2,n=e.height/2,a=[["M",e.x+t,e.y],["l",t,n],["l",-t,n],["l",-t,-n],["z"]];return Object(We.a)(a)}(e):function(e){var t=e.x,n=e.y,a=e.width,i=[["M",t,n],["l",a,0],["l",0,e.height],["l",-a,0],["z"]];return Object(We.a)(i)}(e)};var ot=n(204);function ct(e){var t=Object(k.a)({fontFamily:"Arial, sans-serif",fontSize:12,fontWeight:"normal",lineHeight:1.2},e&&e.defaultStyle||{}),n=parseInt(t.fontSize,10)-1,a=Object(k.a)({},t,{fontSize:n},e&&e.externalStyle||{}),i=new ot.a({style:t});this.getExternalLabelBounds=function(e,t){var n=i.getDimensions(t,{box:{width:90,height:30,x:e.width/2+e.x,y:e.height/2+e.y},style:a});return{x:Math.round(e.x+e.width/2-n.width/2),y:Math.round(e.y),width:Math.ceil(n.width),height:Math.ceil(n.height)}},this.getTextAnnotationBounds=function(e,n){var a=i.getDimensions(n,{box:e,style:t,align:"left-top",padding:5});return{x:e.x,y:e.y,width:e.width,height:Math.max(30,Math.round(a.height))}},this.createText=function(e,t){return i.createText(e,t||{})},this.getDefaultStyle=function(){return t},this.getExternalStyle=function(){return a}}ct.$inject=["config.textRenderer"];var st=/\{([^}]+)\}/g,lt=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;var ut={__init__:["bpmnRenderer"],bpmnRenderer:["type",rt],textRenderer:["type",ct],pathMap:["type",function(){this.pathMap={EVENT_MESSAGE:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:36,width:36,heightElements:[6,14],widthElements:[10.5,21]},EVENT_SIGNAL:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x1},0 Z",height:36,width:36,heightElements:[18],widthElements:[10,20]},EVENT_ESCALATION:{d:"M {mx},{my} l {e.x0},{e.y0} l -{e.x0},-{e.y1} l -{e.x0},{e.y1} Z",height:36,width:36,heightElements:[20,7],widthElements:[8]},EVENT_CONDITIONAL:{d:"M {e.x0},{e.y0} l {e.x1},0 l 0,{e.y2} l -{e.x1},0 Z M {e.x2},{e.y3} l {e.x0},0 M {e.x2},{e.y4} l {e.x0},0 M {e.x2},{e.y5} l {e.x0},0 M {e.x2},{e.y6} l {e.x0},0 M {e.x2},{e.y7} l {e.x0},0 M {e.x2},{e.y8} l {e.x0},0 ",height:36,width:36,heightElements:[8.5,14.5,18,11.5,14.5,17.5,20.5,23.5,26.5],widthElements:[10.5,14.5,12.5]},EVENT_LINK:{d:"m {mx},{my} 0,{e.y0} -{e.x1},0 0,{e.y1} {e.x1},0 0,{e.y0} {e.x0},-{e.y2} -{e.x0},-{e.y2} z",height:36,width:36,heightElements:[4.4375,6.75,7.8125],widthElements:[9.84375,13.5]},EVENT_ERROR:{d:"m {mx},{my} {e.x0},-{e.y0} {e.x1},-{e.y1} {e.x2},{e.y2} {e.x3},-{e.y3} -{e.x4},{e.y4} -{e.x5},-{e.y5} z",height:36,width:36,heightElements:[.023,8.737,8.151,16.564,10.591,8.714],widthElements:[.085,6.672,6.97,4.273,5.337,6.636]},EVENT_CANCEL_45:{d:"m {mx},{my} -{e.x1},0 0,{e.x0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:36,width:36,heightElements:[4.75,8.5],widthElements:[4.75,8.5]},EVENT_COMPENSATION:{d:"m {mx},{my} {e.x0},-{e.y0} 0,{e.y1} z m {e.x1},-{e.y2} {e.x2},-{e.y3} 0,{e.y1} -{e.x2},-{e.y3} z",height:36,width:36,heightElements:[6.5,13,.4,6.1],widthElements:[9,9.3,8.7]},EVENT_TIMER_WH:{d:"M {mx},{my} l {e.x0},-{e.y0} m -{e.x0},{e.y0} l {e.x1},{e.y1} ",height:36,width:36,heightElements:[10,2],widthElements:[3,7]},EVENT_TIMER_LINE:{d:"M {mx},{my}  m {e.x0},{e.y0} l -{e.x1},{e.y1} ",height:36,width:36,heightElements:[10,3],widthElements:[0,0]},EVENT_MULTIPLE:{d:"m {mx},{my} {e.x1},-{e.y0} {e.x1},{e.y0} -{e.x0},{e.y1} -{e.x2},0 z",height:36,width:36,heightElements:[6.28099,12.56199],widthElements:[3.1405,9.42149,12.56198]},EVENT_PARALLEL_MULTIPLE:{d:"m {mx},{my} {e.x0},0 0,{e.y1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} -{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z",height:36,width:36,heightElements:[2.56228,7.68683],widthElements:[2.56228,7.68683]},GATEWAY_EXCLUSIVE:{d:"m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} {e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} {e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z",height:17.5,width:17.5,heightElements:[8.5,6.5312,-6.5312,-8.5],widthElements:[6.5,-6.5,3,-3,5,-5]},GATEWAY_PARALLEL:{d:"m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z",height:30,width:30,heightElements:[5,12.5],widthElements:[5,12.5]},GATEWAY_EVENT_BASED:{d:"m {mx},{my} {e.x0},{e.y0} {e.x0},{e.y1} {e.x1},{e.y2} {e.x2},0 z",height:11,width:11,heightElements:[-6,6,12,-12],widthElements:[9,-3,-12]},GATEWAY_COMPLEX:{d:"m {mx},{my} 0,{e.y0} -{e.x0},-{e.y1} -{e.x1},{e.y2} {e.x0},{e.y1} -{e.x2},0 0,{e.y3} {e.x2},0  -{e.x0},{e.y1} l {e.x1},{e.y2} {e.x0},-{e.y1} 0,{e.y0} {e.x3},0 0,-{e.y0} {e.x0},{e.y1} {e.x1},-{e.y2} -{e.x0},-{e.y1} {e.x2},0 0,-{e.y3} -{e.x2},0 {e.x0},-{e.y1} -{e.x1},-{e.y2} -{e.x0},{e.y1} 0,-{e.y0} -{e.x3},0 z",height:17.125,width:17.125,heightElements:[4.875,3.4375,2.125,3],widthElements:[3.4375,2.125,4.875,3]},DATA_OBJECT_PATH:{d:"m 0,0 {e.x1},0 {e.x0},{e.y0} 0,{e.y1} -{e.x2},0 0,-{e.y2} {e.x1},0 0,{e.y0} {e.x0},0",height:61,width:51,heightElements:[10,50,60],widthElements:[10,40,50,60]},DATA_OBJECT_COLLECTION_PATH:{d:"m {mx}, {my} m  0 15  l 0 -15 m  4 15  l 0 -15 m  4 15  l 0 -15 ",height:61,width:51,heightElements:[12],widthElements:[1,6,12,15]},DATA_ARROW:{d:"m 5,9 9,0 0,-3 5,5 -5,5 0,-3 -9,0 z",height:61,width:51,heightElements:[],widthElements:[]},DATA_STORE:{d:"m  {mx},{my} l  0,{e.y2} c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 l  0,-{e.y2} c -{e.x0},-{e.y1} -{e.x1},-{e.y1} -{e.x2},0c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0 m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1} {e.x2},0m  -{e.x2},{e.y0}c  {e.x0},{e.y1} {e.x1},{e.y1}  {e.x2},0",height:61,width:61,heightElements:[7,10,45],widthElements:[2,58,60]},TEXT_ANNOTATION:{d:"m {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0",height:30,width:10,heightElements:[30],widthElements:[10]},MARKER_SUB_PROCESS:{d:"m{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_CONDITIONAL:{d:"m{mx},{my} m 2,4 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_PARALLEL:{d:"m{mx},{my} m 3,2 l 0,10 m 3,-10 l 0,10 m 3,-10 l 0,10",height:10,width:10,heightElements:[],widthElements:[]},MARKER_SEQUENTIAL:{d:"m{mx},{my} m 0,3 l 10,0 m -10,3 l 10,0 m -10,3 l 10,0",height:10,width:10,heightElements:[],widthElements:[]},MARKER_COMPENSATION:{d:"m {mx},{my} 7,-5 0,10 z m 7.1,-0.3 6.9,-4.7 0,10 -6.9,-4.7 z",height:10,width:21,heightElements:[],widthElements:[]},MARKER_LOOP:{d:"m {mx},{my} c 3.526979,0 6.386161,-2.829858 6.386161,-6.320661 0,-3.490806 -2.859182,-6.320661 -6.386161,-6.320661 -3.526978,0 -6.38616,2.829855 -6.38616,6.320661 0,1.745402 0.714797,3.325567 1.870463,4.469381 0.577834,0.571908 1.265885,1.034728 2.029916,1.35457 l -0.718163,-3.909793 m 0.718163,3.909793 -3.885211,0.802902",height:13.9,width:13.7,heightElements:[],widthElements:[]},MARKER_ADHOC:{d:"m {mx},{my} m 0.84461,2.64411 c 1.05533,-1.23780996 2.64337,-2.07882 4.29653,-1.97997996 2.05163,0.0805 3.85579,1.15803 5.76082,1.79107 1.06385,0.34139996 2.24454,0.1438 3.18759,-0.43767 0.61743,-0.33642 1.2775,-0.64078 1.7542,-1.17511 0,0.56023 0,1.12046 0,1.6807 -0.98706,0.96237996 -2.29792,1.62393996 -3.6918,1.66181996 -1.24459,0.0927 -2.46671,-0.2491 -3.59505,-0.74812 -1.35789,-0.55965 -2.75133,-1.33436996 -4.27027,-1.18121996 -1.37741,0.14601 -2.41842,1.13685996 -3.44288,1.96782996 z",height:4,width:15,heightElements:[],widthElements:[]},TASK_TYPE_SEND:{d:"m {mx},{my} l 0,{e.y1} l {e.x1},0 l 0,-{e.y1} z l {e.x0},{e.y0} l {e.x0},-{e.y0}",height:14,width:21,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_SCRIPT:{d:"m {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z m -7,-12 l 5,0 m -4.5,3 l 4.5,0 m -3,3 l 5,0m -4,3 l 5,0",height:15,width:12.6,heightElements:[6,14],widthElements:[10.5,21]},TASK_TYPE_USER_1:{d:"m {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 -4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 zm -8,6 l 0,5.5 m 11,0 l 0,-5"},TASK_TYPE_USER_2:{d:"m {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 -2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 "},TASK_TYPE_USER_3:{d:"m {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 -4.20799998,3.36699999 -4.20699998,4.34799999 z"},TASK_TYPE_MANUAL:{d:"m {mx},{my} c 0.234,-0.01 5.604,0.008 8.029,0.004 0.808,0 1.271,-0.172 1.417,-0.752 0.227,-0.898 -0.334,-1.314 -1.338,-1.316 -2.467,-0.01 -7.886,-0.004 -8.108,-0.004 -0.014,-0.079 0.016,-0.533 0,-0.61 0.195,-0.042 8.507,0.006 9.616,0.002 0.877,-0.007 1.35,-0.438 1.353,-1.208 0.003,-0.768 -0.479,-1.09 -1.35,-1.091 -2.968,-0.002 -9.619,-0.013 -9.619,-0.013 v -0.591 c 0,0 5.052,-0.016 7.225,-0.016 0.888,-0.002 1.354,-0.416 1.351,-1.193 -0.006,-0.761 -0.492,-1.196 -1.361,-1.196 -3.473,-0.005 -10.86,-0.003 -11.0829995,-0.003 -0.022,-0.047 -0.045,-0.094 -0.069,-0.139 0.3939995,-0.319 2.0409995,-1.626 2.4149995,-2.017 0.469,-0.4870005 0.519,-1.1650005 0.162,-1.6040005 -0.414,-0.511 -0.973,-0.5 -1.48,-0.236 -1.4609995,0.764 -6.5999995,3.6430005 -7.7329995,4.2710005 -0.9,0.499 -1.516,1.253 -1.882,2.19 -0.37000002,0.95 -0.17,2.01 -0.166,2.979 0.004,0.718 -0.27300002,1.345 -0.055,2.063 0.629,2.087 2.425,3.312 4.859,3.318 4.6179995,0.014 9.2379995,-0.139 13.8569995,-0.158 0.755,-0.004 1.171,-0.301 1.182,-1.033 0.012,-0.754 -0.423,-0.969 -1.183,-0.973 -1.778,-0.01 -5.824,-0.004 -6.04,-0.004 10e-4,-0.084 0.003,-0.586 10e-4,-0.67 z"},TASK_TYPE_INSTANTIATING_SEND:{d:"m {mx},{my} l 0,8.4 l 12.6,0 l 0,-8.4 z l 6.3,3.6 l 6.3,-3.6"},TASK_TYPE_SERVICE:{d:"m {mx},{my} v -1.71335 c 0.352326,-0.0705 0.703932,-0.17838 1.047628,-0.32133 0.344416,-0.14465 0.665822,-0.32133 0.966377,-0.52145 l 1.19431,1.18005 1.567487,-1.57688 -1.195028,-1.18014 c 0.403376,-0.61394 0.683079,-1.29908 0.825447,-2.01824 l 1.622133,-0.01 v -2.2196 l -1.636514,0.01 c -0.07333,-0.35153 -0.178319,-0.70024 -0.323564,-1.04372 -0.145244,-0.34406 -0.321407,-0.6644 -0.522735,-0.96217 l 1.131035,-1.13631 -1.583305,-1.56293 -1.129598,1.13589 c -0.614052,-0.40108 -1.302883,-0.68093 -2.022633,-0.82247 l 0.0093,-1.61852 h -2.241173 l 0.0042,1.63124 c -0.353763,0.0736 -0.705369,0.17977 -1.049785,0.32371 -0.344415,0.14437 -0.665102,0.32092 -0.9635006,0.52046 l -1.1698628,-1.15823 -1.5667691,1.5792 1.1684265,1.15669 c -0.4026573,0.61283 -0.68308,1.29797 -0.8247287,2.01713 l -1.6588041,0.003 v 2.22174 l 1.6724648,-0.006 c 0.073327,0.35077 0.1797598,0.70243 0.3242851,1.04472 0.1452428,0.34448 0.3214064,0.6644 0.5227339,0.96066 l -1.1993431,1.19723 1.5840256,1.56011 1.1964668,-1.19348 c 0.6140517,0.40346 1.3028827,0.68232 2.0233517,0.82331 l 7.19e-4,1.69892 h 2.226848 z m 0.221462,-3.9957 c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_SERVICE_FILL:{d:"m {mx},{my} c -1.788948,0.7502 -3.8576,-0.0928 -4.6097055,-1.87438 -0.7521065,-1.78321 0.090598,-3.84627 1.8802645,-4.59604 1.78823,-0.74936 3.856881,0.0929 4.608987,1.87437 0.752106,1.78165 -0.0906,3.84612 -1.879546,4.59605 z"},TASK_TYPE_BUSINESS_RULE_HEADER:{d:"m {mx},{my} 0,4 20,0 0,-4 z"},TASK_TYPE_BUSINESS_RULE_MAIN:{d:"m {mx},{my} 0,12 20,0 0,-12 z m 0,8 l 20,0 m -13,-4 l 0,8"},MESSAGE_FLOW_MARKER:{d:"m {mx},{my} m -10.5 ,-7 l 0,14 l 21,0 l 0,-14 z l 10.5,6 l 10.5,-6"}},this.getRawPath=function(e){return this.pathMap[e].d},this.getScaledPath=function(e,t){var n,a,i=this.pathMap[e];t.abspos?(n=t.abspos.x,a=t.abspos.y):(n=t.containerWidth*t.position.mx,a=t.containerHeight*t.position.my);var r,o,c={};if(t.position){for(var s=t.containerHeight/i.height*t.yScaleFactor,l=t.containerWidth/i.width*t.xScaleFactor,u=0;u<i.heightElements.length;u++)c["y"+u]=i.heightElements[u]*s;for(var p=0;p<i.widthElements.length;p++)c["x"+p]=i.widthElements[p]*l}return r=i.d,o={mx:n,my:a,e:c},String(r).replace(st,(function(e,t){return function(e,t,n){var a=n;return t.replace(lt,(function(e,t,n,i,r){t=t||i,a&&(t in a&&(a=a[t]),"function"==typeof a&&r&&(a=a()))})),a=(null==a||a===n?e:a)+""}(e,t,o)}))}}]},pt=n(97),dt={width:90,height:20};function mt(e){return He(e,"bpmn:Event")||He(e,"bpmn:Gateway")||He(e,"bpmn:DataStoreReference")||He(e,"bpmn:DataObjectReference")||He(e,"bpmn:DataInput")||He(e,"bpmn:DataOutput")||He(e,"bpmn:SequenceFlow")||He(e,"bpmn:MessageFlow")||He(e,"bpmn:Group")}function ft(e){return vt(e.label)}function bt(e){var t=e.length/2-1,n=e[Math.floor(t)],a=e[Math.ceil(t+.01)],i=function(e){var t=e.length/2-1,n=e[Math.floor(t)],a=e[Math.ceil(t+.01)];return{x:n.x+(a.x-n.x)/2,y:n.y+(a.y-n.y)/2}}(e),r=Math.atan((a.y-n.y)/(a.x-n.x)),o=i.x,c=i.y;return Math.abs(r)<Math.PI/2?c-=15:o+=15,{x:o,y:c}}function ht(e){return e.waypoints?bt(e.waypoints):He(e,"bpmn:Group")?{x:e.x+e.width/2,y:e.y+dt.height/2}:{x:e.x+e.width/2,y:e.y+e.height+dt.height/2}}function vt(e){return e&&!!e.labelTarget}var yt=n(11);function gt(e,t){return Object(k.a)({id:e.id,type:e.$type,businessObject:e},t)}function jt(e,t,n){var a=e.di.waypoint;return!a||a.length<2?[Object(yt.e)(t),Object(yt.e)(n)]:a.map((function(e){return{x:e.x,y:e.y}}))}function xt(e,t,n,a){return new Error(e("element {element} referenced by {referenced}#{property} not yet drawn",{element:Ae(n),referenced:Ae(t),property:a}))}function Ot(e,t,n,a,i,r){this._eventBus=e,this._canvas=t,this._elementFactory=n,this._elementRegistry=a,this._translate=i,this._textRenderer=r}Ot.$inject=["eventBus","canvas","elementFactory","elementRegistry","translate","textRenderer"],Ot.prototype.add=function(e,t){var n,a,i,r=e.di,o=this._translate;if(He(r,"bpmndi:BPMNPlane"))n=this._elementFactory.createRoot(gt(e)),this._canvas.setRootElement(n);else if(He(r,"bpmndi:BPMNShape")){var c=!Ke(e),s=function(e){return He(e,"bpmn:Group")}(e);a=t&&(t.hidden||t.collapsed);var l=e.di.bounds;n=this._elementFactory.createShape(gt(e,{collapsed:c,hidden:a,x:Math.round(l.x),y:Math.round(l.y),width:Math.round(l.width),height:Math.round(l.height),isFrame:s})),He(e,"bpmn:BoundaryEvent")&&this._attachBoundary(e,n),He(e,"bpmn:Lane")&&(i=0),He(e,"bpmn:DataStoreReference")&&(function(e,t){var n=t.x,a=t.y;return n>=e.x&&n<=e.x+e.width&&a>=e.y&&a<=e.y+e.height}(t,Object(yt.e)(l))||(t=this._canvas.getRootElement())),this._canvas.addShape(n,t,i)}else{if(!He(r,"bpmndi:BPMNEdge"))throw new Error(o("unknown di {di} for element {semantic}",{di:Ae(r),semantic:Ae(e)}));var u=this._getSource(e),p=this._getTarget(e);a=t&&(t.hidden||t.collapsed),n=this._elementFactory.createConnection(gt(e,{hidden:a,source:u,target:p,waypoints:jt(e,u,p)})),He(e,"bpmn:DataAssociation")&&(t=null),He(e,"bpmn:SequenceFlow")&&(i=0),this._canvas.addConnection(n,t,i)}return mt(e)&&Xe(n)&&this.addLabel(e,n),this._eventBus.fire("bpmnElement.added",{element:n}),n},Ot.prototype._attachBoundary=function(e,t){var n=this._translate,a=e.attachedToRef;if(!a)throw new Error(n("missing {semantic}#attachedToRef",{semantic:Ae(e)}));var i=this._elementRegistry.get(a.id),r=i&&i.attachers;if(!i)throw xt(n,e,a,"attachedToRef");t.host=i,r||(i.attachers=r=[]),-1===r.indexOf(t)&&r.push(t)},Ot.prototype.addLabel=function(e,t){var n,a,i;return n=function(e,t){var n,a,i,r=e.di.label;return r&&r.bounds?(i=r.bounds,a={width:Math.max(dt.width,i.width),height:i.height},n={x:i.x+i.width/2,y:i.y+i.height/2}):(n=ht(t),a=dt),Object(k.a)({x:n.x-a.width/2,y:n.y-a.height/2},a)}(e,t),(a=Xe(t))&&(n=this._textRenderer.getExternalLabelBounds(n,a)),i=this._elementFactory.createLabel(gt(e,{id:e.id+"_label",labelTarget:t,type:"label",hidden:t.hidden||!Xe(t),x:Math.round(n.x),y:Math.round(n.y),width:Math.round(n.width),height:Math.round(n.height)})),this._canvas.addShape(i,t.parent)},Ot.prototype._getEnd=function(e,t){var n,a,i=e.$type,r=this._translate;if(a=e[t+"Ref"],"source"===t&&"bpmn:DataInputAssociation"===i&&(a=a&&a[0]),("source"===t&&"bpmn:DataOutputAssociation"===i||"target"===t&&"bpmn:DataInputAssociation"===i)&&(a=e.$parent),n=a&&this._getElement(a))return n;throw a?xt(r,e,a,t+"Ref"):new Error(r("{semantic}#{side} Ref not specified",{semantic:Ae(e),side:t}))},Ot.prototype._getSource=function(e){return this._getEnd(e,"source")},Ot.prototype._getTarget=function(e){return this._getEnd(e,"target")},Ot.prototype._getElement=function(e){return this._elementRegistry.get(e.id)};var wt={__depends__:[ut,{__depends__:[pt.a],bpmnImporter:["type",Ot]}]},Et=n(43),Nt=n(121);function Ct(e){Le.call(this,e)}S()(Ct,Le),Ct.prototype._modules=[wt,pt.a,Et.a,Nt.a],Ct.prototype._moddleExtensions={};var St=n(173),_t=n(174),kt=n(169);function Mt(e){Ct.call(this,e)}S()(Mt,Ct),Mt.prototype._navigationModules=[St.a,_t.a,kt.a],Mt.prototype._modules=[].concat(Ct.prototype._modules,Mt.prototype._navigationModules);var Pt=n(221),Tt=n(225);function Rt(e,t){return Object(k.A)(t,(function(t){return He(e,t)}))}function At(e,t){for("string"===typeof t&&(t=[t]);e=e.parent;)if(Rt(e,t))return e;return null}function Ft(e,t){return He(t,"bpmn:TextAnnotation")?function(e,t){var n=Object(yt.b)(e),a={x:n.right+t.width/2,y:n.top-50-t.height/2};return Dt(e,t,a,{y:{margin:-30,rowSize:20}})}(e,t):Rt(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])?function(e,t){var n=Object(yt.b)(e),a={x:n.right-10+t.width/2,y:n.bottom+40+t.width/2};return Dt(e,t,a,{x:{margin:30,rowSize:30}})}(e,t):He(t,"bpmn:FlowNode")?function(e,t){var n=Object(yt.b)(e),a=Object(yt.e)(e),i=function(e,t){var n=Object(yt.b)(e);function a(e){return He(e,"bpmn:SequenceFlow")}function i(e){return function(t){return{shape:t,weight:e,distanceTo:function(e){return Object(yt.b)(e).left-n.right}}}}function r(e){return function(t){return{shape:t,weight:e,distanceTo:function(e){var t=Object(yt.b)(e);return n.left-t.right}}}}var o=Object(k.y)([].concat($t(e,a).map(i(5)),Vt(e,a).map(r(1))),(function(e,t){return e[t.shape.id+"__weight_"+t.weight]=t,e}),{}),c=Object(k.y)(o,(function(e,t){var n,a,i,r=t.shape,o=t.weight,c=t.distanceTo,s=e.fav;return(n=c(r))<0||n>250||(a=(i=e[String(n)]=e[String(n)]||{value:n,count:0}).count+=1*o,(!s||s.count<a)&&(e.fav=i)),e}),{});return c.fav?c.fav.value:50}(e),r="left",o=80,c=30;He(e,"bpmn:BoundaryEvent")&&-1!==(r=Object(yt.f)(e,e.host,-25)).indexOf("top")&&(c*=-1);function s(e){return-1!==e.indexOf("top")?-1*o:-1!==e.indexOf("bottom")?o:0}var l={x:n.right+i+t.width/2,y:a.y+s(r)};return Dt(e,t,l,{y:{margin:c,rowSize:o}})}(e,t):function(e,t){var n=Object(yt.b)(e),a=Object(yt.e)(e);return{x:n.right+50+t.width/2,y:a.y}}(e,t)}function Bt(e,t,n){var a={x:t.x-n.width/2,y:t.y-n.height/2,width:n.width,height:n.height},i=function(e,t){var n=It(e);return e.host&&(n=n.concat(It(e.host))),e.attachers&&(n=n.concat(e.attachers.reduce((function(e,t){return e.concat(It(t))}),[]))),n}(e);return Object(k.f)(i,(function(e){return e!==n&&"intersect"===Object(yt.f)(e,a,10)}))}function Dt(e,t,n,a){function i(e){var i={x:n.x,y:n.y};return["x","y"].forEach((function(o){var c=a[o];if(c){var s="x"===o?"width":"height",l=c.margin,u=c.rowSize;i[o]=l<0?Math.min(e[o]+l-t[s]/2,n[o]-u+l):Math.max(r[o]+r[s]+l+t[s]/2,n[o]+u+l)}})),i}for(var r;r=Bt(e,n,t);)n=i(r);return n}function Lt(){return!0}function It(e,t){return[].concat($t(e,t),Vt(e,t))}function Vt(e,t){return t||(t=Lt),e.incoming.filter(t).map((function(e){return e.source}))}function $t(e,t){return t||(t=Lt),e.outgoing.filter(t).map((function(e){return e.target}))}function zt(e,t){function n(t,n){return e.fire(t,n)}this.append=function(e,a){n("autoPlace.start",{source:e,shape:a});var i=n("autoPlace",{source:e,shape:a});i||(i=Ft(e,a));var r=t.appendShape(e,a,i,e.parent);return n("autoPlace.end",{source:e,shape:r}),r}}function Wt(e,t){e.on("autoPlace.end",500,(function(e){t.select(e.shape)}))}zt.$inject=["eventBus","modeling"],Wt.$inject=["eventBus","selection"];var Gt={__init__:["autoPlaceSelectionBehavior"],autoPlace:["type",zt],autoPlaceSelectionBehavior:["type",Wt]},Ht=n(189);function Ut(e){e.invoke(Ht.a,this)}Ut.$inject=["injector"],S()(Ut,Ht.a),Ut.prototype.resize=function(e,t,n){He(e,"bpmn:Participant")?this._modeling.resizeLane(e,t,null,n):this._modeling.resizeShape(e,t,null,n)};var Kt=n(190);function qt(e,t){Kt.a.call(this,e),this._modeling=t}S()(qt,Kt.a),qt.$inject=["eventBus","modeling"],qt.prototype.canResize=function(e,t){if(!He(t,"bpmn:Participant")&&!He(t,"bpmn:Lane")&&!He(t,"bpmn:Loop")&&!He(t,"bpmn:Conditional"))return!1;var n=!0;return Object(k.i)(e,(function(e){(He(e,"bpmn:Lane")||e.labelTarget)&&(n=!1)})),n};var Jt={__init__:["bpmnAutoResize","bpmnAutoResizeProvider"],bpmnAutoResize:["type",Ut],bpmnAutoResizeProvider:["type",qt]},Yt=n(226),Xt=n(218),Qt=n(120),Zt=n(227),en=n(170),tn=n(229),nn=n(95),an=n(241),rn=n(219);function on(e,t,n){Object(k.l)(n)||(n=[n]),Object(k.i)(n,(function(n){Object(k.s)(e[n])||(t[n]=e[n])}))}function cn(e,t,n){var a;t.on("copyPaste.copyElement",750,(function(e){var t=e.descriptor,n=e.element,a=t.oldBusinessObject=Ue(n);if(t.type=n.type,on(a,t,"name"),t.di={},on(a.di,t.di,["fill","stroke"]),on(a.di,t,"isExpanded"),sn(t))return t;a.default&&(t.default=a.default.id)})),t.on("moddleCopy.canCopyProperty",(function(t){var a,i=t.parent,r=t.property;if("processRef"===t.propertyName&&He(i,"bpmn:Participant")&&He(r,"bpmn:Process-action"))return a=e.create("bpmn:Process-action"),n.copyElement(r,a)})),t.on("copyPaste.pasteElements",(function(){a={}})),t.on("copyPaste.pasteElement",(function(t){var i,r,o,c=t.cache,s=t.descriptor,l=s.oldBusinessObject;sn(s)?s.businessObject=Ue(c[s.labelTarget]):(i=e.create(l.$type),s.businessObject=n.copyElement(l,i),function(e,t){var n=Ue(e);e.default&&(a[e.default]={element:n,property:"default"}),e.host&&(Ue(e).attachedToRef=Ue(t[e.host])),a=Object(k.w)(a,Object(k.y)(a,(function(t,a,i){var r=a.element,o=a.property;return i===e.id&&(r[o]=n,t.push(e.id)),t}),[]))}(s,c),on(s,i,["isExpanded","name"]),r=s,o="oldBusinessObject",Object(k.l)(o)||(o=[o]),Object(k.i)(o,(function(e){r[e]&&delete r[e]})))}))}function sn(e){return!!e.labelTarget}cn.$inject=["bpmnFactory","eventBus","moddleCopy"];var ln=["artifacts","dataInputAssociations","dataOutputAssociations","default","flowElements","lanes","incoming","outgoing"];function un(e,t,n){this._bpmnFactory=t,this._eventBus=e,this._moddle=n,e.on("moddleCopy.canCopyProperties",(function(e){var t=e.propertyNames;if(t&&t.length)return Object(k.B)(t,(function(e){return"assignElements"===e}))})),e.on("moddleCopy.canCopyProperty",(function(e){var t=e.parent,n=Object(k.q)(t)&&t.$descriptor,a=e.propertyName;return(!a||-1===ln.indexOf(a))&&(!(a&&n&&!Object(k.f)(n.properties,Object(k.v)({name:a})))&&void 0)})),e.on("moddleCopy.canSetCopiedProperty",(function(e){var t,n,a=e.property;if(n="bpmn:AssignElements",(t=a)&&"function"===typeof t.$instanceOf&&t.$instanceOf(n)&&(!a.values||!a.values.length))return!1}))}function pn(e,t){return Object(k.y)(e.properties,(function(e,n){return t&&n.default?e:e.concat(n.name)}),[])}un.$inject=["eventBus","bpmnFactory","moddle"],un.prototype.copyElement=function(e,t,n){var a=this;n&&!Object(k.l)(n)&&(n=[n]),n=n||pn(e.$descriptor);var i=this._eventBus.fire("moddleCopy.canCopyProperties",{propertyNames:n,sourceElement:e,targetElement:t});return!1===i||(Object(k.l)(i)&&(n=i),Object(k.i)(n,(function(n){var i;Object(k.k)(e,n)&&(i=e.get(n));var r=a.copyProperty(i,t,n);!1!==a._eventBus.fire("moddleCopy.canSetCopiedProperty",{parent:t,property:r,propertyName:n})&&Object(k.m)(r)&&t.set(n,r)}))),t},un.prototype.copyProperty=function(e,t,n){var a=this,i=this._eventBus.fire("moddleCopy.canCopyProperty",{parent:t,property:e,propertyName:n});if(!1!==i){if(i)return Object(k.q)(i)&&i.$type&&!i.$parent&&(i.$parent=t),i;var r=this._moddle.getPropertyDescriptor(t,n);if(!r.isId&&!r.isReference){if(Object(k.l)(e))return Object(k.y)(e,(function(e,r){return(i=a.copyProperty(r,t,n))?(i.$parent=t,e.concat(i)):e}),[]);if(Object(k.q)(e)&&e.$type){if(this._moddle.getElementDescriptor(e).isGeneric)return;return(i=a._bpmnFactory.create(e.$type)).$parent=t,i=a.copyElement(e,i)}return e}}};var dn={__depends__:[rn.a],__init__:["bpmnCopyPaste","moddleCopy"],bpmnCopyPaste:["type",cn],moddleCopy:["type",un]},mn=n(240);var fn=["cancelActivity","instantiate","eventGatewayType","triggeredByEvent","isInterrupting"];function bn(e,t,n,a,i,r){this.replaceElement=function(o,c,s){s=s||{};var l=c.type,u=o.businessObject;if(hn(u)&&"bpmn:Loop"===l&&function(e,t){var n=e&&Object(k.k)(e,"collapsed")?e.collapsed:!Ke(e);return n!==(t&&(Object(k.k)(t,"collapsed")||Object(k.k)(t,"isExpanded"))?Object(k.k)(t,"collapsed")?t.collapsed:!t.isExpanded:n)&&(e.collapsed=n,!0)}(o,c))return a.toggleCollapse(o),o;var p,d=e.create(l),m={type:l,businessObject:d},f=pn(u.$descriptor),b=pn(d.$descriptor,!0),h=(p=b,f.filter((function(e){return-1!==p.indexOf(e)})));Object(k.a)(d,Object(k.x)(c,fn));var v=Object(k.e)(h,(function(e){return"eventDefinitions"===e?vn(o,c.eventDefinitionType):"loopCharacteristics"===e?!qe(d):!d.hasOwnProperty(e)&&(("processRef"!==e||!1!==c.isExpanded)&&"triggeredByEvent"!==e)}));return d=n.copyElement(u,d,v),c.eventDefinitionType&&(vn(d,c.eventDefinitionType)||(m.eventDefinitionType=c.eventDefinitionType)),He(u,"bpmn:Activity")&&(hn(u)?m.isExpanded=Ke(u):c&&Object(k.k)(c,"isExpanded")&&(m.isExpanded=c.isExpanded),Ke(u)&&!He(u,"bpmn:Task")&&m.isExpanded&&(m.width=o.width,m.height=o.height)),hn(u)&&!hn(d)&&(s.moveChildren=!1),He(u,"bpmn:Participant")&&(!0===c.isExpanded?d.processRef=e.create("bpmn:Process-action"):s.moveChildren=!1,m.width=o.width,m.height=t._getDefaultSize(d).height),d.name=u.name,Rt(u,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&Rt(d,["bpmn:ExclusiveGateway","bpmn:InclusiveGateway","bpmn:Activity"])&&(d.default=u.default),c.host&&!He(u,"bpmn:BoundaryEvent")&&He(d,"bpmn:BoundaryEvent")&&(m.host=c.host),m.di={},function(e,t,n){Object(k.l)(n)||(n=[n]),Object(k.i)(n,(function(n){Object(k.s)(e[n])||(t[n]=e[n])}))}(u.di,m.di,["fill","stroke"]),m=i.replaceElement(o,m,s),!1!==s.select&&r.select(m),m}}function hn(e){return He(e,"bpmn:Loop")}function vn(e,t){var n=Ue(e);return t&&n.get("eventDefinitions").some((function(e){return He(e,t)}))}bn.$inject=["bpmnFactory","elementFactory","moddleCopy","modeling","replace","selection"];var yn={__depends__:[dn,mn.a,Et.a],bpmnReplace:["type",bn]};function gn(e){return function(t){var n=t.target,a=Ue(e),i=a.eventDefinitions&&a.eventDefinitions[0],r=a.$type===n.type,o=(i&&i.$type)===n.eventDefinitionType,c=a.triggeredByEvent===n.triggeredByEvent,s=void 0===n.isExpanded||n.isExpanded===Ke(a);return!r||!o||!c||!s}}var jn=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throwing",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],xn=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message Intermediate Catch Event",actionName:"replace-with-message-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Message Intermediate Throw Event",actionName:"replace-with-message-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-message",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Intermediate Catch Event",actionName:"replace-with-timer-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Intermediate Throw Event",actionName:"replace-with-escalation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-escalation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Intermediate Catch Event",actionName:"replace-with-conditional-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Link Intermediate Catch Event",actionName:"replace-with-link-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-link",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:LinkEventDefinition"}},{label:"Link Intermediate Throw Event",actionName:"replace-with-link-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-link",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:LinkEventDefinition"}},{label:"Compensation Intermediate Throw Event",actionName:"replace-with-compensation-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-compensation",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal Intermediate Catch Event",actionName:"replace-with-signal-intermediate-catch",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Signal Intermediate Throw Event",actionName:"replace-with-signal-intermediate-throw",className:"bpmn-icon-intermediate-event-throw-signal",target:{type:"bpmn:IntermediateThrowEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}}],On=[{label:"Start Event",actionName:"replace-with-none-start",className:"bpmn-icon-start-event-none",target:{type:"bpmn:StartEvent"}},{label:"Intermediate Throw Event",actionName:"replace-with-none-intermediate-throw",className:"bpmn-icon-intermediate-event-none",target:{type:"bpmn:IntermediateThrowEvent"}},{label:"End Event",actionName:"replace-with-none-end",className:"bpmn-icon-end-event-none",target:{type:"bpmn:EndEvent"}},{label:"Message End Event",actionName:"replace-with-message-end",className:"bpmn-icon-end-event-message",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Escalation End Event",actionName:"replace-with-escalation-end",className:"bpmn-icon-end-event-escalation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Error End Event",actionName:"replace-with-error-end",className:"bpmn-icon-end-event-error",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel End Event",actionName:"replace-with-cancel-end",className:"bpmn-icon-end-event-cancel",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Compensation End Event",actionName:"replace-with-compensation-end",className:"bpmn-icon-end-event-compensation",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Signal End Event",actionName:"replace-with-signal-end",className:"bpmn-icon-end-event-signal",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Terminate End Event",actionName:"replace-with-terminate-end",className:"bpmn-icon-end-event-terminate",target:{type:"bpmn:EndEvent",eventDefinitionType:"bpmn:TerminateEventDefinition"}}],wn=[{label:"Exclusive Gateway",actionName:"replace-with-exclusive-gateway",className:"bpmn-icon-gateway-xor",target:{type:"bpmn:ExclusiveGateway"}},{label:"Parallel Gateway",actionName:"replace-with-parallel-gateway",className:"bpmn-icon-gateway-parallel",target:{type:"bpmn:ParallelGateway"}},{label:"Inclusive Gateway",actionName:"replace-with-inclusive-gateway",className:"bpmn-icon-gateway-or",target:{type:"bpmn:InclusiveGateway"}},{label:"Complex Gateway",actionName:"replace-with-complex-gateway",className:"bpmn-icon-gateway-complex",target:{type:"bpmn:ComplexGateway"}},{label:"Event based Gateway",actionName:"replace-with-event-based-gateway",className:"bpmn-icon-gateway-eventbased",target:{type:"bpmn:EventBasedGateway",instantiate:!1,eventGatewayType:"Exclusive"}}],En=[{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-loop",className:"bpmn-icon-event-loop-expanded",target:{type:"bpmn:Loop",triggeredByEvent:!0,isExpanded:!0}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-loop",className:"bpmn-icon-loop-collapsed",target:{type:"bpmn:Loop",isExpanded:!1}}],Nn=[{label:"Sub Process",actionName:"replace-with-loop",className:"bpmn-icon-loop-expanded",target:{type:"bpmn:Loop",isExpanded:!0}},{label:"Event Sub Process",actionName:"replace-with-event-loop",className:"bpmn-icon-event-loop-expanded",target:{type:"bpmn:Loop",triggeredByEvent:!0,isExpanded:!0}}],Cn=[{label:"Sub Process",actionName:"replace-with-loop",className:"bpmn-icon-loop-expanded",target:{type:"bpmn:Loop",isExpanded:!0}},{label:"Transaction",actionName:"replace-with-transaction",className:"bpmn-icon-transaction",target:{type:"bpmn:Transaction",isExpanded:!0}}],Sn=[{label:"Task",actionName:"replace-with-task",className:"bpmn-icon-task",target:{type:"bpmn:Task"}},{label:"Send Task",actionName:"replace-with-send-task",className:"bpmn-icon-send",target:{type:"bpmn:SendTask"}},{label:"Receive Task",actionName:"replace-with-receive-task",className:"bpmn-icon-receive",target:{type:"bpmn:ReceiveTask"}},{label:"User Task",actionName:"replace-with-user-task",className:"bpmn-icon-user",target:{type:"bpmn:UserTask"}},{label:"Manual Task",actionName:"replace-with-manual-task",className:"bpmn-icon-manual",target:{type:"bpmn:ManualTask"}},{label:"Business Rule Task",actionName:"replace-with-rule-task",className:"bpmn-icon-business-rule",target:{type:"bpmn:BusinessRuleTask"}},{label:"Service Task",actionName:"replace-with-service-task",className:"bpmn-icon-service",target:{type:"bpmn:ServiceTask"}},{label:"Script Task",actionName:"replace-with-script-task",className:"bpmn-icon-script",target:{type:"bpmn:ScriptTask"}},{label:"Call Activity",actionName:"replace-with-call-activity",className:"bpmn-icon-call-activity",target:{type:"bpmn:CallActivity"}},{label:"Sub Process (collapsed)",actionName:"replace-with-collapsed-loop",className:"bpmn-icon-loop-collapsed",target:{type:"bpmn:Loop",isExpanded:!1}},{label:"Sub Process (expanded)",actionName:"replace-with-expanded-loop",className:"bpmn-icon-loop-expanded",target:{type:"bpmn:Loop",isExpanded:!0}}],_n=[{label:"Message Boundary Event",actionName:"replace-with-message-boundary",className:"bpmn-icon-intermediate-event-catch-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Boundary Event",actionName:"replace-with-timer-boundary",className:"bpmn-icon-intermediate-event-catch-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Escalation Boundary Event",actionName:"replace-with-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Conditional Boundary Event",actionName:"replace-with-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Error Boundary Event",actionName:"replace-with-error-boundary",className:"bpmn-icon-intermediate-event-catch-error",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Cancel Boundary Event",actionName:"replace-with-cancel-boundary",className:"bpmn-icon-intermediate-event-catch-cancel",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CancelEventDefinition"}},{label:"Signal Boundary Event",actionName:"replace-with-signal-boundary",className:"bpmn-icon-intermediate-event-catch-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Compensation Boundary Event",actionName:"replace-with-compensation-boundary",className:"bpmn-icon-intermediate-event-catch-compensation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-message",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:MessageEventDefinition",cancelActivity:!1}},{label:"Timer Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-timer",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:TimerEventDefinition",cancelActivity:!1}},{label:"Escalation Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-escalation",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",cancelActivity:!1}},{label:"Conditional Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-condition",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",cancelActivity:!1}},{label:"Signal Boundary Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-boundary",className:"bpmn-icon-intermediate-event-catch-non-interrupting-signal",target:{type:"bpmn:BoundaryEvent",eventDefinitionType:"bpmn:SignalEventDefinition",cancelActivity:!1}}],kn=[{label:"Message Start Event",actionName:"replace-with-message-start",className:"bpmn-icon-start-event-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition"}},{label:"Timer Start Event",actionName:"replace-with-timer-start",className:"bpmn-icon-start-event-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition"}},{label:"Conditional Start Event",actionName:"replace-with-conditional-start",className:"bpmn-icon-start-event-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition"}},{label:"Signal Start Event",actionName:"replace-with-signal-start",className:"bpmn-icon-start-event-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition"}},{label:"Error Start Event",actionName:"replace-with-error-start",className:"bpmn-icon-start-event-error",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ErrorEventDefinition"}},{label:"Escalation Start Event",actionName:"replace-with-escalation-start",className:"bpmn-icon-start-event-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition"}},{label:"Compensation Start Event",actionName:"replace-with-compensation-start",className:"bpmn-icon-start-event-compensation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:CompensateEventDefinition"}},{label:"Message Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-message-start",className:"bpmn-icon-start-event-non-interrupting-message",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:MessageEventDefinition",isInterrupting:!1}},{label:"Timer Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-timer-start",className:"bpmn-icon-start-event-non-interrupting-timer",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:TimerEventDefinition",isInterrupting:!1}},{label:"Conditional Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-conditional-start",className:"bpmn-icon-start-event-non-interrupting-condition",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:ConditionalEventDefinition",isInterrupting:!1}},{label:"Signal Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-signal-start",className:"bpmn-icon-start-event-non-interrupting-signal",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:SignalEventDefinition",isInterrupting:!1}},{label:"Escalation Start Event (non-interrupting)",actionName:"replace-with-non-interrupting-escalation-start",className:"bpmn-icon-start-event-non-interrupting-escalation",target:{type:"bpmn:StartEvent",eventDefinitionType:"bpmn:EscalationEventDefinition",isInterrupting:!1}}],Mn=[{label:"Sequence Flow",actionName:"replace-with-sequence-flow",className:"bpmn-icon-connection"},{label:"Default Flow",actionName:"replace-with-default-flow",className:"bpmn-icon-default-flow"},{label:"Conditional Flow",actionName:"replace-with-conditional-flow",className:"bpmn-icon-conditional-flow"}],Pn=[{label:"Expanded Pool",actionName:"replace-with-expanded-pool",className:"bpmn-icon-participant",target:{type:"bpmn:Participant",isExpanded:!0}},{label:"Collapsed Pool",actionName:"replace-with-collapsed-pool",className:"bpmn-icon-lane",target:{type:"bpmn:Participant",isExpanded:!1}}];function Tn(e,t,n,a,i,r){this._popupMenu=e,this._modeling=t,this._moddle=n,this._bpmnReplace=a,this._rules=i,this._translate=r,this.register()}Tn.$inject=["popupMenu","modeling","moddle","bpmnReplace","rules","translate"],Tn.prototype.register=function(){this._popupMenu.registerProvider("bpmn-replace",this)},Tn.prototype.getEntries=function(e){var t,n=e.businessObject;if(!this._rules.allowed("shape.replace",{element:e}))return[];var a=gn(e);return He(n,"bpmn:StartEvent")&&!qe(n.$parent)?(t=Object(k.e)(jn,a),this._createEntries(e,t)):He(n,"bpmn:Participant")?(t=Object(k.e)(Pn,(function(e){return Ke(n)!==e.target.isExpanded})),this._createEntries(e,t)):He(n,"bpmn:StartEvent")&&qe(n.$parent)?(t=Object(k.e)(kn,(function(t){var n=!1!==t.target.isInterrupting,i=Ue(e).isInterrupting===n;return a(t)||!a(t)&&!i})),this._createEntries(e,t)):He(n,"bpmn:EndEvent")?(t=Object(k.e)(On,(function(e){return!("bpmn:CancelEventDefinition"===e.target.eventDefinitionType&&!He(n.$parent,"bpmn:Transaction"))&&a(e)})),this._createEntries(e,t)):He(n,"bpmn:BoundaryEvent")?(t=Object(k.e)(_n,(function(e){var t=e.target;if("bpmn:CancelEventDefinition"===t.eventDefinition&&!He(n.attachedToRef,"bpmn:Transaction"))return!1;var i=!1!==t.cancelActivity,r=n.cancelActivity===i;return a(e)||!a(e)&&!r})),this._createEntries(e,t)):He(n,"bpmn:IntermediateCatchEvent")||He(n,"bpmn:IntermediateThrowEvent")?(t=Object(k.e)(xn,a),this._createEntries(e,t)):He(n,"bpmn:Gateway")?(t=Object(k.e)(wn,a),this._createEntries(e,t)):He(n,"bpmn:Transaction")?(t=Object(k.e)(Nn,a),this._createEntries(e,t)):qe(n)&&Ke(n)?(t=Object(k.e)(Cn,a),this._createEntries(e,t)):He(n,"bpmn:Loop")&&Ke(n)?(t=Object(k.e)(En,a),this._createEntries(e,t)):He(n,"bpmn:AdHocSubProcess")&&!Ke(n)?(t=Object(k.e)(Sn,(function(t){var n=t.target,a="bpmn:Loop"===n.type,i=!0===n.isExpanded;return gn(e)&&(!a||i)})),this._createEntries(e,t)):He(n,"bpmn:SequenceFlow")?this._createSequenceFlowEntries(e,Mn):He(n,"bpmn:FlowNode")?(t=Object(k.e)(Sn,a),He(n,"bpmn:Loop")&&!Ke(n)&&(t=Object(k.e)(t,(function(e){return"Sub Process (collapsed)"!==e.label}))),this._createEntries(e,t)):[]},Tn.prototype.getHeaderEntries=function(e){var t=[];return He(e,"bpmn:Activity")&&!qe(e)&&(t=t.concat(this._getLoopEntries(e))),!He(e,"bpmn:Loop")||He(e,"bpmn:Transaction")||qe(e)||t.push(this._getAdHocEntry(e)),t},Tn.prototype._createEntries=function(e,t){var n=[],a=this;return Object(k.i)(t,(function(t){var i=a._createMenuEntry(t,e);n.push(i)})),n},Tn.prototype._createSequenceFlowEntries=function(e,t){var n=Ue(e),a=[],i=this._modeling,r=this._moddle,o=this;return Object(k.i)(t,(function(t){switch(t.actionName){case"replace-with-default-flow":n.sourceRef.default!==n&&(He(n.sourceRef,"bpmn:ExclusiveGateway")||He(n.sourceRef,"bpmn:InclusiveGateway")||He(n.sourceRef,"bpmn:ComplexGateway")||He(n.sourceRef,"bpmn:Activity"))&&a.push(o._createMenuEntry(t,e,(function(){i.updateProperties(e.source,{default:n})})));break;case"replace-with-conditional-flow":!n.conditionExpression&&He(n.sourceRef,"bpmn:Activity")&&a.push(o._createMenuEntry(t,e,(function(){var t=r.create("bpmn:FormalExpression",{body:""});i.updateProperties(e,{conditionExpression:t})})));break;default:if(He(n.sourceRef,"bpmn:Activity")&&n.conditionExpression)return a.push(o._createMenuEntry(t,e,(function(){i.updateProperties(e,{conditionExpression:void 0})})));if((He(n.sourceRef,"bpmn:ExclusiveGateway")||He(n.sourceRef,"bpmn:InclusiveGateway")||He(n.sourceRef,"bpmn:ComplexGateway")||He(n.sourceRef,"bpmn:Activity"))&&n.sourceRef.default===n)return a.push(o._createMenuEntry(t,e,(function(){i.updateProperties(e.source,{default:void 0})})))}})),a},Tn.prototype._createMenuEntry=function(e,t,n){var a=this._translate,i=this._bpmnReplace.replaceElement;return n=n||function(){return i(t,e.target)},{label:a(e.label),className:e.className,id:e.actionName,action:n}},Tn.prototype._getLoopEntries=function(e){var t=this,n=this._translate;function a(n,a){var i;a.active?i=void 0:(i=t._moddle.create(a.options.loopCharacteristics),a.options.isSequential&&(i.isSequential=a.options.isSequential)),t._modeling.updateProperties(e,{loopCharacteristics:i})}var i,r,o,c=Ue(e).loopCharacteristics;return c&&(i=c.isSequential,r=void 0===c.isSequential,o=void 0!==c.isSequential&&!c.isSequential),[{id:"toggle-parallel-mi",className:"bpmn-icon-parallel-mi-marker",title:n("Parallel Multi Instance"),active:o,action:a,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!1}},{id:"toggle-sequential-mi",className:"bpmn-icon-sequential-mi-marker",title:n("Sequential Multi Instance"),active:i,action:a,options:{loopCharacteristics:"bpmn:MultiInstanceLoopCharacteristics",isSequential:!0}},{id:"toggle-loop",className:"bpmn-icon-loop-marker",title:n("Loop"),active:r,action:a,options:{loopCharacteristics:"bpmn:StandardLoopCharacteristics"}}]},Tn.prototype._getAdHocEntry=function(e){var t=this._translate,n=He(Ue(e),"bpmn:AdHocSubProcess"),a=this._bpmnReplace.replaceElement;return{id:"toggle-adhoc",className:"bpmn-icon-ad-hoc-marker",title:t("Ad-hoc"),active:n,action:function(t,i){return a(e,n?{type:"bpmn:Loop"}:{type:"bpmn:AdHocSubProcess"},{autoResize:!1,layoutConnection:!1})}}};var Rn={__depends__:[an.a,yn],__init__:["replaceMenuProvider"],replaceMenuProvider:["type",Tn]},An=n(65),Fn=Math.abs;var Bn=["bpmn:Participant","bpmn:Process-action","bpmn:Loop"],Dn=30;function Ln(e,t){return t=t||[],e.children.filter((function(e){return He(e,"bpmn:Lane")?(Ln(e,t),t.push(e),e):e})),t}function In(e){return e.children.filter((function(e){return He(e,"bpmn:Lane")}))}function Vn(e){return At(e,Bn)||e}function $n(e,t){var n=Vn(e),a=Ln(n,He(n,"bpmn:Process")?[]:[n]),i=Object(yt.b)(e),r=Object(yt.b)(t),o=function(e,t){return Object(An.f)(Object(yt.b)(t),Object(yt.b)(e))}(e,t),c=[];return a.forEach((function(t){if(t!==e){var n=0,a=o.right,s=0,l=o.left,u=Object(yt.b)(t);o.top&&(Fn(u.bottom-i.top)<10&&(s=r.top-u.bottom),Fn(u.top-i.top)<5&&(n=r.top-u.top)),o.bottom&&(Fn(u.top-i.bottom)<10&&(n=r.bottom-u.top),Fn(u.bottom-i.bottom)<5&&(s=r.bottom-u.bottom)),(n||a||s||l)&&c.push({shape:t,newBounds:Object(An.e)(t,{top:n,right:a,bottom:s,left:l})})}})),c}var zn=n(51);function Wn(e,t,n,a,i,r,o,c,s,l,u,p){e=e||{},a.registerProvider(this),this._contextPad=a,this._modeling=i,this._elementFactory=r,this._connect=o,this._create=c,this._popupMenu=s,this._canvas=l,this._rules=u,this._translate=p,!1!==e.autoPlace&&(this._autoPlace=t.get("autoPlace",!1)),n.on("create.end",250,(function(e){var t=e.context.shape;if(Object(zn.a)(e)&&a.isOpen(t)){var n=a.getEntries(t);n.replace&&n.replace.action.click(e,t)}}))}function Gn(e,t,n){var a=e.$instanceOf(t),i=!1,r=e.eventDefinitions||[];return Object(k.i)(r,(function(e){e.$type===n&&(i=!0)})),a&&i}Wn.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate"],Wn.prototype.getContextPadEntries=function(e){var t=this._contextPad,n=this._modeling,a=this._elementFactory,i=this._connect,r=this._create,o=this._popupMenu,c=this._canvas,s=this._rules,l=this._autoPlace,u=this._translate,p={};if("label"===e.type)return p;var d=e.businessObject;function m(e,t){i.start(e,t)}function f(e,t,n,i){function o(t,n){var o=a.createShape(Object(k.a)({type:e},i));r.start(t,o,{source:n})}return"string"!==typeof n&&(i=n,n=u("Append {type}",{type:e.replace(/^bpmn:/,"")})),{group:"model",className:t,title:n,action:{dragstart:o,click:l?function(t,n){var r=a.createShape(Object(k.a)({type:e},i));l.append(n,r)}:o}}}function b(e){return function(a,i){n.splitLane(i,e),t.open(i,!0)}}if(Rt(d,["bpmn:Lane","bpmn:Participant"])&&Ke(d)){var h=In(e);Object(k.a)(p,{"lane-insert-above":{group:"lane-insert-above",className:"bpmn-icon-lane-insert-above",title:u("Add Lane above"),action:{click:function(e,t){n.addLane(t,"top")}}}}),h.length<2&&(e.height>=120&&Object(k.a)(p,{"lane-divide-two":{group:"lane-divide",className:"bpmn-icon-lane-divide-two",title:u("Divide into two Lanes"),action:{click:b(2)}}}),e.height>=180&&Object(k.a)(p,{"lane-divide-three":{group:"lane-divide",className:"bpmn-icon-lane-divide-three",title:u("Divide into three Lanes"),action:{click:b(3)}}})),Object(k.a)(p,{"lane-insert-below":{group:"lane-insert-below",className:"bpmn-icon-lane-insert-below",title:u("Add Lane below"),action:{click:function(e,t){n.addLane(t,"bottom")}}}})}He(d,"bpmn:FlowNode")&&(He(d,"bpmn:EventBasedGateway")?Object(k.a)(p,{"append.receive-task":f("bpmn:ReceiveTask","bpmn-icon-receive-task",u("Append ReceiveTask")),"append.message-intermediate-event":f("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-message",u("Append MessageIntermediateCatchEvent"),{eventDefinitionType:"bpmn:MessageEventDefinition"}),"append.timer-intermediate-event":f("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-timer",u("Append TimerIntermediateCatchEvent"),{eventDefinitionType:"bpmn:TimerEventDefinition"}),"append.condition-intermediate-event":f("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-condition",u("Append ConditionIntermediateCatchEvent"),{eventDefinitionType:"bpmn:ConditionalEventDefinition"}),"append.signal-intermediate-event":f("bpmn:IntermediateCatchEvent","bpmn-icon-intermediate-event-catch-signal",u("Append SignalIntermediateCatchEvent"),{eventDefinitionType:"bpmn:SignalEventDefinition"})}):Gn(d,"bpmn:BoundaryEvent","bpmn:CompensateEventDefinition")?Object(k.a)(p,{"append.compensation-activity":f("bpmn:Task","bpmn-icon-task",u("Append compensation activity"),{isForCompensation:!0})}):He(d,"bpmn:EndEvent")||d.isForCompensation||Gn(d,"bpmn:IntermediateThrowEvent","bpmn:LinkEventDefinition")||qe(d)||Object(k.a)(p,{"append.end-event":f("bpmn:EndEvent","bpmn-icon-end-event-none",u("Append EndEvent")),"append.gateway":f("bpmn:ExclusiveGateway","bpmn-icon-gateway-none",u("Append Gateway")),"append.append-task":f("bpmn:Task","bpmn-icon-task",u("Append Task")),"append.intermediate-event":f("bpmn:IntermediateThrowEvent","bpmn-icon-intermediate-event-none",u("Append Intermediate/Boundary Event"))})),o.isEmpty(e,"bpmn-replace")||Object(k.a)(p,{replace:{group:"edit",className:"bpmn-icon-screw-wrench",title:u("Change type"),action:{click:function(e,n){var a=Object(k.a)(function(e){var n=c.getContainer(),a=t.getPad(e).html,i=n.getBoundingClientRect(),r=a.getBoundingClientRect(),o=r.top-i.top;return{x:r.left-i.left,y:o+r.height+5}}(n),{cursor:{x:e.x,y:e.y}});o.open(n,"bpmn-replace",a)}}}}),Rt(d,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])&&Object(k.a)(p,{"append.text-annotation":f("bpmn:TextAnnotation","bpmn-icon-text-annotation"),connect:{group:"connect",className:"bpmn-icon-connection-multi",title:u("Connect using "+(d.isForCompensation?"":"Sequence/MessageFlow or ")+"Association"),action:{click:m,dragstart:m}}}),Rt(d,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&Object(k.a)(p,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:u("Connect using DataInputAssociation"),action:{click:m,dragstart:m}}});var v=s.allowed("elements.delete",{elements:[e]});return Object(k.l)(v)&&(v=v[0]===e),v&&Object(k.a)(p,{delete:{group:"edit",className:"bpmn-icon-trash",title:u("Remove"),action:{click:function(t){n.removeElements([e])}}}}),p};var Hn={__depends__:[en.a,tn.a,Et.a,Qt.a,nn.a,Rn],__init__:["contextPadProvider"],contextPadProvider:["type",Wn]},Un=n(230);function Kn(e){e.registerFilter((function(e){return Object(k.e)(e,(function(e){var t=Rt(e,["bpmn:Association","bpmn:BoundaryEvent","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:Lane","bpmn:MessageFlow","bpmn:Participant","bpmn:SequenceFlow","bpmn:TextAnnotation"]);return!(e.labelTarget||t)}))}))}Kn.$inject=["distributeElements"];var qn={__depends__:[Un.a],__init__:["bpmnDistributeElements"],bpmnDistributeElements:["type",Kn]},Jn=n(205),Yn=n(126),Xn=n(22);function Qn(e){e.invoke(Yn.a,this)}S()(Qn,Yn.a),Qn.$inject=["injector"],Qn.prototype._registerDefaultActions=function(e){Yn.a.prototype._registerDefaultActions.call(this,e);var t=e.get("canvas",!1),n=e.get("elementRegistry",!1),a=e.get("selection",!1),i=e.get("spaceTool",!1),r=e.get("lassoTool",!1),o=e.get("handTool",!1),c=e.get("globalConnect",!1),s=e.get("distributeElements",!1),l=e.get("alignElements",!1),u=e.get("directEditing",!1),p=e.get("searchPad",!1),d=e.get("modeling",!1);t&&n&&a&&this._registerAction("selectElements",(function(){var e=t.getRootElement(),i=n.filter((function(t){return t!==e}));return a.select(i),i})),i&&this._registerAction("spaceTool",(function(){i.toggle()})),r&&this._registerAction("lassoTool",(function(){r.toggle()})),o&&this._registerAction("handTool",(function(){o.toggle()})),c&&this._registerAction("globalConnectTool",(function(){c.toggle()})),a&&s&&this._registerAction("distributeElements",(function(e){var t=a.get(),n=e.type;t.length&&s.trigger(t,n)})),a&&l&&this._registerAction("alignElements",(function(e){var t=a.get(),n=[],i=e.type;t.length&&(n=Object(k.e)(t,(function(e){return!He(e,"bpmn:Lane")})),l.trigger(n,i))})),a&&d&&this._registerAction("setColor",(function(e){var t=a.get();t.length&&d.setColor(t,e)})),a&&u&&this._registerAction("directEditing",(function(){var e=a.get();e.length&&u.activate(e[0])})),p&&this._registerAction("find",(function(){p.toggle()})),t&&d&&this._registerAction("moveToOrigin",(function(){var e,a,i=t.getRootElement();a=He(i,"bpmn:Collaboration")?n.filter((function(e){return He(e.parent,"bpmn:Collaboration")})):n.filter((function(e){return e!==i&&!He(e.parent,"bpmn:Loop")})),e=Object(Xn.b)(a),d.moveElements(a,{x:-e.x,y:-e.y},i)}))};var Zn={__depends__:[Jn.a],editorActions:["type",Qn]};function ea(e){e.on(["create.init","shape.move.init"],(function(e){var t=e.context;Rt(e.shape,["bpmn:Participant","bpmn:Loop","bpmn:Conditional","bpmn:TextAnnotation"])&&(t.gridSnappingContext||(t.gridSnappingContext={}),t.gridSnappingContext.snapLocation="top-left")}))}ea.$inject=["eventBus"];var ta=n(220);function na(e,t){e.on("autoPlace",(function(e){var n=e.source,a=Object(yt.e)(n),i=e.shape,r=Ft(n,i);return["x","y"].forEach((function(e){var n={};r[e]!==a[e]&&(r[e]>a[e]?n.min=r[e]:n.max=r[e],He(i,"bpmn:TextAnnotation")&&(!function(e){return"x"===e}(e)?n.offset=-i.height/2:n.offset=-i.width/2),r[e]=t.snapValue(r[e],n))})),r}))}na.$inject=["eventBus","gridSnapping"];function aa(e,t,n){t.on(["create.start","shape.move.start"],1750,(function(t){var a=t.context,i=a.shape,r=e.getRootElement();He(i,"bpmn:Participant")&&He(r,"bpmn:Process-action")&&r.children.length&&(a.createConstraints&&(i.width=n.snapValue(i.width,{min:i.width}),i.height=n.snapValue(i.height,{min:i.height})))}))}aa.$inject=["canvas","eventBus","gridSnapping"];var ia=n(14),ra=n(37);function oa(e,t,n){ia.a.call(this,e),this._gridSnapping=t;var a=this;this.postExecuted(["connection.create","connection.layout"],3e3,(function(e){var t=e.context,i=t.connection,r=t.hints||{},o=i.waypoints;r.connectionStart||r.connectionEnd||!1===r.createElementsBehavior||function(e){return e.length>3}(o)&&n.updateWaypoints(i,a.snapMiddleSegments(o))}))}function ca(e,t,n){var a=Object(ra.d)(t,n),i={};return function(e){return"h"===e}(a)&&(i.y=e.snapValue(t.y)),function(e){return"v"===e}(a)&&(i.x=e.snapValue(t.x)),("x"in i||"y"in i)&&(t=Object(k.a)({},t,i),n=Object(k.a)({},n,i)),[t,n]}oa.$inject=["eventBus","gridSnapping","modeling"],S()(oa,ia.a),oa.prototype.snapMiddleSegments=function(e){var t,n=this._gridSnapping;e=e.slice();for(var a=1;a<e.length-2;a++)t=ca(n,e[a],e[a+1]),e[a]=t[0],e[a+1]=t[1];return e};var sa={__init__:["gridSnappingAutoPlaceBehavior","gridSnappingCreateParticipantBehavior","gridSnappingLayoutConnectionBehavior"],gridSnappingAutoPlaceBehavior:["type",na],gridSnappingCreateParticipantBehavior:["type",aa],gridSnappingLayoutConnectionBehavior:["type",oa]},la={__depends__:[ta.a,sa],__init__:["bpmnGridSnapping"],bpmnGridSnapping:["type",ea]};function ua(e,t){this._interactionEvents=t;var n=this;e.on(["interactionEvents.createHit","interactionEvents.updateHit"],(function(e){var t=e.element,a=e.gfx;return He(t,"bpmn:Lane")?n.createParticipantHit(t,a):He(t,"bpmn:Participant")?Ke(t)?n.createParticipantHit(t,a):n.createDefaultHit(t,a):He(t,"bpmn:Loop")||He(t,"bpmn:Conditional")?Ke(t)?n.createLoopHit(t,a):n.createDefaultHit(t,a):void 0}))}ua.$inject=["eventBus","interactionEvents"],ua.prototype.createDefaultHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createDefaultHit(e,t),!0},ua.prototype.createParticipantHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:30,height:e.height}),!0},ua.prototype.createLoopHit=function(e,t){return this._interactionEvents.removeHits(t),this._interactionEvents.createBoxHit(t,"click-stroke",{width:e.width,height:e.height}),this._interactionEvents.createBoxHit(t,"all",{width:e.width,height:30}),!0};var pa={__init__:["bpmnInteractionEvents"],bpmnInteractionEvents:["type",ua]},da=n(122),ma=n(125);function fa(e){e.invoke(ma.a,this)}S()(fa,ma.a),fa.$inject=["injector"],fa.prototype.registerBindings=function(e,t){function n(n,a){t.isRegistered(n)&&e.addListener(a)}ma.a.prototype.registerBindings.call(this,e,t),n("selectElements",(function(n){var a=n.keyEvent;if(e.isKey(["a","A"],a)&&e.isCmd(a))return t.trigger("selectElements"),!0})),n("find",(function(n){var a=n.keyEvent;if(e.isKey(["f","F"],a)&&e.isCmd(a))return t.trigger("find"),!0})),n("spaceTool",(function(n){var a=n.keyEvent;if(!e.hasModifier(a))return e.isKey(["s","S"],a)?(t.trigger("spaceTool"),!0):void 0})),n("lassoTool",(function(n){var a=n.keyEvent;if(!e.hasModifier(a))return e.isKey(["l","L"],a)?(t.trigger("lassoTool"),!0):void 0})),n("handTool",(function(n){var a=n.keyEvent;if(!e.hasModifier(a))return e.isKey(["h","H"],a)?(t.trigger("handTool"),!0):void 0})),n("globalConnectTool",(function(n){var a=n.keyEvent;if(!e.hasModifier(a))return e.isKey(["c","C"],a)?(t.trigger("globalConnectTool"),!0):void 0})),n("directEditing",(function(n){var a=n.keyEvent;if(!e.hasModifier(a))return e.isKey(["e","E"],a)?(t.trigger("directEditing"),!0):void 0}))};var ba={__depends__:[da.a],__init__:["keyboardBindings"],keyboardBindings:["type",fa]},ha=n(228),va=n(176),ya=n(168),ga=n(20);function ja(e,t){var n=t.create("bpmn:CategoryValue"),a=t.create("bpmn:Category",{categoryValue:[n]});return Object(ga.a)(e.get("rootElements"),a),Ue(a).$parent=e,Ue(n).$parent=a,n}function xa(e,t,n,a,i,r,o){function c(e,t){(t||Rt(e,["bpmn:Task","bpmn:TextAnnotation","bpmn:Group"])||Oa(e))&&a.activate(e)}this._bpmnFactory=t,this._canvas=n,this._modeling=i,this._textRenderer=o,a.registerProvider(this),e.on("element.dblclick",(function(e){c(e.element,!0)})),e.on(["autoPlace.start","canvas.viewbox.changing","drag.init","element.mousedown","popupMenu.open"],(function(e){a.isActive()&&a.complete()})),e.on(["commandStack.changed"],(function(e){a.isActive()&&a.cancel()})),e.on("directEditing.activate",(function(e){r.removeResizers()})),e.on("create.end",500,(function(e){var t=e.context,n=t.shape,a=e.context.canExecute;e.isTouch||a&&(t.hints&&!1===t.hints.createElementsBehavior||c(n))})),e.on("autoPlace.end",500,(function(e){c(e.shape)}))}function Oa(e){return He(e,"bpmn:Loop")&&!Ke(e)||He(e,"bpmn:Conditional")&&!Ke(e)}xa.$inject=["eventBus","bpmnFactory","canvas","directEditing","modeling","resizeHandles","textRenderer"],xa.prototype.activate=function(e){var t=Xe(e);if(void 0!==t){var n={text:t},a=this.getEditingBBox(e);Object(k.a)(n,a);var i={};return(Rt(e,["bpmn:Task","bpmn:Participant","bpmn:Lane","bpmn:CallActivity"])||Oa(e))&&Object(k.a)(i,{centerVertically:!0}),mt(e)&&Object(k.a)(i,{autoResize:!0}),He(e,"bpmn:TextAnnotation")&&Object(k.a)(i,{resizable:!0,autoResize:!0}),Object(k.a)(n,{options:i}),n}},xa.prototype.getEditingBBox=function(e){var t=this._canvas,n=e.label||e,a=t.getAbsoluteBBox(n),i=a.x+a.width/2,r=a.y+a.height/2,o={x:a.x,y:a.y},c=t.zoom(),s=this._textRenderer.getDefaultStyle(),l=this._textRenderer.getExternalStyle(),u=l.fontSize*c,p=l.lineHeight,d=s.fontSize*c,m=s.lineHeight,f={fontFamily:this._textRenderer.getDefaultStyle().fontFamily,fontWeight:this._textRenderer.getDefaultStyle().fontWeight};(He(e,"bpmn:Lane")||function(e){return He(e,"bpmn:Participant")&&Ke(e)}(e))&&(Object(k.a)(o,{width:a.height,height:30*c,x:a.x-a.height/2+15*c,y:r-30*c/2}),Object(k.a)(f,{fontSize:d+"px",lineHeight:m,paddingTop:7*c+"px",paddingBottom:7*c+"px",paddingLeft:5*c+"px",paddingRight:5*c+"px",transform:"rotate(-90deg)"})),(Rt(e,["bpmn:Task","bpmn:CallActivity"])||function(e){return He(e,"bpmn:Participant")&&!Ke(e)}(e)||Oa(e))&&(Object(k.a)(o,{width:a.width,height:a.height}),Object(k.a)(f,{fontSize:d+"px",lineHeight:m,paddingTop:7*c+"px",paddingBottom:7*c+"px",paddingLeft:5*c+"px",paddingRight:5*c+"px"})),function(e){return He(e,"bpmn:Loop")&&Ke(e)||He(e,"bpmn:Conditional")&&Ke(e)}(e)&&(Object(k.a)(o,{width:a.width,x:a.x}),Object(k.a)(f,{fontSize:d+"px",lineHeight:m,paddingTop:7*c+"px",paddingBottom:7*c+"px",paddingLeft:5*c+"px",paddingRight:5*c+"px"}));var b=90*c,h=7*c,v=4*c;if(n.labelTarget&&(Object(k.a)(o,{width:b,height:a.height+h+v,x:i-b/2,y:a.y-h}),Object(k.a)(f,{fontSize:u+"px",lineHeight:p,paddingTop:h+"px",paddingBottom:v+"px"})),mt(n)&&!ft(n)&&!vt(n)){var y=ht(e),g=t.getAbsoluteBBox({x:y.x,y:y.y,width:0,height:0}),j=u+h+v;Object(k.a)(o,{width:b,height:j,x:g.x-b/2,y:g.y-j/2}),Object(k.a)(f,{fontSize:u+"px",lineHeight:p,paddingTop:h+"px",paddingBottom:v+"px"})}return He(e,"bpmn:TextAnnotation")&&(Object(k.a)(o,{width:a.width,height:a.height,minWidth:30*c,minHeight:10*c}),Object(k.a)(f,{textAlign:"left",paddingTop:5*c+"px",paddingBottom:7*c+"px",paddingLeft:7*c+"px",paddingRight:5*c+"px",fontSize:d+"px",lineHeight:m})),{bounds:o,style:f}},xa.prototype.update=function(e,t,n,a){var i,r,o;if((He(e,"bpmn:TextAnnotation")&&(r=this._canvas.getAbsoluteBBox(e),i={x:e.x,y:e.y,width:e.width/r.width*a.width,height:e.height/r.height*a.height}),He(e,"bpmn:Group"))&&!Ue(e).categoryValueRef){var c=ja(Ue(this._canvas.getRootElement()).$parent,this._bpmnFactory);Ue(e).categoryValueRef=c}(o=t)&&o.trim()||(t=null),this._modeling.updateLabel(e,t,i)};var wa="djs-element-hidden",Ea="djs-label-hidden";function Na(e,t,n,a){var i,r,o,c=this,s=t.getDefaultLayer();e.on("directEditing.activate",(function(e){var n=e.active;if(He(i=n.element.label||n.element,"bpmn:TextAnnotation")){r=t.getAbsoluteBBox(i),o=Object(P.f)("g");var l=a.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:i.width,containerHeight:i.height,position:{mx:0,my:0}}),u=c.path=Object(P.f)("path");Object(P.b)(u,{d:l,strokeWidth:2,stroke:Ca(i)}),Object(P.a)(o,u),Object(P.a)(s,o),Object(Ge.c)(o,i.x,i.y)}He(i,"bpmn:TextAnnotation")||i.labelTarget?t.addMarker(i,wa):(He(i,"bpmn:Task")||He(i,"bpmn:CallActivity")||He(i,"bpmn:Loop")||He(i,"bpmn:Conditional")||He(i,"bpmn:Participant"))&&t.addMarker(i,Ea)})),e.on("directEditing.resize",(function(e){if(He(i,"bpmn:TextAnnotation")){var t=e.height,n=e.dy,o=Math.max(i.height/r.height*(t+n),0),s=a.getScaledPath("TEXT_ANNOTATION",{xScaleFactor:1,yScaleFactor:1,containerWidth:i.width,containerHeight:o,position:{mx:0,my:0}});Object(P.b)(c.path,{d:s})}})),e.on(["directEditing.complete","directEditing.cancel"],(function(e){var n=e.active;n&&(t.removeMarker(n.element.label||n.element,wa),t.removeMarker(i,Ea)),i=void 0,r=void 0,o&&(Object(P.j)(o),o=void 0)}))}function Ca(e,t){return Ue(e).di.get("stroke")||t||"black"}Na.$inject=["eventBus","canvas","elementRegistry","pathMap"];var Sa={__depends__:[va.a,ya.a,en.a],__init__:["labelEditingProvider","labelEditingPreview"],labelEditingProvider:["type",xa],labelEditingPreview:["type",Na]},_a=n(46),ka=["top","bottom","left","right"],Ma=10;function Pa(e,t){function n(e){if(ft(e)){var n=function(e){var t=Object(yt.e)(e.label),n=Ta(Object(yt.e)(e),t);if(a=n,-1===ka.indexOf(a))return;var a;var i=function(e){var t=Object(yt.e)(e);return[].concat(e.incoming.map((function(e){return e.waypoints[e.waypoints.length-2]})),e.outgoing.map((function(e){return e.waypoints[1]}))).map((function(e){return Ta(t,e)}))}(e);if(e.host){var r=function(e){var t,n=e.host,a=Object(yt.e)(e),i=Object(yt.f)(a,n);t=i.indexOf("-")>=0?i.split("-"):[i];return ka.filter((function(e){return-1===t.indexOf(e)}))}(e);i=i.concat(r)}var o=ka.filter((function(e){return-1===i.indexOf(e)}));if(-1!==o.indexOf(n))return;return o[0]}(e);n&&function(e,n){var a=Object(yt.e)(e),i=e.label,r=Object(yt.e)(i);if(!i.parent)return;var o,c=Object(yt.b)(e);switch(n){case"top":o={x:a.x,y:c.top-Ma-i.height/2};break;case"left":o={x:c.left-Ma-i.width/2,y:a.y};break;case"bottom":o={x:a.x,y:c.bottom+Ma+i.height/2};break;case"right":o={x:c.right+Ma+i.width/2,y:a.y}}var s=Object(_a.b)(o,r);t.moveShape(i,s)}(e,n)}}ia.a.call(this,e),this.postExecuted(["connection.create","connection.layout","connection.updateWaypoints"],(function(e){var t=e.context,a=t.connection,i=a.source,r=a.target;!1!==(t.hints||{}).createElementsBehavior&&(n(i),n(r))})),this.postExecuted(["label.create"],(function(e){var t=e.context,a=t.shape;!1!==(t.hints||{}).createElementsBehavior&&n(a.labelTarget)})),this.postExecuted(["elements.create"],(function(e){var t=e.context,a=t.elements;!1!==(t.hints||{}).createElementsBehavior&&a.forEach((function(e){n(e)}))}))}function Ta(e,t){return Object(yt.f)(t,e,5)}function Ra(e,t,n){ia.a.call(this,e),this.preExecute("shape.append",(function(e){var t=e.source,n=e.shape;e.position||(He(n,"bpmn:TextAnnotation")?e.position={x:t.x+t.width/2+75,y:t.y-50-n.height/2}:e.position={x:t.x+t.width+80+n.width/2,y:t.y+t.height/2})}),!0)}function Aa(e,t){e.invoke(ia.a,this),this.postExecute("shape.move",(function(e){var n=e.newParent,a=e.shape,i=Object(k.e)(a.incoming.concat(a.outgoing),(function(e){return He(e,"bpmn:Association")}));Object(k.i)(i,(function(e){t.moveConnection(e,{x:0,y:0},n)}))}),!0)}S()(Pa,ia.a),Pa.$inject=["eventBus","modeling"],S()(Ra,ia.a),Ra.$inject=["eventBus","elementFactory","bpmnRules"],S()(Aa,ia.a),Aa.$inject=["injector","modeling"];function Fa(e,t){t.invoke(ia.a,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",500,(function(e){var t=e.elements;1===(t=t.filter((function(e){return Ba(e,e.host)}))).length&&t.map((function(e){return t.indexOf(e)})).forEach((function(a){var i=t[a];e.elements[a]=n.replaceShape(t[a],i)}))}),!0),this.preExecute("elements.move",500,(function(e){var t=e.shapes,a=e.newHost;if(1===t.length){var i=t[0];Ba(i,a)&&(e.shapes=[n.replaceShape(i,a)])}}),!0)}function Ba(e,t){return!vt(e)&&Rt(e,["bpmn:IntermediateThrowEvent","bpmn:IntermediateCatchEvent"])&&!!t}function Da(e,t){function n(e){return Object(k.e)(e.attachers,(function(e){return He(e,"bpmn:BoundaryEvent")}))}ia.a.call(this,e),this.postExecute("connection.create",(function(e){var a=e.context.source,i=e.context.target,r=n(i);He(a,"bpmn:EventBasedGateway")&&He(i,"bpmn:ReceiveTask")&&r.length>0&&t.removeElements(r)})),this.postExecute("connection.reconnect",(function(e){var a=e.context.oldSource,i=e.context.newSource;He(a,"bpmn:Gateway")&&He(i,"bpmn:EventBasedGateway")&&Object(k.i)(i.outgoing,(function(e){var a=e.target,i=n(a);He(a,"bpmn:ReceiveTask")&&i.length>0&&t.removeElements(i)}))}))}Fa.$inject=["bpmnReplace","injector"],S()(Fa,ia.a),Fa.prototype.replaceShape=function(e,t){var n=function(e){var t=Ue(e).eventDefinitions;return t&&t[0]}(e),a={type:"bpmn:BoundaryEvent",host:t};return n&&(a.eventDefinitionType=n.$type),this._bpmnReplace.replaceElement(e,a,{layoutConnection:!1})},Da.$inject=["eventBus","modeling"],S()(Da,ia.a);function La(e,t,n,a,i){function r(e){return Rt(e,["bpmn:ReceiveTask","bpmn:SendTask"])||function(e,t){Object(k.l)(t)||(t=[t]);return Object(k.A)(t,(function(t){return Je(e,t)}))}(e,["bpmn:ErrorEventDefinition","bpmn:EscalationEventDefinition","bpmn:MessageEventDefinition","bpmn:SignalEventDefinition"])}function o(t){var n=e.getDefinitions().get("rootElements");return!!Object(k.f)(n,Object(k.v)({id:t.id}))}function c(e){return He(e,"bpmn:ErrorEventDefinition")?"errorRef":He(e,"bpmn:EscalationEventDefinition")?"escalationRef":He(e,"bpmn:MessageEventDefinition")?"messageRef":He(e,"bpmn:SignalEventDefinition")?"signalRef":void 0}function s(e){if(Rt(e,["bpmn:ReceiveTask","bpmn:SendTask"]))return e.get("messageRef");var t=e.get("eventDefinitions")[0];return t.get(c(t))}n.invoke(ia.a,this),this.executed("shape.create",(function(t){var n=t.shape;if(r(n)){var a,i=s(Ue(n));i&&!o(i)&&(a=e.getDefinitions().get("rootElements"),Object(ga.a)(a,i),t.addedRootElement=i)}}),!0),this.reverted("shape.create",(function(t){var n=t.addedRootElement;if(n){var a=e.getDefinitions().get("rootElements");Object(ga.c)(a,n)}}),!0),t.on("copyPaste.copyElement",(function(e){var t=e.descriptor,n=e.element;if(r(n)){var a=s(Ue(n));a&&(t.referencedRootElement=a)}})),t.on("copyPaste.pasteElement",500,(function(e){var t=e.descriptor,n=t.businessObject;if(r(n)){var s=t.referencedRootElement;s&&(o(s)||(s=a.copyElement(s,i.create(s.$type))),function(e,t){if(Rt(e,["bpmn:ReceiveTask","bpmn:SendTask"]))return e.set("messageRef",t);var n=e.get("eventDefinitions")[0];n.set(c(n),t)}(n,s))}}))}function Ia(e){e.invoke(ia.a,this),this.preExecute("shape.create",1500,(function(e){var t=e.context,n=t.parent,a=t.shape;He(n,"bpmn:Lane")&&!He(a,"bpmn:Lane")&&(t.parent=At(n,"bpmn:Participant"))}))}La.$inject=["bpmnjs","eventBus","injector","moddleCopy","bpmnFactory"],S()(La,ia.a),Ia.$inject=["injector"],S()(Ia,ia.a);var Va=1500;function $a(e,t,n){t.on(["create.hover","create.move","create.end","shape.move.hover","shape.move.move","shape.move.end"],Va,(function(t){var a=t.context.shape||t.shape,i=t.hover;He(i,"bpmn:Lane")&&!Rt(a,["bpmn:Lane","bpmn:Participant"])&&(t.hover=Vn(i),t.hoverGfx=e.getGraphics(t.hover));var r=n.getRootElement();i!==r&&(a.labelTarget||He(a,"bpmn:Group"))&&(t.hover=r,t.hoverGfx=e.getGraphics(t.hover))})),t.on(["connect.hover","connect.out","connect.end","connect.cleanup","global-connect.hover","global-connect.out","global-connect.end","global-connect.cleanup"],Va,(function(t){var n=t.hover;He(n,"bpmn:Lane")&&(t.hover=Vn(n)||n,t.hoverGfx=e.getGraphics(t.hover))})),t.on(["bendpoint.move.hover"],Va,(function(t){var n=t.context,a=t.hover,i=n.type;He(a,"bpmn:Lane")&&/reconnect/.test(i)&&(t.hover=Vn(a)||a,t.hoverGfx=e.getGraphics(t.hover))})),t.on(["connect.start"],Va,(function(e){var t=e.context,n=t.start;He(n,"bpmn:Lane")&&(t.start=Vn(n)||n)})),t.on("shape.move.start",2e3,(function(e){var t=e.shape;He(t,"bpmn:Lane")&&(e.shape=Vn(t)||t)}))}function za(e,t,n){ia.a.call(this,e),this.preExecute("shape.create",(function(e){var n=e.context.shape;if(He(n,"bpmn:DataObjectReference")&&"label"!==n.type){var a=t.create("bpmn:DataObject");n.businessObject.dataObjectRef=a}}))}$a.$inject=["elementRegistry","eventBus","canvas"],za.$inject=["eventBus","bpmnFactory","moddle"],S()(za,ia.a);var Wa=20,Ga=20,Ha=2e3;function Ua(e,t,n){function a(t){var a,i=t.parent,r=e.getRootElement();He(r,"bpmn:Collaboration")?a=r:(a=n.makeCollaboration(),t.process=i),t.parent=a}ia.a.call(this,t),t.on(["create.start","shape.move.start"],Ha,(function(t){var n=t.context,a=n.shape,i=e.getRootElement();if(He(a,"bpmn:Participant")&&He(i,"bpmn:Process-action")&&i.children.length){var r=i.children.filter((function(e){return!He(e,"bpmn:Group")&&!vt(e)&&!function(e){return!!e.waypoints}(e)}));if(r.length){var o=Object(Xn.b)(r),c=function(e,t){t={width:t.width+40+30,height:t.height+40};var n=Math.max(e.width,t.width),a=Math.max(e.height,t.height);return{x:-n/2,y:-a/2,width:n,height:a}}(a,o);Object(k.a)(a,c),n.createConstraints=function(e,t){return{bottom:(t=Object(yt.b)(t)).top+e.height/2-Ga,left:t.right-e.width/2+Wa,top:t.bottom-e.height/2+Ga,right:t.left+e.width/2-Wa-30}}(a,o)}}})),t.on("create.start",Ha,(function(n){var a=n.context.shape,i=e.getRootElement(),r=e.getGraphics(i);function o(e){e.element=i,e.gfx=r}He(a,"bpmn:Participant")&&He(i,"bpmn:Process-action")&&(t.on("element.hover",Ha,o),t.once("create.cleanup",(function(){t.off("element.hover",o)})))})),this.preExecute("shape.create",(function(e){var t=e.parent;He(e.shape,"bpmn:Participant")&&He(t,"bpmn:Process-action")&&a(e)}),!0),this.execute("shape.create",(function(e){var t=e.process,n=e.shape;t&&(e.oldProcessRef=n.businessObject.processRef,n.businessObject.processRef=t.businessObject)}),!0),this.revert("shape.create",(function(e){var t=e.process,n=e.shape;t&&(n.businessObject.processRef=e.oldProcessRef)}),!0),this.postExecute("shape.create",(function(e){var t=e.process,a=e.shape;if(t){var i=t.children.slice();n.moveElements(i,{x:0,y:0},a)}}),!0),this.preExecute("elements.create",Ha,(function(e){var t,n=e.elements,i=e.parent;Ka(n)&&He(i,"bpmn:Process-action")&&(a(e),t=Ka(n),e.oldProcessRef=t.businessObject.processRef,t.businessObject.processRef=i.businessObject)}),!0),this.revert("elements.create",(function(e){var t=e.elements;e.process&&(Ka(t).businessObject.processRef=e.oldProcessRef)}),!0),this.postExecute("elements.create",(function(e){var t,a=e.elements,i=e.process;if(i){t=Ka(a);var r=i.children.slice();n.moveElements(r,{x:0,y:0},t)}}),!0)}function Ka(e){return Object(k.f)(e,(function(e){return He(e,"bpmn:Participant")}))}Ua.$inject=["canvas","eventBus","modeling"],S()(Ua,ia.a);var qa="__targetRef_placeholder";function Ja(e,t){function n(e,n){var a=e.get("properties"),i=Object(k.f)(a,(function(e){return e.name===qa}));return!i&&n&&(i=t.create("bpmn:Property",{name:qa}),Object(ga.a)(a,i)),i}function a(e,t){var a=n(e);a&&(function(e,t,n){var a=e.get("dataInputAssociations");return Object(k.f)(a,(function(e){return e!==n&&e.targetRef===t}))}(e,a,t)||Object(ga.c)(e.get("properties"),a))}function i(e){var t,i=e.context,r=i.connection,o=r.businessObject,c=r.target,s=c&&c.businessObject,l=i.newTarget,u=l&&l.businessObject,p=i.oldTarget||i.target,d=p&&p.businessObject,m=r.businessObject;d&&d!==s&&a(d,o),u&&u!==s&&a(u,o),s?(t=n(s,!0),m.targetRef=t):m.targetRef=null}ia.a.call(this,e),this.executed(["connection.create","connection.delete","connection.move","connection.reconnect"],Ya(i)),this.reverted(["connection.create","connection.delete","connection.move","connection.reconnect"],Ya(i))}function Ya(e){return function(t){if(He(t.context.connection,"bpmn:DataInputAssociation"))return e(t)}}function Xa(e){this._bpmnUpdater=e}function Qa(e,t,n,a){function i(e){return e.children.filter((function(e){return He(e,"bpmn:DataStoreReference")&&!e.labelTarget}))}function r(e,a){var i=e.businessObject||e;if(a=a||n.filter((function(e){return He(e,"bpmn:Participant")}))[0]){var r=a.businessObject||a;t.execute("dataStore.updateContainment",{dataStoreBo:i,newSemanticParent:r.processRef||r,newDiParent:r.di})}}ia.a.call(this,a),t.registerHandler("dataStore.updateContainment",Xa),this.preExecute("shape.create",(function(e){var t=e.context,n=t.shape;He(n,"bpmn:DataStoreReference")&&"label"!==n.type&&(t.hints||(t.hints={}),t.hints.autoResize=!1)})),this.preExecute("elements.move",(function(e){var t=e.context,n=t.shapes;n.filter((function(e){return He(e,"bpmn:DataStoreReference")})).length&&(t.hints||(t.hints={}),t.hints.autoResize=n.filter((function(e){return!He(e,"bpmn:DataStoreReference")})))})),this.postExecute("shape.create",(function(e){var t=e.context.shape,n=t.parent;He(t,"bpmn:DataStoreReference")&&"label"!==t.type&&He(n,"bpmn:Collaboration")&&r(t)})),this.postExecute("shape.move",(function(e){var t=e.context,n=t.shape,a=t.oldParent,i=n.parent;He(a,"bpmn:Collaboration")||He(n,"bpmn:DataStoreReference")&&"label"!==n.type&&He(i,"bpmn:Collaboration")&&r(n,He(a,"bpmn:Participant")?a:function(e,t){for(;e.parent;){if(He(e.parent,t))return e.parent;e=e.parent}}(a,"bpmn:Participant"))})),this.postExecute("shape.delete",(function(t){var n=t.context.shape,a=e.getRootElement();Rt(n,["bpmn:Participant","bpmn:Loop","bpmn:Conditional"])&&He(a,"bpmn:Collaboration")&&i(a).filter((function(e){return function(e,t){var n=e.businessObject||e,a=t.businessObject||t;for(;n.$parent;){if(n.$parent===a.processRef||a)return!0;n=n.$parent}return!1}(e,n)})).forEach((function(e){r(e)}))})),this.postExecute("canvas.updateRoot",(function(e){var t=e.context,n=t.oldRoot,a=t.newRoot;i(n).forEach((function(e){He(a,"bpmn:Process-action")&&r(e,a)}))}))}Ja.$inject=["eventBus","bpmnFactory"],S()(Ja,ia.a),Xa.$inject=["bpmnUpdater"],Xa.prototype.execute=function(e){var t=e.dataStoreBo,n=e.newSemanticParent,a=e.newDiParent;e.oldSemanticParent=t.$parent,e.oldDiParent=t.di.$parent,this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(t.di,a)},Xa.prototype.revert=function(e){var t=e.dataStoreBo,n=e.oldSemanticParent,a=e.oldDiParent;this._bpmnUpdater.updateSemanticParent(t,n),this._bpmnUpdater.updateDiParent(t.di,a)},Qa.$inject=["canvas","commandStack","elementRegistry","eventBus"],S()(Qa,ia.a);function Za(e,t,n){ia.a.call(this,e),this.postExecuted("shape.delete",500,(function(e){var t=e.context,a=t.hints,i=t.shape,r=t.oldParent;He(i,"bpmn:Lane")&&(a&&a.nested||function(e,t){var a,i,r,o=In(t),c=[],s=[];Object(Xn.a)(o,(function(t){return t.y>e.y?s.push(t):c.push(t),t.children})),o.length&&(a=s.length&&c.length?e.height/2:e.height,c.length&&(i=n.calculateAdjustments(c,"y",a,e.y-10),n.makeSpace(i.movingShapes,i.resizingShapes,{x:0,y:a},"s")),s.length&&(r=n.calculateAdjustments(s,"y",-a,e.y+e.height+10),n.makeSpace(r.movingShapes,r.resizingShapes,{x:0,y:-a},"n")))}(i,r))}))}Za.$inject=["eventBus","modeling","spaceTool"],S()(Za,ia.a);function ei(e,t){t.invoke(ia.a,this),this._bpmnReplace=e;var n=this;this.postExecuted("elements.create",500,(function(e){var t=e.elements;t.filter((function(e){return ti(e,e.host)})).map((function(e){return t.indexOf(e)})).forEach((function(a){e.elements[a]=n.replaceShape(t[a])}))}),!0),this.preExecute("elements.move",500,(function(e){var t=e.shapes,a=e.newHost;t.forEach((function(e,i){var r,o=e.host;ti(e,(r=o,-1!==t.indexOf(r)?o:a))&&(t[i]=n.replaceShape(e))}))}),!0)}function ti(e,t){return!vt(e)&&He(e,"bpmn:BoundaryEvent")&&!t}ei.$inject=["bpmnReplace","injector"],S()(ei,ia.a),ei.prototype.replaceShape=function(e){var t,n=function(e){var t=Ue(e).eventDefinitions;return t&&t[0]}(e);return t=n?{type:"bpmn:IntermediateCatchEvent",eventDefinitionType:n.$type}:{type:"bpmn:IntermediateThrowEvent"},this._bpmnReplace.replaceElement(e,t,{layoutConnection:!1})};var ni=n(139);function ai(e,t,n){function a(e,t,a){var i,r,o,c,s=t.waypoints;e.outgoing.slice(),e.incoming.slice();c=Object(k.p)(a.width)?Object(yt.e)(a):a;var l=Object(ni.a)(s,c);if(l){if(i=s.slice(0,l.index),r=s.slice(l.index+(l.bendpoint?1:0)),!i.length||!r.length)return;o=l.bendpoint?s[l.index]:c,ii(e,i[i.length-1])||i.push(ri(o)),ii(e,r[0])||r.unshift(ri(o))}var u=[].concat([],[]);u.length&&n.removeElements(u)}ia.a.call(this,e),this.preExecute("elements.move",(function(e){var n=e.newParent,a=e.shapes,i=e.delta,r=a[0];if(r&&n){n&&n.waypoints&&(e.newParent=n=n.parent);var o=Object(yt.e)(r),c={x:o.x+i.x,y:o.y+i.y},s=Object(k.f)(n.children,(function(e){return t.canInsert(a,e)&&Object(ni.a)(e.waypoints,c)}));s&&(e.targetFlow=s,e.position=c)}}),!0),this.postExecuted("elements.move",(function(e){var t=e.shapes,n=e.targetFlow,i=e.position;n&&a(t[0],n,i)}),!0),this.preExecute("shape.create",(function(e){var n=e.parent,a=e.shape;t.canInsert(a,n)&&(e.targetFlow=n,e.parent=n.parent)}),!0),this.postExecuted("shape.create",(function(e){var t=e.shape,n=e.targetFlow,i=e.position;n&&a(t,n,i)}),!0)}function ii(e,t){var n=t.x,a=t.y;return n>=e.x&&n<=e.x+e.width&&a>=e.y&&a<=e.y+e.height}function ri(e){return Object(k.a)({},e)}function oi(e,t){ia.a.call(this,e),this.preExecuted("connection.create",(function(e){var n=e.context,a=n.source,i=n.target,r=i.incoming.slice();n.hints&&!1===n.hints.createElementsBehavior||He(a,"bpmn:EventBasedGateway")&&i.incoming.length&&r.filter(ci).forEach((function(e){t.removeConnection(e)}))})),this.preExecuted("shape.replace",(function(e){var n=e.context.newShape;He(n,"bpmn:EventBasedGateway")&&n.outgoing.filter(ci).map((function(e){return e.target})).reduce((function(e,t){var n=t.incoming.filter(ci);return e.concat(n)}),[]).forEach((function(e){e.source!==n&&t.removeConnection(e)}))}))}function ci(e){return He(e,"bpmn:SequenceFlow")}S()(ai,ia.a),ai.$inject=["eventBus","bpmnRules","modeling"],oi.$inject=["eventBus","modeling"],S()(oi,ia.a);function si(e,t,n,a,i,r){function o(){return Ue(t.getRootElement()).$parent}function c(e){var t=Ue(e).categoryValueRef;if(t){var n=t.$parent;t&&(Object(ga.c)(n.categoryValue,t),n&&!n.categoryValue.length&&function(e){var t=o();Object(ga.c)(t.get("rootElements"),e)}(n))}}i.invoke(ia.a,this),this.executed("shape.delete",(function(e){var t,a=e.context.shape;if(He(a,"bpmn:Group")){var i=Ue(a).categoryValueRef,r=n.filter((function(e){return He(e,"bpmn:Group")}));t=i,r.some((function(e){var n=Ue(e);return n.categoryValueRef&&n.categoryValueRef===t}))||c(a)}})),this.reverted("shape.delete",(function(e){var t=e.context.shape;if(He(t,"bpmn:Group")){var n=Ue(t).categoryValueRef,a=o(),i=n?n.$parent:null;Object(ga.a)(i.get("categoryValue"),n),Object(ga.a)(a.get("rootElements"),i)}})),this.execute("shape.create",(function(t){var n=Ue(t.context.shape);if(He(n,"bpmn:Group")&&!n.categoryValueRef){var a=ja(o(),e);n.categoryValueRef=a}})),this.revert("shape.create",(function(e){var t=e.context.shape;He(t,"bpmn:Group")&&(c(t),delete Ue(t).categoryValueRef)})),a.on("moddleCopy.canCopyProperty",2e3,(function(t){var n,a=t.property;if(He(a,"bpmn:CategoryValue"))return n=ja(o(),e),r.copyElement(a,n)}))}function li(e,t,n,a){var i,r,o,c;return 0===(i=(a.y-n.y)*(t.x-e.x)-(a.x-n.x)*(t.y-e.y))?null:(r=e.y-n.y,o=e.x-n.x,c=((a.x-n.x)*r-(a.y-n.y)*o)/i,{x:Math.round(e.x+c*(t.x-e.x)),y:Math.round(e.y+c*(t.y-e.y))})}function ui(e){function t(e,t,n){var a,i={x:n.x,y:n.y-50},r={x:n.x-50,y:n.y},o=li(e,t,n,i),c=li(e,t,n,r);a=o&&c?pi(o,n)>pi(c,n)?c:o:o||c,e.original=a}e.on("bpmnElement.added",(function(e){var n=e.element;n.waypoints&&function(e){var n=e.waypoints;t(n[0],n[1],Object(yt.e)(e.source)),t(n[n.length-1],n[n.length-2],Object(yt.e)(e.target))}(n)}))}function pi(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function di(e){ia.a.call(this,e);var t=["bpmn:Participant","bpmn:Lane"];this.executed(["shape.move","shape.create","shape.resize"],(function(e){var n=Ue(e.context.shape);Rt(n,t)&&!n.di.get("isHorizontal")&&n.di.set("isHorizontal",!0)}))}function mi(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))}function fi(e){return Math.atan((e[1].y-e[0].y)/(e[1].x-e[0].x))}function bi(e,t){var n=t[0],a=t[1],i={x:a.x-n.x,y:a.y-n.y},r=function(e,t,n){var a=[{n:e[0]-n[0],lambda:t[0]},{n:e[1]-n[1],lambda:t[1]}];return-(a[0].n*t[0]+a[1].n*t[1])/(a[0].lambda*t[0]+a[1].lambda*t[1])}([n.x,n.y],[i.x,i.y],[e.x,e.y]);return{x:n.x+r*i.x,y:n.y+r*i.y}}function hi(e,t){var n=bi(e,t);return mi({x:n.x-e.x,y:n.y-e.y})}function vi(e,t){return mi({x:e.x-t.x,y:e.y-t.y})}si.$inject=["bpmnFactory","canvas","elementRegistry","eventBus","injector","moddleCopy"],S()(si,ia.a),ui.$inject=["eventBus"],di.$inject=["eventBus"],S()(di,ia.a);var yi=Math.sqrt,gi=Math.min,ji=Math.max,xi=Math.abs;function Oi(e){return Math.pow(e,2)}function wi(e,t){return yi(Oi(e.x-t.x)+Oi(e.y-t.y))}function Ei(e,t,n,a){var i=t.x-e.x,r=t.y-e.y,o=n.x-e.x,c=n.y-e.y,s=i*i+r*r,l=(i*o+r*c)/s,u=l*l-(o*o+c*c-a*a)/s;if(u<0&&u>-1e-6&&(u=0),u<0)return[];var p=yi(u),d=-l+p,m=-l-p,f={x:e.x-i*d,y:e.y-r*d};return 0===u?[f]:[f,{x:e.x-i*m,y:e.y-r*m}].filter((function(n){return function(e,t,n){return Ni(e.x,t.x,n.x)&&Ni(e.y,t.y,n.y)}(n,e,t)}))}function Ni(e,t,n){return e>=gi(t,n)-Ci&&e<=ji(t,n)+Ci}var Ci=.1;function Si(e,t){return xi(e.x-t.x)<=Ci&&xi(e.y-t.y)<=Ci}function _i(e,t,n,a){var i=0,r=0,o=function(e){return{x:e.x+e.width/2,y:e.y+e.height/2}}(e),c=function(e,t){var n,a,i,r,o,c,s,l,u,p,d,m,f=0;for(f=0;f<t.length-1;f++){if(Si(n=t[f],a=t[f+1])?c=[n]:(i=wi(e,n),r=wi(e,a),c=Ei(n,a,e,gi(i,r))),c.length<1)throw new Error("expected between [1, 2] circle -> line intersections");1===c.length&&(s={type:"bendpoint",position:c[0],segmentIndex:f,bendpointIndex:Si(n,c[0])?f:f+1}),2===c.length&&(d=c[0],m=c[1],s={type:"segment",position:o={x:(d.x+m.x)/2,y:(d.y+m.y)/2},segmentIndex:f,relativeLocation:wi(n,o)/wi(n,a)}),l=wi(s.position,e),(!p||u>l)&&(p=s,u=l)}return p}(o,n),s=c.segmentIndex,l=function(e,t,n,a){var i=n.segmentIndex,r=t.length-e.length;if(a.segmentMove){var o=a.segmentMove.segmentStartIndex,c=a.segmentMove.newSegmentStartIndex;return i===o?c:i>=c?i+r<c?c:i+r:i}if(a.bendpointMove){var s,l=a.bendpointMove.insert,u=a.bendpointMove.bendpointIndex;return 0===r?i:(i>=u&&(s=l?i+1:i-1),i<u&&(s=i,l&&"bendpoint"!==n.type&&u-1===i&&ki(t,u)<n.relativeLocation&&s++),s)}return 0===r?i:a.connectionStart?0===i?0:null:a.connectionEnd&&i===e.length-2?t.length-2:null}(n,t,c,a);if(null===l)return{x:i,y:r};if(l<0||l>t.length-2)return{x:i,y:r};var u=Mi(n,s),p=Mi(t,l),d=c.position,m=function(e,t){var n=vi(e[0],e[1]),a=vi(e[0],t);return 0===n?0:a/n}(u,d),f=function(e,t){var n=fi(e);return fi(t)-n}(u,p);if("bendpoint"===c.type){var b=t.length-n.length,h=c.bendpointIndex,v=n[h];if(-1!==t.indexOf(v))return{x:i,y:r};if(0===b){var y=t[h];return{x:y.x-c.position.x,y:y.y-c.position.y}}b<0&&0!==h&&h<n.length-1&&(m=ki(n,h))}var g,j,x=(p[1].x-p[0].x)*m+p[0].x,O=(p[1].y-p[0].y)*m+p[0].y,w=(g={x:o.x-d.x,y:o.y-d.y},(j=f)?{x:Math.cos(j)*g.x-Math.sin(j)*g.y,y:Math.sin(j)*g.x+Math.cos(j)*g.y}:g);return i=x+w.x-o.x,r=O+w.y-o.y,Object(yt.h)({x:i,y:r})}function ki(e,t){var n=vi(e[t-1],e[t]);return n/(n+vi(e[t],e[t+1]))}function Mi(e,t){return[e[t],e[t+1]]}var Pi=n(78),Ti={width:90,height:20},Ri="name",Ai="text";function Fi(e,t,n,a){ia.a.call(this,e),this.postExecute("element.updateProperties",(function(e){var n=e.context,i=n.element,r=n.properties;if(Ri in r&&t.updateLabel(i,r.name),Ai in r&&He(i,"bpmn:TextAnnotation")){var o=a.getTextAnnotationBounds({x:i.x,y:i.y,width:i.width,height:i.height},r.text||"");t.updateLabel(i,r.text,o)}})),this.postExecute(["shape.create","connection.create"],(function(e){var n=e.context;if(!1!==(n.hints||{}).createElementsBehavior){var i=n.shape||n.connection,r=i.businessObject;if(!vt(i)&&mt(i)&&Xe(i)){var o=ht(i),c=a.getExternalLabelBounds(Ti,Xe(i));t.createLabel(i,o,{id:r.id+"_label",businessObject:r,width:c.width,height:c.height})}}})),this.postExecute("shape.delete",(function(e){var n=e.context,a=n.labelTarget,i=n.hints||{};a&&!1!==i.unsetLabel&&t.updateLabel(a,null,null,{removeShape:!1})})),this.postExecute(["label.create"],(function(e){var t,a=e.context.shape;a.labelTarget&&He(a.labelTarget||a,"bpmn:BaseElement")&&((t=a.businessObject.di).label||(t.label=n.create("bpmndi:BPMNLabel",{bounds:n.create("dc:Bounds")})),Object(k.a)(t.label.bounds,{x:a.x,y:a.y,width:a.width,height:a.height}))})),this.postExecute(["connection.layout","connection.updateWaypoints"],(function(e){var n=e.context;if(!1!==(n.hints||{}).labelBehavior){var a,i=n.connection.label;i&&i.parent&&(a=function(e){var t=e.context,n=t.connection,a=n.label,i=Object(k.a)({},t.hints),r=t.newWaypoints||n.waypoints,o=t.oldWaypoints;return"undefined"===typeof i.startChanged&&(i.startChanged=!!i.connectionStart),"undefined"===typeof i.endChanged&&(i.endChanged=!!i.connectionEnd),_i(a,r,o,i)}(e),t.moveShape(i,a))}})),this.postExecute(["shape.replace"],(function(e){var t=e.context,n=t.newShape,a=t.oldShape,i=Ue(n);i&&mt(i)&&a.label&&n.label&&(n.label.x=a.label.x,n.label.y=a.label.y)})),this.postExecute("shape.resize",(function(e){var n,a=e.context,i=a.shape,r=a.newBounds,o=a.oldBounds;if(ft(i)){var c=i.label,s=function(e,t,n){var a=Object(Pi.a)(e,t,n);return Object(yt.h)(Object(_a.b)(a,e))}(function(e,t){if(!t.length)return;var n=function(e,t){var n=t.map((function(t){return{line:t,distance:hi(e,t)}}));return Object(k.B)(n,"distance")[0].line}(e,t);return bi(e,n)}(Object(yt.e)(c),[[{x:(n=o).x,y:n.y},{x:n.x+(n.width||0),y:n.y}],[{x:n.x+(n.width||0),y:n.y},{x:n.x+(n.width||0),y:n.y+(n.height||0)}],[{x:n.x,y:n.y+(n.height||0)},{x:n.x+(n.width||0),y:n.y+(n.height||0)}],[{x:n.x,y:n.y},{x:n.x,y:n.y+(n.height||0)}]]),o,r);t.moveShape(c,s)}}))}S()(Fi,ia.a),Fi.$inject=["eventBus","modeling","bpmnFactory","textRenderer"];var Bi="flow elements must be children of pools/participants";function Di(e,t,n){function a(e,n,a){t.add({position:{x:e.x+5,y:e.y+5},type:"error",timeout:a||2e3,html:"<div>"+n+"</div>"})}e.on(["shape.move.rejected","create.rejected"],(function(e){var t=e.context,i=t.shape;He(t.target,"bpmn:Collaboration")&&He(i,"bpmn:FlowNode")&&a(e,n(Bi))})),e.on(["elements.paste.rejected"],(function(e){var t=e.context,i=t.position,r=t.target;He(r,"bpmn:Collaboration")&&a(i,n(Bi)),He(r,"bpmn:Process-action")&&a(i,n("participants cannot be pasted onto a non-empty process diagram"),3e3)}))}function Li(e,t,n,a){ia.a.call(this,e);var i=a.get("dragging",!1);function r(e){var a,i,r=e.source,o=e.target;e.parent&&(He(e,"bpmn:SequenceFlow")&&(n.canConnectSequenceFlow(r,o)||(i=!0),n.canConnectMessageFlow(r,o)&&(a="bpmn:MessageFlow")),He(e,"bpmn:MessageFlow")&&(n.canConnectMessageFlow(r,o)||(i=!0),n.canConnectSequenceFlow(r,o)&&(a="bpmn:SequenceFlow")),He(e,"bpmn:Association")&&!n.canConnectAssociation(r,o)&&(i=!0),i&&t.removeConnection(e),a&&t.connect(r,o,{type:a,waypoints:e.waypoints.slice()}))}this.postExecuted("elements.move",(function(e){var t=e.closure.allConnections;Object(k.i)(t,r)}),!0),this.preExecute("connection.reconnect",(function(e){var a,r,o=e.context,c=o.connection,s=o.newSource||c.source,l=o.newTarget||c.target;(a=n.canConnect(s,l))&&a.type!==c.type&&(r=t.connect(s,l,{type:a.type,waypoints:c.waypoints.slice()}),t.removeConnection(c),o.connection=r,i&&function(e,t){var n,a=i.context(),r=a&&a.payload.previousSelection;if(!r||!r.length)return;if(-1===(n=r.indexOf(e)))return;r.splice(n,1,t)}(c,r))})),this.postExecuted("element.updateProperties",(function(e){var n,a=e.context,i=a.properties,r=a.element,o=r.businessObject;i.default&&(n=Object(k.f)(r.outgoing,Object(k.v)({id:r.businessObject.default.id})))&&t.updateProperties(n,{conditionExpression:void 0}),i.conditionExpression&&o.sourceRef.default===o&&t.updateProperties(r.source,{default:void 0})}))}function Ii(e,t){ia.a.call(this,e),this.preExecute("shape.delete",(function(e){var t=e.shape,n=t.parent;He(t,"bpmn:Participant")&&(e.collaborationRoot=n)}),!0),this.postExecute("shape.delete",(function(e){var n=e.collaborationRoot;n&&!n.businessObject.participants.length&&t.makeProcess()}),!0)}function Vi(e,t,n,a,i,r){a.invoke(ia.a,this),this._bpmnReplace=e,this._elementRegistry=n,this._selection=r,this.postExecuted(["elements.move"],500,(function(e){var n=e.context,a=n.newParent,i=n.newHost,r=[];Object(k.i)(n.closure.topLevel,(function(e){r=qe(e)?r.concat(e.children):r.concat(e)})),1===r.length&&i&&(a=i);var o=t.canReplace(r,a);o&&this.replaceElements(r,o.replacements,i)}),this),this.postExecute(["shape.replace"],1500,(function(e){var n,a=e.context,i=a.oldShape,r=a.newShape,o=i.attachers;o&&o.length&&(n=t.canReplace(o,r),this.replaceElements(o,n.replacements))}),this),this.postExecuted(["shape.replace"],1500,(function(e){var t=e.context,n=t.oldShape,a=t.newShape;i.unclaimId(n.businessObject.id,n.businessObject),i.updateProperties(a,{id:n.id})}))}Di.$inject=["eventBus","tooltips","translate"],S()(Li,ia.a),Li.$inject=["eventBus","modeling","bpmnRules","injector"],Ii.$inject=["eventBus","modeling"],S()(Ii,ia.a),S()(Vi,ia.a),Vi.prototype.replaceElements=function(e,t){var n=this._elementRegistry,a=this._bpmnReplace,i=this._selection;Object(k.i)(t,(function(t){var i={type:t.newElementType},r=n.get(t.oldElementId),o=e.indexOf(r);e[o]=a.replaceElement(r,i,{select:!1})})),t&&i.select(e)},Vi.$inject=["bpmnReplace","bpmnRules","elementRegistry","injector","modeling","selection"];var $i=Math.abs,zi=Math.min,Wi=Math.max;function Gi(e,t,n,a){var i=e[t];e[t]=void 0===i?n:a(n,i)}function Hi(e,t,n){return Gi(e,t,n,zi)}function Ui(e,t,n){return Gi(e,t,n,Wi)}var Ki={width:300,height:150},qi={width:140,height:120},Ji={width:50,height:30};function Yi(e){e.on("resize.start",1500,(function(e){var t=e.context,n=t.shape,a=t.direction,i=t.balanced;(He(n,"bpmn:Lane")||He(n,"bpmn:Participant"))&&(t.resizeConstraints=function(e,t,n){var a=Vn(e),i=!0,r=!0,o=Ln(a,[a]),c=Object(yt.b)(e),s={},l={};return/e/.test(t)?l.right=c.left+300:/w/.test(t)&&(l.left=c.right-300),o.forEach((function(e){var a=Object(yt.b)(e);/n/.test(t)&&(a.top<c.top-10&&(i=!1),n&&$i(c.top-a.bottom)<10&&Ui(s,"top",a.top+60),$i(c.top-a.top)<5&&Hi(l,"top",a.bottom-60)),/s/.test(t)&&(a.bottom>c.bottom+10&&(r=!1),n&&$i(c.bottom-a.top)<10&&Hi(s,"bottom",a.bottom-60),$i(c.bottom-a.bottom)<5&&Ui(l,"bottom",a.top+60))})),a.children.filter((function(e){return!e.hidden&&!e.waypoints&&(He(e,"bpmn:FlowElement")||He(e,"bpmn:Artifact"))})).forEach((function(e){var n=Object(yt.b)(e);i&&/n/.test(t)&&Hi(l,"top",n.top-20),/e/.test(t)&&Ui(l,"right",n.right+20),r&&/s/.test(t)&&Ui(l,"bottom",n.bottom+20),/w/.test(t)&&Hi(l,"left",n.left-50)})),{min:l,max:s}}(n,a,i)),He(n,"bpmn:Participant")&&(t.minDimensions=Ki),He(n,"bpmn:Loop")&&Ke(n)&&(t.minDimensions=qi),He(n,"bpmn:Conditional")&&Ke(n)&&(t.minDimensions=qi),He(n,"bpmn:TextAnnotation")&&(t.minDimensions=Ji)}))}Yi.$inject=["eventBus"];function Xi(e,t){e.on("resize.start",1501,(function(e){var t=e.context,n=t.shape;(He(n,"bpmn:Lane")||He(n,"bpmn:Participant"))&&(t.balanced=!Object(zn.a)(e))})),e.on("resize.end",1001,(function(e){var n=e.context,a=n.shape,i=n.canExecute,r=n.newBounds;if(He(a,"bpmn:Lane")||He(a,"bpmn:Participant"))return i&&(r=Object(yt.g)(r),t.resizeLane(a,r,n.balanced)),!1}))}function Qi(e,t,n){ia.a.call(this,e),this.preExecute("shape.delete",(function(e){var a=e.context.shape;if(1===a.incoming.length&&1===a.outgoing.length){var i=a.incoming[0],r=a.outgoing[0];if(He(i,"bpmn:SequenceFlow")&&He(r,"bpmn:SequenceFlow")&&t.canConnect(i.source,r.target,i)){var o=function(e,t){var n=li(Zi(e[e.length-2]),Zi(e[e.length-1]),Zi(t[1]),Zi(t[0]));return n?[].concat(e.slice(0,e.length-1),[n],t.slice(1)):[Zi(e[0]),Zi(t[t.length-1])]}(i.waypoints,r.waypoints);n.reconnectEnd(i,r.target,o)}}}))}function Zi(e){return e.original||e}function er(e){e.on("spaceTool.getMinDimensions",(function(e){var t=e.shapes,n={};return Object(k.i)(t,(function(t){var a=t.id;He(t,"bpmn:Participant")&&(n[a]=Ki),He(t,"bpmn:Loop")&&Ke(t)&&(n[a]=qi),He(t,"bpmn:Conditional")&&Ke(t)&&(e.minDimensions=qi),He(t,"bpmn:TextAnnotation")&&(n[a]=Ji)})),n}))}function tr(e,t){e.invoke(ia.a,this),this.postExecuted("shape.replace",(function(e){var n=e.context.oldShape,a=e.context.newShape;if(He(a,"bpmn:Loop")&&He(a,"bpmn:Conditional")&&He(n,"bpmn:Task")&&Ke(a)){var i,r={x:(i=a).x+i.width/6,y:i.y+i.height/2};t.createShape({type:"bpmn:StartEvent"},r,a)}}))}Xi.$inject=["eventBus","modeling"],S()(Qi,ia.a),Qi.$inject=["eventBus","bpmnRules","modeling"],er.$inject=["eventBus"],tr.$inject=["injector","modeling"],S()(tr,ia.a);function nr(e,t,n,a){ia.a.call(this,e),this.executed(["shape.toggleCollapse"],500,(function(e){var t,n=e.context.shape;He(n,"bpmn:Loop")&&(n.collapsed?Ue(n).di.isExpanded=!1:((t=n.children).length&&t.forEach((function(e){"label"!==e.type||e.businessObject.name||(e.hidden=!0)})),Ue(n).di.isExpanded=!0))})),this.reverted(["shape.toggleCollapse"],500,(function(e){var t=e.context.shape;t.collapsed?Ue(t).di.isExpanded=!1:Ue(t).di.isExpanded=!0})),this.postExecuted(["shape.toggleCollapse"],500,(function(e){var a,i=e.context.shape,r=t._getDefaultSize(i);a=i.collapsed?function(e,t){return{x:e.x+(e.width-t.width)/2,y:e.y+(e.height-t.height)/2,width:t.width,height:t.height}}(i,r):function(e,t){var n,a,i,r=e.children,o=t;return n=(i=r,i.filter((function(e){return!e.hidden}))).concat([e]),(a=Object(An.a)(n))?(o.width=Math.max(a.width,o.width),o.height=Math.max(a.height,o.height),o.x=a.x+(a.width-o.width)/2,o.y=a.y+(a.height-o.height)/2):(o.x=e.x+(e.width-o.width)/2,o.y=e.y+(e.height-o.height)/2),o}(i,r),n.resizeShape(i,a,null,{autoResize:!i.collapsed&&"nwse"})}))}function ar(e,t,n,a){t.invoke(ia.a,this),this.preExecute("shape.delete",(function(e){var t=e.context.shape,i=t.businessObject;vt(t)||(He(t,"bpmn:Participant")&&Ke(t)&&n.ids.unclaim(i.processRef.id),a.unclaimId(i.id,i))})),this.preExecute("connection.delete",(function(e){var t=e.context.connection.businessObject;a.unclaimId(t.id,t)})),this.preExecute("canvas.updateRoot",(function(){var t=e.getRootElement().businessObject;n.ids.unclaim(t.id)}))}S()(nr,ia.a),nr.$inject=["eventBus","elementFactory","modeling"],S()(ar,ia.a),ar.$inject=["canvas","injector","moddle","modeling"];function ir(e,t,n){var a;function i(){if(!a)throw new Error(n("out of bounds release"));return a}ia.a.call(this,e);var r=["spaceTool","lane.add","lane.resize","lane.split","elements.create","elements.delete","elements.move","shape.create","shape.delete","shape.move","shape.resize"];this.preExecute(r,5e3,(function(e){(a=a||new rr).enter()})),this.postExecuted(r,500,(function(e){!function(){if(!a)throw new Error(n("out of bounds release"));var e=a.leave();e&&(t.updateLaneRefs(a.flowNodes,a.lanes),a=null)}()})),this.preExecute(["shape.create","shape.move","shape.delete","shape.resize"],(function(e){var t=e.context.shape,n=i();t.labelTarget||(He(t,"bpmn:Lane")&&n.addLane(t),He(t,"bpmn:FlowNode")&&n.addFlowNode(t))}))}function rr(){this.flowNodes=[],this.lanes=[],this.counter=0,this.addLane=function(e){this.lanes.push(e)},this.addFlowNode=function(e){this.flowNodes.push(e)},this.enter=function(){this.counter++},this.leave=function(){return this.counter--,!this.counter}}function or(e,t){ia.a.call(this,e),this.preExecute("connection.delete",(function(e){var n=e.context.connection,a=n.source;(function(e,t){if(!He(e,"bpmn:SequenceFlow"))return!1;var n=Ue(t),a=Ue(e);return n.get("default")===a})(n,a)&&t.updateProperties(a,{default:null})}))}ir.$inject=["eventBus","modeling","translate"],S()(ir,ia.a),S()(or,ia.a),or.$inject=["eventBus","modeling"];var cr={__init__:["adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","rootElementReferenceBehavior","createBehavior","fixHoverBehavior","createDataObjectBehavior","createParticipantBehavior","dataStoreBehavior","dataInputAssociationBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","groupBehavior","importDockingFix","isHorizontalFix","labelBehavior","modelingFeedback","removeElementBehavior","removeParticipantBehavior","replaceConnectionBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","toggleElementCollapseBehaviour","spaceToolBehavior","subProcessStartEventBehavior","unclaimIdBehavior","unsetDefaultFlowBehavior","updateFlowNodeRefsBehavior"],adaptiveLabelPositioningBehavior:["type",Pa],appendBehavior:["type",Ra],associationBehavior:["type",Aa],attachEventBehavior:["type",Fa],boundaryEventBehavior:["type",Da],rootElementReferenceBehavior:["type",La],createBehavior:["type",Ia],fixHoverBehavior:["type",$a],createDataObjectBehavior:["type",za],createParticipantBehavior:["type",Ua],dataInputAssociationBehavior:["type",Ja],dataStoreBehavior:["type",Qa],deleteLaneBehavior:["type",Za],detachEventBehavior:["type",ei],dropOnFlowBehavior:["type",ai],eventBasedGatewayBehavior:["type",oi],groupBehavior:["type",si],importDockingFix:["type",ui],isHorizontalFix:["type",di],labelBehavior:["type",Fi],modelingFeedback:["type",Di],replaceConnectionBehavior:["type",Li],removeParticipantBehavior:["type",Ii],replaceElementBehaviour:["type",Vi],resizeBehavior:["type",Yi],resizeLaneBehavior:["type",Xi],removeElementBehavior:["type",Qi],toggleElementCollapseBehaviour:["type",nr],spaceToolBehavior:["type",er],subProcessStartEventBehavior:["type",tr],unclaimIdBehavior:["type",ar],updateFlowNodeRefsBehavior:["type",ir],unsetDefaultFlowBehavior:["type",or]},sr=n(44),lr=n(86);function ur(e,t){var n=Object(yt.f)(e,t,-15);return"intersect"!==n?n:null}function pr(e){lr.a.call(this,e)}function dr(e){return!e||vt(e)}function mr(e){do{if(He(e,"bpmn:Process-action"))return Ue(e);if(He(e,"bpmn:Participant"))return Ue(e).processRef||Ue(e)}while(e=e.parent)}function fr(e){return He(e,"bpmn:TextAnnotation")}function br(e){return He(e,"bpmn:Group")&&!e.labelTarget}function hr(e){return He(e,"bpmn:BoundaryEvent")&&gr(e,"bpmn:CompensateEventDefinition")}function vr(e){return Ue(e).isForCompensation}function yr(e){for(var t=e;t=t.parent;){if(He(t,"bpmn:FlowElementsContainer"))return Ue(t);if(He(t,"bpmn:Participant"))return Ue(t).processRef}return null}function gr(e,t){var n=Ue(e);return!!Object(k.f)(n.eventDefinitions||[],(function(e){return He(e,t)}))}function jr(e,t){return(Ue(e).eventDefinitions||[]).every((function(e){return He(e,t)}))}function xr(e){return He(e,"bpmn:ReceiveTask")||He(e,"bpmn:IntermediateCatchEvent")&&(gr(e,"bpmn:MessageEventDefinition")||gr(e,"bpmn:TimerEventDefinition")||gr(e,"bpmn:ConditionalEventDefinition")||gr(e,"bpmn:SignalEventDefinition"))}function Or(e){return e.waypoints}function wr(e,t){return-1!==function(e){for(var t=[];e;)(e=e.parent)&&t.push(e);return t}(t).indexOf(e)}function Er(e,t,n){if(dr(e)||dr(t))return null;if(!He(n,"bpmn:DataAssociation")){if(Br(e,t))return{type:"bpmn:MessageFlow"};if(Dr(e,t))return{type:"bpmn:SequenceFlow"}}var a=Lr(e,t);return a||(hr(e)&&vr(t)?{type:"bpmn:Association",associationDirection:"One"}:!!Fr(e,t)&&{type:"bpmn:Association"})}function Nr(e,t,n){return!(!vt(e)&&!br(e))||!(He(t,"bpmn:Participant")&&!Ke(t))&&(He(e,"bpmn:Participant")?He(t,"bpmn:Process-action")||He(t,"bpmn:Collaboration"):Rt(e,["bpmn:DataInput","bpmn:DataOutput"])&&e.parent?t===e.parent:He(e,"bpmn:Lane")?He(t,"bpmn:Participant")||He(t,"bpmn:Lane"):!(He(e,"bpmn:BoundaryEvent")&&(a=e,!Ue(a).cancelActivity||!_r(a)&&!kr(a)))&&(He(e,"bpmn:FlowElement")&&!He(e,"bpmn:DataStoreReference")?He(t,"bpmn:FlowElementsContainer")?Ke(t):Rt(t,["bpmn:Participant","bpmn:Lane"]):Rt(e,["bpmn:Artifact","bpmn:DataAssociation","bpmn:DataStoreReference"])?Rt(t,["bpmn:Collaboration","bpmn:Lane","bpmn:Participant","bpmn:Process-action","bpmn:Loop","bpmn:Conditional"]):!!He(e,"bpmn:MessageFlow")&&(He(t,"bpmn:Collaboration")||e.source.parent===t||e.target.parent===t)));var a}function Cr(e){return He(e,"bpmn:Lane")}function Sr(e){return!!function(e){return!vt(e)&&He(e,"bpmn:BoundaryEvent")}(e)||(!(!He(e,"bpmn:IntermediateThrowEvent")||!_r(e))||He(e,"bpmn:IntermediateCatchEvent")&&kr(e))}function _r(e){var t=Ue(e);return t&&!(t.eventDefinitions&&t.eventDefinitions.length)}function kr(e){return function(e,t){return t.some((function(t){return gr(e,t)}))}(e,["bpmn:MessageEventDefinition","bpmn:TimerEventDefinition","bpmn:SignalEventDefinition","bpmn:ConditionalEventDefinition"])}function Mr(e,t,n,a){if(Array.isArray(e)||(e=[e]),1!==e.length)return!1;var i=e[0];return!vt(i)&&(!!Sr(i)&&(!qe(t)&&(!(!He(t,"bpmn:Activity")||vr(t))&&(!(a&&!ur(a,t))&&(!function(e){return He(e,"bpmn:ReceiveTask")&&Object(k.f)(e.incoming,(function(e){return He(e.source,"bpmn:EventBasedGateway")}))}(t)&&"attach")))))}function Pr(e,t,n){if(!t)return!1;var a={replacements:[]};return Object(k.i)(e,(function(e){qe(t)||He(e,"bpmn:StartEvent")&&"label"!==e.type&&Nr(e,t)&&(function(e){return e&&!1!==Ue(e).isInterrupting}(e)||a.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"}),(function(e){return Je(e,"bpmn:ErrorEventDefinition")}(e)||function(e){return Je(e,"bpmn:EscalationEventDefinition")}(e)||function(e){return Je(e,"bpmn:CompensateEventDefinition")}(e))&&a.replacements.push({oldElementId:e.id,newElementType:"bpmn:StartEvent"})),He(t,"bpmn:Transaction")||gr(e,"bpmn:CancelEventDefinition")&&"label"!==e.type&&(He(e,"bpmn:EndEvent")&&Nr(e,t)&&a.replacements.push({oldElementId:e.id,newElementType:"bpmn:EndEvent"}),He(e,"bpmn:BoundaryEvent")&&Mr(e,t,0,n)&&a.replacements.push({oldElementId:e.id,newElementType:"bpmn:BoundaryEvent"}))})),!!a.replacements.length&&a}function Tr(e,t){return!Object(k.A)(e,Cr)&&(!t||e.every((function(e){return Nr(e,t)})))}function Rr(e,t,n,a){return!!t&&(!(!vt(e)&&!br(e))||n!==t&&((!n||!wr(n,t))&&(Nr(e,t)||Ir(e,t,a))))}function Ar(e,t){return He(e,"bpmn:Loop")||He(e,"bpmn:Conditional")?Ke(e)&&(!t||t.width>=100&&t.height>=80):He(e,"bpmn:Lane")?!t||t.width>=130&&t.height>=60:He(e,"bpmn:Participant")?!t||t.width>=250&&t.height>=50:!!fr(e)||!!br(e)}function Fr(e,t){return!Or(e)&&!Or(t)&&(!(!hr(e)||!vr(t))||!wr(t,e)&&!wr(e,t)&&(!!function(e,t){var n=fr(e),a=fr(t);return(n||a)&&n!==a}(e,t)||!!Lr(e,t)))}function Br(e,t){return!(zr(e)&&!zr(t))&&(He(a=e,"bpmn:InteractionNode")&&(!He(a,"bpmn:Event")||He(a,"bpmn:ThrowEvent")&&jr(a,"bpmn:MessageEventDefinition"))&&function(e){return He(e,"bpmn:InteractionNode")&&!vr(e)&&(!He(e,"bpmn:Event")||He(e,"bpmn:CatchEvent")&&jr(e,"bpmn:MessageEventDefinition"))}(t)&&(n=t,!(mr(e)===mr(n))));var n,a}function Dr(e,t){return!(xr(t)&&t.incoming.length>0&&(n=t.incoming,(n=n||[]).some($r))&&!He(e,"bpmn:EventBasedGateway"))&&(He(i=e,"bpmn:FlowNode")&&!He(i,"bpmn:EndEvent")&&!qe(i)&&!(He(i,"bpmn:IntermediateThrowEvent")&&gr(i,"bpmn:LinkEventDefinition"))&&!hr(i)&&!vr(i)&&function(e){return He(e,"bpmn:FlowNode")&&!He(e,"bpmn:StartEvent")&&!He(e,"bpmn:BoundaryEvent")&&!qe(e)&&!(He(e,"bpmn:IntermediateCatchEvent")&&gr(e,"bpmn:LinkEventDefinition"))&&!vr(e)}(t)&&(a=t,yr(e)===yr(a))&&!(He(e,"bpmn:EventBasedGateway")&&!xr(t)));var n,a,i}function Lr(e,t){return Rt(e,["bpmn:DataObjectReference","bpmn:DataStoreReference"])&&Rt(t,["bpmn:Activity","bpmn:ThrowEvent"])?{type:"bpmn:DataInputAssociation"}:!(!Rt(t,["bpmn:DataObjectReference","bpmn:DataStoreReference"])||!Rt(e,["bpmn:Activity","bpmn:CatchEvent"]))&&{type:"bpmn:DataOutputAssociation"}}function Ir(e,t,n){if(!t)return!1;if(Array.isArray(e)){if(1!==e.length)return!1;e=e[0]}return t.source!==e&&t.target!==e&&(Rt(t,["bpmn:SequenceFlow","bpmn:MessageFlow"])&&!vt(t)&&He(e,"bpmn:FlowNode")&&!He(e,"bpmn:BoundaryEvent")&&Nr(e,t.parent))}function Vr(e,t){return!!vt(t)||!(He(t,"bpmn:Lane")&&!function(e,t){return e&&t&&-1!==e.indexOf(t)}(e,t.parent))}function $r(e){if(e&&e.source)return He(e.source,"bpmn:EventBasedGateway")}function zr(e){return At(e,"bpmn:Process-action")||At(e,"bpmn:Collaboration")}S()(pr,lr.a),pr.$inject=["eventBus"],pr.prototype.init=function(){this.addRule("connection.start",(function(e){return function(e){if(dr(e))return null;return Rt(e,["bpmn:FlowNode","bpmn:InteractionNode","bpmn:DataObjectReference","bpmn:DataStoreReference"])}(e.source)})),this.addRule("connection.create",(function(e){var t=e.source,n=e.target,a=e.hints||{},i=a.targetParent;if(a.targetAttach)return!1;i&&(n.parent=i);try{return Er(t,n)}finally{i&&(n.parent=null)}})),this.addRule("connection.reconnect",(function(e){var t=e.connection;return Er(e.source,e.target,t)})),this.addRule("connection.updateWaypoints",(function(e){return{type:e.connection.type}})),this.addRule("shape.resize",(function(e){return Ar(e.shape,e.newBounds)})),this.addRule("elements.create",(function(e){var t=e.elements,n=e.position,a=e.target;return Object(k.d)(t,(function(e){return Or(e)?Er(e.source,e.target,e):e.host?Mr(e,e.host,null,n):Rr(e,a,null,n)}))})),this.addRule("elements.move",(function(e){var t=e.target,n=e.shapes,a=e.position;return Mr(n,t,null,a)||Pr(n,t,a)||Tr(n,t)||Ir(n,t,a)})),this.addRule("shape.create",(function(e){return Rr(e.shape,e.target,e.source,e.position)})),this.addRule("shape.attach",(function(e){return Mr(e.shape,e.target,null,e.position)})),this.addRule("element.copy",(function(e){var t=e.element;return Vr(e.elements,t)}))},pr.prototype.canConnectMessageFlow=Br,pr.prototype.canConnectSequenceFlow=Dr,pr.prototype.canConnectDataAssociation=Lr,pr.prototype.canConnectAssociation=Fr,pr.prototype.canMove=Tr,pr.prototype.canAttach=Mr,pr.prototype.canReplace=Pr,pr.prototype.canDrop=Nr,pr.prototype.canInsert=Ir,pr.prototype.canCreate=Rr,pr.prototype.canConnect=Er,pr.prototype.canResize=Ar,pr.prototype.canCopy=Vr;var Wr={__depends__:[sr.a],__init__:["bpmnRules"],bpmnRules:["type",pr]};function Gr(e,t){e.on("saveXML.start",2e3,(function(){var e,n,a=t.getRootElement(),i=Ue(a).di;e=Object(Xn.h)([a],!1),e=Object(k.e)(e,(function(e){return e!==a&&!e.labelTarget})),n=Object(k.u)(e,Ze),i.set("planeElement",n)}))}Gr.$inject=["eventBus","canvas"];var Hr={__init__:["bpmnDiOrdering"],bpmnDiOrdering:["type",Gr]},Ur=n(191);function Kr(e,t,n){Ur.a.call(this,e);var a=[{type:"bpmn:Loop",order:{level:6}},{type:"bpmn:SequenceFlow",order:{level:3,containers:["bpmn:Participant","bpmn:FlowElementsContainer"]}},{type:"bpmn:DataAssociation",order:{level:9,containers:["bpmn:Collaboration","bpmn:Process-action"]}},{type:"bpmn:MessageFlow",order:{level:9,containers:["bpmn:Collaboration"]}},{type:"bpmn:Association",order:{level:6,containers:["bpmn:Participant","bpmn:FlowElementsContainer","bpmn:Collaboration"]}},{type:"bpmn:BoundaryEvent",order:{level:8}},{type:"bpmn:Group",order:{level:10,containers:["bpmn:Collaboration","bpmn:Process-action"]}},{type:"bpmn:FlowElement",order:{level:5}},{type:"bpmn:Participant",order:{level:-2}},{type:"bpmn:Lane",order:{level:-1}}];function i(e){var t=e.order;return t||(e.order=t=function(e){if(e.labelTarget)return{level:10};var t=Object(k.f)(a,(function(t){return Rt(e,[t.type])}));return t&&t.order||{level:1}}(e)),t}this.getOrdering=function(e,a){if(e.labelTarget)return{parent:t.getRootElement(),index:-1};var r=i(e);r.containers&&(a=function(e,t,a){for(var i=t;i&&!Rt(i,a);)i=i.parent;if(!i)throw new Error(n("no parent for {element} in {parent}",{element:e.id,parent:t.id}));return i}(e,a,r.containers));var o=a.children.indexOf(e),c=Object(k.g)(a.children,(function(t){return!(!e.labelTarget&&t.labelTarget)&&r.level<i(t).level}));return-1!==c&&-1!==o&&o<c&&(c-=1),{index:c,parent:a}}}Kr.$inject=["eventBus","canvas","translate"],S()(Kr,Ur.a);var qr={__depends__:[pt.a],__init__:["bpmnOrderingProvider"],bpmnOrderingProvider:["type",Kr]},Jr=n(231),Yr=n(232),Xr=n(233),Qr=n(234),Zr=n(171);function eo(e){this._model=e}eo.$inject=["moddle"],eo.prototype._needsId=function(e){return Rt(e,["bpmn:RootElement","bpmn:FlowElement","bpmn:MessageFlow","bpmn:DataAssociation","bpmn:Artifact","bpmn:Participant","bpmn:Lane","bpmn:LaneSet","bpmn:Process-action","bpmn:Collaboration","bpmndi:BPMNShape","bpmndi:BPMNEdge","bpmndi:BPMNDiagram","bpmndi:BPMNPlane","bpmn:Property","bpmn:CategoryValue"])},eo.prototype._ensureId=function(e){var t;t=He(e,"bpmn:Mapper")?"Mapper":He(e,"bpmn:Query")?"Query":He(e,"bpmn:Function")?"Function":He(e,"bpmn:Loop")?"Loop":He(e,"bpmn:Conditional")?"Condition":He(e,"bpmn:Activity")?"Activity":He(e,"bpmn:Event")?"Event":He(e,"bpmn:Gateway")?"Gateway":Rt(e,["bpmn:SequenceFlow","bpmn:MessageFlow"])?"Flow":(e.$type||"").replace(/^[^:]*:/g,""),t+="_",!e.id&&this._needsId(e)&&(e.id=this._model.ids.nextPrefixed(t,e))},eo.prototype.create=function(e,t){var n=this._model.create(e,t||{});return this._ensureId(n),n},eo.prototype.createDiLabel=function(){return this.create("bpmndi:BPMNLabel",{bounds:this.createDiBounds()})},eo.prototype.createDiShape=function(e,t,n){return this.create("bpmndi:BPMNShape",Object(k.a)({bpmnElement:e,bounds:this.createDiBounds(t)},n))},eo.prototype.createDiBounds=function(e){return this.create("dc:Bounds",e)},eo.prototype.createDiWaypoints=function(e){var t=this;return Object(k.u)(e,(function(e){return t.createDiWaypoint(e)}))},eo.prototype.createDiWaypoint=function(e){return this.create("dc:Point",Object(k.x)(e,["x","y"]))},eo.prototype.createDiEdge=function(e,t,n){return this.create("bpmndi:BPMNEdge",Object(k.a)({bpmnElement:e},n))},eo.prototype.createDiPlane=function(e){return this.create("bpmndi:BPMNPlane",{bpmnElement:e})};var to=n(106);function no(e,t,n,a){ia.a.call(this,e),this._bpmnFactory=t,this._translate=a;var i=this;function r(e){var t=e.context.oldRoot.children;Object(k.i)(t,(function(e){He(e,"bpmn:BaseElement")&&i.updateParent(e)}))}function o(e){var t=e.context.shape;He(t,"bpmn:BaseElement")&&i.updateBounds(t)}function c(e){i.updateConnection(e.context)}function s(e){i.updateConnectionWaypoints(e.context.connection)}function l(e){i.updateAttachment(e.context)}this.executed(["connection.layout","connection.create"],(function(e){var t,a=e.context,i=a.hints||{};a.cropped||!1===i.createElementsBehavior||((t=a.connection).waypoints=n.getCroppedWaypoints(t),a.cropped=!0)})),this.reverted(["connection.layout"],(function(e){delete e.context.cropped})),this.executed(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],ao((function(e){var t=e.context;i.updateParent(t.shape||t.connection,t.oldParent)}))),this.reverted(["shape.move","shape.create","shape.delete","connection.create","connection.move","connection.delete"],ao((function(e){var t=e.context,n=t.shape||t.connection,a=t.parent||t.newParent;i.updateParent(n,a)}))),this.executed(["canvas.updateRoot"],r),this.reverted(["canvas.updateRoot"],r),this.executed(["shape.move","shape.create","shape.resize"],ao((function(e){"label"!==e.context.shape.type&&o(e)}))),this.reverted(["shape.move","shape.create","shape.resize"],ao((function(e){"label"!==e.context.shape.type&&o(e)}))),e.on("shape.changed",(function(e){"label"===e.element.type&&o({context:{shape:e.element}})})),this.executed(["connection.create","connection.move","connection.delete","connection.reconnect"],ao(c)),this.reverted(["connection.create","connection.move","connection.delete","connection.reconnect"],ao(c)),this.executed(["connection.layout","connection.move","connection.updateWaypoints"],ao(s)),this.reverted(["connection.layout","connection.move","connection.updateWaypoints"],ao(s)),this.executed("connection.reconnect",ao((function(e){var t=e.context,n=t.connection,a=t.oldSource,i=t.newSource,r=Ue(n),o=Ue(a),c=Ue(i);r.conditionExpression&&!Rt(c,["bpmn:Activity","bpmn:ExclusiveGateway","bpmn:InclusiveGateway"])&&(t.oldConditionExpression=r.conditionExpression,delete r.conditionExpression),a!==i&&o.default===r&&(t.oldDefault=o.default,delete o.default)}))),this.reverted("connection.reconnect",ao((function(e){var t=e.context,n=t.connection,a=t.oldSource,i=t.newSource,r=Ue(n),o=Ue(a),c=Ue(i);t.oldConditionExpression&&(r.conditionExpression=t.oldConditionExpression),t.oldDefault&&(o.default=t.oldDefault,delete c.default)}))),this.executed(["element.updateAttachment"],ao(l)),this.reverted(["element.updateAttachment"],ao(l))}function ao(e){return function(t){var n=t.context;He(n.shape||n.connection,"bpmn:BaseElement")&&e(t)}}S()(no,ia.a),no.$inject=["eventBus","bpmnFactory","connectionDocking","translate"],no.prototype.updateAttachment=function(e){var t=e.shape,n=t.businessObject,a=t.host;n.attachedToRef=a&&a.businessObject},no.prototype.updateParent=function(e,t){if(!(e instanceof to.b)&&!(He(e,"bpmn:DataStoreReference")&&e.parent&&He(e.parent,"bpmn:Collaboration"))){var n=e.parent,a=e.businessObject,i=n&&n.businessObject,r=i&&i.di;He(e,"bpmn:FlowNode")&&this.updateFlowNodeRefs(a,i,t&&t.businessObject),He(e,"bpmn:DataOutputAssociation")&&(i=e.source?e.source.businessObject:null),He(e,"bpmn:DataInputAssociation")&&(i=e.target?e.target.businessObject:null),this.updateSemanticParent(a,i),He(e,"bpmn:DataObjectReference")&&a.dataObjectRef&&this.updateSemanticParent(a.dataObjectRef,i),this.updateDiParent(a.di,r)}},no.prototype.updateBounds=function(e){var t=e.businessObject.di,n=e instanceof to.b?this._getLabel(t):t,a=n.bounds;a||(a=this._bpmnFactory.createDiBounds(),n.set("bounds",a)),Object(k.a)(a,{x:e.x,y:e.y,width:e.width,height:e.height})},no.prototype.updateFlowNodeRefs=function(e,t,n){var a,i;n!==t&&(He(n,"bpmn:Lane")&&(a=n.get("flowNodeRef"),Object(ga.c)(a,e)),He(t,"bpmn:Lane")&&(i=t.get("flowNodeRef"),Object(ga.a)(i,e)))},no.prototype.updateDiConnection=function(e,t,n){e.sourceElement&&e.sourceElement.bpmnElement!==t&&(e.sourceElement=t&&t.di),e.targetElement&&e.targetElement.bpmnElement!==n&&(e.targetElement=n&&n.di)},no.prototype.updateDiParent=function(e,t){if(t&&!He(t,"bpmndi:BPMNPlane")&&(t=t.$parent),e.$parent!==t){var n=(t||e.$parent).get("planeElement");t?(n.push(e),e.$parent=t):(Object(ga.c)(n,e),e.$parent=null)}},no.prototype.getLaneSet=function(e){var t,n;return He(e,"bpmn:Lane")?((t=e.childLaneSet)||(t=this._bpmnFactory.create("bpmn:LaneSet"),e.childLaneSet=t,t.$parent=e),t):(He(e,"bpmn:Participant")&&(e=e.processRef),(t=(n=e.get("laneSets"))[0])||((t=this._bpmnFactory.create("bpmn:LaneSet")).$parent=e,n.push(t)),t)},no.prototype.updateSemanticParent=function(e,t,n){var a,i=this._translate;if(e.$parent!==t&&(!He(e,"bpmn:DataInput")&&!He(e,"bpmn:DataOutput")||(He(t,"bpmn:Participant")&&"processRef"in t&&(t=t.processRef),!("ioSpecification"in t)||t.ioSpecification!==e.$parent))){if(He(e,"bpmn:Lane"))t&&(t=this.getLaneSet(t)),a="lanes";else if(He(e,"bpmn:FlowElement")){if(t)if(He(t,"bpmn:Participant"))t=t.processRef;else if(He(t,"bpmn:Lane"))do{t=t.$parent.$parent}while(He(t,"bpmn:Lane"));a="flowElements"}else if(He(e,"bpmn:Artifact")){for(;t&&!He(t,"bpmn:Process-action")&&!He(t,"bpmn:Loop")&&!He(t,"bpmn:Conditional")&&!He(t,"bpmn:Collaboration");){if(He(t,"bpmn:Participant")){t=t.processRef;break}t=t.$parent}a="artifacts"}else if(He(e,"bpmn:MessageFlow"))a="messageFlows";else if(He(e,"bpmn:Participant")){a="participants";var r,o=e.processRef;o&&(r=function(e){for(;e&&!He(e,"bpmn:Process-actions");)e=e.$parent;return e}(e.$parent||t),e.$parent&&(Object(ga.c)(r.get("rootElements"),o),o.$parent=null),t&&(Object(ga.a)(r.get("rootElements"),o),o.$parent=r))}else He(e,"bpmn:DataOutputAssociation")?a="dataOutputAssociations":He(e,"bpmn:DataInputAssociation")&&(a="dataInputAssociations");if(!a)throw new Error(i("no parent for {element} in {parent}",{element:e.id,parent:t.id}));var c;if(e.$parent&&(c=e.$parent.get(a),Object(ga.c)(c,e)),t?((c=t.get(a)).push(e),e.$parent=t):e.$parent=null,n){var s=n.get(a);Object(ga.c)(c,e),t&&(s||(s=[],t.set(a,s)),s.push(e))}}},no.prototype.updateConnectionWaypoints=function(e){e.businessObject.di.set("waypoint",this._bpmnFactory.createDiWaypoints(e.waypoints))},no.prototype.updateConnection=function(e){var t,n=e.connection,a=Ue(n),i=Ue(n.source),r=Ue(n.target);if(He(a,"bpmn:DataAssociation"))He(a,"bpmn:DataInputAssociation")?(a.get("sourceRef")[0]=i,t=e.parent||e.newParent||r,this.updateSemanticParent(a,r,t)):He(a,"bpmn:DataOutputAssociation")&&(t=e.parent||e.newParent||i,this.updateSemanticParent(a,i,t),a.targetRef=r);else{var o=He(a,"bpmn:SequenceFlow");a.sourceRef!==i&&(o&&(Object(ga.c)(a.sourceRef&&a.sourceRef.get("outgoing"),a),i&&i.get("outgoing")&&i.get("outgoing").push(a)),a.sourceRef=i),a.targetRef!==r&&(o&&(Object(ga.c)(a.targetRef&&a.targetRef.get("incoming"),a),r&&r.get("incoming")&&r.get("incoming").push(a)),a.targetRef=r)}this.updateConnectionWaypoints(n),this.updateDiConnection(a.di,i,r)},no.prototype._getLabel=function(e){return e.label||(e.label=this._bpmnFactory.createDiLabel()),e.label};var io=n(124);function ro(e,t,n){io.a.call(this),this._bpmnFactory=e,this._moddle=t,this._translate=n}function oo(e,t,n){e[n]=t[n],delete t[n]}S()(ro,io.a),ro.$inject=["bpmnFactory","moddle","translate"],ro.prototype.baseCreate=io.a.prototype.create,ro.prototype.create=function(e,t){return"label"===e?this.baseCreate(e,Object(k.a)({type:"label"},dt,t)):this.createBpmnElement(e,t)},ro.prototype.createBpmnElement=function(e,t){var n,a,i,r=this._translate,o=(t=t||{}).businessObject;if(!o){if(!t.type)throw new Error(r("no shape type specified"));o=this._bpmnFactory.create(t.type)}return o.di||(o.di="root"===e?this._bpmnFactory.createDiPlane(o,[],{id:o.id+"_di"}):"connection"===e?this._bpmnFactory.createDiEdge(o,[],{id:o.id+"_di"}):this._bpmnFactory.createDiShape(o,{},{id:o.id+"_di"})),He(o,"bpmn:Group")&&(t=Object(k.a)({isFrame:!0},t)),t.di&&(Object(k.a)(o.di,t.di),delete t.di),function(e,t,n){Object(k.i)(n,(function(n){void 0!==t[n]&&oo(e,t,n)}))}(o,t,["processRef","isInterrupting","associationDirection","isForCompensation"]),t.isExpanded&&oo(o.di,t,"isExpanded"),He(o,"bpmn:ExclusiveGateway")&&(o.di.isMarkerVisible=!0),He(o,"bpmn:Query")&&(o.di.isMarkerVisible=!0),t.eventDefinitionType&&(a=o.get("eventDefinitions")||[],i=this._bpmnFactory.create(t.eventDefinitionType),"bpmn:ConditionalEventDefinition"===t.eventDefinitionType&&(i.condition=this._bpmnFactory.create("bpmn:FormalExpression")),a.push(i),i.$parent=o,o.eventDefinitions=a,delete t.eventDefinitionType),n=this._getDefaultSize(o),t=Object(k.a)({businessObject:o,id:o.id},n,t),this.baseCreate(e,t)},ro.prototype._getDefaultSize=function(e){return He(e,"bpmn:Loop")||He(e,"bpmn:Conditional")?Ke(e)?{width:350,height:200}:{width:100,height:80}:He(e,"bpmn:Task")?{width:100,height:80}:He(e,"bpmn:Gateway")?{width:50,height:50}:He(e,"bpmn:Event")?{width:36,height:36}:He(e,"bpmn:Participant")?Ke(e)?{width:600,height:250}:{width:400,height:60}:He(e,"bpmn:Lane")?{width:400,height:100}:He(e,"bpmn:DataObjectReference")?{width:36,height:50}:He(e,"bpmn:DataStoreReference")?{width:50,height:50}:He(e,"bpmn:TextAnnotation")?{width:100,height:30}:He(e,"bpmn:Group")?{width:300,height:300}:{width:100,height:80}},ro.prototype.createParticipantShape=function(e){return Object(k.q)(e)||(e={isExpanded:e}),!1!==(e=Object(k.a)({type:"bpmn:Participant"},e||{})).isExpanded&&(e.processRef=this._bpmnFactory.create("bpmn:Process-action")),this.createShape(e)};var co=n(177),so="default",lo="id",uo="di",po={width:0,height:0};function mo(e,t,n,a,i){this._elementRegistry=e,this._moddle=t,this._translate=n,this._modeling=a,this._textRenderer=i}function fo(e,t){return lo in e&&e.id!==t.id}function bo(e,t){Object(k.i)(t,(function(t,n){n!==uo?e.set(n,t):e.di&&function(e,t){Object(k.i)(t,(function(t,n){e.set(n,t)}))}(e.di,t)}))}mo.$inject=["elementRegistry","moddle","translate","modeling","textRenderer"],mo.prototype.execute=function(e){var t=e.element,n=[t],a=this._translate;if(!t)throw new Error(a("element required"));var i=this._elementRegistry,r=this._moddle.ids,o=t.businessObject,c=function(e){var t=Object(k.a)({},e);return ho.forEach((function(n){n in e&&(t[n]=Ue(t[n]))})),t}(e.properties),s=e.oldProperties||function(e,t){var n=Object(k.t)(t);return Object(k.y)(n,(function(n,a){return n[a]=a!==uo?e.get(a):function(e,t){return Object(k.y)(t,(function(t,n){return t[n]=e.get(n),t}),{})}(e.di,Object(k.t)(t.di)),n}),{})}(o,c);return fo(c,o)&&(r.unclaim(o.id),i.updateId(t,c.id),r.claim(c.id,o)),so in c&&(c.default&&n.push(i.get(c.default.id)),o.default&&n.push(i.get(o.default.id))),bo(o,c),e.oldProperties=s,e.changed=n,n},mo.prototype.postExecute=function(e){var t=e.element.label,n=t&&Ue(t).name;if(n){var a=this._textRenderer.getExternalLabelBounds(t,n);this._modeling.resizeShape(t,a,po)}},mo.prototype.revert=function(e){var t=e.element,n=e.properties,a=e.oldProperties,i=t.businessObject,r=this._elementRegistry,o=this._moddle.ids;return bo(i,a),fo(n,i)&&(o.unclaim(n.id),r.updateId(t,a.id),o.claim(a.id,i)),e.changed};var ho=["default"];function vo(e,t){this._canvas=e,this._modeling=t}function yo(e,t){this._modeling=e,this._spaceTool=t}function go(e,t){this._modeling=e,this._translate=t}function jo(e,t){this._modeling=e,this._spaceTool=t}vo.$inject=["canvas","modeling"],vo.prototype.execute=function(e){var t=this._canvas,n=e.newRoot,a=n.businessObject,i=t.getRootElement(),r=i.businessObject,o=r.$parent,c=r.di;t.setRootElement(n,!0),Object(ga.a)(o.rootElements,a),a.$parent=o,Object(ga.c)(o.rootElements,r),r.$parent=null,r.di=null,c.bpmnElement=a,a.di=c,e.oldRoot=i},vo.prototype.revert=function(e){var t=this._canvas,n=e.newRoot.businessObject,a=e.oldRoot,i=a.businessObject,r=n.$parent,o=n.di;t.setRootElement(a,!0),Object(ga.c)(r.rootElements,n),n.$parent=null,Object(ga.a)(r.rootElements,i),i.$parent=r,n.di=null,o.bpmnElement=i,i.di=o},yo.$inject=["modeling","spaceTool"],yo.prototype.preExecute=function(e){var t=this._spaceTool,n=this._modeling,a=e.shape,i=e.location,r=Vn(a),o=r===a,c=o?a:a.parent;In(c).length||n.createShape({type:"bpmn:Lane"},{x:a.x+Dn,y:a.y,width:a.width-Dn,height:a.height},c);var s=[];Object(Xn.a)(r,(function(e){return s.push(e),e.label&&s.push(e.label),e===a?[]:Object(k.e)(e.children,(function(e){return e!==a}))}));var l="top"===i?-120:120,u="top"===i?a.y:a.y+a.height,p=u+("top"===i?10:-10),d="top"===i?"n":"s",m=t.calculateAdjustments(s,"y",l,p);t.makeSpace(m.movingShapes,m.resizingShapes,{x:0,y:l},d,p),e.newLane=n.createShape({type:"bpmn:Lane"},{x:a.x+(o?Dn:0),y:u-("top"===i?120:0),width:a.width-(o?Dn:0),height:120},c)},go.$inject=["modeling","translate"],go.prototype.preExecute=function(e){var t=this._modeling,n=this._translate,a=e.shape,i=e.count,r=In(a),o=r.length;if(o>i)throw new Error(n("more than {count} child lanes",{count:i}));var c,s,l,u,p,d=Math.round(a.height/i);for(p=0;p<i;p++)c=a.y+p*d,s=p===i-1?a.height-d*p:d,l={x:a.x+Dn,y:c,width:a.width-Dn,height:s},p<o?t.resizeShape(r[p],l):(u={type:"bpmn:Lane"},t.createShape(u,l,a))},jo.$inject=["modeling","spaceTool"],jo.prototype.preExecute=function(e){var t=e.shape,n=e.newBounds;!1!==e.balanced?this.resizeBalanced(t,n):this.resizeSpace(t,n)},jo.prototype.resizeBalanced=function(e,t){var n=this._modeling,a=$n(e,t);n.resizeShape(e,t),a.forEach((function(e){n.resizeShape(e.shape,e.newBounds)}))},jo.prototype.resizeSpace=function(e,t){var n,a,i,r,o,c=this._spaceTool,s=Object(yt.b)(e),l=Object(yt.b)(t),u=Object(An.f)(l,s),p=Vn(e),d=[],m=[];Object(Xn.a)(p,(function(e){return d.push(e),(He(e,"bpmn:Lane")||He(e,"bpmn:Participant"))&&m.push(e),e.children})),(u.bottom||u.top)&&(n=u.bottom||u.top,a=e.y+(u.bottom?e.height:0)+(u.bottom?-10:10),i=u.bottom?"s":"n",r=u.top>0||u.bottom<0?-n:n,o=c.calculateAdjustments(d,"y",r,a),c.makeSpace(o.movingShapes,o.resizingShapes,{x:0,y:n},i)),(u.left||u.right)&&(n=u.right||u.left,a=e.x+(u.right?e.width:0)+(u.right?-10:100),i=u.right?"e":"w",r=u.left>0||u.right<0?-n:n,o=c.calculateAdjustments(m,"x",r,a),c.makeSpace(o.movingShapes,o.resizingShapes,{x:n,y:0},i))};var xo="flowNodeRef",Oo="lanes";function wo(e){this._elementRegistry=e}function Eo(e){this._moddle=e}wo.$inject=["elementRegistry"],wo.prototype.computeUpdates=function(e,t){var n=[],a=[],i={},r=[];function o(e){-1===n.indexOf(e)&&(r.push(e),n.push(e))}function c(e){return e.parent?function(e){var t=Vn(e);return i[t.id]||(i[t.id]=Ln(t)),i[t.id]}(e).filter((function(t){return function(e,t){var n=Object(yt.b)(t),a=e.x+e.width/2,i=e.y+e.height/2;return a>n.left&&a<n.right&&i>n.top&&i<n.bottom}(e,t)})).map((function(e){return e.businessObject})):[]}return t.forEach((function(e){var t=Vn(e);t&&-1===n.indexOf(t)&&(t.children.filter((function(e){return He(e,"bpmn:FlowNode")})).forEach(o),n.push(t))})),e.forEach(o),r.forEach((function(e){var t=e.businessObject,n=t.get(Oo).slice(),i=c(e);a.push({flowNode:t,remove:n,add:i})})),t.forEach((function(e){var t=e.businessObject;e.parent||t.get(xo).forEach((function(e){a.push({flowNode:e,remove:[t],add:[]})}))})),a},wo.prototype.execute=function(e){var t=e.updates;t||(t=e.updates=this.computeUpdates(e.flowNodeShapes,e.laneShapes)),t.forEach((function(e){var t=e.flowNode,n=t.get(Oo);e.remove.forEach((function(e){Object(ga.c)(n,e),Object(ga.c)(e.get(xo),t)})),e.add.forEach((function(e){Object(ga.a)(n,e),Object(ga.a)(e.get(xo),t)}))}))},wo.prototype.revert=function(e){e.updates.forEach((function(e){var t=e.flowNode,n=t.get(Oo);e.add.forEach((function(e){Object(ga.c)(n,e),Object(ga.c)(e.get(xo),t)})),e.remove.forEach((function(e){Object(ga.a)(n,e),Object(ga.a)(e.get(xo),t)}))}))},Eo.$inject=["moddle"],Eo.prototype.execute=function(e){var t=this._moddle.ids,n=e.id,a=e.element;e.claiming?t.claim(n,a):t.unclaim(n)},Eo.prototype.revert=function(e){var t=this._moddle.ids,n=e.id,a=e.element;e.claiming?t.unclaim(n):t.claim(n,a)};var No={fill:void 0,stroke:void 0};function Co(e){this._commandStack=e}Co.$inject=["commandStack"],Co.prototype.postExecute=function(e){var t=e.elements,n=e.colors||No,a=this,i={};"fill"in n&&Object(k.a)(i,{fill:n.fill}),"stroke"in n&&Object(k.a)(i,{stroke:n.stroke}),Object(k.i)(t,(function(e){a._commandStack.execute("element.updateProperties",{element:e,properties:{di:i}})}))};var So={width:0,height:0};function _o(e,t){function n(e,t){var n=e.label||e,a=e.labelTarget||e;return function(e,t,n){var a=e.businessObject,i=Ye(a);i&&("categoryValueRef"===i?a.categoryValueRef.value=t:a[i]=t)}(n,t),[n,a]}this.preExecute=function(t){var n=t.element,a=n.businessObject,i=t.newLabel;if(!vt(n)&&mt(n)&&!ft(n)&&!ko(i)){var r=ht(n);r={x:r.x,y:r.y+7},e.createLabel(n,r,{id:a.id+"_label",businessObject:a})}},this.execute=function(e){return e.oldLabel=Xe(e.element),n(e.element,e.newLabel)},this.revert=function(e){return n(e.element,e.oldLabel)},this.postExecute=function(n){var a=n.element,i=a.label||a,r=n.newLabel,o=n.newBounds,c=n.hints||{};if(vt(i)&&ko(r))!1!==c.removeShape&&e.removeShape(i,{unsetLabel:!1});else if(mt(a)||He(a,"bpmn:TextAnnotation")){var s=Xe(i);"undefined"===typeof o&&(o=t.getExternalLabelBounds(i,s)),o&&e.resizeShape(i,o,So)}}}function ko(e){return!e||!e.trim()}function Mo(e,t,n,a){co.a.call(this,e,t,n),this._bpmnRules=a}_o.$inject=["modeling","textRenderer"],S()(Mo,co.a),Mo.$inject=["eventBus","elementFactory","commandStack","bpmnRules"],Mo.prototype.getHandlers=function(){var e=co.a.prototype.getHandlers.call(this);return e["element.updateProperties"]=mo,e["canvas.updateRoot"]=vo,e["lane.add"]=yo,e["lane.resize"]=jo,e["lane.split"]=go,e["lane.updateRefs"]=wo,e["id.updateClaim"]=Eo,e["element.setColor"]=Co,e["element.updateLabel"]=_o,e},Mo.prototype.updateLabel=function(e,t,n,a){this._commandStack.execute("element.updateLabel",{element:e,newLabel:t,newBounds:n,hints:a||{}})},Mo.prototype.connect=function(e,t,n,a){var i=this._bpmnRules;if(n||(n=i.canConnect(e,t)),n)return this.createConnection(e,t,n,e.parent,a)},Mo.prototype.updateProperties=function(e,t){this._commandStack.execute("element.updateProperties",{element:e,properties:t})},Mo.prototype.resizeLane=function(e,t,n){this._commandStack.execute("lane.resize",{shape:e,newBounds:t,balanced:n})},Mo.prototype.addLane=function(e,t){var n={shape:e,location:t};return this._commandStack.execute("lane.add",n),n.newLane},Mo.prototype.splitLane=function(e,t){this._commandStack.execute("lane.split",{shape:e,count:t})},Mo.prototype.makeCollaboration=function(){var e=this._create("root",{type:"bpmn:Collaboration"}),t={newRoot:e};return this._commandStack.execute("canvas.updateRoot",t),e},Mo.prototype.updateLaneRefs=function(e,t){this._commandStack.execute("lane.updateRefs",{flowNodeShapes:e,laneShapes:t})},Mo.prototype.makeProcess=function(){var e={newRoot:this._create("root",{type:"bpmn:Process-action"})};this._commandStack.execute("canvas.updateRoot",e)},Mo.prototype.claimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t,claiming:!0})},Mo.prototype.unclaimId=function(e,t){this._commandStack.execute("id.updateClaim",{id:e,element:t})},Mo.prototype.setColor=function(e,t){e.length||(e=[e]),this._commandStack.execute("element.setColor",{elements:e,colors:t})};var Po=n(206),To=n(192),Ro={top:"bottom","top-right":"bottom-left","top-left":"bottom-right",right:"left",bottom:"top","bottom-right":"top-left","bottom-left":"top-right",left:"right"},Ao={top:"t",right:"r",bottom:"b",left:"l"};function Fo(){}function Bo(e,t){return He(t,"bpmn:Participant")?"source":He(e,"bpmn:Participant")?"target":Io(t)?"source":Io(e)||He(t,"bpmn:Event")?"target":He(e,"bpmn:Event")?"source":null}function Do(e,t){return e?e.original||e:Object(yt.e)(t)}function Lo(e,t){return He(t,"bpmn:Activity")&&He(e,"bpmn:BoundaryEvent")&&t.businessObject.isForCompensation}function Io(e){return He(e,"bpmn:Loop")&&Ke(e)}function Vo(e,t){return e===t}function $o(e){var t=/right|left/.exec(e);return t&&t[0]}function zo(e){var t=/top|bottom/.exec(e);return t&&t[0]}function Wo(e){return"right"===e||"left"===e}function Go(e,t){var n=t.waypoints,a=n&&n.length&&Object(yt.f)(n[0],e);return"top"===a?["t:r"]:"right"===a?["r:b"]:"left"===a?["l:t"]:["b:l"]}function Ho(e,t,n){var a=Object(yt.e)(e),i=Object(yt.e)(t),r=function(e){var t=e.host;return Object(yt.f)(Object(yt.e)(e),t,-10)}(e),o=Vo(e.host,t),c=-1!==["top","right","bottom","left"].indexOf(r),s=Object(yt.f)(i,a,{x:e.width/2+t.width/2,y:e.height/2+t.height/2});return o?function(e,t,n,a,i){var r,o=t?e:zo(e),c=Ao[o];r=t?Wo(e)?Uo("y",n,a,i)?"h":"b":Uo("x",n,a,i)?"v":"l":"v";return[c+":"+r]}(r,c,e,t,n):[function(e,t,n){if(n)return Ao[e];if(Vo(zo(e),zo(t))||(a=$o(e),i=$o(t),Ro[a]===i))return Ao[zo(e)];var a,i;return Ao[$o(e)]}(r,s,c)+":"+function(e,t,n){if(n)return Wo(e)?function(e,t){var n=$o(e),a=Ro[n];return-1!==t.indexOf(a)}(e,t)||Vo(e,t)?"h":"v":function(e,t){var n=zo(e),a=Ro[n];return-1!==t.indexOf(a)}(e,t)||Vo(e,t)?"v":"h";return Wo(t)||Vo(zo(e),zo(t))&&$o(t)?"h":"v"}(r,s,c)]}function Uo(e,t,n,a){return!(Ko(e,a,n,40)||Ko(e,a,{x:n.x+n.width,y:n.y+n.height},40)||Ko(e,a,Object(yt.e)(t),40))}function Ko(e,t,n,a){return Math.abs(t[e]-n[e])<a}S()(Fo,Po.a),Fo.prototype.layoutConnection=function(e,t){t||(t={});var n,a,i=t.source||e.source,r=t.target||e.target,o=t.waypoints||e.waypoints,c=t.connectionStart,s=t.connectionEnd;return c||(c=Do(o&&o[0],i)),s||(s=Do(o&&o[o.length-1],r)),(He(e,"bpmn:Association")||He(e,"bpmn:DataAssociation"))&&o&&!Lo(i,r)?[].concat([c],o.slice(1,-1),[s]):(He(e,"bpmn:MessageFlow")?n=function(e,t){return{preferredLayouts:["straight","v:v"],preserveDocking:Bo(e,t)}}(i,r):(He(e,"bpmn:SequenceFlow")||Lo(i,r))&&(n=i===r?{preferredLayouts:Go(i,e)}:He(i,"bpmn:BoundaryEvent")?{preferredLayouts:Ho(i,r,s)}:He(i,"bpmn:Gateway")?{preferredLayouts:["v:h"]}:He(r,"bpmn:Gateway")?{preferredLayouts:["h:v"]}:{preferredLayouts:["h:h"]}),n&&(n=Object(k.a)(n,t),a=Object(To.b)(Object(To.a)(i,r,c,s,o,n))),a||[c,s])};var qo=n(207),Jo={__init__:["modeling","bpmnUpdater"],__depends__:[cr,Wr,Hr,qr,yn,Jr.a,Yr.a,Xr.a,Qr.a,Et.a,va.a,Zr.a],bpmnFactory:["type",eo],bpmnUpdater:["type",no],elementFactory:["type",ro],modeling:["type",Mo],layouter:["type",Fo],connectionDocking:["type",qo.a]},Yo=n(222),Xo=n(235),Qo=n(236),Zo=n(237),ec=n(238);function tc(e,t,n,a,i,r,o,c){this._palette=e,this._create=t,this._elementFactory=n,this._spaceTool=a,this._lassoTool=i,this._handTool=r,this._globalConnect=o,this._translate=c,e.registerProvider(this)}tc.$inject=["palette","create","elementFactory","spaceTool","lassoTool","handTool","globalConnect","translate"],tc.prototype.getPaletteEntries=function(e){var t={},n=this._create,a=this._elementFactory,i=this._spaceTool,r=this._lassoTool,o=this._handTool,c=this._globalConnect,s=this._translate;function l(e,t,i,r,o){function c(t){var i=a.createShape(Object(k.a)({type:e},o));o&&(i.businessObject.di.isExpanded=o.isExpanded),n.start(t,i)}var l=e.replace(/^bpmn:/,"");return{group:t,className:i,title:r||s("Create {type}",{type:l}),action:{dragstart:c,click:c}}}function u(e){var t=a.createShape({type:"bpmn:Loop",x:0,y:0,isExpanded:!0}),i=a.createShape({type:"bpmn:StartEvent",x:40,y:82,parent:t});n.start(e,[t,i],{hints:{autoSelect:[i]}})}function p(e){n.start(e,a.createParticipantShape())}return Object(k.a)(t,{"hand-tool":{group:"tools",className:"bpmn-icon-hand-tool",title:s("Activate the hand tool"),action:{click:function(e){o.activateHand(e)}}},"lasso-tool":{group:"tools",className:"bpmn-icon-lasso-tool",title:s("Activate the lasso tool"),action:{click:function(e){r.activateSelection(e)}}},"space-tool":{group:"tools",className:"bpmn-icon-space-tool",title:s("Activate the create/remove space tool"),action:{click:function(e){i.activateSelection(e)}}},"global-connect-tool":{group:"tools",className:"bpmn-icon-connection-multi",title:s("Activate the global connect tool"),action:{click:function(e){c.toggle(e)}}},"tool-separator":{group:"tools",separator:!0},"create.start-event":l("bpmn:StartEvent","event","bpmn-icon-start-event-none",s("Create StartEvent")),"create.intermediate-event":l("bpmn:IntermediateThrowEvent","event","bpmn-icon-intermediate-event-none",s("Create Intermediate/Boundary Event")),"create.end-event":l("bpmn:EndEvent","event","bpmn-icon-end-event-none",s("Create EndEvent")),"create.exclusive-gateway":l("bpmn:ExclusiveGateway","gateway","bpmn-icon-gateway-none",s("Create Gateway")),"create.task":l("bpmn:Task","activity","bpmn-icon-task",s("Create Task")),"create.data-object":l("bpmn:DataObjectReference","data-object","bpmn-icon-data-object",s("Create DataObjectReference")),"create.data-store":l("bpmn:DataStoreReference","data-store","bpmn-icon-data-store",s("Create DataStoreReference")),"create.loop":{group:"activity",className:"bpmn-icon-loop-expanded",title:s("Create Loop"),action:{dragstart:u,click:u}},"create.participant-expanded":{group:"collaboration",className:"bpmn-icon-participant",title:s("Create Pool/Participant"),action:{dragstart:p,click:p}},"create.group":l("bpmn:Group","artifact","bpmn-icon-group",s("Create Group"))}),t};var nc={__depends__:[Xo.a,nn.a,Zr.a,Qo.a,Zo.a,ec.a,pt.a],__init__:["paletteProvider"],paletteProvider:["type",tc]},ac=n(76),ic=n(137),rc=n.n(ic);function oc(e,t,n,a,i){ia.a.call(this,e),e.on("shape.move.move",250,(function(e){var r=e.context,o=r.canExecute;r.visualReplacements||(r.visualReplacements={}),o&&o.replacements?function(e){var r=e.canExecute.replacements;Object(k.i)(r,(function(r){var o=r.oldElementId,c={type:r.newElementType};if(!e.visualReplacements[o]){var s=t.get(o);Object(k.a)(c,{x:s.x,y:s.y});var l=n.createShape(c);a.addShape(l,s.parent);var u=Object(M.i)('[data-element-id="'+rc()(s.id)+'"]',e.dragGroup);u&&Object(P.b)(u,{display:"none"});var p=i.addDragger(l,e.dragGroup);e.visualReplacements[o]=p,a.removeShape(l)}}))}(r):function(e){var t=e.visualReplacements;Object(k.i)(t,(function(n,a){var i=Object(M.i)('[data-element-id="'+rc()(a)+'"]',e.dragGroup);i&&Object(P.b)(i,{display:"inline"}),n.remove(),t[a]&&delete t[a]}))}(r)}))}oc.$inject=["eventBus","elementRegistry","elementFactory","canvas","previewSupport"],S()(oc,ia.a);var cc={__depends__:[ac.a],__init__:["bpmnReplacePreview"],bpmnReplacePreview:["type",oc]},sc=n(24),lc=n(31),uc=40,pc=["x","y"],dc=Math.abs;function mc(e){e.on(["connect.hover","connect.move","connect.end"],1250,(function(e){var t,n,a=e.context,i=a.canExecute,r=a.start,o=a.hover,c=a.source,s=a.target;e.originalEvent&&Object(lc.b)(e.originalEvent)||(a.initialConnectionStart||(a.initialConnectionStart=a.connectionStart),i&&o&&function(e,t,n){pc.forEach((function(a){var i=hc(a,t);e[a]<t[a]+n?Object(sc.e)(e,a,t[a]+n):e[a]>t[a]+i-n&&Object(sc.e)(e,a,t[a]+i-n)}))}(e,o,function(e){return He(e,"bpmn:Task")?10:20}(o)),o&&(t=i,n=["bpmn:Association","bpmn:DataInputAssociation","bpmn:DataOutputAssociation","bpmn:SequenceFlow"],Object(k.A)(n,(function(e){return bc(t,e)})))?(a.connectionStart=Object(sc.d)(r),Rt(o,["bpmn:Event","bpmn:Gateway"])&&fc(e,Object(sc.d)(o)),Rt(o,["bpmn:Task","bpmn:Loop","bpmn:Conditional"])&&function(e,t){var n=Object(sc.d)(t);pc.forEach((function(a){(function(e,t,n){return e[n]>t[n]+20&&e[n]<t[n]+hc(n,t)-20})(e,t,a)&&Object(sc.e)(e,a,n[a])}))}(e,o),He(c,"bpmn:BoundaryEvent")&&s===c.host&&function(e){var t=e.context,n=t.source,a=t.target;if(function(e){var t=e.hover,n=e.source;return t&&n&&t===n}(t))return;var i=Object(sc.d)(n),r=Object(yt.f)(i,a,-10),o=[];/top|bottom/.test(r)&&o.push("x");/left|right/.test(r)&&o.push("y");o.forEach((function(t){var n,a=e[t];dc(a-i[t])<uc&&(n=a>i[t]?i[t]+uc:i[t]-uc,Object(sc.e)(e,t,n))}))}(e)):bc(i,"bpmn:MessageFlow")?(He(r,"bpmn:Event")&&(a.connectionStart=Object(sc.d)(r)),He(o,"bpmn:Event")&&fc(e,Object(sc.d)(o))):a.connectionStart=a.initialConnectionStart)}))}function fc(e,t){Object(sc.e)(e,"x",t.x),Object(sc.e)(e,"y",t.y)}function bc(e,t){return e&&e.type===t}function hc(e,t){return"x"===e?t.width:t.height}mc.$inject=["eventBus"];var vc=n(102);function yc(e,t){t.invoke(vc.a,this),e.on(["create.move","create.end"],1500,gc),e.on(["create.move","create.end","shape.move.move","shape.move.end"],1500,(function(e){var t=e.context,n=t.canExecute,a=t.target;n&&("attach"===n||n.attach)&&!Object(sc.c)(e)&&function(e,t){var n,a=Object(yt.b)(t),i=ur(e,t),r=e.context.shape;n=r.parent?{x:0,y:0}:Object(yt.e)(r);/top/.test(i)?Object(sc.e)(e,"y",a.top-n.y):/bottom/.test(i)&&Object(sc.e)(e,"y",a.bottom-n.y);/left/.test(i)?Object(sc.e)(e,"x",a.left-n.x):/right/.test(i)&&Object(sc.e)(e,"x",a.right-n.x)}(e,a)}))}function gc(e){var t=e.context.createConstraints;if(t){var n=t.top,a=t.right,i=t.bottom,r=t.left;(r&&r>=e.x||a&&a<=e.x)&&Object(sc.e)(e,"x",e.x),(n&&n>=e.y||i&&i<=e.y)&&Object(sc.e)(e,"y",e.y)}}function jc(e,t){return-1!==e.indexOf(t)}function xc(e,t,n){return t?{x:e.x-n.x,y:e.y-n.y}:{x:e.x,y:e.y}}S()(yc,vc.a),yc.$inject=["eventBus","injector"],yc.prototype.initSnap=function(e){var t=vc.a.prototype.initSnap.call(this,e),n=e.shape,a=!!this._elementRegistry.get(n.id);return Object(k.i)(n.outgoing,(function(n){var i=n.waypoints[0];i=i.original||i,t.setSnapOrigin(n.id+"-docking",xc(i,a,e))})),Object(k.i)(n.incoming,(function(n){var i=n.waypoints[n.waypoints.length-1];i=i.original||i,t.setSnapOrigin(n.id+"-docking",xc(i,a,e))})),He(n,"bpmn:Participant")&&t.setSnapLocations(["top-left","bottom-right","mid"]),t},yc.prototype.addSnapTargetPoints=function(e,t,n){vc.a.prototype.addSnapTargetPoints.call(this,e,t,n);var a=this.getSnapTargets(t,n);Object(k.i)(a,(function(n){var a;(function(e){if(He(e,"bpmn:Loop")&&Ke(e))return!0;return He(e,"bpmn:Participant")}(n)||(a="bpmn:TextAnnotation",[t,n].every((function(e){return He(e,a)}))))&&(e.add("top-left",Object(sc.g)(n)),e.add("bottom-right",Object(sc.a)(n)))}));var i=this._elementRegistry;return Object(k.i)(t.incoming,(function(n){if(i.get(t.id)){jc(a,n.source)||e.add("mid",Object(yt.e)(n.source));var r=n.waypoints[0];e.add(n.id+"-docking",r.original||r)}})),Object(k.i)(t.outgoing,(function(n){if(i.get(t.id)){jc(a,n.target)||e.add("mid",Object(yt.e)(n.target));var r=n.waypoints[n.waypoints.length-1];e.add(n.id+"-docking",r.original||r)}})),He(n,"bpmn:SequenceFlow")&&(e=this.addSnapTargetPoints(e,t,n.parent)),e},yc.prototype.getSnapTargets=function(e,t){return vc.a.prototype.getSnapTargets.call(this,e,t).filter((function(e){return!He(e,"bpmn:Lane")}))};var Oc={__depends__:[n(223).a],__init__:["connectSnapping","createMoveSnapping"],connectSnapping:["type",mc],createMoveSnapping:["type",yc]},wc=n(239);function Ec(e,t,n){this._elementRegistry=e,this._canvas=n,t.registerProvider(this)}function Nc(e){return Object(k.e)(e,(function(e){return!!e.matched})).length>0}function Cc(e,t){var n=[],a=e;if(!e)return n;e=e.toLowerCase(),t=t.toLowerCase();var i=e.indexOf(t);return i>-1?(0!==i&&n.push({normal:a.substr(0,i)}),n.push({matched:a.substr(i,t.length)}),t.length+i<e.length&&n.push({normal:a.substr(t.length+i,e.length)})):n.push({normal:a}),n}Ec.$inject=["elementRegistry","searchPad","canvas"],Ec.prototype.find=function(e){var t=this._canvas.getRootElement(),n=this._elementRegistry.filter((function(e){return!e.labelTarget}));return n=Object(k.e)(n,(function(e){return e!==t})),n=Object(k.u)(n,(function(t){return{primaryTokens:Cc(Xe(t),e),secondaryTokens:Cc(t.id,e),element:t}})),n=Object(k.e)(n,(function(e){return Nc(e.primaryTokens)||Nc(e.secondaryTokens)})),n=Object(k.B)(n,(function(e){return Xe(e.element)+e.element.id}))};var Sc={__depends__:[wc.a],__init__:["bpmnSearch"],bpmnSearch:["type",Ec]};function _c(e){$e.call(this,e)}function kc(e,t,n,a,i,r){this._create=t,this._elementFactory=n,this._spaceTool=a,this._lassoTool=i,this.translate=r,e.registerProvider(this)}function Mc(e,t,n,a,i){t.invoke(Wn,this),this.getContextPadEntries=function(e){var t=this._modeling,n=this._elementFactory,a=this._autoPlace,i=this._create,r=this._translate,o=this._connect,c=e.businessObject;function s(e,t,n){o.start(e,t,n)}function l(n){t.removeElements([e])}var u={};if("label"===e.type)return u;function p(t){var i=n.createShape({type:t,x:0,y:0,isExpanded:!0});a.append(e,i)}function d(e,t,r,o){function c(t,a){var r=n.createShape(Object(k.a)({type:e},o));i.start(t,r,{source:a})}return"string"!==typeof r&&(o=r,r="Append "+e.replace(/^bpmn:/,"")),{group:"model",className:t,title:r,action:{dragstart:c,click:a?function(t,i){var r=n.createShape(Object(k.a)({type:e},o));a.append(i,r)}:c}}}return Rt(c,["bpmn:FlowNode","bpmn:InteractionNode"])&&Object(k.a)(u,{connect:{group:"connect",className:"bpmn-icon-connection-multi",title:r("Connect using transition"),action:{click:s,dragstart:s}}}),He(c,"bpmn:FlowNode")&&(He(c,"bpmn:EndEvent")||Object(k.a)(u,{"append.append-mapper":d("bpmn:Mapper","bpmn-icon-task","Append Mapper")},{"append.query":d("bpmn:Query","bpmn-icon-gateway-xor","Append query")})),Object(k.a)(u,{"connect-conditional":{group:"activity",className:"bpmn-icon-sequential-mi-marker",title:r("Create Condition"),action:{dragstart:function(){return p("bpmn:Conditional")},click:function(){return p("bpmn:Conditional")}}}}),Object(k.a)(u,{"connect-loop":{group:"activity",className:"bpmn-icon-loop-marker",title:r("Create Loop"),action:{dragstart:function(){return p("bpmn:Loop")},click:function(){return p("bpmn:Loop")}}}}),Object(k.a)(u,{delete:{group:"edit",className:"bpmn-icon-trash",title:"Remove",action:{click:l,dragstart:l}}}),u}}S()(_c,$e),_c.Viewer=Ct,_c.NavigatedViewer=Mt,_c.prototype.createDiagram=function(e){return this.importXML('<?xml version="1.0" encoding="UTF-8"?>\n  <process-Actions \n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"\n  xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"\n  xmlns:dc="http://www.omg.org/spec/DD/20100524/DC"\n  targetNamespace="http://bpmn.io/schema/bpmn"\n  id="Definitions_1">\n  <process-Action id="ProcessAction_1">\n  </process-Action>\n  <bpmndi:BPMNDiagram id="BPMNDiagram_1">\n  <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">\n  <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">\n  <dc:Bounds height="36.0" width="36.0" x="173.0" y="102.0"/>\n  </bpmndi:BPMNShape>\n  </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n  </process-Actions>',e)},_c.prototype._interactionModules=[St.a,_t.a,Pt.a,kt.a],_c.prototype._modelingModules=[Tt.a,Gt,Yt.a,Jt,Xt.a,Qt.a,Zt.a,Hn,dn,nn.a,qn,Zn,la,pa,ba,ha.a,Sa,Jo,Yo.a,nc,cc,ya.a,Oc,Sc],_c.prototype._modules=[].concat(Ct.prototype._modules,_c.prototype._interactionModules,_c.prototype._modelingModules),kc.$inject=["palette","create","elementFactory","spaceTool","lassoTool","translate"],kc.prototype.getPaletteEntries=function(e){var t={},n=this._create,a=this._elementFactory,i=this.translate;function r(e,t,r,o,c){function s(t){var i=a.createShape(Object(k.a)({type:e},c));c&&(i.businessObject.di.isExpanded=c.isExpanded),n.start(t,i)}var l=e.replace(/^bpmn:/,"");return{group:t,className:r,title:o||"Create "+i(l),action:{dragstart:s,click:s}}}function o(e,t){var i=a.createShape({type:t,x:0,y:0,isExpanded:!0});n.start(e,[i],{hints:{autoSelect:[]}})}return Object(k.a)(t,{"create.mapper":r("bpmn:Mapper","activity","bpmn-icon-task"),"create.query":r("bpmn:Query","gateway","bpmn-icon-gateway-xor"),"create.loop":{group:"activity",className:"bpmn-icon-loop-marker",title:i("Create Loop"),action:{dragstart:function(e){return o(e,"bpmn:Loop")},click:function(e){return o(e,"bpmn:Loop")}}},"create.conditional":{group:"activity",className:"bpmn-icon-sequential-mi-marker",title:i("Create Condition"),action:{dragstart:function(e){return o(e,"bpmn:Conditional")},click:function(e){return o(e,"bpmn:Conditional")}}}}),t},S()(Mc,Wn),Mc.$inject=["config.contextPad","injector","eventBus","contextPad","modeling","elementFactory","connect","create","popupMenu","canvas","rules","translate"];var Pc=1500;function Tc(e){return e&&/^custom:/.test(e.type)}function Rc(e){lr.a.call(this,e)}S()(Rc,lr.a),Rc.$inject=["eventBus"],Rc.prototype.init=function(){function e(e,t){if(Tc(e))return He(t,"bpmn:Process-action")||He(t,"bpmn:Participant")||He(t,"bpmn:Collaboration")}function t(e,t){if(Tc(e)||Tc(t))return Tc(e)?!!He(t,"bpmn:Task")&&{type:"custom:connection"}:Tc(t)?!!He(e,"bpmn:Task")&&{type:"custom:connection"}:void 0}this.addRule("elements.move",Pc,(function(t){var n,a=t.target,i=t.shapes;return Object(k.y)(i,(function(t,i){return void 0===n&&(n=Tc(i)),n===Tc(i)&&!1!==t&&e(i,a)}),void 0)})),this.addRule("shape.create",Pc,(function(t){var n=t.target;return e(t.shape,n)})),this.addRule("shape.resize",Pc,(function(e){if(Tc(e.shape))return!1})),this.addRule("connection.create",Pc,(function(e){return t(e.source,e.target)})),this.addRule("connection.reconnectStart",Pc,(function(e){var n=e.connection;return t(e.hover||e.source,n.target)})),this.addRule("connection.reconnectEnd",Pc,(function(e){var n=e.connection;return t(n.source,e.hover||e.target)}))};var Ac={__init__:["contextPadProvider","customRules","paletteProvider"],contextPadProvider:["type",Mc],paletteProvider:["type",kc],customRules:["type",Rc]},Fc=n(300),Bc=n(348),Dc=n(302),Lc=n(364),Ic=n(303),Vc=n(179),$c=n(79),zc=n(367),Wc=n(368),Gc=n(365),Hc=n(217),Uc=(n(274),n(34)),Kc=n(242),qc=n(350),Jc=n(363),Yc=n(347),Xc=n(109),Qc=n.n(Xc),Zc=n(30),es=n(392),ts=n(305),ns=n(389),as=n(156),is=n.n(as),rs=["createdBy","createdOn","updatedBy","updatedOn","version","id"],os={CONTEXT:"context",SELF:"self",NONE:"none",SOURCE:"source",PARENT:"parent"},cs="CUSTOM",ss={date:"DD/MM/YYYY",time:"HH:mm:ss",datetime:"DD/MM/YYYY HH:mm"},ls=["one_to_one","many_to_one","many_to_many","one_to_many","json_one_to_one","json_many_to_one","json_many_to_many","json_one_to_many"],us=["many_to_many","one_to_many","json_many_to_many","json_one_to_many"],ps=["panel","label","spacer","button"],ds=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return JSON.parse(JSON.stringify({name:e.name,version:e.version,type:e.type,fullName:e.fullName,modelType:e.modelType,title:e.title,targetJsonModel:e.targetJsonModel,jsonModel:e.jsonModel,targetModel:e.targetModel,id:e.id,target:e.target}))}))};function ms(e,t,n,a){var i=[],r=function(e){var t,i,r=e.value,o=e.modelSubField,c=r&&r.from||n,s=null===r||void 0===r?void 0:r.selected,l=function(e){var t="";return e&&e.forEach((function(e){if(e.name){var n=$s(e.name);t=t?"".concat(t,"?.").concat(n):"".concat(n)}})),t}(o);if(c===os.CONTEXT&&(s=l?{value:l}:null),c===os.SOURCE)if(l){var u=o[0],p=null===a||void 0===a?void 0:a.fullName,d=null===u||void 0===u?void 0:u.fullName;a.modelType===cs&&(p=null===a||void 0===a?void 0:a.name),u.modelType===cs&&(d=null===u||void 0===u?void 0:u.name),s=d&&p&&d===p?{value:"SOURCE"}:{value:l}}else s=null;if(c===os.SELF)if(l){var m=o[0];s=m&&a.fullName===m.fullName?{value:"SOURCE"}:{value:l}}else s=null;if([os.PARENT].includes(c)&&(null===(t=s)||void 0===t?void 0:t.value)&&"object"===typeof(null===(i=s)||void 0===i?void 0:i.value)){var f=$s(s.value.name);s=l?{value:"".concat(f,"?.").concat(l)}:{value:f}}return s||null};return e.forEach((function(e){var a,o=e.value,c=e.dataPath,s=e.type,u=Object(l.a)({},o),p=(u||{}).fields,d=function(e){return e.target?e.target.split(".").pop():e.targetModel?e.targetModel.split(".").pop():null}(e),m=e.jsonTarget,f=null===(a=e.jsonModel)||void 0===a?void 0:a.name;if("object"===typeof p&&p&&(u.fields=ms(o.fields,t)),u.selected=r(e),u&&!u.from&&(u.from=n),!e.isRemoved&&u.selected&&![void 0,null].includes(u.selected.value)){var b={dataPath:c,type:s,target:d||void 0,value:u,name:e.name,modelSubField:ds(e.modelSubField)||void 0,sourceField:e.sourceField||void 0,selfField:e.selfField||void 0};"many-to-one"===s.toLowerCase()&&(b.jsonModel=f||void 0,!f&&m&&(b.jsonModel=m||void 0)),"json-many-to-one"===s.toLowerCase()&&(b.target=e["targetJsonModel.name"]),i.push(JSON.parse(JSON.stringify(b)))}})),i}function fs(e){return bs.apply(this,arguments)}function bs(){return(bs=Object(f.a)(m.a.mark((function e(t){var n,a,i,r,o,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.post("ws/rest/com.axelor.meta.db.MetaSelect/search",{data:{_domain:"self.name = :name",_domainContext:{name:t}},fields:["name","items"],offset:0,limit:1,sortBy:null});case 2:if(n=e.sent,a=n.data,!(i=a&&a[0])){e.next=12;break}return r=i.items,e.next=9,N.post("ws/rest/com.axelor.meta.db.MetaSelectItem/search",{data:{_domain:"self.id in (:list)",_domainContext:{list:r.map((function(e){return e.id}))}},fields:["title","value","color","data","order"],offset:0,limit:-1,sortBy:["order"]});case 9:return o=e.sent,c=o.data,e.abrupt("return",c);case 12:return e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hs(){return vs.apply(this,arguments)}function vs(){return(vs=Object(f.a)(m.a.mark((function e(){var t,n,a,i,r,o,c,s,u=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.length>0&&void 0!==u[0]?u[0]:{},n=u.length>1?u[1]:void 0,a=u.length>2?u[2]:void 0,e.t1=!n||"metaModel"===n,!e.t1){e.next=8;break}return e.next=7,js(t,a);case 7:e.t1=e.sent;case 8:if(e.t0=e.t1,e.t0){e.next=11;break}e.t0=[];case 11:if(i=e.t0,e.t3=!n||"metaJsonModel"===n,!e.t3){e.next=17;break}return e.next=16,Os(t);case 16:e.t3=e.sent;case 17:if(e.t2=e.t3,e.t2){e.next=20;break}e.t2=[];case 20:for(r=e.t2,o=[],c=0;c<i.length;c++)o.push(Object(l.a)(Object(l.a)({},i[c]),{},{type:"metaModel"}));for(s=0;s<r.length;s++)o.push(Object(l.a)(Object(l.a)({},r[s]),{},{type:"metaJsonModel"}));return e.abrupt("return",o||[]);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ys(e){return gs.apply(this,arguments)}function gs(){return(gs=Object(f.a)(m.a.mark((function e(t){var n,a,i,r,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.next=3,N.search("com.axelor.meta.db.MetaModel",{data:{criteria:[{fieldName:"name",operator:"=",value:t}]},fields:["name","metaFields","id","fullName"]});case 3:if((a=e.sent)&&-1!==a.status&&(i=(a||{}).data,n=(void 0===i?[]:i)[0]||null),n){e.next=11;break}return r=[{fieldName:"name",operator:"=",value:t}],e.next=9,Os(r);case 9:o=e.sent,n=o[0];case 11:return e.abrupt("return",n||null);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function js(e){return xs.apply(this,arguments)}function xs(){return(xs=Object(f.a)(m.a.mark((function e(t){var n,a,i,r,o,c,s,l=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:[],a=[],t&&t.search&&a.push({fieldName:"fullName",operator:"like",value:t.search}),e.next=5,N.search("com.axelor.meta.db.MetaModel",{data:{criteria:[].concat(a,Object(p.a)(n||[]))},fields:["name","metaFields","id","fullName"]});case 5:return i=e.sent,r=[],t&&t.search&&r.push({fieldName:"name",operator:"like",value:t.search}),e.next=10,Os([].concat(r,Object(p.a)(n)));case 10:if(o=e.sent,!i||-1!==i.status){e.next=13;break}return e.abrupt("return",[]);case 13:return c=(i||{}).data,s=void 0===c?[]:c,e.abrupt("return",[].concat(Object(p.a)(s),Object(p.a)(o)));case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Os(){return ws.apply(this,arguments)}function ws(){return(ws=Object(f.a)(m.a.mark((function e(){var t,n,a,i,r=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},e.next=3,N.search("com.axelor.meta.db.MetaJsonModel",{data:{criteria:t}});case 3:if(!(n=e.sent)||-1!==n.status){e.next=6;break}return e.abrupt("return",[]);case 6:return a=(n||{}).data,i=void 0===a?[]:a,e.abrupt("return",i.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{modelType:cs})})));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Es(e){return Ns.apply(this,arguments)}function Ns(){return(Ns=Object(f.a)(m.a.mark((function e(t){var n,a,i,r,o,c,s,l,u,d,f,b,h,v,y=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y.length>1&&void 0!==y[1]&&y[1],n=[],a="".concat(t.fullName||t.target),t.modelType!==cs&&a){e.next=25;break}return i=[{fieldName:"jsonModel.name",operator:"=",value:t.name}],r={criteria:i},e.next=8,N.search("com.axelor.meta.db.MetaJsonField",{data:r,fields:["type","nameField","required","model","targetModel","targetJsonModel","targetJsonModel.name","modelField","jsonModel","jsonModel.name","title","name","selection"],sortBy:["title"]});case 8:o=e.sent,c=(o||{}).data,s=void 0===c?[]:c,l=0;case 11:if(!(l<s.length)){e.next=23;break}if(!(u=s[l]).selection){e.next=18;break}return e.next=16,fs(u.selection);case 16:d=e.sent,u.selectionList=d;case 18:u.jsonModel&&(u.jsonModel.name=u["jsonModel.name"]),n.push(u);case 20:l++,e.next=11;break;case 23:e.next=33;break;case 25:return e.next=27,N.fetchFields(a);case 27:if(!(f=e.sent)||-1!==f.status){e.next=30;break}return e.abrupt("return",[]);case 30:b=(f||{}).data,h=void 0===b?[]:b,n=Object(p.a)(h.fields),Object.keys(h.jsonFields).forEach((function(e){var t,a=h.jsonFields[e];(t=n).push.apply(t,Object(p.a)(Object.values(a)))}));case 33:return v=Gs(n,"title"),e.abrupt("return",v.filter((function(e){return!ps.includes(e.type)})));case 35:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Cs(e){return Ss.apply(this,arguments)}function Ss(){return(Ss=Object(f.a)(m.a.mark((function e(t){var n,a,i,r,o,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.targetModel){e.next=7;break}return e.next=3,Es({fullName:t.targetModel});case 3:return n=e.sent,e.abrupt("return",n);case 7:if(!t.targetJsonModel){e.next=16;break}return a=[{fieldName:"jsonModel.id",operator:"=",value:t.targetJsonModel.id}],i={criteria:a},e.next=12,N.search("com.axelor.meta.db.MetaJsonField",{data:i,fields:["type","nameField","required","model","targetModel","targetJsonModel","targetJsonModel.name","modelField","jsonModel","jsonModel.name","title","name"],sortBy:["title"]});case 12:return r=e.sent,o=(r||{}).data,c=(void 0===o?[]:o).map((function(e){return e.jsonModel&&(e.jsonModel.name=e["jsonModel.name"]),e})),e.abrupt("return",Object(p.a)(c));case 16:return e.abrupt("return",[]);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _s(e){return ks.apply(this,arguments)}function ks(){return(ks=Object(f.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.search("com.axelor.meta.db.MetaJsonRecord",{data:{criteria:[{fieldName:"jsonModel",operator:"=",value:t}],operator:"and"}});case 2:if(!(n=e.sent)||-1!==n.status){e.next=5;break}return e.abrupt("return",[]);case 5:return e.abrupt("return",n&&n.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ms(e){return Ps.apply(this,arguments)}function Ps(){return(Ps=Object(f.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.search("com.axelor.meta.db.MetaJsonRecord",{data:{_domain:t}});case 2:if(!(n=e.sent)||-1!==n.status){e.next=5;break}return e.abrupt("return",[]);case 5:return e.abrupt("return",n&&n.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ts(e){return Rs.apply(this,arguments)}function Rs(){return(Rs=Object(f.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.search("com.axelor.meta.db.MetaJsonField",{data:{_domain:"self.jsonModel.name = '".concat(t,"' and self.nameField = true")},fields:["name"]});case 2:if(!((n=e.sent)&&n.status>-1)){e.next=5;break}return e.abrupt("return",n.data&&n.data[0]);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function As(e){return Fs.apply(this,arguments)}function Fs(){return(Fs=Object(f.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.search(t);case 2:if(!(n=e.sent)||-1!==n.status){e.next=5;break}return e.abrupt("return",[]);case 5:return e.abrupt("return",n&&n.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Bs(e,t){return Ds.apply(this,arguments)}function Ds(){return(Ds=Object(f.a)(m.a.mark((function e(t,n){var a,i,r,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"action-mapper-method-create-script-from-json",a={action:"action-mapper-method-create-script-from-json",data:{context:{_model:n,_jsonString:t}}},e.next=4,N.action(a);case 4:if(i=e.sent,r=i.data,o=void 0===r?[]:r,!(Array.isArray(o)&&o[0]&&o[0].values&&o[0].values._scriptString)){e.next=9;break}return e.abrupt("return",o[0].values._scriptString);case 9:return e.abrupt("return",void 0);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ls=n(54),Is=n.n(Ls);function Vs(e,t){var n=o.a.useRef(null),a=function(){return n.current&&clearTimeout(n.current)},i=function(e){return n.current=setTimeout(e,t)};return o.a.useEffect((function(){return function(){return a()}}),[]),function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];a(),i((function(){return e.apply(void 0,n)}))}}function $s(e){if(e)return e.charAt(0).toLowerCase()+e.slice(1)}function zs(e){if(e)return e.charAt(0).toUpperCase()+e.slice(1)}function Ws(e){return window._t&&"string"===typeof e?window._t(e):e}function Gs(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.sort((function(e,n){var a=e[t],i=n[t];return a<i?-1:a>i?1:0}))}function Hs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/-/g,"_").toLowerCase()},a=[].concat(Object(p.a)(rs),Object(p.a)(t)),i=e.filter((function(e){return-1===a.indexOf(e.name)}));return i.filter((function(e){return!us.includes(n(e.type))}))}function Us(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.replace(/-/g,"_").toLowerCase();return-1!==ls.indexOf(t)}function Ks(e){var t=e.targetName,n=e.name;return t&&(n="".concat(n,".").concat(t)),n}var qs="row",Js=function(e){return"_selectId"===e?"id":e},Ys=Object(ts.a)((function(e){return{listbox:{maxHeight:"300px !important"},input:{width:"100% !important"},inputSelected:{width:"100% !important",color:"rgba(0, 0, 0, 0.87)",border:"1px solid #e0e0e0",padding:"0px 12px",borderRadius:25,background:"#e0e0e0",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",textAlign:"center",fontSize:"0.8125rem"}}}));function Xs(e){var t=Object(r.useState)(!1),n=Object(u.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)([]),p=Object(u.a)(s,2),d=p[0],b=p[1],h=Object(r.useState)(e.isMulti?[]:null),v=Object(u.a)(h,2),y=v[0],g=v[1],j=Object(r.useState)(""),x=Object(u.a)(j,2),O=x[0],w=x[1],E=e.name,N=e.value,C=e.onChange,S=e.options,_=e.optionLabelKey,k=void 0===_?"title":_,M=e.optionValueKey,P=void 0===M?"id":M,T=e.isMulti,R=void 0!==T&&T,A=e.title,F=e.fetchAPI,B=e.inline,D=e.InputProps,L=e.error,I=e.filterSelectedOptions,V=void 0!==I&&I,$=e.disableCloseOnSelect,z=void 0===$||$,W=e.readOnly,G=void 0!==W&&W,H=e.concatValue,U=e.isProcessContext,K=void 0!==U&&U,q=e.inputRootClass,J=void 0===q?{}:q,Y=Object(Zc.a)(e,["name","value","onChange","options","optionLabelKey","optionValueKey","isMulti","title","fetchAPI","inline","InputProps","error","filterSelectedOptions","disableCloseOnSelect","readOnly","concatValue","isProcessContext","inputRootClass"]),X=Ys(),Q=Object(r.useState)(!1),Z=Object(u.a)(Q,2),ee=Z[0],te=Z[1],ne=o.a.useCallback((function(e){return S&&S.find((function(t){return t&&t[Js(P)]===e.trim()}))}),[S,P]);function ae(){return(ae=Object(f.a)(m.a.mark((function e(){var t,n=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.length>0&&void 0!==n[0]?n[0]:"",w(t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ie=Vs((function(){return ae.apply(this,arguments)}),400);function re(e){"Backspace"===e.key&&y&&y[Js(k)]===O&&C(null,"backspace")}function oe(e,t){C("string"===typeof N?R?e.map((function(e){return e&&e[Js(P)]})).join(",")||[]:e&&e[Js(P)]:e,t)}Object(r.useEffect)((function(){var e=!0;return a&&(b([]),te(!0),F?Object(f.a)(m.a.mark((function t(){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F({search:O});case 2:n=t.sent,e&&(b(n),te(!1));case 4:case"end":return t.stop()}}),t)})))():(b(S),te(!1))),function(){e=!1,te(!1)}}),[F,S,O,a]),Object(r.useEffect)((function(){if("string"===typeof N){var e=N.split(",");g(R?e.map((function(e){return ne(e)})):ne(e[0]))}else g(N||(R?[]:null))}),[N,R,ne]);var ce=function(e){return"metaJsonModel"===(e&&e.type)?"".concat(e&&e[Js(k)]?e[Js(k)]:""," (Custom model)")||!1:"fieldName"===E?"".concat(Ws(e&&e.title?e.title:"")," (").concat(e&&e[Js(k)],")"):e?e[Js(k)]&&H&&e[Js(P)]?"".concat(e[Js(k)]," (").concat(e[Js(P)],")"):e[Js(k)]?e[Js(k)]:e.name?e.name:e.id?e.id.toString():"":""};return Object(i.jsx)(ns.a,Object(l.a)(Object(l.a)({getOptionSelected:function(e,t){return R?e[Js(P)]===t[Js(P)]:ce(e)===ce(t)},getOptionLabel:function(e){return ce(e)},loading:ee,id:is()("select-widget"),open:a,onOpen:function(){return c(!0)},onClose:function(){return c(!1)},disabled:G,value:y?R?Array.isArray(y)?y:[]:y:R?[]:null,onChange:function(e,t,n){return oe(t,n)},options:d||[],multiple:R,filterSelectedOptions:V,onInputChange:function(e,t){return ie(t)},classes:{option:"menu-item",input:K?y?X.inputSelected:X.input:"",inputRoot:J},renderInput:function(e){return Object(i.jsx)(es.a,Object(l.a)(Object(l.a)({},e),{},{error:L,label:B?"":A,fullWidth:!0,onClick:function(){G||c(!0)},InputProps:Object(l.a)(Object(l.a)(Object(l.a)({},D),e.InputProps),{},{endAdornment:Object(i.jsxs)(o.a.Fragment,{children:[ee?Object(i.jsx)(Yc.a,{className:X.circularProgress,size:15}):null,e.InputProps.endAdornment]})})},R?{}:{onKeyDown:re}))}},R?{disableCloseOnSelect:z}:{}),Y))}var Qs=n(360),Zs=n(362),el=n(356),tl=n(361),nl=n(355),al=n(216),il=n.n(al),rl=n(358),ol=n(359),cl=n(27),sl=n.n(cl),ll=n(32),ul=n.n(ll),pl=n(349),dl=n(388),ml=n(351),fl=Object($c.a)((function(e){return{dialogPaper:{minHeight:"75vh",maxHeight:"75vh"},cardContent:{height:"100%",minWidth:250,paddingLeft:0,paddingRight:0},cardContentItemText:{fontSize:12,lineHeight:.5,paddingBottom:8},cardContentItemContainer:{marginLeft:10},cardContentItemTitle:{fontSize:16},cardActionView:{justifyContent:"flex-end"},noFields:{textAlign:"center",color:"gray"},save:{margin:e.spacing(1),backgroundColor:"#0275d8",borderColor:"#0267bf",color:"white",textTransform:"none","&:hover":{backgroundColor:"#025aa5",borderColor:"#014682",color:"white"}},dialogTitle:{"& > h2":{display:"flex",justifyContent:"space-between"}},subHeaderRow:{borderBottom:"1px solid #eee",paddingLeft:16,paddingRight:16,paddingBottom:8,display:"flex"},fieldListViewContainer:{marginLeft:16,marginRight:2,marginTop:8,overflowY:"auto",height:"53.8vh"},searchField:{width:"75%","& input":{padding:"8px 0 7px !important"}},checkbox:{color:"#2185D0 !important","&$checked":{color:"#2185D0 !important",backgrounColor:"#2185D0 !important"}}}}));function bl(e){var t,n,a=e.data,c=e.onSubmit,s=e.open,l=e.onClose,d=fl(),m=o.a.useState([]),f=Object(u.a)(m,2),b=f[0],h=f[1],v=o.a.useState(!1),y=Object(u.a)(v,2),j=y[0],x=y[1],O=o.a.useState(""),w=Object(u.a)(O,2),E=w[0],N=w[1],C=Object.values(a).filter((function(e){return!1!==e.isRemoved})),S=o.a.useCallback((function(e){e&&e.stopPropagation(),l(),h([]),x(!1)}),[l]),_=o.a.useCallback((function(e){e.stopPropagation();var t=C.filter((function(e,t){return-1!==b.indexOf(e.name)}));c&&c(t),S(e)}),[c,b,S,C]),k=o.a.useCallback((function(e){e.stopPropagation();var t=e.target.value;h((function(e){return-1!==e.indexOf(t)?(x(!1),Object(p.a)(e.filter((function(e){return e!==t})))):[].concat(Object(p.a)(e),[t])}))}),[]),M=o.a.useCallback((function(e){h(e?C.map((function(e){return e.name})):[]),x(e)}),[C]),P=o.a.useCallback((function(e){N(e.target.value)}),[]);return Object(r.useEffect)((function(){N("")}),[s]),Object(i.jsx)(o.a.Fragment,{children:Object(i.jsxs)(Fc.a,{fullWidth:!0,open:s,onClose:function(e,t){"backdropClick"!==t&&S()},"aria-labelledby":"scroll-dialog-title",children:[Object(i.jsx)(Bc.a,{id:"scroll-dialog-title",className:d.dialogTitle,children:Object(i.jsx)("span",{children:"Select Fields"})}),Object(i.jsxs)(Dc.a,{dividers:!0,classes:{root:d.cardContent},children:[Object(i.jsxs)("div",{className:d.subHeaderRow,children:[Object(i.jsx)(pl.a,{control:Object(i.jsx)(dl.a,{classes:{root:d.checkbox},onChange:function(){return M(!j)},value:j,checked:j})}),Object(i.jsx)(es.a,{classes:{root:d.searchField},placeholder:"Search fields",onChange:function(e){return P(e)}})]}),Object(i.jsxs)("div",{className:d.fieldListViewContainer,children:[(t=C,n=E,n?t.filter((function(e){return(e.title||"").toLowerCase().includes(n.toLowerCase())||(e.name||"").toLowerCase().includes(n.toLowerCase())})):t).map((function(e,t){return Object(i.jsx)(qc.a,{container:!0,children:Object(i.jsx)(pl.a,{control:Object(i.jsx)(dl.a,{classes:{root:d.checkbox},onChange:k,value:e.name,checked:-1!==b.indexOf(e.name)}),label:Object(i.jsxs)("div",{className:d.cardContentItemContainer,children:[Object(i.jsx)(g.a,{className:d.cardContentItemTitle,children:e.title}),Object(i.jsx)(g.a,{className:d.cardContentItemText,children:e.name})]})})},t)})),0===C.length&&Object(i.jsx)(g.a,{className:d.noFields,children:"No fields available"})]})]}),Object(i.jsxs)(ml.a,{className:d.cardActionView,children:[Object(i.jsx)(Vc.a,{variant:"contained",className:d.save,color:"primary",onClick:S,children:"Close"}),Object(i.jsx)(Vc.a,{variant:"contained",className:d.save,color:"primary",onClick:_,children:"OK"})]})]})})}var hl=o.a.memo(bl),vl=n(213),yl=n.n(vl),gl=Object($c.a)({container:{display:"flex"},input:{width:"100%",display:"flex",position:"relative","& > div:before":{border:0}},parentField:{marginRight:5,color:"#3f51b5"},clickableView:{cursor:"pointer","& input":{cursor:"pointer"}},fieldName:{fontSize:12},fieldNameColumn:{width:"unset"},addFieldButton:{padding:0,marginLeft:5}}),jl=function(e){var t=e.type.replace(/-/g,"_").toLowerCase();return-1!==ls.indexOf(t)};function xl(e){var t=gl(),n=e.item,a=e.handleAdd,r=o.a.useState(!1),c=Object(u.a)(r,2),s=c[0],l=c[1],p=function(e){if(jl(e)){var t=e.value;return(null===t||void 0===t?void 0:t.fields)||null}return null}(n);return o.a.useEffect((function(){n&&jl(n)&&n.subFieldName&&l(!0)}),[n]),n?Object(i.jsxs)("div",{className:ul()(t.input),children:[Object(i.jsx)(qc.a,{container:!0,direction:"column",className:t.fieldNameColumn,children:Object(i.jsx)(g.a,{title:n.name,children:n.title||n.autoTitle||n.name})}),Object(i.jsx)("div",{children:p&&s&&Object(i.jsx)(hl,{data:p,iconButton:!0,onSubmit:function(e){return a(e)},icon:Object(i.jsx)(yl.a,{}),buttonTitle:"Add Fields",iconButtonClassName:t.addFieldButton})})]}):null}var Ol=o.a.memo(xl),wl=n(344);function El(e){var t=e.name,n=e.title,a=e.autoTitle,r=e.value,c=void 0===r?"":r,s=(e.onChange,e.onBlur),p=e.readOnly,d=e.inline,m=e.InputProps,f=e.style,b=Object(Zc.a)(e,["name","title","autoTitle","value","onChange","onBlur","readOnly","inline","InputProps","style"]),h=o.a.useState(),v=Object(u.a)(h,2),y=v[0],g=v[1];return o.a.useEffect((function(){g(c)}),[c]),d?Object(i.jsx)(wl.a,Object(l.a)({style:Object(l.a)({width:"100%"},f),placeholder:n,inputProps:{"aria-label":n},name:t,onChange:function(e){return g(e.target.value)},onBlur:function(e){return s(e.target.value)},autoComplete:"off",readOnly:p,disabled:p,value:y||""},b)):Object(i.jsx)(es.a,Object(l.a)({label:n||a,name:t,style:Object(l.a)({width:"100%"},f),onChange:function(e){return g(e.target.value)},onBlur:s,autoComplete:"off",InputProps:Object(l.a)({readOnly:p},m),value:y||"",className:b.className},b))}El.defaultProps={rows:3,readOnly:!1};var Nl=El;function Cl(e){var t=e.type,n=void 0===t?"integer":t,a=e.title,c=e.onChange,s=e.value,p=void 0===s?0:s,d=(e.readOnly,e.scale),m=void 0===d?2:d,f=(e.customeFormat,e.onBlur),b=Object(Zc.a)(e,["type","title","onChange","value","readOnly","scale","customeFormat","onBlur"]),h=Object(r.useState)(p),v=Object(u.a)(h,2),y=v[0],g=v[1],j=Object(r.useCallback)((function(e){return Number(Number(e).toFixed("integer"===n?0:m))}),[n,m]);return o.a.useEffect((function(){g(j(p))}),[p,g,j]),Object(i.jsx)(Nl,Object(l.a)({onChange:g,title:a,type:"number",value:"".concat(y),onBlur:function(e){c(j(e.target.value)),g(j(e.target.value)),f&&f(e)}},b))}Cl.defaultProps={readOnly:!1};var Sl=Cl,_l=n(163),kl=n(352),Ml=n(353),Pl=n(382),Tl=n(39),Rl={date:kl.a,time:Ml.a,datetime:Pl.a};var Al=function(e){var t=e.inline,n=e.type,a=void 0===n?"date":n,c=Object(Zc.a)(e,["inline","type"]),s=Object(r.useState)(!1),p=Object(u.a)(s,2),d=p[0],m=p[1],f=o.a.useRef(),b=(c.name,c.title),h=c.format,v=(c.error,c.onChange),y=Object(Zc.a)(c,["name","title","format","error","onChange"]),g=Rl[a];return o.a.useEffect((function(){d&&(f.current=y.value)}),[d,y.value]),Object(i.jsx)(Tl.a,{utils:_l.a,children:Object(i.jsx)(g,Object(l.a)(Object(l.a)(Object(l.a)(Object(l.a)({autoOk:!0,open:d,ampm:!1,views:"date"===a?["date"]:"datetime"===a?["date","hours","minutes"]:"time"===a?["hours","minutes","seconds"]:["date"],onChange:function(e){f.current=e,v(e)},PopoverProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},disableToolbar:!0,variant:"inline"},t?{invalidDateMessage:""}:{}),{},{style:Object(l.a)({width:"100%"},t?{margin:0}:{}),label:t?"":b,format:h||ss[a]},"time"!==a?{animateYearScrolling:!1}:{}),y),{},{onKeyDown:function(e){40===e.keyCode&&m(!0)},onClose:function(){v(f.current),m(!1)},onOpen:function(){return m(!0)}}))})},Fl=n(395),Bl=n(346),Dl=n(394),Ll=n(385),Il=Object($c.a)((function(e){return{root:{display:"flex",flexWrap:"wrap"},select:{width:"100%"}}}));function Vl(e){var t=e.name,n=e.value,a=void 0===n?"":n,r=e.onChange,o=e.options,c=e.title,s=e.className,u=Object(Zc.a)(e,["name","value","onChange","options","title","className"]),p=Il();return Object(i.jsxs)(Bl.a,{className:ul()(p.formControl,s),children:[Object(i.jsx)(Dl.a,{children:c}),Object(i.jsx)(Ll.a,Object(l.a)(Object(l.a)({value:a,onChange:function(e){return r(e.target.value)},name:t,style:{marginRight:8},classes:{select:p.select}},u),{},{children:o&&Array.isArray(o)&&o.map((function(e,t){var n=e.name,a=e.title;return Object(i.jsx)(Fl.a,{value:n,children:a},t)}))}))]})}var $l=n(383),zl=n(384),Wl={border:"1px dashed gray",padding:"0.5rem 1rem",marginBottom:".5rem",backgroundColor:"white"},Gl=function(e){var t=e.id,n=(e.text,e.index),a=e.moveCard,i=Object(Zc.a)(e,["id","text","index","moveCard"]),o=Object(r.useRef)(null),c=Object($l.a)({accept:qs,collect:function(e){return{handlerId:e.getHandlerId()}},hover:function(e,t){var i;if(o.current){var r=e.index,c=n;if(r!==c){var s=null===(i=o.current)||void 0===i?void 0:i.getBoundingClientRect(),l=(s.bottom-s.top)/2,u=t.getClientOffset().y-s.top;r<c&&u<l||r>c&&u>l||(a(r,c),e.index=c)}}}}),s=Object(u.a)(c,2),p=s[0].handlerId,d=s[1],m=Object(zl.a)({type:qs,item:function(){return{id:t,index:n}},collect:function(e){return{isDragging:e.isDragging()}}}),f=Object(u.a)(m,3),b=f[0].isDragging,h=f[1],v=f[2],y=b?0:1;return h(d(o)),i.children({preview:v,ref:o,style:Object(l.a)(Object(l.a)({},Wl),{},{opacity:y}),handlerId:p})},Hl=n(391),Ul=n(215),Kl=n.n(Ul),ql=Object($c.a)((function(e){return{root:{display:"flex",justifyContent:"center",flexWrap:"wrap",listStyle:"none",padding:e.spacing(.5),margin:0},chip:{margin:e.spacing(.5)},rightIcon:{width:"0.8em",height:"0.8em"}}})),Jl=function(e){return"_selectId"===e?"id":e};var Yl=function(e){var t=e.sourceModel,n=e.value,a=e.onChange,r=e.parentRow,c=e.targetModel,s=e.isContext,u=void 0!==s&&s,p=e.isProcessContext,d=void 0!==p&&p,b=(e.element,e.isM2o),h=void 0!==b&&b,v=Object(Zc.a)(e,["sourceModel","value","onChange","parentRow","targetModel","isContext","isProcessContext","element","isM2o"]),y=ql(),g=function(){if(Array.isArray(n)&&n.length){var e=n.filter((function(e){return e.name})),a=e[e.length-1];return(u||d)&&e.length-1===0?a:"com.axelor.meta.db.MetaJsonRecord"===a.model&&a.targetModel?{fullName:a.targetModel}:a.target?{fullName:a.target}:{fullName:a.model}}return t||(r?{fullName:r.target}:c||void 0)},j=o.a.useCallback((function(e,t){if("remove-option"===t){var i=function(e,t){for(var n,a=function(a){var i=e[a];if(-1===t.findIndex((function(e){return e.name===i.name})))return n=a,"break"},i=0;i<e.length&&"break"!==a(i);i++);return n}(n,e);i&&e.splice(i,e.length-1)}a(e)}),[n,a]),x=function(){return Array.isArray(n)&&n.length},O=function(e){var t=v.optionLabelKey,n=v.optionValueKey,a=v.concatValue,i=v.name;return"metaJsonModel"===(e&&e.type)?"".concat(e&&e[Jl(t)]?e[Jl(t)]:""," (Custom model)")||!1:"fieldName"===i?"".concat(Ws(e&&e.title?e.title:"")," (").concat(e&&e[Jl(t)],")"):e?e[Jl(t)]&&a&&e[Jl(n)]?"".concat(e[Jl(t)]||e[Jl(n)]):e[Jl(t)]?e[Jl(t)]:e.name?e.name:e.id?e.id.toString():"":""};return Object(i.jsx)("div",{className:v.containerClassName,children:Object(i.jsx)(Xs,Object(l.a)({title:e.title,isMulti:!0,fetchAPI:Object(f.a)(m.a.mark((function e(){var a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&n&&n[0])){e.next=3;break}if("SOURCE"!==n[0].title){e.next=3;break}return e.abrupt("return",[]);case 3:if(!d||x()){e.next=9;break}return e.next=6,hs();case 6:e.t0=e.sent,e.next=19;break;case 9:if(!u||x()){e.next=15;break}return e.next=12,hs();case 12:e.t1=e.sent,e.next=18;break;case 15:return e.next=17,Es(g());case 17:e.t1=e.sent;case 18:e.t0=e.t1;case 19:return a=e.t0,t&&(!n||n.length<1)&&(i=Object.assign({},t,{title:"SOURCE"}),a.splice(0,0,Object(l.a)({},i))),h&&n&&n.length>0&&(a=a.filter((function(e){return["many_to_one","one_to_one"].includes(e.type.toLowerCase())&&!rs.includes(e.name)}))),e.abrupt("return",a);case 23:case"end":return e.stop()}}),e)}))),value:n,onChange:j,renderTags:function(e,t){return e.map((function(n,a){return Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsx)(Hl.a,Object(l.a)({title:n[Jl(v.optionValueKey)],label:O(n),className:y.chip},t({index:a})),a),a<e.length-1&&Object(i.jsx)(Kl.a,{className:y.rightIcon})]},a)}))}},v))})},Xl=Object($c.a)((function(e){return{root:{width:"100%",overflowX:"auto",height:"calc(100% - 120px)",overflowY:"auto"},table:{minWidth:650,"& td":{padding:"0px 16px !important"}},tableRowRoot:{"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover},"& .MuiInput-underline:before":{borderBottom:0}},input:{width:"100%"},error:{fontSize:"0.7em",position:"absolute",paddingTop:1,color:"red",fontWeight:"bold"},valueInputContainer:{position:"relative"},radioInput:{padding:4},iconButton:{padding:"8px",marginTop:7},deleteIcon:{color:"#0275d8"},headerTitle:{paddingLeft:0,textAlign:"center"},rightIcon:{width:"0.8em",height:"0.8em"},addFieldButton:{left:10,top:7,textTransform:"capitalize"},searchField:{marginLeft:20,"&>div":{marginTop:10}}}})),Ql=function(e){return e.type.replace(/-/g,"_").toLowerCase()},Zl=function(e,t,n){var a=[{title:"Self",id:os.SELF},{title:"Context",id:os.CONTEXT},{title:"Expression",id:os.NONE},{title:"Source",id:os.SOURCE}],i=Object(cl.get)(t,"value.from",n);return t&&[os.CONTEXT,os.SELF,os.SOURCE].includes(i)&&a.push({title:"Parent",id:os.PARENT}),a},eu=function(e){var t,n=(e.value||{}).selected;return n&&"object"===typeof n.value?n.value:(n&&(t=n.value),{name:t})},tu=function(e){var t=(e.value||{}).selected,n=void 0===t?{}:t;if(n)return Us(e.type)?Object(Uc.a)({},n.targetName,n.value):n.value},nu=function(e){var t={};return e.subField&&(t.borderBottom="0px"),t},au=function(e,t,n){var a;return e.id===os.PARENT?!(null===t||void 0===t||null===(a=t.value)||void 0===a?void 0:a.selected):e.id===os.SOURCE&&!n},iu=function(e,t){var n=e.contextModel,a=Object(cl.get)(e,"value.from",t);return n&&"context"===a?{fullName:n.target}:[os.SELF,os.SOURCE,os.PARENT].includes(a)?{fullName:eu(e).target}:{}},ru=function(e,t,n){var a;(t&&t[e.targetName]&&(a=e.targetName),!a&&n&&t&&t[n]&&(a=n),a)||(a=(t?t.name:null)?"name":"_selectId");return a};function ou(e){var t=e.editor,n=e.internalProps,a=n.onChange,o=n.value,c=Object(Zc.a)(n,["onChange","value"]),s=Xl(),p=c.field,d=void 0===p?{}:p,b=d.targetName,h=d.target,v=d.targetModel,y=Object(r.useState)(null),g=Object(u.a)(y,2),j=g[0],x=g[1],O=function(){var e=Object(f.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],"com.axelor.meta.db.MetaJsonRecord"!==h||!d.domain){e.next=11;break}return e.next=4,Ms(d.domain);case 4:return t=e.sent,e.next=7,Ts(d.jsonTarget);case 7:n=e.sent,x(n&&n.name),e.next=20;break;case 11:if(!d.targetJsonModel){e.next=17;break}return e.next=14,_s(d["targetJsonModel.name"]);case 14:t=e.sent,e.next=20;break;case 17:return e.next=19,As(h||v);case 19:t=e.sent;case 20:return e.abrupt("return",t);case 21:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=o._selectId?Object(l.a)(Object(l.a)({},o),{},{id:o._selectId}):o;return Object(i.jsx)(Xs,{name:"fieldValue",title:"Value",placeholder:"Value",fetchAPI:O,isMulti:!1,optionValueKey:b,optionLabelKey:b,onChange:function(e){a({name:"fieldValue",value:e,nameField:j},t)},value:w||[],classes:{root:s.MuiAutocompleteRoot}})}function cu(e){var t=e.Component,n=e.editor,a=e.internalProps,r=a.onChange,o=a.value,c=(a.value2,a.classes,a.style),s=(a.targetName,Object(Zc.a)(a,["onChange","value","value2","classes","style","targetName"]));return Object(i.jsx)(t,Object(l.a)({name:"fieldValue",onChange:function(e){return r({name:"fieldValue",value:e},n)},value:o,style:c},s))}var su=o.a.memo((function(e){var t=e.type,n=e.operator,a=void 0===n?"=":n,r=e.onChange,o=e.value,c=e.classes,s=e.parentType,u=e.editor,p=Object(Zc.a)(e,["type","operator","onChange","value","classes","parentType","editor"]),d=Object(l.a)({value:o.fieldValue,value2:o.fieldValue2,onChange:r},p),m=[],f={};switch(t){case"one_to_one":case"many_to_one":case"many_to_many":case"one_to_many":case"json_one_to_one":case"json_many_to_one":case"json_many_to_many":case"json_one_to_many":return Object(i.jsx)(ou,{operator:a,editor:u,internalProps:Object(l.a)(Object(l.a)({},d),{},{value:o.fieldValue}),parentType:s});case"date":case"time":case"datetime":return Object(i.jsx)(cu,{Component:Al,operator:a,editor:u,internalProps:Object(l.a)(Object(l.a)({type:t,value:function(e){return e?Is()(e,ss[t]):null}(o.fieldValue),onChange:function(e,n){var a=e.name,i=e.value;return r({name:a,value:i&&i.format(ss[t])},n)}},p),{},{margin:"none",classes:c,style:{width:"250px !important"}})});case"integer":case"long":case"decimal":return f={Component:(m=p.field.selectionList&&p.field.selectionList.map((function(e){var t=e.title,n=e.value,a=e.data;return{name:a&&a.value||n,title:t}})))?Vl:Sl,operator:a,editor:u,internalProps:Object(l.a)({},m?Object(l.a)({options:m,classes:c},d):Object(l.a)(Object(l.a)({type:t},d),{},{margin:"none",classes:c,style:{width:"250px !important"}}))},Object(i.jsx)(cu,Object(l.a)({},f));case"enum":return m=p.field.selectionList.map((function(e){var t=e.title,n=e.value,a=e.data;return{name:a&&a.value||n,title:t}})),Object(i.jsx)(cu,{Component:Vl,operator:a,editor:u,internalProps:Object(l.a)({options:m,classes:c},d)});case"boolean":var b=[{title:"Yes",value:!0},{title:"No",value:!1}];return Object(i.jsx)(Xs,{optionLabelKey:"title",optionValueKey:"value",options:b,value:b.find((function(e){return e.value===o.fieldValue})),onChange:function(e){return r({value:e.value})}});default:return f={Component:(m=p.field&&p.field.selectionList&&p.field.selectionList.map((function(e){var t=e.title,n=e.value,a=e.data;return{name:a&&a.value||n,title:t}})))?Vl:Nl,operator:a,editor:u,internalProps:Object(l.a)({},m?Object(l.a)(Object(l.a)({options:m,classes:c},d),{},{value:o.fieldValue,className:c.input}):Object(l.a)(Object(l.a)({classes:c},d),{},{onBlur:function(e){return d.onChange(e.target)},margin:"none",style:{width:"100%"}}))},Object(i.jsx)(cu,Object(l.a)({},f))}}));var lu=function(e){var t=Xl(),n=e.onRowChange,a=e.data,r=void 0===a?[]:a,c=e.metaFields,s=void 0===c?[]:c,u=e.onRemove,p=e.errors,d=e.onClearError,b=e.onSubFieldAdd,y=e.handleAdd,g=e.sourceModel,j=e.targetModel,x=e.manageFieldClick,O=e.handleFieldSearch,w=e.onReorder,E=o.a.useCallback((function(){return g?os.SOURCE:os.NONE}),[g]),N=o.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t,a,i,r){var o,c,s,l,u,f,b;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=t.target.value,c=t.target.nameField,p&&p[r.dataPath]&&o&&d(r.dataPath),s=a,l=o,u=Object(cl.get)(r,"value.from",E()),"value"===a&&(s="".concat(a,".selected"),f=o,b=o?ru(r,o,c):Object(cl.get)(r,"value.selected.targetName"),!Us(r.type)||u&&u!==os.NONE||"object"!==typeof f||(f="_selectId"===b?o.id:o[b]),l={value:f},u===os.NONE&&Us(r.type)&&(l.targetName=b)),(["contextModel","sourceField","selfField"].includes(a)||[os.SELF,os.SOURCE,os.PARENT].includes(u)&&"value"===a)&&n&&n(r,i,"modelSubField",[]),n&&n(r,i,s,l);case 9:case"end":return e.stop()}}),e)})));return function(t,n,a,i){return e.apply(this,arguments)}}(),[n,p,d,E]),C=o.a.useCallback((function(e){u&&u(e)}),[u]),S=o.a.useCallback((function(e,n){var a=arguments.length>3?arguments[3]:void 0;if(e.isRemoved||e.isHidden)return null;var r=Object(cl.get)(e,"value.from",E());return Object(i.jsx)(Gl,{index:n,id:e.name,moveCard:w,children:function(o){var c=o.ref,u=o.style,p=o.handlerId,d=o.preview;return Object(i.jsxs)(nl.a,{"data-handler-id":p,ref:d,style:Object(l.a)({},u),classes:{root:t.tableRowRoot},children:[Object(i.jsx)(el.a,{align:"left",ref:c,style:{cursor:"move"},children:Object(i.jsx)("div",{children:Object(i.jsx)(il.a,{})})}),Object(i.jsx)(el.a,{style:Object(l.a)({},nu(e)),children:Object(i.jsx)(Ol,{name:"name",className:t.input,item:e,onChange:function(e){return N(e,"name",n)},onSubFieldAdd:b,handleAdd:y,onSubFieldChange:function(e){N(e,"subFieldName",n)}})}),Object(i.jsx)(el.a,{children:"="}),Object(i.jsx)(el.a,{style:Object(l.a)({},nu(e)),className:t.valueInputContainer,children:r===os.SELF?Object(i.jsx)(Yl,{optionValueKey:"name",optionLabelKey:"title",concatValue:!0,parentRow:a,targetModel:j,value:e.modelSubField,onChange:function(t){return N({target:{value:t}},"modelSubField",n,e)}}):r===os.SOURCE?Object(i.jsx)(Yl,{optionValueKey:"name",optionLabelKey:"title",concatValue:!0,sourceModel:g,value:e.modelSubField,onChange:function(t){return N({target:{value:t}},"modelSubField",n,e)}}):r===os.PARENT?Object(i.jsx)(Xs,{optionValueKey:"name",optionLabelKey:"title",concatValue:!0,options:s,fetchAPI:function(){return Es(iu(a,E()))},value:eu(e),onChange:function(t){return N({target:{value:t}},"value",n,e)}}):r===os.CONTEXT?Object(i.jsx)(Yl,{optionValueKey:"name",optionLabelKey:"title",concatValue:!0,isContext:!0,value:e.modelSubField,onChange:function(t){return N({target:{value:t}},"modelSubField",n,e)}}):Object(i.jsx)(su,{row:e,type:Ql(e),onChange:function(t,a){N({target:t},"value",n,e)},value:{fieldValue:tu(e),fieldValue2:""},classes:t,field:e.subFieldName||e})}),Object(i.jsx)(el.a,{style:Object(l.a)({},nu(e)),size:"small",children:Object(i.jsx)(Xs,{disableClearable:!0,options:Zl(0,a,E()),value:r||E(),getOptionDisabled:function(e){return au(e,a,g)},onChange:function(t){return N({target:{value:t}},"value.from",n,e)}})}),Object(i.jsx)(el.a,{style:void 0!==e.level?Object(l.a)({borderBottom:"0px"},nu(e)):Object(l.a)({},nu(e)),children:Object(i.jsx)(v.a,{size:"medium",onClick:function(){return C(e)},className:t.iconButton,children:Object(i.jsx)(h.a,{title:"Remove field",children:Object(i.jsx)(rl.a,{fontSize:"small",className:t.deleteIcon})})})})]})}},e.name)}),[t,C,N,s,b,y,g,E,j,w]);return Object(i.jsxs)(Kc.a,{className:t.root,children:[Object(i.jsxs)(qc.a,{container:!0,style:{backgroundColor:"#FAFAFA"},children:[Object(i.jsx)(v.a,{variant:"contained",color:"primary",startIcon:Object(i.jsx)(ol.a,{}),className:t.addFieldButton,onClick:x,title:"Manage Fields",children:Object(i.jsx)(ol.a,{})}),Object(i.jsx)(es.a,{classes:{root:t.searchField},placeholder:"Search fields",onChange:function(e){return O(e)}})]}),Object(i.jsxs)(Qs.a,{className:t.table,"aria-label":"simple table",stickyHeader:!0,children:[Object(i.jsxs)("colgroup",{children:[Object(i.jsx)("col",{style:{width:"3%"}}),Object(i.jsx)("col",{style:{width:"27%",minWidth:300}}),Object(i.jsx)("col",{style:{width:"15px"}}),Object(i.jsx)("col",{style:{width:"50%",minWidth:200}}),Object(i.jsx)("col",{style:{width:"210px",minWidth:230}}),Object(i.jsx)("col",{style:{width:"5%"}})]}),Object(i.jsx)(tl.a,{children:Object(i.jsxs)(nl.a,{children:[Object(i.jsx)(el.a,{align:"left",children:"\xa0"}),Object(i.jsx)(el.a,{className:t.headerTitle,children:"Field name"}),Object(i.jsx)(el.a,{className:t.headerTitle}),Object(i.jsx)(el.a,{className:t.headerTitle,children:"Value"}),Object(i.jsx)(el.a,{className:t.headerTitle,children:"Value from"}),Object(i.jsx)(el.a,{className:t.headerTitle})]})}),Object(i.jsx)(Zs.a,{children:r.map((function(e,t){return S(e,t)}))})]})]})},uu=n(71),pu=o.a.createContext();function du(){return o.a.useContext(pu)}var mu=function(e){var t=e.children,n=function(e){var t=o.a.useState(e),n=Object(u.a)(t,2),a=n[0],i=n[1];return[a,o.a.useCallback((function(e){return i(Object(uu.a)(e))}),[i])]}({builderFields:[]}),a=Object(u.a)(n,2),r={state:a[0],update:a[1]};return Object(i.jsx)(pu.Provider,{value:r,children:t})},fu=Object($c.a)((function(e){return{table:{minWidth:650},input:{width:"13%",marginRight:20},metaFieldGrid:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},newRecordSwitch:{marginTop:2},newRecordSwitchText:{display:"flex",flexDirection:"column",justifyContent:"center"},newRecordInputView:{display:"flex",flexDirection:"row",marginTop:5},modelFieldSelection:{marginRight:20,marginLeft:50},addModelFieldIcon:{marginLeft:15},saveButton:{marginLeft:10},cardContent:{overflow:"auto",height:600},cardContentItemText:{lineHeight:3},cardActionView:{justifyContent:"flex-end"},capitalizeText:{textTransform:"capitalize"},saveButtonText:{marginLeft:10},saveMessageAlert:{width:"100%",marginBottom:10,display:"flex",justifyContent:"space-between"},topView:{margin:"10px 10px 0px 10px"},searchField:{flexDirection:"row",width:"12%","& input":{paddingBottom:0}},loaderView:{position:"absolute",left:0,right:0,top:0,bottom:0,height:"100%",backgroundColor:"rgba(0,0,0,0.2)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",zIndex:"999"},paper:{margin:e.spacing(1),width:"calc(100% - 16px)",display:"flex",height:"calc(100% - 50px)",overflow:"hidden"},dialogPaper:{maxWidth:"100%",maxHeight:"100%",resize:"both",width:"100%",height:"90%"},root:{display:"flex",flexDirection:"column",alignItems:"flex-start",height:"100%",overflow:"hidden"},save:{margin:e.spacing(1),backgroundColor:"#0275d8",borderColor:"#0267bf",color:"white","&:hover":{backgroundColor:"#025aa5",borderColor:"#014682",color:"white"}},selectContainer:{minWidth:150},targetModelInputRoot:{marginTop:"22px !important"}}})),bu=function(e){return e.targetJsonModel?e.targetJsonModel.id:e.targetModel},hu=function(e){return e?e.filter((function(e){return Object.keys(e).length>0})):e},vu=function(e){return e.target&&"com.axelor.meta.db.MetaJsonRecord"!==e.target?Object(l.a)(Object(l.a)({},e),{},{fullName:e.target}):e.targetModel?Object(l.a)(Object(l.a)({},e),{},{fullName:e.targetModel}):Object(l.a)(Object(l.a)({},e),{},{modelType:cs,name:e.jsonTarget})},yu=function(e,t){var n,a=e;if(e&&(null===e||void 0===e?void 0:e.selected)&&(null===e||void 0===e||null===(n=e.selected)||void 0===n?void 0:n.value)){var i="".concat(e.selected.value).split(".");if(t===os.CONTEXT)return{contextModel:{name:zs(i[0])}};if(t===os.SELF)return a.selected=Object(l.a)(Object(l.a)({},a.selected),{},{value:i[0]}),{value:a}}return{}},gu=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=n.find((function(e){return e.name===t.name}));if(!a)for(var i=0;i<n.length;i++){var r=n[i],o=Object(cl.get)(r,"value.fields");if(o&&(a=e(t,o)))break}return a},ju=function e(t,n){return t.map((function(t){var a=Object(l.a)({},t),i=!1;if(a.value&&a.value.fields){var r=e(a.value.fields,n);i=-1!==r.findIndex((function(e){return!1===e.isHidden})),a=Object(l.a)(Object(l.a)({},a),{},{value:Object(l.a)(Object(l.a)({},a.value),{},{fields:r})})}return t.name.toLowerCase().includes(n.toLowerCase())||i?a.isHidden=!1:a.isHidden=!0,a}))},xu=function e(t){var n=t.fields,a=void 0===n?[]:n,i=t.from,r=void 0===i?os.PARENT:i,o=t.shouldChangeFrom,c=void 0===o||o;return a.map((function(t){var n=Object(l.a)({},t);if(Object(cl.get)(n,"value.from")===r&&(c&&(n.value.from=os.NONE),n.value&&n.value.selected&&(n=Object.assign({},Object(l.a)(Object(l.a)({},n),{},{value:Object(l.a)(Object(l.a)({},n.value),{},{selected:Object(l.a)(Object(l.a)({},n.value.selected),{},{value:null})})}))),n.modelSubField=[]),n.value&&n.value.fields){var a=Object(p.a)(e({fields:n.value.fields,from:r,shouldChangeFrom:c}));n=Object.assign({},Object(l.a)(Object(l.a)({},n),{},{value:Object(l.a)(Object(l.a)({},n.value),{},{fields:a})}))}return n}))};var Ou=function(e){var t=e.params,n=e.onSave,a=e.handleClose,r=e.open,c=e.bpmnModeler,s=fu(),d=du(),b=d.state,h=d.update,v=b.builderFields,y=o.a.useState(),j=Object(u.a)(y,2),x=j[0],O=j[1],w=o.a.useState(),E=Object(u.a)(w,2),N=E[0],C=E[1],S=o.a.useState([]),_=Object(u.a)(S,2),k=_[0],M=_[1],P=o.a.useState(!1),T=Object(u.a)(P,2),R=T[0],A=T[1],F=o.a.useState(!1),B=Object(u.a)(F,2),D=B[0],L=B[1],I=o.a.useState({}),V=Object(u.a)(I,2),$=V[0],z=V[1],W=o.a.useState([]),G=Object(u.a)(W,2),H=G[0],U=G[1],K=o.a.useState({}),q=Object(u.a)(K,2),J=q[0],Y=q[1],X=o.a.useState(!1),Q=Object(u.a)(X,2),Z=Q[0],ee=Q[1],te=o.a.useState(!1),ne=Object(u.a)(te,2),ae=ne[0],ie=ne[1],re=o.a.useState({alertMessage:"Add all values",alertTitle:"Error"}),oe=Object(u.a)(re,2),ce=oe[0],se=oe[1],le=o.a.useState(!1),ue=Object(u.a)(le,2),pe=ue[0],de=ue[1],me=o.a.useCallback((function(e){h((function(t){Object(cl.set)(t,"builderFields",e)}))}),[h]),fe=o.a.useCallback((function(e,t,n,a){h((function(t){var i=t.builderFields.findIndex((function(t){return t.name===e.name})),r=t.builderFields[i];if("value.from"===n&&[os.CONTEXT,os.SELF].includes(Object(cl.get)(r,"value.from"))){var o=Object(cl.get)(r,"value.fields",[]);if(o.length){var c=xu({fields:o});Object(cl.set)(t.builderFields,"[".concat(i,"].value.fields"),c)}}if("value.selected"===n&&[os.CONTEXT,os.SELF].includes(Object(cl.get)(r,"value.from"))){var s=Object(cl.get)(r,"value.fields",[]);if(s.length){var l=xu({fields:s,shouldChangeFrom:!1});Object(cl.set)(t.builderFields,"[".concat(i,"].value.fields"),l)}}Object(cl.set)(t.builderFields,"[".concat(i,"].").concat(n),a)}))}),[h]),be=o.a.useCallback((function(e){h((function(t){var n=t.builderFields.findIndex((function(t){return t.name===e.name}));-1!==n&&(t.builderFields[n].isRemoved=!0)}))}),[h]),he=o.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(n,a){var i,r,o,c,s,u,p,d,f,b,v,y;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=32;break}if(i=n.target||bu(n),r=$[i],o=JSON.parse(t.resultMetaField||"{}"),c=Object(cl.get)(o,"fields",[]),$[i]){e.next=24;break}if(x.modelType!==cs){e.next=12;break}return e.next=9,Cs(Object(l.a)({},n));case 9:r=e.sent,e.next=15;break;case 12:return e.next=14,Es(vu(n));case 14:r=e.sent;case 15:z(Object(Uc.a)({},i,r)),s="".concat(n.dataPath,".value.fields"),u=[],p=gu(n,c),d=Object(cl.get)(p,"value.fields",[]),Hs(r).forEach((function(e,t){var n=d.find((function(t){return t.name===e.name}))||{},a=n.value,i=Object(cl.get)(n,"value.from"),r=yu(a,i);u.push(Object(l.a)(Object(l.a)({},e),{},{dataPath:"".concat(s,"[").concat(t,"]"),from:i,value:a,hideFields:!0,isRemoved:!0,modelSubField:n.modelSubField},r))})),h((function(e){Object(cl.set)(e.builderFields,"".concat(n.dataPath,".value.fields"),u),Object(cl.set)(e.builderFields,"".concat(n.dataPath,".hideFields"),!1)})),e.next=30;break;case 24:f=[],b="".concat(n.dataPath,".value.fields"),v=gu(n,c),y=Object(cl.get)(v,"value.fields",[]),Hs(r).forEach((function(e,t){var n=y.find((function(t){return t.name===e.name}))||{},a=n.value,i=Object(cl.get)(n,"value.from"),r=yu(a,i);f.push(Object(l.a)(Object(l.a)({},e),{},{dataPath:"".concat(b,"[").concat(t,"]"),from:i,value:a,hideFields:!0,isRemoved:!1,modelSubField:n.modelSubField},r))})),h((function(e){Object(cl.set)(e.builderFields,"".concat(n.dataPath,".value.fields"),f),Object(cl.set)(e.builderFields,"".concat(n.dataPath,".hideFields"),!1)}));case 30:e.next=33;break;case 32:h((function(e){Object(cl.set)(e.builderFields,"".concat(n.dataPath,".hideFields"),!0)}));case 33:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[x,$,h,t]),ve=o.a.useCallback((function(e){h((function(t){e.forEach((function(e){Object(cl.set)(t.builderFields,"".concat(e.dataPath,".isRemoved"),!1)}))}))}),[h]),ye=o.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(n){var a,i,r,o=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.length>1&&void 0!==o[1]?o[1]:{},a=JSON.parse(t.resultMetaField||"{}"),i=Object(cl.get)(a,"fields",[]),r=new Array(i.length),Hs(Object(p.a)(n)).forEach((function(e,t){var n=i.findIndex((function(t){return t.name===e.name})),a=i[n]||{},o=a.value,c=Object(cl.get)(a,"value.from"),s=yu(o,c),u=Object(l.a)(Object(l.a)({},e),{},{path:Ks(e),from:c,value:o,hideFields:!0,isRemoved:!o,modelSubField:hu(a.modelSubField),selfField:a.selfField,sourceField:a.sourceField,processId:a.processId?{name:a.processId}:null},s);-1!==n?(u.dataPath="[".concat(n,"]"),r.splice(n,1,Object(l.a)({},u))):(u.dataPath="[".concat(r.length,"]"),r.push(Object(l.a)({},u)))})),h((function(e){Object(cl.set)(e,"builderFields",r.filter((function(e){return e})))}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,h]),ge=o.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}return e.next=3,Es(t);case 3:a=e.sent,U(Object(p.a)(a)),Y({}),ye(a,n);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[ye]),je=o.a.useCallback((function(e){Y((function(t){return JSON.parse(JSON.stringify(Object(cl.set)(t,e,void 0)))}))}),[]),xe=o.a.useCallback((function(){var e=JSON.parse(t.resultMetaField||"{}"),n=ms(v,e,function(e){return e?os.SOURCE:os.NONE}(N),N),a=function(e){var t="";return e.forEach((function(e){t=""===t?e.name:"".concat(t,".").concat(e.name)})),t}(k);return{fields:n,targetModel:x&&x.name,sourceModel:a&&""!==a?a:void 0,sourceModelList:k,newRecord:D,isJson:(x&&x.modelType)===cs}}),[v,x,D,N,k,t]),Oe=o.a.useCallback(Object(f.a)(m.a.mark((function e(){var a,i,r,o,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Y({}),a=xe(),i=JSON.stringify(Object(l.a)({},a)),x){e.next=6;break}return n(void 0),e.abrupt("return");case 6:return(r=t.model)||(r="CUSTOM"===x.modelType?"com.axelor.meta.db.MetaJsonRecord":x.fullName),e.next=10,Bs(i,r);case 10:o=e.sent,c={resultMetaField:i,resultField:o,targetField:a.targetModel,sourceField:a.sourceModel},n(c);case 13:case"end":return e.stop()}}),e)}))),[t,x,n,xe]),we=o.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:O(t),ge(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[ge]),Ee=Vs(o.a.useCallback((function(e){var t=ju(v,e);me(Object(p.a)(t))}),[v,me]),400),Ne=o.a.useCallback((function(e){var t=e.target.value;Ee(t)}),[Ee]),Ce=o.a.useCallback((function(){ee(!0)}),[]),Se=o.a.useCallback((function(){ee(!1)}),[]),_e=o.a.useCallback((function(e,t){h((function(n){var a=n.builderFields[e];n.builderFields.splice(e,1),n.builderFields.splice(t,0,a)}))}),[h]);return o.a.useEffect((function(){function e(){return(e=Object(f.a)(m.a.mark((function e(){var n,a,i,r,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:if(!(n=JSON.parse(t.resultMetaField||"{}"))||!t.resultMetaField){e.next=19;break}return A(!0),e.next=7,ys(n.targetModel);case 7:return a=e.sent,i=n.sourceModelList&&n.sourceModelList[n.sourceModelList.length-1]||{},r=i.target?i.target.split(".").pop():i.name,e.next=12,ys(r);case 12:o=e.sent,M(Object(p.a)(n.sourceModelList||[])),O(a),C(o),L(n.newRecord),ge(a),A(!1);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,ge]),Object(i.jsxs)(Fc.a,{onClose:function(e,t){"backdropClick"!==t&&a()},"aria-labelledby":"simple-dialog-title",open:r,classes:{paper:s.dialogPaper},children:[Object(i.jsx)(Bc.a,{id:"simple-dialog-title",children:"Script"}),Object(i.jsxs)("div",{className:s.root,children:[Object(i.jsx)(Kc.a,{variant:"outlined",className:s.paper,children:Object(i.jsx)("div",{style:{height:"100%",width:"100%"},children:Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)(qc.a,{container:!0,style:{height:"100%"},children:[Object(i.jsxs)(qc.a,{container:!0,className:s.topView,children:[Object(i.jsx)(qc.a,{container:!0,justify:"space-between",style:{marginBottom:10},children:Object(i.jsx)(qc.a,{item:!0,className:s.metaFieldGrid,children:Object(i.jsx)(qc.a,{container:!0,children:Object(i.jsx)(hl,{data:v,onSubmit:function(e){return ve(e)},icon:Object(i.jsx)(Qc.a,{}),buttonTitle:"Add Fields",iconButton:!0,buttonClassName:s.modelFieldSelection,iconButtonClassName:s.addModelFieldIcon,open:Z,onClose:Se})})})}),Object(i.jsxs)(qc.a,{container:!0,style:{marginBottom:10,alignItems:"flex-end"},children:[Object(i.jsx)(Xs,{className:s.input,name:"metaModal",title:"Target Model",placeholder:"Target Model",fetchAPI:function(e){return js(e)},optionLabelKey:"name",onChange:function(e){return we(e)},value:x,inputRootClass:s.targetModelInputRoot}),Object(i.jsx)(Yl,{containerClassName:s.selectContainer,title:"Source Model",optionValueKey:"name",optionLabelKey:"name",concatValue:!0,isM2o:!0,isContext:!0,value:k,onChange:function(e){var t=e.map((function(e){return!e.fullName&&e.target?Object(l.a)(Object(l.a)({},e),{},{fullName:e.target}):e}));M(Object(p.a)(t)),C(Object(l.a)({},t[t.length-1]))}}),Object(i.jsxs)(qc.a,{item:!0,className:s.newRecordInputView,children:[Object(i.jsx)(Jc.a,{className:s.newRecordSwitch,checked:D,onChange:function(e){return L(e.target.checked)}}),Object(i.jsx)(g.a,{className:s.newRecordSwitchText,children:"New Record"})]})]})]}),Object(i.jsx)(lu,{builderFields:v,data:v,onRowChange:fe,onRemove:be,metaFields:H,errors:J,onClearError:je,onSubFieldAdd:he,handleAdd:ve,sourceModel:N,targetModel:x,bpmnModeler:c,manageFieldClick:Ce,handleFieldSearch:Ne,onReorder:_e})]}),R&&Object(i.jsx)("div",{className:s.loaderView,children:Object(i.jsx)(Yc.a,{size:32})})]})})}),Object(i.jsxs)("div",{children:[Object(i.jsx)(Vc.a,{className:s.save,onClick:Oe,children:"OK"}),Object(i.jsx)(Vc.a,{className:s.save,onClick:function(){var e=JSON.parse(t.resultMetaField||"{}"),n=xe();n&&n.targetModel&&JSON.stringify(e)!==JSON.stringify(n)?(de(!0),ie(!0),se({alertMessage:"Current changes will be lost. Do you really want to proceed?",alertTitle:"Question"})):a()},style:{textTransform:"none"},children:"Cancel"})]})]}),ae&&Object(i.jsxs)(Fc.a,{open:ae,onClose:function(e,t){"backdropClick"!==t&&ie(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",classes:{paper:s.dialog},children:[Object(i.jsx)(Bc.a,{id:"alert-dialog-title",children:ce.alertTitle}),Object(i.jsx)(Dc.a,{children:Object(i.jsx)(Lc.a,{id:"alert-dialog-description",children:ce.alertMessage})}),Object(i.jsxs)(Ic.a,{children:[Object(i.jsx)(Vc.a,{onClick:function(){ie(!1),pe&&a()},color:"primary",autoFocus:!0,className:s.save,children:"Ok"}),Object(i.jsx)(Vc.a,{onClick:function(){ie(!1)},color:"primary",autoFocus:!0,style:{textTransform:"none"},className:s.save,children:"Cancel"})]})]})]})};function wu(e){var t=e.params,n=e.onSave,a=e.handleClose,c=e.open,s=e.bpmnModeler,l=o.a.useState(null),p=Object(u.a)(l,2),d=p[0],m=p[1];return Object(r.useEffect)((function(){var e=t();m(e)}),[t]),Object(i.jsx)("div",{className:"App",children:Object(i.jsx)(Ou,{onSave:n,params:d,handleClose:a,open:c,bpmnModeler:s})})}function Eu(e){var t=e.handleClose,n=e.open,a=e.onSave,r=e.params,o=e.bpmnModeler;return Object(i.jsx)(Gc.a,{backend:Hc.a,children:Object(i.jsx)(mu,{children:Object(i.jsx)(wu,{onSave:a,handleClose:t,open:n,params:r,bpmnModeler:o})})})}var Nu=function(e,t){var n=encodeURIComponent(e),a=document.createElement("a");document.body.appendChild(a),a.setAttribute("href","data:image/svg+xml;utf-8,"+n),a.setAttribute("download",t),a.click()};function Cu(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.sort((function(e,n){var a=e[t],i=n[t];return a<i?-1:a>i?1:0}))}function Su(e,t){return function e(n){var a=n.items,i=void 0===a?[]:a,r=n.jsonFields,o=void 0===r?[]:r;return[].concat(Object(p.a)(i),Object(p.a)(o)).reduce((function(t,n){return[].concat(Object(p.a)(t),Object(p.a)(e(n)))}),n.type===t?[n]:[])}(e)}function _u(e){if(e){var t=e.match(/[A-Z][a-z]+/g);if(t){if(t.join("").trim().length!==e.length)return"fetchAPI";var n=t&&t.join("-");return"".concat(n.toLowerCase(),"-form")}}}function ku(e){return window._t&&"string"===typeof e?window._t(e):e}function Mu(e){return!!e&&!!JSON.parse(String(e).toLowerCase())}var Pu=n(298),Tu=Object(ts.a)({desciption:{marginTop:5,color:"#999"},error:{color:"#CC3333"}});function Ru(e){var t=e.desciption,n=e.type,a=Tu();return Object(i.jsx)("div",{className:ul()(a.desciption,n&&a.error),children:t})}var Au=Object(ts.a)({root:{display:"flex",flexDirection:"column",marginTop:5},label:{fontWeight:"bolder",display:"inline-block",verticalAlign:"middle",color:"#666",marginBottom:3},textarea:{fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif",resize:"vertical",borderColor:"#ccc","&:focus":{boxShadow:"rgba(82, 180, 21, 0.2) 0px 0px 1px 2px",outline:"none",borderColor:"rgb(82, 180, 21)"}},error:{borderColor:"#cc3333 !important",background:"#f0c2c2","&:focus":{boxShadow:"rgba(204,58,51, 0.2) 0px 0px 1px 2px !important",outline:"none",borderColor:"#cc3333 !important"}},readOnly:{borderColor:"#ccc !important",background:"#E3E3E3",color:"#7E7E7E","&:focus":{boxShadow:"none !important",outline:"none",borderColor:"#ccc !important"}}});function Fu(e){var t=e.entry,n=e.element,a=e.rows,c=void 0===a?1:a,s=e.bpmnModeler,l=e.className,p=e.readOnly,d=Au(),m=t||{},f=m.label,b=m.description,h=m.name,v=m.validate,y=m.get,g=m.set,j=Object(r.useState)(null),x=Object(u.a)(j,2),O=x[0],w=x[1],E=Object(r.useState)(null),N=Object(u.a)(E,2),C=N[0],S=N[1],_=Object(r.useState)(!1),k=Object(u.a)(_,2),M=k[0],P=k[1],T=o.a.useCallback((function(){return y?y(n)[h]:n.businessObject[h]}),[n,y,h]),R=function(e){!function(e){g?(g(n,Object(Uc.a)({},h,e)),w(e)):s.get("modeling").updateProperties(n,Object(Uc.a)({},h,e))}(e),w(e);var t=A();P(t)},A=o.a.useCallback((function(){if(!v||(null===O||void 0===O)&&"id"===h)return S(null),!1;var e=v(n,Object(Uc.a)({},h,""===O?void 0:O));return e&&e[h]?(S(e[h]),!0):(S(null),!1)}),[v,n,O,h]);return Object(r.useEffect)((function(){var e=A();P(e)}),[A]),Object(r.useEffect)((function(){if(n){var e=T(n);w(e)}}),[n,T,t]),Object(i.jsxs)("div",{className:ul()(d.root,l),children:[Object(i.jsx)("label",{className:d.label,children:f}),Object(i.jsx)(Pu.a,{id:"camunda_".concat(h,"_").concat(Date()),value:O||"",className:ul()(d.textarea,M&&d.error,p&&d.readOnly),rowsMin:c,onBlur:function(e){p||R(e.target.value)},onChange:function(e){w(e.target.value)},readOnly:"function"===typeof p?p():p}),C&&Object(i.jsx)(Ru,{desciption:C,type:"error"}),b&&Object(i.jsx)(Ru,{desciption:b})]})}var Bu=Object(ts.a)({root:{display:"flex",flexDirection:"column",marginTop:5,width:"100%"},error:{borderColor:"#cc3333 !important",background:"#f0c2c2","&:focus":{boxShadow:"rgba(204,58,51, 0.2) 0px 0px 1px 2px !important",outline:"none",borderColor:"#cc3333 !important"}},label:{fontWeight:"bolder",display:"inline-block",verticalAlign:"middle",color:"#666",marginBottom:3},fieldWrapper:{position:"relative"},input:{width:"calc(100% - 35px)",padding:"3px 28px 3px 6px ",border:"1px solid #ccc","&:focus":{boxShadow:"rgba(82, 180, 21, 0.2) 0px 0px 1px 2px",outline:"none",borderColor:"rgb(82, 180, 21)"}},clearButton:{background:"transparent",border:"none",top:0,right:0,position:"absolute",height:23,width:24,overflow:"hidden",cursor:"pointer",display:"flex",alignItems:"center"},clear:{fontSize:"1rem"},readOnly:{borderColor:"#ccc !important",background:"#E3E3E3","&:focus":{boxShadow:"none !important",outline:"none",borderColor:"#ccc !important"}}});function Du(e){var t=e.entry,n=e.element,a=e.canRemove,c=void 0!==a&&a,s=e.rootClass,l=e.labelClass,p=e.type,d=void 0===p?"text":p,m=e.isLabel,f=void 0===m||m,b=e.readOnly,h=void 0!==b&&b,v=e.bpmnModeler,y=Bu(),g=t||{},j=g.label,x=g.description,O=g.name,w=g.modelProperty,E=g.set,N=g.get,C=Object(r.useState)(null),S=Object(u.a)(C,2),_=S[0],k=S[1],M=o.a.useCallback((function(){return n.businessObject[O]}),[n,O]),P=function(e){E?E(n,Object(Uc.a)({},w,e)):function(e){v&&v.get("modeling").updateProperties(n,Object(Uc.a)({},O,e))}(e)};return Object(r.useEffect)((function(){if(n){var e;if(N){var t=N();e=t&&t[w]}else e=M();k(e)}}),[n,N,M,w]),Object(i.jsxs)("div",{className:ul()(y.root,s),children:[f&&Object(i.jsx)("label",{className:ul()(y.label,l),children:j}),Object(i.jsxs)("div",{className:y.fieldWrapper,children:[Object(i.jsx)("input",{id:"camunda-".concat(O,"_").concat(Date()),type:d,readOnly:h,name:O,value:_||"",onChange:function(e){return k(e.target.value)},className:ul()(y.input,h&&y.readOnly),onBlur:function(e){return P(e.target.value)}}),c&&_&&Object(i.jsx)("button",{onClick:function(){k(""),P(void 0)},className:y.clearButton,children:Object(i.jsx)(rl.a,{className:y.clear})})]}),x&&Object(i.jsx)(Ru,{desciption:x})]})}var Lu=Object(ts.a)({root:{display:"flex",flexDirection:"column",marginTop:5},label:{fontWeight:"bolder",display:"inline-block",verticalAlign:"middle",color:"#666",marginBottom:3}});function Iu(e){var t=e.entry,n=e.element,a=Lu(),c=t||{},s=c.id,l=c.name,p=c.emptyParameter,d=c.selectOptions,m=c.canBeDisabled,f=c.canBeHidden,b=c.label,h=c.modelProperty,v=c.description,y=c.set,g=c.get,j=Object(r.useState)([]),x=Object(u.a)(j,2),O=x[0],w=x[1],E=Object(r.useState)(null),N=Object(u.a)(E,2),C=N[0],S=N[1],_=function(e){n.businessObject[l]=e},k=o.a.useCallback((function(){return n.businessObject[l]}),[n,l]);return Object(r.useEffect)((function(){if(n){var e=g&&g(n),t=k?k(n):e&&e[h];S(t)}}),[n,h,g,k]),Object(r.useEffect)((function(){if("object"===typeof d)w(d);else{var e=d(n);e&&w(e)}}),[d,n]),Object(i.jsxs)("div",{className:a.root,children:[Object(i.jsx)("label",{htmlFor:"camunda-".concat(s),className:a.label,children:b}),Object(i.jsxs)("select",{id:"camunda-".concat(s,"-select"),name:h,"data-disable":m?"isDisabled":"","data-show":f?"isHidden":"",value:C||"",onChange:function(e){S(e.target.value),(y||_)&&(y?y(n,Object(Uc.a)({},h,e.target.value)):_(e.target.value))},children:[O&&O.map((function(e,t){return Object(i.jsxs)("option",{value:e.value,children:[e.name?e.name:""," "]},t)})),p&&Object(i.jsx)("option",{value:""})]}),v&&Object(i.jsx)(Ru,{desciption:v})]})}var Vu=Object(ts.a)({root:{display:"flex",alignItems:"center",marginTop:5},label:{fontWeight:"bolder",color:"#666"},checkbox:{margin:"3px 3px 3px 0px"}});function $u(e){var t=e.entry,n=e.element,a=e.className,c=Vu(),s=t||{},l=s.id,p=s.name,d=s.label,m=s.modelProperty,f=s.get,b=s.set,h=s.defaultValue,v=void 0!==h&&h,y=Object(r.useState)(v),g=Object(u.a)(y,2),j=g[0],x=g[1],O=o.a.useCallback((function(e){n.businessObject[p]=e.toString()}),[n,p]),w=o.a.useCallback((function(){return Mu(n.businessObject[p]||n.businessObject.$attrs[p])}),[n,p]);return Object(r.useEffect)((function(){if(n){var e;if(f){var t=f(n);e=t&&t[m]}else e=w(),O(e);x(e)}}),[n,m,f,w,O]),Object(i.jsxs)("div",{className:ul()(c.root,a),children:[Object(i.jsx)("input",{id:"camunda-".concat(l),type:"checkbox",name:m,checked:j,onChange:function(e){x((function(e){return!e})),b?b(n,Object(Uc.a)({},m,e.target.checked)):O(e.target.checked)},className:c.checkbox}),d&&Object(i.jsx)("label",{htmlFor:"camunda-".concat(l),className:c.label,children:d})]})}var zu=Object($c.a)((function(e){return{autoComplete:{"& > div > label":{fontSize:14},"& > div > div":{paddingRight:"15px !important"},background:"white",border:"1px solid #ccc",padding:"0px 5px"},input:{fontSize:14,color:e.palette.common.black,padding:"3px 0 3px !important"},label:{fontSize:14},endAdornment:{top:0},circularProgress:{color:"#0A73FA"},error:{borderColor:"#cc3333 !important",background:"#f0c2c2","&:focus":{boxShadow:"rgba(204,58,51, 0.2) 0px 0px 1px 2px !important",outline:"none",borderColor:"#cc3333 !important"}},errorDescription:{marginTop:5,color:"#CC3333"},labelTitle:{fontWeight:"bolder",display:"inline-block",verticalAlign:"middle",color:"#666",marginBottom:3},container:{marginTop:10}}}));function Wu(e){var t=e.optionLabel,n=void 0===t?"name":t,a=e.multiple,c=void 0!==a&&a,s=e.index,d=e.value,m=e.update,f=e.criteriaIds,b=e.type,h=e.options,v=e.entry,y=e.isLabel,g=void 0!==y&&y,j=e.error,x=void 0!==j&&j,O=e.className,w=e.defaultValue,E=e.placeholder,N=e.validate,C=e.bpmnModeler,S=e.element,_=e.onChange,k=Object(r.useState)(!1),M=Object(u.a)(k,2),P=M[0],T=M[1],R=Object(r.useState)([]),A=Object(u.a)(R,2),F=A[0],B=A[1],D=Object(r.useState)(null),L=Object(u.a)(D,2),I=L[0],V=L[1],$=Object(r.useState)(!1),z=Object(u.a)($,2),W=z[0],G=z[1],H=Object(r.useState)(null),U=Object(u.a)(H,2),K=U[0],q=U[1],J=Object(r.useState)(!1),Y=Object(u.a)(J,2),X=Y[0],Q=Y[1],Z=zu(),ee=v.name,te=v.label,ne=v.fetchMethod,ae=function(e,t){C&&(C.get("modeling").updateProperties(S,Object(Uc.a)({},ee,e)),_&&_(t))},ie=Object(r.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";G(!0);var t=[];if(e&&t.push({fieldName:n,operator:"like",value:e}),ne&&P)return ne(t).then((function(e){e&&(B(e||[]),G(!1))}));G(!1)}),[n,ne,P]);!function(e,t){var n=Object(r.useRef)(!1);Object(r.useEffect)((function(){if(n.current){var a=setTimeout((function(){return e()}),t);return function(){return clearTimeout(a)}}n.current=!0}),[e,t])}(o.a.useCallback((function(){I&&ie(I,f)}),[ie,I,f]),500);var re=o.a.useCallback((function(){if(!N||(null===d||void 0===d)&&"id"===ee)return q(null),!1;var e=N(Object(Uc.a)({},ee,""===d?void 0:d));return e&&e[ee]?(q(e[ee]),!0):(q(null),!1)}),[N,d,ee]);return Object(r.useEffect)((function(){var e=re();Q(e)}),[re]),Object(r.useEffect)((function(){(!P||h&&h.length<1)&&B([])}),[P,h]),Object(r.useEffect)((function(){P&&(h&&h.length>0?B(Object(p.a)(h)):ie(null,f))}),[ie,P,f,h]),Object(r.useEffect)((function(){h&&(G(!0),B(h),G(!1))}),[h]),Object(i.jsxs)("div",{className:Z.container,children:[Object(i.jsx)("label",{className:Z.labelTitle,children:te}),Object(i.jsx)(ns.a,{classes:{inputFocused:Z.input,clearIndicator:Z.input,popupIndicator:Z.input,endAdornment:Z.endAdornment},size:"small",open:P,onOpen:function(e){e&&e.stopPropagation(),T(!0)},onClose:function(e){e&&e.stopPropagation(),T(!1)},onClick:function(e){e&&e.stopPropagation(),T(!0)},loading:W,defaultValue:function(){return w||S.businessObject[ee]},clearOnEscape:!0,autoComplete:!0,className:ul()(Z.autoComplete,O,X&&Z.error),options:F,multiple:c,value:d,getOptionSelected:function(e,t){if(t){var a;return e[a=e[n]?n:e.title?"title":"name"]===(t.id?t[a]:t)}},onChange:function(e,t){var a=t;"multiple"===b&&(a=t&&t.filter((function(e,t,a){return t===a.findIndex((function(t){return t[n]===e[n]}))}))),m?m(a,t&&t[n]):ae(t&&t[n],t)},name:ee,onInputChange:function(e,t){return V(t)},renderInput:function(e){return Object(i.jsx)(es.a,Object(l.a)(Object(l.a)({error:x,helperText:x?"Required":"",className:X?Z.error:"",fullWidth:!0},e),{},{InputProps:Object(l.a)(Object(l.a)({},e.InputProps||{}),{},{endAdornment:Object(i.jsxs)(o.a.Fragment,{children:[W?Object(i.jsx)(Yc.a,{className:Z.circularProgress,size:15}):null,e.InputProps.endAdornment]}),onClick:function(e){return e&&e.stopPropagation()},disableUnderline:!0}),inputProps:Object(l.a)(Object(l.a)({},e.inputProps||{}),{},{onClick:function(t){t&&t.stopPropagation(),e.inputProps&&e.inputProps.onClick&&e.inputProps.onClick(t)}}),placeholder:E||te||"",InputLabelProps:{className:Z&&Z.label},label:g?te:void 0}))},getOptionLabel:function(e){return e[n]?e[n]:e.title?e.title:"object"===typeof e?"":e}},s),K&&Object(i.jsx)("div",{className:Z.errorDescription,children:K})]})}var Gu=Object(ts.a)({root:{display:"flex",flexDirection:"column",marginTop:10},assignElements:{width:"100%"},label:{fontWeight:"bolder",display:"inline-block",verticalAlign:"middle",color:"#666",marginBottom:3},add:{top:"-23px !important",position:"absolute",height:23,width:24,overflow:"hidden",cursor:"pointer",backgroundColor:"#f8f8f8",border:"1px solid #ccc",borderBottom:"none",right:0},clear:{top:"-23px !important",position:"absolute",height:23,width:24,overflow:"hidden",cursor:"pointer",backgroundColor:"#f8f8f8",border:"1px solid #ccc",borderBottom:"none",right:23},container:{position:"relative"}});function Hu(e){var t=e.entry,n=e.options,a=Gu(),o=t||{},c=o.label,s=o.defaultSize,l=void 0===s?5:s,d=o.id,m=o.setOptionLabelValue,f=o.createExtensionElement,b=o.onSelectionChange,h=o.removeExtensionElement,v=Object(r.useState)([]),y=Object(u.a)(v,2),g=y[0],j=y[1],x=Object(r.useState)(null),O=Object(u.a)(x,2),w=O[0],E=O[1],N=function(e){E(e.target.value),b(e.target.value)};return Object(r.useEffect)((function(){n&&j(n)}),[n]),Object(i.jsx)("div",{className:a.root,children:Object(i.jsxs)("div",{children:[Object(i.jsx)("label",{htmlFor:"cam-assignElements-".concat(d),className:a.label,children:c}),Object(i.jsxs)("div",{className:a.container,children:[Object(i.jsx)("select",{id:"cam-assignElements-".concat(d),className:a.assignElements,name:"selectedExtensionElement",size:l,"data-list-entry-container":!0,value:w||"",onChange:function(){},children:g&&g.length>0&&g.map((function(e){return Object(i.jsx)("option",{value:e.id,onClick:N,children:e.text},e.id)}))}),Object(i.jsx)("button",{className:a.add,id:"cam-assignElements-create-".concat(d),onClick:function(){f();var e=m(g.length);j((function(t){return[].concat(Object(p.a)(t||[]),[{id:t.length,text:e}])})),E(g.length),b(g.length)},children:Object(i.jsx)("span",{children:"+"})}),Object(i.jsx)("button",{className:a.clear,id:"cam-assignElements-remove-".concat(d),onClick:function(){h(w)},children:Object(i.jsx)("span",{style:{fontSize:10},children:"X"})})]})]})})}var Uu=n(366),Ku=Object($c.a)((function(e){return{root:{display:"flex",flexWrap:"wrap"},select:{width:"150px"}}}));function qu(e){var t=e.name,n=e.value,a=void 0===n?"":n,r=e.onChange,o=e.options,c=e.title,s=e.className,u=e.disableUnderline,p=void 0!==u&&u,d=Object(Zc.a)(e,["name","value","onChange","options","title","className","disableUnderline"]),m=Ku();return Object(i.jsxs)(Bl.a,{className:ul()(m.formControl,s),children:[Object(i.jsx)(Dl.a,{children:c}),Object(i.jsx)(Ll.a,Object(l.a)(Object(l.a)({disableUnderline:p,value:a,onChange:function(e){return r(e.target.value)},name:t,style:{marginRight:8},classes:{select:ul()(m.select,s)}},d),{},{children:o&&Array.isArray(o)&&o.map((function(e,t){var n=e.name,a=e.title;return Object(i.jsx)(Fl.a,{value:n,children:a},t)}))}))]})}function Ju(e){var t=e.name,n=e.title,a=e.autoTitle,r=e.value,o=void 0===r?"":r,c=e.onChange,s=e.onBlur,u=e.readOnly,p=e.inline,d=e.InputProps,m=e.style,f=e.disableUnderline,b=void 0!==f&&f,h=e.className,v=Object(Zc.a)(e,["name","title","autoTitle","value","onChange","onBlur","readOnly","inline","InputProps","style","disableUnderline","className"]);return p?Object(i.jsx)(wl.a,Object(l.a)({style:Object(l.a)({width:"100%"},m),className:h,placeholder:n,inputProps:{"aria-label":n,disableUnderline:b},name:t,onChange:function(e){return c(e.target.value)},onBlur:s,autoComplete:"off",readOnly:u,disabled:u,value:o||""},v)):Object(i.jsx)(es.a,Object(l.a)({id:"filled-".concat(t),label:n||a,name:t,style:Object(l.a)({width:"100%"},m),onChange:function(e){return c(e.target.value)},onBlur:s,autoComplete:"off",InputProps:Object(l.a)(Object(l.a)({readOnly:u},d),{},{disableUnderline:b}),value:o||"",className:ul()(v.className,h)},v))}Ju.defaultProps={rows:3,readOnly:!1};var Yu=Ju,Xu=Object($c.a)((function(e){return{button:{color:"#0275d8",textTransform:"none"},buttonLabel:{maxHeight:30}}}));var Qu=function(e){var t=e.title,n=e.Icon,a=e.onClick,r=e.className,o=Xu();return t?n?Object(i.jsx)(Vc.a,{className:ul()(o.button,o.buttonLabel,r),endIcon:Object(i.jsx)(n,{}),onClick:a,children:t}):Object(i.jsx)(Vc.a,{className:ul()(o.button,o.buttonLabel,r),onClick:a,children:t}):Object(i.jsx)(v.a,{size:"medium",onClick:a,className:ul()(o.button,r),style:{padding:"0px 12px"},children:Object(i.jsx)(n,{fontSize:"small"})})};function Zu(e){var t=e.type,n=void 0===t?"integer":t,a=e.title,c=e.onChange,s=e.value,p=void 0===s?0:s,d=(e.readOnly,e.scale),m=void 0===d?2:d,f=(e.customeFormat,e.onBlur),b=e.className,h=e.disableUnderline,v=Object(Zc.a)(e,["type","title","onChange","value","readOnly","scale","customeFormat","onBlur","className","disableUnderline"]),y=Object(r.useState)(p),g=Object(u.a)(y,2),j=g[0],x=g[1],O=Object(r.useCallback)((function(e){return Number(Number(e).toFixed("integer"===n?0:m))}),[n,m]);return o.a.useEffect((function(){x(O(p))}),[p,x,O]),Object(i.jsx)(Yu,Object(l.a)({className:b,onChange:x,title:a,type:"number",value:"".concat(j),onBlur:function(e){c(O(j)),x(O(j)),f&&f(e)},disableUnderline:h},v))}Zu.defaultProps={readOnly:!1};var ep=Zu,tp=[{name:"and",title:"AND"},{name:"or",title:"OR"}],np={and:"&&",or:"||"},ap={and:"and",or:"or"},ip={JS:".",GROOVY:"?.",BPM:"."},rp={date:"DD/MM/YYYY",time:"HH:mm:ss",datetime:"DD/MM/YYYY HH:mm"},op=["=",">=","<=",">","<","like","isNull","between","contains","in","isTrue"],cp=["many_to_many","many-to-many","json_many_to_many","json-many-to-many","one_to_one","one-to-one","json_one_to_one","json-one-to-one","enum"],sp=["long","decimal","date","time","datetime","enum","text","integer","boolean","many_to_many","many-to-many","json_many_to_many","json-many-to-many","many_to_one","many-to-one","json_many_to_one","json-many-to-one","one_to_one","one-to-one","json_one_to_one","json-one-to-one","string"],lp={enum:["=","!=","isNull","isNotNull"],text:["like","notLike","isNull","isNotNull"],integer:["=","!=",">=","<=",">","<","between","notBetween","isNull","isNotNull"],boolean:["isTrue","isFalse"],button:["="]},up={JS:{"=":"===","!=":"!==",">":">",">=":">=","<":"<","<=":"<=",in:"in",notIn:"in",like:"LIKE",notLike:"NOT LIKE",isNotNull:"!== null",isNull:"=== null",isTrue:"===",isFalse:"==="},GROOVY:{"=":"==","!=":"!=",">":">",">=":">=","<":"<","<=":"<=",isNotNull:"!= null",isNull:"== null",isTrue:"==",isFalse:"==",in:"contains",notIn:"contains",like:"contains",notLike:"contains",contains:"contains",notContains:"contains"},BPM:{"=":"=","!=":"!=",">":">",">=":">=","<":"<","<=":"<=",isNotNull:"is NOT NULL",isNull:"is NULL",isTrue:"is",isFalse:"is",in:"IN",notIn:"NOT IN",like:"LIKE",notLike:"NOT LIKE",contains:"MEMBER OF",notContains:"NOT MEMBER OF"}},pp=[{name:"=",title:"equals"},{name:"!=",title:"not equal"},{name:">",title:"greater than"},{name:">=",title:"greater or equal"},{name:"<",title:"less than"},{name:"<=",title:"less or equal"},{name:"in",title:"in"},{name:"between",title:"between"},{name:"notBetween",title:"not Between"},{name:"notIn",title:"not in"},{name:"isNull",title:"is null"},{name:"isNotNull",title:"is not null"},{name:"like",title:"contains"},{name:"notLike",title:"doesn't contain"},{name:"isTrue",title:"is true"},{name:"isFalse",title:"is false"},{name:"contains",title:"contains"},{name:"notContains",title:"not contains"}],dp={date:kl.a,time:Ml.a,datetime:Pl.a};var mp=function(e){var t=e.inline,n=e.type,a=void 0===n?"date":n,c=e.disableUnderline,s=void 0!==c&&c,p=e.className,d=Object(Zc.a)(e,["inline","type","disableUnderline","className"]),m=Object(r.useState)(!1),f=Object(u.a)(m,2),b=f[0],h=f[1],v=o.a.useRef(),y=(d.name,d.title),g=d.format,j=(d.error,d.onChange),x=Object(Zc.a)(d,["name","title","format","error","onChange"]),O=dp[a];return Object(i.jsx)(Tl.a,{utils:_l.a,children:Object(i.jsx)(O,Object(l.a)(Object(l.a)(Object(l.a)(Object(l.a)({autoOk:!0,open:b,ampm:!1,views:"date"===a?["date"]:"datetime"===a?["date","hours","minutes"]:"time"===a?["hours","minutes","seconds"]:["date"],InputProps:{disableUnderline:s},onChange:function(e){v.current=e,j(e)},PopoverProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},disableToolbar:!0,variant:"inline"},t?{invalidDateMessage:""}:{}),{},{className:p,style:Object(l.a)({width:"100%"},t?{margin:0}:{}),label:t?"":y,format:g||rp[a]},"time"!==a?{animateYearScrolling:!1}:{}),x),{},{onKeyDown:function(e){40===e.keyCode&&h(!0)},onClose:function(){j(v.current),h(!1)},onOpen:function(){return h(!0)}}))})};function fp(e){return"bpmQuery"===e}function bp(e){if(e)return e.charAt(0).toLowerCase()+e.slice(1)}var hp=function(e,t,n){var a=e.type,i=e.jsonField,r=e.targetName;switch(a){case"text":case"string":case"date":case"datetime":case"time":return"json_extract_text(".concat(t,".").concat(i,",'").concat(n,"')");case"many-to-one":case"json-many-to-one":case"many_to_one":case"json_many_to_one":return r?"json_extract_text(".concat(t,".").concat(i,",'").concat(n,"','").concat(r,"')"):"json_extract_text(".concat(t,".").concat(i,",'").concat(n,"')");case"integer":return"json_extract_integer(".concat(t,".").concat(i,",'").concat(n,"')");case"decimal":return"json_extract_decimal(".concat(t,".").concat(i,",'").concat(n,"')");case"boolean":return"json_extract_boolean(".concat(t,".").concat(i,",'").concat(n,"')")}},vp={JS:".",GROOVY:"?.",BPM:"."},yp=Object(ts.a)((function(e){return{listbox:{maxHeight:"300px !important"},chip:{"&.MuiChip-outlined .MuiChip-deleteIconSmall":{color:"#0275d8"},border:"1px solid #0275d8",color:"#0275d8"}}}));function gp(e){var t=Object(r.useState)(!1),n=Object(u.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)([]),p=Object(u.a)(s,2),d=p[0],b=p[1],h=Object(r.useState)(e.isMulti?[]:null),v=Object(u.a)(h,2),y=v[0],g=v[1],j=Object(r.useState)(""),x=Object(u.a)(j,2),O=x[0],w=x[1],E=e.name,N=e.value,C=e.onChange,S=e.options,_=e.optionLabelKey,k=void 0===_?"title":_,M=e.optionValueKey,P=void 0===M?"id":M,T=e.isMulti,R=void 0!==T&&T,A=e.title,F=e.fetchAPI,B=e.inline,D=e.InputProps,L=e.error,I=e.filterSelectedOptions,V=void 0!==I&&I,$=e.disableCloseOnSelect,z=void 0===$||$,W=e.readOnly,G=Object(Zc.a)(e,["name","value","onChange","options","optionLabelKey","optionValueKey","isMulti","title","fetchAPI","inline","InputProps","error","filterSelectedOptions","disableCloseOnSelect","readOnly"]),H=yp(),U=Object(r.useState)(!1),K=Object(u.a)(U,2),q=K[0],J=K[1],Y=o.a.useCallback((function(e){return S&&S.find((function(t){return t&&t[P]===e.trim()}))}),[S,P]);function X(){return(X=Object(f.a)(m.a.mark((function e(){var t,n=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.length>0&&void 0!==n[0]?n[0]:"",w(t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Q=function(e,t){var n=o.a.useRef(null),a=function(){return n.current&&clearTimeout(n.current)},i=function(e){return n.current=setTimeout(e,t)};return o.a.useEffect((function(){return function(){return a()}}),[]),function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];a(),i((function(){return e.apply(void 0,n)}))}}((function(){return X.apply(this,arguments)}),400);function Z(e){"Backspace"===e.key&&y&&y[k]===O&&C(null)}function ee(e){C("string"===typeof N?R?e.map((function(e){return e&&e[P]})).join(",")||[]:e&&e[P]:e)}Object(r.useEffect)((function(){var e=!0;return a&&(J(!0),F?Object(f.a)(m.a.mark((function t(){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F({search:O});case 2:n=t.sent,e&&(b(n),J(!1));case 4:case"end":return t.stop()}}),t)})))():(b(S),J(!1))),function(){e=!1,J(!1)}}),[F,S,O,a]),Object(r.useEffect)((function(){if("string"===typeof N){var e=N.split(",");g(R?e.map((function(e){return Y(e)})):Y(e[0]))}else g(N||(R?[]:null))}),[N,R,Y]);var te=function(e){return"metaJsonModel"===(e&&e.type)?"".concat(e&&e.title," (").concat(e&&e[k]?e[k]:"",") (Custom model)")||!1:"fieldName"===E?"".concat(ku(e&&e.title?e.title:"")," (").concat(e&&e[k],")"):"metaModel"===(e&&e.type)?"".concat(e&&e.title?e.title:""," (").concat(e&&e[k]?e[k]:"",")")||!1:"dmnModel"===(e&&e.type)?"".concat(e&&e.dmnNodeNameId?e.dmnNodeNameId:""," (").concat(e&&e.resultVariable?e.resultVariable:"",")")||!1:e?e[k]?e[k]:e.id?e.id.toString():"":""};return Object(i.jsx)(ns.a,Object(l.a)(Object(l.a)({getOptionSelected:function(e,t){return R?e[P]===t[P]:te(e)===te(t)},getOptionLabel:function(e){return te(e)},disabled:W,loading:q,id:is()("select-widget"),open:a,onOpen:function(){return c(!0)},onClose:function(){return c(!1)},value:y?R?Array.isArray(y)?y:[]:y:R?[]:null,onChange:function(e,t){return ee(t)},options:d||[],multiple:R,filterSelectedOptions:V,onInputChange:function(e,t){return Q(t)},classes:{option:"menu-item",listbox:H.listbox},renderTags:function(e,t){return e.map((function(e,n){return Object(i.jsx)(Hl.a,Object(l.a)({variant:"outlined",label:e[k],size:"small",classes:{root:H.chip}},t({index:n})))}))},renderInput:function(e){return Object(i.jsx)(es.a,Object(l.a)(Object(l.a)({},e),{},{error:L,label:B?"":A,fullWidth:!0,onClick:function(){W||c(!0)},InputProps:Object(l.a)(Object(l.a)(Object(l.a)({},D),e.InputProps),{},{endAdornment:Object(i.jsxs)(o.a.Fragment,{children:[q?Object(i.jsx)(Yc.a,{className:H.circularProgress,size:15}):null,e.InputProps.endAdornment]})})},R?{}:{onKeyDown:Z}))}},R?{disableCloseOnSelect:z}:{}),G))}function jp(e){return xp.apply(this,arguments)}function xp(){return(xp=Object(f.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.search("com.axelor.meta.db.MetaModel",{data:t});case 2:return n=e.sent,e.abrupt("return",n&&n.data&&n.data[0]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Op(){return(Op=Object(f.a)(m.a.mark((function e(t,n){var a,i,r,o,c,s,l,u,p,d=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=d.length>2&&void 0!==d[2]&&d[2],i=d.length>3&&void 0!==d[3]&&d[3],"com.axelor.meta.db.MetaJsonRecord"!==t||!n){e.next=10;break}return e.next=5,N.get("ws/meta/fields/com.axelor.meta.db.MetaJsonRecord?jsonModel=".concat(n));case 5:return r=e.sent,o=Mp(r)||[],e.abrupt("return",o&&o.filter((function(e){return a?["many_to_one","one_to_many","many_to_many"].includes(e.type.toLowerCase()):i?e:["many_to_one","many-to-one"].includes(e.type.toLowerCase())})));case 10:return c={criteria:[{fieldName:"fullName",operator:"=",value:t}]},e.next=13,jp(c);case 13:if(s=e.sent){e.next=16;break}return e.abrupt("return",[]);case 16:return l=s&&s.metaFields.map((function(e){return e.name})),e.next=19,N.fields({fields:l,model:s.fullName});case 19:return u=e.sent,p=u&&u.data&&u.data.fields,e.abrupt("return",p&&p.filter((function(e){return a?["many_to_one","one_to_many","many_to_many"].includes(e.type.toLowerCase()):i?e:["many_to_one","many-to-one"].includes(e.type.toLowerCase())})));case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function wp(){return(wp=Object(f.a)(m.a.mark((function e(t){var n,a,i,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",[]);case 2:if("metaModel"!==t.type){e.next=12;break}if(t.fullName){e.next=5;break}return e.abrupt("return",[]);case 5:return e.next=7,N.get("ws/meta/fields/".concat(t.fullName));case 7:return n=e.sent,a=Mp(n),e.abrupt("return",a);case 12:if(t.name){e.next=14;break}return e.abrupt("return",[]);case 14:return e.next=16,N.get("ws/meta/fields/com.axelor.meta.db.MetaJsonRecord?jsonModel=".concat(t.name));case 16:return i=e.sent,r=Mp(i),e.abrupt("return",r||[]);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ep(){return Np.apply(this,arguments)}function Np(){return(Np=Object(f.a)(m.a.mark((function e(){var t,n,a,i,r,o,c,s,u,p=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=p.length>0&&void 0!==p[0]?p[0]:{},n=p.length>1?p[1]:void 0,a=p.length>2?p[2]:void 0,e.t1=!n||"metaModel"===n,!e.t1){e.next=8;break}return e.next=7,Dp(t,!0);case 7:e.t1=e.sent;case 8:if(e.t0=e.t1,e.t0){e.next=11;break}e.t0=[];case 11:if(i=e.t0,e.t3=!n||"metaJsonModel"===n,!e.t3){e.next=17;break}return e.next=16,Ip(t);case 16:e.t3=e.sent;case 17:if(e.t2=e.t3,e.t2){e.next=20;break}e.t2=[];case 20:for(r=e.t2,o=[],c=0;c<i.length;c++)o.push(Object(l.a)(Object(l.a)({},i[c]),{},{type:"metaModel"}));for(s=0;s<r.length;s++)o.push(Object(l.a)(Object(l.a)({},r[s]),{},{type:"metaJsonModel"}));if(a)for(u=0;u<a.length;u++)o.push(Object(l.a)(Object(l.a)({},a[u]),{},{type:"dmnModel"}));return e.abrupt("return",o||[]);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Cp(){return Sp.apply(this,arguments)}function Sp(){return(Sp=Object(f.a)(m.a.mark((function e(){var t,n,a,i,r=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:[],e.next=3,N.search("com.axelor.apps.bpm.db.DmnTable",{data:{criteria:t}});case 3:return n=e.sent,a=(n||{}).data,i=void 0===a?[]:a,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _p(e){return kp.apply(this,arguments)}function kp(){return(kp=Object(f.a)(m.a.mark((function e(t){var n,a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.search("com.axelor.apps.bpm.db.DmnField",t);case 2:return n=e.sent,a=(n||{}).data,i=void 0===a?[]:a,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Mp=function(e){var t=e&&e.data,n=t&&t.fields,a=Object.values(t&&t.jsonFields||[{}]),i=[];return i=n||[],a&&a.forEach((function(e){var t=Object.values(e||{})||[];i=[].concat(Object(p.a)(i),Object(p.a)(t))})),i};function Pp(e){return Tp.apply(this,arguments)}function Tp(){return(Tp=Object(f.a)(m.a.mark((function e(t){var n,a,i,r,o,c,s=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.length>1&&void 0!==s[1]?s[1]:[],a=s.length>2&&void 0!==s[2]?s[2]:"form",t&&t.name){e.next=4;break}return e.abrupt("return",[]);case 4:if(i=[{fieldName:"type",operator:"=",value:a}],"metaJsonModel"!==t.type){e.next=9;break}i.push({fieldName:"name",operator:"=",value:"custom-model-".concat(t.name,"-").concat(a)}),e.next=12;break;case 9:if(t.fullName){e.next=11;break}return e.abrupt("return");case 11:i.push({fieldName:"model",operator:"=",value:t.fullName});case 12:return e.next=14,N.search("com.axelor.meta.db.MetaView",{fields:["name","title"],data:{criteria:[].concat(i,Object(p.a)(n)),operator:"and"}});case 14:return r=e.sent,o=(r||{}).data,c=(void 0===o?[]:o).filter((function(e){return null!==e.name})),c=cl.uniqBy(c||[],"name")||[],e.abrupt("return",c);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Rp(){return Ap.apply(this,arguments)}function Ap(){return(Ap=Object(f.a)(m.a.mark((function e(){var t,n,a,i,r,o,c,s,l,u,d,f,b,h,v,y,g,j,x,O,w,E=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=E.length>0&&void 0!==E[0]?E[0]:[],n=[],a=[],i=[],!(t.length>0)){e.next=51;break}r=0;case 6:if(!(r<t.length)){e.next=27;break}if(o=t[r],c=o.type,s=o.model,l=o.modelFullName,"fetchAPI"!==(u=_u(s))){e.next=14;break}return e.next=12,Pp({name:s,type:c,fullName:l});case 12:(d=e.sent)&&d[0]&&(u=d[0].name);case 14:if(!u){e.next=23;break}return"metaModel"===c&&a.push(l),e.next=18,N.view({data:{name:"metaModel"===c?u:"custom-model-".concat(s,"-form"),type:"form"},model:s});case 18:f=e.sent,(b=f&&f.data&&f.data.view)&&(h=Su(b,"button"),n=[].concat(Object(p.a)(n),Object(p.a)(h||[]))),e.next=24;break;case 23:"metaJsonModel"===c&&i.push(s);case 24:r++,e.next=6;break;case 27:if(!(a&&a.length>0)){e.next=38;break}v=0;case 29:if(!(v<a.length)){e.next=38;break}return e.next=32,N.search("com.axelor.meta.db.MetaJsonField",{data:{criteria:[{fieldName:"model",operator:"like",value:a[v]},{fieldName:"type",operator:"=",value:"button"}],operator:"and"}});case 32:y=e.sent,(g=y&&y.data)&&g.length>0&&(n=[].concat(Object(p.a)(n),Object(p.a)(g||[])));case 35:v++,e.next=29;break;case 38:if(!(i&&i.length>0)){e.next=50;break}j=0;case 40:if(!(j<i.length)){e.next=50;break}return e.next=43,N.get("ws/meta/fields/com.axelor.meta.db.MetaJsonRecord?jsonModel=".concat(i[j]));case 43:x=e.sent,O=Mp(x),w=O.filter((function(e){return"button"===e.type})),n=[].concat(Object(p.a)(n),Object(p.a)(w||[]));case 47:j++,e.next=40;break;case 50:return e.abrupt("return",n);case 51:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Fp(e){return Bp.apply(this,arguments)}function Bp(){return(Bp=Object(f.a)(m.a.mark((function e(t){var n,a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.search("com.axelor.meta.db.MetaView",{data:{_domain:"self.type = :type and self.extension IS NULL and self.name in :names",_domainContext:{type:"form",names:t&&t.length>0?t:[""]}},fields:["name","title","model"]});case 2:return n=e.sent,a=(n||{}).data,i=void 0===a?[]:a,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Dp(){return Lp.apply(this,arguments)}function Lp(){return(Lp=Object(f.a)(m.a.mark((function e(){var t,n,a,i,r,o,c,s,u,p=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},n=p.length>1&&void 0!==p[1]&&p[1],e.next=4,N.search("com.axelor.meta.db.MetaModel",{data:t});case 4:if(!(a=e.sent)||-1!==a.status){e.next=7;break}return e.abrupt("return",[]);case 7:if(i=(a||{}).data,r=void 0===i?[]:i,n){e.next=10;break}return e.abrupt("return",r);case 10:return o=r.reduce(function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a,i,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.then();case 2:if(a=e.sent,"fetchAPI"!==(i=_u(n.name))){e.next=11;break}return e.next=7,Pp(Object(l.a)(Object(l.a)({},n),{},{type:"metaModel"}));case 7:(r=e.sent)&&r[0]&&a.push(r[0].name),e.next=12;break;case 11:i&&a.push(i);case 12:return e.abrupt("return",Promise.resolve(a));case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Promise.resolve([])),e.next=13,o;case 13:return c=e.sent,e.next=16,Fp(c);case 16:return s=e.sent,u=r.reduce(function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a,i,r,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.then();case 2:if(a=e.sent,"fetchAPI"!==(i=_u(n.name))){e.next=11;break}return e.next=7,Pp(Object(l.a)(Object(l.a)({},n),{},{type:"metaModel"}));case 7:(r=e.sent)&&r[0]&&a.push(Object(l.a)(Object(l.a)({},n),{},{title:r[0].title})),e.next=12;break;case 11:i&&(o=s.find((function(e){return e.name===i})),a.push(Object(l.a)(Object(l.a)({},n),{},{title:o&&o.title})));case 12:return e.abrupt("return",Promise.resolve(a));case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Promise.resolve([])),e.abrupt("return",u);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ip(){return Vp.apply(this,arguments)}function Vp(){return(Vp=Object(f.a)(m.a.mark((function e(){var t,n,a,i,r=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},e.next=3,N.search("com.axelor.meta.db.MetaJsonModel",{data:t});case 3:if(!(n=e.sent)||-1!==n.status){e.next=6;break}return e.abrupt("return",[]);case 6:return a=(n||{}).data,i=void 0===a?[]:a,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $p(){return zp.apply(this,arguments)}function zp(){return(zp=Object(f.a)(m.a.mark((function e(){var t,n,a,i,r=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:{},e.next=3,Dp(t);case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=[];case 6:return n=e.t0,e.next=9,Ip(t);case 9:if(e.t1=e.sent,e.t1){e.next=12;break}e.t1=[];case 12:return a=e.t1,i=[].concat(Object(p.a)(n),Object(p.a)(a)),e.abrupt("return",i);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Wp=Object($c.a)((function(){return{MuiAutocompleteRoot:{width:"250px",marginRight:"10px"},iconButton:{marginRight:10},icon:{color:"#0275d8"}}}));function Gp(e){var t=e.initValue,n=void 0===t?"":t,a=e.getMetaFields,c=e.onChange,s=e.value,d=e.classNames,b=e.isParent,y=void 0!==b&&b,g=e.isUserPath,j=void 0!==g&&g,x=e.startModel,O=e.isCollection,w=void 0!==O&&O,E=e.allowAllFields,N=void 0!==E&&E,C=e.excludeUITypes,S=void 0!==C&&C,_=e.isDatePath,k=void 0!==_&&_,M=s||{},P=M.fieldName,T=void 0===P?"":P,R=M.allFields,A=Object(r.useState)([]),F=Object(u.a)(A,2),B=F[0],D=F[1],L=Object(r.useState)(!0),I=Object(u.a)(L,2),V=I[0],$=I[1],z=Object(r.useState)(!0),W=Object(u.a)(z,2),G=W[0],H=W[1],U=Object(r.useState)(null),K=Object(u.a)(U,2),q=K[0],J=K[1],Y=Wp(),X=T&&T.split("."),Q=X||[],Z=Object(u.a)(Q,1)[0],ee=T&&y&&B&&B.some((function(e){return e.name===Z})),te=ee&&(B.find((function(e){return e.name===Z}))||{}).target,ne=ee&&(B.find((function(e){return e.name===Z}))||{}).jsonTarget;function ae(e){e&&B.some((function(t){return t.name===e.name&&t.target}));var t=y?"".concat(n).concat(e?e.name:""):e?e.name:"";t=e&&e.name?t:t.slice(0,-1);var a=q&&[].concat(Object(p.a)(q||[]),[e]).reverse().find((function(e){return e&&e.target}));c(""===t?void 0:t,e,a)}var ie=B&&B.find((function(e){return e.name===Z}));return Object(r.useEffect)((function(){var e=!0;return Object(f.a)(m.a.mark((function t(){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a();case 2:n=t.sent,e&&D(n&&n.filter((function(e){return w?["many_to_one","one_to_many","many_to_many"].includes(e.type.toLowerCase()):N?k?["date","datetime"].includes(e.type.toLowerCase()):e:["many_to_one","many-to-one"].includes(e.type.toLowerCase())})));case 4:case"end":return t.stop()}}),t)})))(),function(){e=!1}}),[a,w,N,S,k]),Object(r.useEffect)((function(){var e=T&&T.split("."),t=B&&B.find((function(t){return t.name===(e&&e[0])})),n=e&&e.length>0?e[e.length-1]:void 0;j&&t&&n&&t.name===n&&1===e.length?"com.axelor.auth.db.User"===t.target?$(!1):$(!0):w&&t&&n&&t.name===n&&1===e.length?["MANY_TO_MANY","ONE_TO_MANY"].includes(t.type)?($(!1),H(!1)):$(!0):k&&t?["datetime","date"].includes(t.type&&t.type.toLowerCase())?($(!1),H(!1)):$(!0):x&&t&&n&&t.name===n&&(x.fullName===t.target||x.name===t.jsonTarget)&&1===e.length?$(!1):$(!0)}),[j,x,B,w,k,T]),Object(r.useEffect)((function(){J(R)}),[R]),Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsx)(gp,{name:"fieldName",title:"Field Name",placeholder:"field name",options:B,optionLabelKey:"name",onChange:function(e){return ae(e)},value:ie,classes:{root:ul()(Y.MuiAutocompleteRoot,d&&d.root)}}),ee&&te&&(!j||ie&&"com.axelor.meta.db.MetaJsonRecord"!==ie.target&&!ie.jsonField)&&Object(i.jsxs)(o.a.Fragment,{children:[V&&Object(i.jsx)(v.a,{size:"small",onClick:function(){if($((function(e){return!e})),B&&B.length>0&&Z){var e=B.find((function(e){return e.name===Z}));ae(Object(l.a)({},e||{}))}},className:Y.iconButton,children:Object(i.jsx)(h.a,{title:ku("Remove sub field"),children:Object(i.jsx)(rl.a,{className:Y.icon,fontSize:"small"})})}),V&&Object(i.jsx)(Gp,{getMetaFields:function(){return function(e,t){return Op.apply(this,arguments)}(te,ne,w,N)},initValue:"".concat(n).concat(Z,"."),value:{fieldName:X.slice(1).join("."),allFields:R},onChange:c,classNames:d,isParent:!!te,isUserPath:j,isDatePath:k,startModel:x,isCollection:w,allowAllFields:N}),!V&&G&&Object(i.jsx)(v.a,{size:"small",onClick:function(){return $((function(e){return!e}))},className:Y.iconButton,children:Object(i.jsx)(h.a,{title:ku("Add sub field"),children:Object(i.jsx)(Uu.a,{className:Y.icon,fontSize:"small"})})})]})]})}var Hp=Object($c.a)((function(e){return{expressionBuilder:{display:"flex",alignItems:"center",justifyContent:"space-between"},newIcon:{color:"#58B423",marginLeft:5},new:{cursor:"pointer",marginTop:18.6,display:"flex"},textbox:{width:"100%"},dialog:{minWidth:300},title:{fontSize:18,fontWeight:"bold"},save:{margin:e.spacing(1),backgroundColor:"#0275d8",borderColor:"#0267bf",textTransform:"none",color:"white","&:hover":{backgroundColor:"#025aa5",borderColor:"#014682",color:"white"}}}})),Up=function(e,t,n,a){var i=a.create(e,t);return i.$parent=n,i};function Kp(e){var t=e.element,n=e.bpmnFactory,a=e.bpmnModeler,c=Object(r.useState)(!1),s=Object(u.a)(c,2),l=s[0],p=s[1],d=Object(r.useState)(!1),m=Object(u.a)(d,2),f=m[0],b=m[1],v=Object(r.useState)(!1),y=Object(u.a)(v,2),g=y[0],j=y[1],x=Object(r.useState)(null),O=Object(u.a)(x,2),w=O[0],E=O[1],N=Object(r.useState)(null),C=Object(u.a)(N,2),S=C[0],_=C[1],k=Hp(),M=function(){j(!1)},P=function(e){if(t)return t.businessObject[e]},T=function(e,n){if(t){var a=t.businessObject;a&&(a[e]=n,n||delete a[e])}},R=o.a.useCallback((function(e){var n=t.businessObject;return n&&n[e]&&n[e].value||""}),[t]),A=function(e,a){if(t.businessObject&&t.businessObject.script)t.businessObject.script.value=e;else{var i=Up("bpmn:Script",{value:e},t.businessObject,n);t.businessObject.script=i}if(t.businessObject&&t.businessObject.scriptMeta)t.businessObject.scriptMeta.value=a;else{var r=Up("bpmn:ScriptMeta",{value:a},t.businessObject,n);t.businessObject.scriptMeta=r}a||delete t.businessObject.scriptMeta,e||delete t.businessObject.script};return Object(r.useEffect)((function(){var e=R("scriptMeta");p(!!e)}),[R]),Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsxs)("div",{className:k.expressionBuilder,children:[Object(i.jsx)(Fu,{element:t,className:k.textbox,rows:3,readOnly:l,bpmnModeler:a,entry:{id:"script",label:ku("Script"),modelProperty:"script",name:"script",get:function(){var e=t&&t.businessObject;return{script:(e&&e.script&&e.script.value||"").replace(/[\u200B-\u200D\uFEFF]/g,"")}},set:function(e,t){A(t.script,void 0)}}}),Object(i.jsxs)("div",{className:k.new,children:[Object(i.jsx)(h.a,{title:"Enable","aria-label":"enable",children:Object(i.jsx)(zc.a,{className:k.newIcon,onClick:function(){l&&(_("Script can't be managed using builder once changed manually."),E("Warning"),b(!0))}})}),Object(i.jsx)(Wc.a,{className:k.newIcon,onClick:function(){j(!0)}}),g&&Object(i.jsx)(Eu,{open:g,handleClose:M,bpmnModeler:a,onSave:function(e){!function(e){var t=e||{},n=t.resultField,a=t.resultMetaField,i=t.sourceField,r=t.targetField;A(n,a),T("sourceField",i),T("targetField",r),M()}(e),p(!0)},params:function(){return function(){var e=t&&t.businessObject;return e?{resultField:e.script&&e.script.value,resultMetaField:e.scriptMeta&&e.scriptMeta.value}:{}}()}}),f&&Object(i.jsxs)(Fc.a,{open:f,onClose:function(e,t){"backdropClick"!==t&&b(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",classes:{paper:k.dialog},children:[Object(i.jsx)(Bc.a,{id:"alert-dialog-title",children:Object(i.jsx)("label",{className:k.title,children:ku(w)})}),Object(i.jsx)(Dc.a,{children:Object(i.jsx)(Lc.a,{id:"alert-dialog-description",children:ku(S)})}),Object(i.jsxs)(Ic.a,{children:[Object(i.jsx)(Vc.a,{onClick:function(){b(!1),_(null),E(null),p(!1),t.businessObject&&(t.businessObject.scriptValue=void 0)},color:"primary",className:k.save,autoFocus:!0,children:"Ok"}),Object(i.jsx)(Vc.a,{onClick:function(){b(!1)},color:"primary",className:k.save,children:"Cancel"})]})]})]})]}),Object(i.jsx)(Du,{entry:{id:"sourceField",label:ku("Source Field"),modelProperty:"sourceField",get:function(){return{sourceField:P("sourceField")}},set:function(e,t){T("sourceField",t.sourceField)}},bpmnModeler:a,element:t,canRemove:!0}),Object(i.jsx)(Du,{entry:{id:"targetField",label:ku("Target Field"),modelProperty:"targetField",get:function(){return{targetField:P("targetField")}},set:function(e,t){T("targetField",t.targetField)}},element:t,canRemove:!0})]})}var qp=n(72),Jp=n.n(qp),Yp=n(369),Xp=n(370),Qp=n(371),Zp=n(372),ed=n(373),td=n(374),nd=n(375),ad=n(145),id=n.n(ad),rd=n(396),od=n(387),cd=function(e,t){return"ws/rest/".concat(e,"/").concat(t)},sd=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(O.a)(this,e),this.model=t.model}return Object(w.a)(e,[{key:"search",value:function(e){var t=e.fields,n=e.sortBy,a=e.data,i=e.limit,r=e.offset,o=cd(this.model,"search");return N.post(o,{fields:t,sortBy:n,data:a,limit:i,offset:r})}},{key:"fetch",value:function(e,t){var n="".concat(e,"/fetch"),a=cd(this.model,n);return N.post(a,t)}},{key:"view",value:function(e){return N.post("/ws/meta/view",e)}},{key:"fields",value:function(e){return N.post("/ws/meta/view/fields",e)}},{key:"save",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=cd(this.model,"");return N.post(n,Object(l.a)({},t?e:{data:e}))}},{key:"removeAll",value:function(e){var t=cd(this.model,"removeAll");return N.post(t,{records:e})}},{key:"action",value:function(e,t){var n="/ws/action/".concat(e);return N.post(n,Object(l.a)(Object(l.a)({},t),{},{model:this.model}))}}]),e}(),ld=new sd({model:"com.axelor.meta.db.MetaModel"}),ud=new sd({model:"com.axelor.meta.db.MetaField"});var pd=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e&&e.data,r=i&&i.fields,o=Object.values(i&&i.jsonFields||[{}]),c=[];return c=r&&r.filter((function(e){return!e.json&&sp.includes((e.type||"").toLowerCase())}))||[],o&&o.forEach((function(e){var i=(Object.values(e||{})||[]).filter((function(e){return sp.includes((e.type||"").toLowerCase())&&("many-to-many"!==e.type||e.targetName)}))||[];t&&!a&&(i=i.filter((function(e){return![].concat(Object(p.a)(cp),Object(p.a)(n?["many_to_one","json_many_to_one","many-to-one","json-many-to-one"]:[])).includes((e.type||"").toLowerCase())}))||[]),c=[].concat(Object(p.a)(c),Object(p.a)(i))})),c};function dd(e,t){return md.apply(this,arguments)}function md(){return(md=Object(f.a)(m.a.mark((function e(t,n){var a,i,r,o,c,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",[]);case 2:if("metaModel"!==t.type){e.next=17;break}return e.next=5,N.get("ws/meta/fields/".concat(t.fullName?t.fullName:"".concat(t.packageName,".").concat(t.name)));case 5:return a=e.sent,i=pd(a,n),e.next=9,N.search("com.axelor.meta.db.MetaField",{data:{_domain:"self.metaModel.name = '".concat(t.name,"' AND self.typeName = 'ZonedDateTime'"),_domainContext:{_model:"com.axelor.meta.db.MetaField"}},fields:["name","typeName","metaModel"]});case 9:if(r=e.sent,!((o=r&&r.data&&r.data.length>0&&r.data.map((function(e){return e.name})))&&o.length>0&&i&&i.length>0)){e.next=14;break}return i.forEach((function(e){o.includes(e.name)&&(e.typeName="ZonedDateTime")})),e.abrupt("return",i);case 14:return e.abrupt("return",i);case 17:return e.next=19,N.get("ws/meta/fields/com.axelor.meta.db.MetaJsonRecord?jsonModel=".concat(t.name));case 19:return c=e.sent,s=pd(c,n),e.abrupt("return",Cu(s,"sequence")||[]);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fd(e){return bd.apply(this,arguments)}function bd(){return(bd=Object(f.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ld.search({data:t});case 2:return n=e.sent,e.abrupt("return",n&&n.data&&n.data[0]);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hd(){return(hd=Object(f.a)(m.a.mark((function e(t){var n,a,i,r,o,c,s,l,u,d,f,b,h,v,y,g=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(g.length>1&&void 0!==g[1])||g[1],a=g.length>2&&void 0!==g[2]&&g[2],i=g.length>3?g[3]:void 0,r=g.length>4&&void 0!==g[4]&&g[4],o=g.length>5?g[5]:void 0,c=g.length>6&&void 0!==g[6]&&g[6],"com.axelor.meta.db.MetaJsonRecord"!==t||!i){e.next=22;break}return e.next=9,N.get("ws/meta/fields/com.axelor.meta.db.MetaJsonRecord?jsonModel=".concat(i));case 9:if(s=e.sent,l=(l=pd(s,a,r,o)||[]).filter((function(e){return sp.includes((e.type||"").toLowerCase())&&(!a||!e.json)&&("many-to-many"!==(e.type||"").toLowerCase()||e.targetName)})),!c){e.next=17;break}return e.next=15,Rp([{model:i,type:"metaJsonModel",modelFullName:t}]);case 15:u=e.sent,l=[].concat(Object(p.a)(l||[]),Object(p.a)(u||[]));case 17:if(!(!n&&l&&l.length>0)){e.next=19;break}return e.abrupt("return",l.filter((function(e){return!["many_to_many","json_many_to_many"].includes((e&&(e.type||"")).toLowerCase().replaceAll("-","_"))})));case 19:return e.abrupt("return",Cu(l,"sequence")||[]);case 22:return d={criteria:[{fieldName:"fullName",operator:"=",value:t}]},e.next=25,fd(d);case 25:if(f=e.sent){e.next=28;break}return e.abrupt("return",[]);case 28:return b=f&&f.metaFields.map((function(e){return e.name})),e.next=31,ud.fields({fields:b,model:f.fullName});case 31:if(h=e.sent,v=(v=h&&h.data&&h.data.fields).filter((function(e){return sp.includes((e.type||"").toLowerCase())&&(!a||!e.json)&&("many-to-many"!==e.type||e.targetName)})),!c){e.next=39;break}return e.next=37,Rp([{model:f&&f.name,type:"metaModel",modelFullName:f&&f.fullName}]);case 37:y=e.sent,v=[].concat(Object(p.a)(v||[]),Object(p.a)(y||[]));case 39:if(!(!n&&v&&v.length>0)){e.next=41;break}return e.abrupt("return",v.filter((function(e){return!["many_to_many","json_many_to_many"].includes((e&&(e.type||"")).toLowerCase().replaceAll("-","_"))})));case 41:return e.abrupt("return",v);case 42:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vd(e){return yd.apply(this,arguments)}function yd(){return(yd=Object(f.a)(m.a.mark((function e(t){var n,a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new sd({model:t}),e.next=3,n.search({});case 3:if(!(a=e.sent)||-1!==a.status){e.next=6;break}return e.abrupt("return",[]);case 6:return e.abrupt("return",a&&a.data);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gd(e){return jd.apply(this,arguments)}function jd(){return(jd=Object(f.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.search("com.axelor.meta.db.MetaJsonRecord",{data:{criteria:[{fieldName:"jsonModel",operator:"=",value:t}],operator:"and"}});case 2:if(!(n=e.sent)||-1!==n.status){e.next=5;break}return e.abrupt("return",[]);case 5:return e.abrupt("return",n&&n.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xd(e){return Od.apply(this,arguments)}function Od(){return(Od=Object(f.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.search("com.axelor.meta.db.MetaJsonField",{data:{criteria:[{fieldName:"jsonModel",operator:"=",value:t},{fieldName:"nameField",operator:"=",value:!0}],operator:"and"},fields:["name"]});case 2:if(!((n=e.sent)&&n.status>-1)){e.next=5;break}return e.abrupt("return",n.data&&n.data[0]);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var wd=Object($c.a)((function(){return{MuiAutocompleteRoot:{width:"250px",marginRight:"10px"},iconButton:{marginRight:10},icon:{color:"#0275d8"}}}));function Ed(e){var t=e.initValue,n=void 0===t?"":t,a=e.getMetaFields,c=e.editor,s=e.onChange,d=e.value,b=e.classNames,y=e.expression,g=void 0===y?"GROOVY":y,j=e.type,x=e.isParent,O=void 0!==x&&x,w=e.isBPM,E=e.isField,N=e.setInitialField,C=void 0===N?function(){}:N,S=e.isAllowButtons,_=void 0!==S&&S,k=d||{},M=k.fieldName,P=void 0===M?"":M,T=k.allField,R=void 0===T?[]:T,A=k.isShow,F=Object(r.useState)([]),B=Object(u.a)(F,2),D=B[0],L=B[1],I=wd(),V="context"===E&&fp(j)&&w,$=fp(j)?"BPM":g,z=P&&vp[$]&&P.split(V?"?.":vp[$]),W=z&&z.slice(1)&&z.slice(1).join(V?"?.":vp[$]),G=Object(r.useState)(!(!A&&!W)),H=Object(u.a)(G,2),U=H[0],K=H[1],q=z||[],J=Object(u.a)(q,1)[0],Y=P&&O&&D&&D.some((function(e){return e.name===J})),X=Y&&(D.find((function(e){return e.name===J}))||{}).target,Q=Y&&(D.find((function(e){return e.name===J}))||{}).jsonTarget,Z=(D.find((function(e){return e.name===J}))||{}).type,ee=R&&R.length>0&&R.find((function(e){return["many_to_many","json_many_to_many"].includes((e&&(e.type||"")).toLowerCase().replaceAll("-","_"))})),te=R&&R.length>0&&R.find((function(e){return["many_to_one","json_many_to_one"].includes((e&&(e.type||"")).toLowerCase().replaceAll("-","_"))})),ne=["one_to_one","json_one_to_one"].includes((Z||"").toLowerCase().replaceAll("-","_"));function ae(e){var t=e&&D.some((function(t){return t.name===e.name&&t.target}));if(w){var a,i=O?e&&e.name?"".concat(n).concat(e.name):"".concat(function(){var e=n&&n.split(vp[$]);return e&&e.length>0&&(e.filter(Boolean)||[]).join(vp[$])}()):e&&e.name?"".concat(t?V?"?.":vp[$]:"").concat(n).concat(e.name):"";if(e&&R.findIndex((function(t){return t.name===e.name}))<=-1){var r=(i||"").split(V?"?.":vp[$])||[],o=R&&R.filter((function(e){return r.includes(e.name)}))||[];a=[].concat(Object(p.a)(o),[e])}else{var l=Object(p.a)(R||[]),u=(P||"").split(V?"?.":vp[$]);u&&u.length>0&&u.forEach((function(e){var t=l.findIndex((function(t){return t.name===e}));t>-1&&l.splice(t,1)})),a=l}s({name:"fieldName",value:e,fieldNameValue:i||void 0,allField:a,isShow:U},c)}else{var d=O?"".concat(n).concat(e?e.name:""):e?e.name:"";if(d=fp(j)?e&&e.name?d:d.slice(0,-1):d,s({name:"fieldName",value:d},c),s({name:"fieldType",value:e&&e.type||""},c),s({name:"field",value:e},c),s({name:"isShow",value:U},c),e&&R.findIndex((function(t){return t.name===e.name}))<=-1){var m=(d||"").split(vp[$])||[],f=R&&R.filter((function(e){return m.includes(e.name)}))||[];s({name:"allField",value:[].concat(Object(p.a)(f),[e])},c)}else{var b=Object(p.a)(R||[]),h=(P||"").split(vp[$]),v="".concat(n).concat(vp[$]).concat(J).split(vp[$]);if(h&&h.length>0&&h.forEach((function(e){var t=b.findIndex((function(t){return t.name===e}));t>-1&&!(v||[]).includes(e)&&b.splice(t,1)})),s({name:"allField",value:b},c),b&&1===b.length){var y=b[0];s({name:"fieldType",value:y&&y.type||""},c),s({name:"field",value:y},c),C()}else{var g=b[b.length-1];s({name:"fieldType",value:g&&g.type||""},c),s({name:"field",value:g},c),C()}}}}var ie=D&&D.find((function(e){return e.name===J}))||R&&R.find((function(e){return e.name===J}));return Object(r.useEffect)((function(){var e=!0;return e&&K(!(!A&&!W)),function(){e=!1}}),[A,W]),Object(r.useEffect)((function(){var e=!0;return Object(f.a)(m.a.mark((function t(){var n;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a();case 2:n=t.sent,e&&L(n);case 4:case"end":return t.stop()}}),t)})))(),function(){e=!1}}),[a]),Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsx)(gp,{name:"fieldName",title:"Field Name",placeholder:"field name",options:D,optionLabelKey:"name",onChange:function(e){return ae(e)},value:ie,classes:{root:ul()(I.MuiAutocompleteRoot,b&&b.root)}}),Y&&X&&Object(i.jsxs)(o.a.Fragment,{children:[U&&!ne&&Object(i.jsx)(v.a,{size:"small",onClick:function(){if(K((function(e){return!e})),R&&R.length>0&&J){var e=R.find((function(e){return e.name===J}));ae(Object(l.a)({},e||{}))}},className:I.iconButton,children:Object(i.jsx)(h.a,{title:ku("Remove sub field"),children:Object(i.jsx)(rl.a,{className:I.icon,fontSize:"small"})})}),(U||ne)&&Object(i.jsx)(Ed,{getMetaFields:function(){return function(e){return hd.apply(this,arguments)}(X,!!fp(j)||ee&&z&&z.length>0&&z.includes(ee.name)&&z[0]!==ee.name,fp(j),Q,te,w,_)},editor:c,initValue:"".concat(n).concat(J).concat(V?"?.":vp[$]),value:{fieldName:z.slice(1).join(V?"?.":vp[$]),allField:R},onChange:s,classNames:b,expression:$,type:j,isParent:!!X,isBPM:w,setInitialField:C,isField:E,isAllowButtons:_}),!U&&!ne&&Object(i.jsx)(v.a,{size:"small",onClick:function(){return K((function(e){return!e}))},className:I.iconButton,children:Object(i.jsx)(h.a,{title:ku("Add sub field"),children:Object(i.jsx)(Uu.a,{className:I.icon,fontSize:"small"})})})]})]})}var Nd=Object($c.a)((function(e){return{Container:{display:"flex"},rulesGroupHeader:{display:"flex"},paper:{margin:e.spacing(1,0),padding:e.spacing(3,2),overflow:"auto"},rules:{display:"flex",alignItems:"flex-end",justifyContent:"flex-start",marginBottom:15},MuiAutocompleteRoot:{width:"250px",marginRight:"10px"},disabled:{pointerEvents:"none",opacity:.5},valueFrom:{fontSize:12,color:"rgba(0, 0, 0, 0.54)",fontFamily:'"Roboto", "Helvetica", "Arial", sans-serif'},radio:{padding:"1px 9px",color:"#0275d8","&.MuiRadio-colorSecondary.Mui-checked":{color:"#0275d8"}},operators:{minWidth:75},iconButton:{marginRight:10},timelineConnector:{backgroundColor:"#0275d8"},combinator:{width:"fit-content"},icon:{color:"#0275d8"},timeline:{height:"100%",padding:0,margin:0},timelineOppositeContent:{display:"flex",alignItems:"center",justifyContent:"flex-end",maxWidth:60,padding:0}}}));function Cd(e,t){return Sd.apply(this,arguments)}function Sd(){return(Sd=Object(f.a)(m.a.mark((function e(t,n){var a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=fp(n),e.next=3,dd(t,a);case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0=[];case 6:return i=e.t0,e.abrupt("return",i.filter((function(e){return sp.includes((e.type||"").toLowerCase())&&(!a||!e.json)})));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _d(e){var t=e.operator,n=e.editor,a=e.internalProps,o=e.parentType,c=a.onChange,s=a.value,p=Object(Zc.a)(a,["onChange","value"]),d=Nd(),b=p.field,h=void 0===b?{}:b,v=h.targetName,y=h.target,g=h.targetModel,j=h.model,x=h.jsonTarget,O=Object(r.useState)(null),w=Object(u.a)(O,2),E=w[0],N=w[1],C=function(){var e=Object(f.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("com.axelor.meta.db.MetaJsonRecord"!==j||!x){e.next=10;break}return e.next=3,gd(x);case 3:return t=e.sent,e.next=6,xd(x);case 6:n=e.sent,N(n&&n.name),e.next=13;break;case 10:return e.next=12,vd(y||g);case 12:t=e.sent;case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return["like","notLike"].includes(t)?Object(i.jsx)(Yu,Object(l.a)({name:"fieldValue",onChange:function(e){var t;"string"===typeof e||fp(o)||(t=e&&e.length>0?e&&e.find((function(e){return e&&v&&e[v]})):e&&e[v],c({name:"nameField",value:t?E:"id"},n)),c({name:"fieldValue",value:e},n)},margin:"none",style:{marginTop:"15px",width:"250px !important"},value:s},p)):["contains","notContains","in","notIn","=","!="].includes(t)?Object(i.jsx)(gp,{name:"fieldValue",title:"Value",placeholder:"Value",fetchAPI:C,isMulti:!(fp(o)&&["contains","notContains"].includes(t)||["=","!="].includes(t)),optionLabelKey:v,onChange:function(e){var t;"string"===typeof e||fp(o)||(t=e&&e.length>0?e&&e.find((function(e){return e&&v&&e[v]})):e&&e[v],c({name:"nameField",value:t?E:"id"},n)),c({name:"fieldValue",value:e},n)},value:s||[],classes:{root:d.MuiAutocompleteRoot}}):null}function kd(e){var t=e.Component,n=e.operator,a=e.editor,r=e.internalProps,c=r.onChange,s=r.value,u=r.value2,p=r.classes,d=r.style,m=r.targetName,f=Object(Zc.a)(r,["onChange","value","value2","classes","style","targetName"]);return["=","!=",">",">=","<","<=","like","notLike"].includes(n)?Object(i.jsx)(t,Object(l.a)({name:"fieldValue",onChange:function(e){return c({name:"fieldValue",value:e},a)},value:s,style:d},f)):["between","notBetween"].includes(n)?Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsx)(t,Object(l.a)({name:"fieldValue",style:Object(l.a)({marginRight:8},d),onChange:function(e){return c({name:"fieldValue",value:e},a)},value:s},f)),Object(i.jsx)(t,Object(l.a)({name:"fieldValue2",onChange:function(e){return c({name:"fieldValue2",value:e},a)},value:u,style:d},f))]}):["in","notIn"].includes(n)?Object(i.jsx)(gp,Object(l.a)({name:"fieldValue",title:"Value",placeholder:"Value",isMulti:!0,optionLabelKey:m,onChange:function(e){c({name:"fieldValue",value:e},a)},value:s||[],classes:{root:p.MuiAutocompleteRoot},optionValueKey:"name"},f)):null}function Md(e){var t=e.type,n=e.operator,a=e.onChange,r=e.value,o=e.classes,c=e.parentType,s=e.editor,u=Object(Zc.a)(e,["type","operator","onChange","value","classes","parentType","editor"]),p=Object(l.a)({value:r.fieldValue,value2:r.fieldValue2,onChange:a},u),d=[],m={};switch(t){case"one_to_one":case"many_to_one":case"many_to_many":case"one_to_many":case"json_one_to_one":case"json_many_to_one":case"json_many_to_many":case"json_one_to_many":return Object(i.jsx)(_d,{operator:n,editor:s,internalProps:Object(l.a)({},p),parentType:c});case"date":case"time":case"datetime":var f=function(e){return e?Is()(e,rp[t]):null};return Object(i.jsx)(kd,{Component:mp,operator:n,editor:s,internalProps:Object(l.a)(Object(l.a)({type:t,value:f(r.fieldValue),value2:f(r.fieldValue2),onChange:function(e,n){var i=e.name,r=e.value;return a({name:i,value:r&&r.format(rp[t])},n)}},u),{},{margin:"none",classes:o,style:{marginTop:"15px",width:"250px !important"}})});case"integer":case"long":case"decimal":case"double":return m={Component:(d=u.field.selectionList&&u.field.selectionList.map((function(e){var t=e.title,n=e.value,a=e.data;return{name:a&&a.value||n,title:t}})))?qu:ep,operator:n,editor:s,internalProps:Object(l.a)({},d?Object(l.a)({options:d,classes:o},p):Object(l.a)(Object(l.a)({type:t},p),{},{margin:"none",classes:o,style:{marginTop:"15px",width:"250px !important"}}))},Object(i.jsx)(kd,Object(l.a)({},m));case"enum":return d=u.field.selectionList.map((function(e){var t=e.title,n=e.value,a=e.data;return{name:a&&a.value||n,title:t}})),Object(i.jsx)(kd,{Component:qu,operator:n,editor:s,internalProps:Object(l.a)({options:d,classes:o},p)});default:return m={Component:(d=u.field&&u.field.selectionList&&u.field.selectionList.map((function(e){var t=e.title,n=e.value,a=e.data;return{name:a&&a.value||n,title:t}})))?qu:Yu,operator:n,editor:s,internalProps:Object(l.a)({},d?Object(l.a)({options:d,classes:o},p):Object(l.a)(Object(l.a)({classes:o},p),{},{margin:"none",style:{marginTop:"15px",width:"250px !important"}}))},Object(i.jsx)(kd,Object(l.a)({},m))}}function Pd(e){var t=e.getMetaFields,n=e.onChange,a=e.onRemoveRule,c=e.editor,s=e.value,l=e.expression,p=e.parentType,d=e.parentMetaModal,m=e.isAllowButtons,f=void 0!==m&&m,b=s.fieldType,y=void 0===b?"":b,g=s.field,j=s.operator,x=s.fieldValue,O=s.fieldValue2,w=void 0===O?"":O,E=s.isRelationalValue,N=s.relatedValueModal,C=s.relatedValueFieldName,S=s.relatedElseValueModal,_=s.relatedElseValueFieldName,k=s.isShowMetaModelField,M=s.isShowElseMetaModelField,P=Nd(),T=y&&y.toLowerCase().replaceAll("-","_"),R=Object(r.useState)(E||"none"),A=Object(u.a)(R,2),F=A[0],B=A[1],D=Object(r.useState)(N||null),L=Object(u.a)(D,2),I=L[0],V=L[1],$=Object(r.useState)(k||!1),z=Object(u.a)($,2),W=z[0],G=z[1],H=Object(r.useState)(S||null),U=Object(u.a)(H,2),K=U[0],q=U[1],J=Object(r.useState)(M||!1),Y=Object(u.a)(J,2),X=Y[0],Q=Y[1],Z=function(e){if(e&&"string"===typeof e){var t=e.toString().split(".");return t&&t.length>1?t.slice(1).join("."):e}},ee=Object(r.useState)(null),te=Object(u.a)(ee,2),ne=te[0],ae=te[1],ie=Object(r.useState)(null),re=Object(u.a)(ie,2),oe=re[0],ce=re[1],se=function(e,t){e.map((function(e){return lp[e]=t}))};se(["long","decimal","double","date","time","datetime"],lp.integer),se(["one_to_many","json_one_to_many"],lp.text),se(["many_to_many","json_many_to_many"],["in","notIn","isNull","contains","notContains"]),se(["many_to_one","one_to_one","json_many_to_one","json_one_to_one"],["=","!=","in","notIn","isNull","isNotNull"]),se(["string"],["=","!=","isNull","isNotNull","like","notLike"]);var le=pp.filter((function(e){var t=T;if(""===t&&s.fieldName&&s.allField.length>0){var n=s.allField.find((function(e){return e.name===s.fieldName}));t=(n&&n.type||"").toLowerCase()}return(lp[t]||[]).includes(e.name)})),ue=function(e,t){n({name:e,value:t},c)};return Object(r.useEffect)((function(){B(E||"none"),V(N||null),G(k||!1),q(S||null),Q(M||!1)}),[E,N,k,S,M]),Object(r.useEffect)((function(){var e=s.fieldValue,t=s.allField,n=void 0===t?[]:t,a=s.fieldValue2,i=void 0===a?"":a,r=s.isRelationalValue,o=s.relatedValueModal,c=s.relatedValueFieldName,l=s.relatedElseValueModal,u=s.relatedElseValueFieldName,p=s.isShowMetaModelField,d=s.isShowElseMetaModelField;ae({allField:n,field:u,fieldName:Z(i)||u&&u.name,fieldType:u&&u.type,fieldValue:null,fieldValue2:null,operator:null,isRelationalValue:r||"none",relatedValueFieldName:c,relatedValueModal:o,relatedElseValueFieldName:u,relatedElseValueModal:l,isShow:d}),ce({allField:n,field:c,fieldName:Z(e)||c&&c.fieldName,fieldType:c&&c.type,fieldValue:null,fieldValue2:null,operator:null,isRelationalValue:r||"none",relatedValueFieldName:c,relatedValueModal:o,isShow:p})}),[s]),Object(i.jsxs)("div",{className:P.rules,children:[Object(i.jsx)(Ed,{getMetaFields:t,isField:F,editor:c,onChange:n,value:s,expression:l,type:p,isParent:!0,isAllowButtons:f,setInitialField:function(){B("none")}}),Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsx)(qu,{name:"operator",title:"Operator",options:g&&g.selectionList?pp.filter((function(e){return(F&&"none"!==F?["=","!=","isNull","isNotNull"]:["=","!=","isNull","isNotNull","in","notIn"]).includes(e.name)})):F&&"none"!==F?le.filter((function(e){return"in"!==e.name&&"notIn"!==e.name})):le,onChange:function(e){n({name:"operator",value:e},c),B(null)},value:j,className:P.operators}),j&&"button"!==g.type&&!["isNull","isNotNull","isTrue","isFalse"].includes(j)&&Object(i.jsxs)(rd.a,{"aria-label":"radioType",name:"radioType",value:F||"none",onChange:function(e){B(e.target.value),ce({fieldValue:null}),ue("fieldValue",null),ae({fieldValue2:null}),ue("fieldValue2",null),!e.target.value||"in"!==j&&"notIn"!==j||(n({name:"operator",value:void 0},c),B(null)),e.target.value?(ue("isRelationalValue","none"===e.target.value?null:e.target.value),ue("fieldValue",null),ue("fieldValue2",null),"self"===e.target.value?(V(d),q(d),ue("relatedValueModal",d),ue("relatedElseValueModal",d)):(V(null),q(null),Q(!1),G(!1),ue("relatedValueModal",null),ue("relatedElseValueModal",null))):(ue("relatedValueFieldName",null),ue("relatedValueModal",null),ue("relatedElseValueFieldName",null),ue("relatedElseValueModal",null))},children:[Object(i.jsx)("label",{className:P.valueFrom,children:"Value from"}),Object(i.jsx)(pl.a,{value:"self",control:Object(i.jsx)(od.a,{className:P.radio,size:"small"}),label:"Self"}),Object(i.jsx)(pl.a,{value:"context",control:Object(i.jsx)(od.a,{className:P.radio,size:"small"}),label:"Context"}),Object(i.jsx)(pl.a,{value:"none",control:Object(i.jsx)(od.a,{className:P.radio,size:"small"}),label:"None"})]})]}),F&&"none"!==F&&j&&!["isNull","isNotNull","isTrue","isFalse"].includes(j)?Object(i.jsxs)(o.a.Fragment,{children:["context"===F&&Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsx)(gp,{name:"metaModal",title:"Model",placeholder:"Model",fetchAPI:function(){return Ep()},optionLabelKey:"name",onChange:function(e){V(e),e?(ce({fieldValue:bp(e.name)}),ue("relatedValueModal",e),ue("fieldValue",bp(e.name))):(ce({fieldValue:null}),ue("fieldValue",null))},value:I,classes:{root:P.MuiAutocompleteRoot}}),W&&"context"===F&&Object(i.jsx)(v.a,{size:"small",onClick:function(){if(G(!1),ue("isShowMetaModelField",!1),I){var e=I.name;ce({fieldValue:bp(e)}),ue("relatedValueModal",I),ue("fieldValue",bp(e))}},className:P.iconButton,children:Object(i.jsx)(h.a,{title:ku("Remove sub field"),children:Object(i.jsx)(rl.a,{color:"primary",fontSize:"small"})})})]}),(W||"self"===F)&&Object(i.jsx)(Ed,{getMetaFields:function(){return"context"===F?Cd(I,p):t()},editor:c,isField:F,onChange:function(e,t){var n=e.value,a=e.fieldNameValue,i=e.allField,r=e.isShow;ce({allField:i,field:n,fieldName:a,fieldType:n&&n.type,fieldValue:null,fieldValue2:null,operator:null,isRelationalValue:"none"===F?null:F,relatedValueFieldName:null,relatedValueModal:null,isShow:r,isShowMetaModelField:W}),ue("isRelationalValue","none"===F?null:F),ue("relatedValueFieldName",n),ue("relatedValueModal",I);var o=fp(p),c="context"===F&&o;ue("fieldValue",a?(d&&d.id)===(I&&I.id)?o?"self.".concat(a):"".concat(bp(I&&I.name||d&&d.name||"self")).concat(c?"?.":ip[o?"BPM":l]).concat(a).concat(n&&n.typeName&&!o?"".concat(c?"?.":ip[l],"toLocalDateTime()"):""):"".concat(bp(I&&I.name||d&&d.name||o?"self":"")).concat(c?"?.":ip[o?"BPM":l]).concat(a).concat(n&&["json-many-to-one","MANY_TO_ONE","many-to-one"].includes(n.type)&&o&&"context"===F?"".concat(c?"?.":ip[l],"getTarget()"):"").concat(n&&n.typeName&&!o?"".concat(c?"?.":ip[l],"toLocalDateTime()"):""):void 0)},value:oe,expression:l,type:p,isParent:!0,isBPM:!0}),!W&&I&&"context"===F&&Object(i.jsx)(v.a,{size:"small",onClick:function(){G(!0),ue("isShowMetaModelField",!0)},className:P.iconButton,children:Object(i.jsx)(h.a,{title:ku("Add sub field"),children:Object(i.jsx)(Uu.a,{className:P.icon,fontSize:"small"})})}),["between","notBetween"].includes(j)&&Object(i.jsxs)(o.a.Fragment,{children:["context"===F&&Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsx)(gp,{name:"metaModal",title:"Meta Modal Else",placeholder:"meta modal",fetchAPI:function(){return Ep()},optionLabelKey:"name",onChange:function(e){q(e),e?(ae({fieldValue2:bp(e.name)}),ue("relatedElseValueModal",e),ue("fieldValue2",bp(e.name))):(ae({fieldValue2:null}),ue("fieldValue2",null))},value:K,classes:{root:P.MuiAutocompleteRoot}}),X&&"context"===F&&Object(i.jsx)(v.a,{size:"small",onClick:function(){if(Q(!1),ue("isShowElseMetaModelField",!1),K){var e=K.name;ce({fieldValue:bp(e)}),ue("relatedElseValueModal",K),ue("fieldValue2",bp(e))}},className:P.iconButton,children:Object(i.jsx)(h.a,{title:ku("Remove sub field"),children:Object(i.jsx)(rl.a,{color:"primary",fontSize:"small"})})})]}),(X||"self"===F)&&Object(i.jsx)(Ed,{getMetaFields:function(){return Cd(K,T)},editor:c,isField:F,onChange:function(e,t){var n=e.value,a=e.fieldNameValue,i=e.allField,r=e.isShow;ae({allField:i,field:n,fieldName:a,fieldType:n&&n.type,fieldValue:null,fieldValue2:null,operator:null,isRelationalValue:"none"===F?null:F,relatedValueFieldName:C,relatedValueModal:S,relatedElseValueFieldName:_,relatedElseValueModal:S,isShow:r,isShowMetaModelField:W,isShowElseMetaModelField:X}),ue("relatedElseValueFieldName",n),ue("relatedElseValueModal",K);var o=fp(p),c="context"===F&&o;ue("fieldValue2",a?(d&&d.id)===(K&&K.id)?o?"self.".concat(a):"".concat(bp(I&&I.name&&d&&d.name)).concat(c?"?.":ip[o?"BPM":l]).concat(a).concat(n&&n.typeName&&!o?"".concat(c?"?.":ip[l],"toLocalDateTime()"):""):"".concat(bp(K&&K.name)).concat(c?"?.":ip[o?"BPM":l]).concat(a).concat(n&&["json-many-to-one","MANY_TO_ONE","many-to-one"].includes(n.type)&&o&&"context"===F?"".concat(c?"?.":ip[l],"getTarget()"):"").concat(n&&n.typeName&&!o?"".concat(c?"?.":ip[l],"toLocalDateTime()"):""):void 0)},value:ne,expression:l,type:p,isParent:!0,isBPM:!0}),!X&&K&&"context"===F&&Object(i.jsx)(v.a,{size:"small",onClick:function(){Q(!0),ue("isShowElseMetaModelField",!0)},className:P.iconButton,children:Object(i.jsx)(h.a,{title:ku("Add sub field"),children:Object(i.jsx)(Uu.a,{className:P.icon,fontSize:"small"})})})]})]}):j&&("button"===g.type?Object(i.jsx)(qu,{name:"fieldValue",onChange:function(e){return n({name:"fieldValue",value:e},c)},value:x,options:[{name:!0,title:"true"},{name:!1,title:"false"}],className:P.operators}):Object(i.jsx)(Md,{type:T,parentType:p,operator:j,onChange:function(e,t){n(e,t),ue("isRelationalValue",null),ue("relatedValueFieldName",null),ue("relatedValueModal",null)},value:{fieldValue:x,fieldValue2:w},classes:P,editor:c,field:g})),Object(i.jsx)(Qu,{Icon:id.a,onClick:a})]})}function Td(e){var t=e.onAddGroup,n=e.isRemoveGroup,a=e.onRemoveGroup,c=e.onAddRule,s=e.onRemoveRule,l=e.editor,p=void 0===l?{}:l,d=e.getChildEditors,m=e.onChange,f=e.getMetaFields,b=e.isDisable,h=e.expression,v=e.type,y=e.parentMetaModal,g=e.element,j=e.isAllowButtons,x=void 0!==j&&j,O=Nd(),w=Object(r.useState)(!1),E=Object(u.a)(w,2),N=E[0],C=E[1],S=p.id,_=p.rules,k=void 0===_?[]:_,M=d(p.id);return Object(r.useEffect)((function(){var e=fp(v);C(e)}),[v]),Object(i.jsx)(Kc.a,{variant:"outlined",className:ul()(O.paper,b&&O.disabled),children:Object(i.jsx)("div",{className:ul()(O.rulesGroupHeader),children:Object(i.jsx)(Yp.a,{align:"alternate",className:O.timeline,children:Object(i.jsxs)(Xp.a,{children:[Object(i.jsx)(Qp.a,{className:O.timelineOppositeContent,children:Object(i.jsx)(qu,{name:"combinator",className:O.combinator,disableUnderline:!0,options:tp,value:p.combinator||"and",onChange:function(e){return m({name:"combinator",value:e},p)}})}),Object(i.jsxs)(Zp.a,{children:[Object(i.jsx)(ed.a,{variant:"outlined",style:{borderColor:"#0275d8"}}),Object(i.jsx)(td.a,{className:O.timelineConnector})]}),Object(i.jsxs)(nd.a,{children:[Object(i.jsx)(Qu,{title:"Add Group",Icon:Qc.a,onClick:function(){return t(S)}}),n&&Object(i.jsx)(Qu,{title:"Remove Group",Icon:id.a,onClick:function(){return a(S)}}),k.map((function(e,t){return Object(i.jsx)(o.a.Fragment,{children:Object(i.jsx)(Pd,{getMetaFields:f,onRemoveRule:function(){return s(p.id,t)},onChange:function(e,n){return m(e,n,t)},editor:p,value:e,expression:h,parentType:v,isBPM:N,parentMetaModal:y,element:g,isAllowButtons:x})},t)})),Object(i.jsx)(Qu,{title:"Add Rule",Icon:Qc.a,onClick:function(){return c(S)}}),M.map((function(e,n){return Object(i.jsx)(o.a.Fragment,{children:Object(i.jsx)(Td,{isRemoveGroup:!0,onAddGroup:t,onRemoveGroup:a,onAddRule:c,onRemoveRule:s,getChildEditors:d,getMetaFields:f,onChange:function(e,t,n){return m(e,t,n)},editor:e,type:v,element:g,expression:h,isAllowButtons:x})},e.id)}))]})]})})})})}var Rd=Object($c.a)((function(e){return{Container:{display:"flex"},rulesGroupHeader:{display:"flex"},paper:{margin:e.spacing(1),padding:e.spacing(3,2)},rules:{display:"flex"},MuiAutocompleteRoot:{width:"100%",marginRight:"10px"},MuiAutocompleteRoot1:{width:"500px"},title:{flexGrow:1},disabled:{pointerEvents:"none",opacity:.5},popoverContainer:{display:"flex",flexDirection:"column",padding:e.spacing(2)},typography:{display:"flex"},popoverHeader:{display:"flex",alignItems:"center",borderBottom:"solid 1px #DDD"}}})),Ad=0,Fd={id:Ad,parentId:-1,combinator:"and",rules:[{}]},Bd={rules:[Fd]};var Dd=function(e){var t=e.value,n=void 0===t?Bd:t,a=e.setValue,c=e.index,s=e.element,d=e.type,b=e.processConfigs,h=e.isAllowButtons,v=e.defaultModel,y=n.metaModals,g=n.rules,j=Object(r.useState)("GROOVY"),x=Object(u.a)(j,1)[0],O=Object(r.useState)(y||v),w=Object(u.a)(O,2),E=w[0],N=w[1],C=Object(r.useState)(g),S=Object(u.a)(C,2),_=S[0],k=S[1],M=Rd();function P(e){Ad=(_?_.length:Ad)+1,k((function(t){return[].concat(Object(p.a)(t),[{id:Ad,parentId:e,rules:[]}])}))}function T(e){k(Object(uu.a)((function(t){var n=_.findIndex((function(t){return t.id===e}));t.splice(n,1)})))}function R(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k(Object(uu.a)((function(n){var a=_.findIndex((function(t){return t.id===e}));n[a].rules=[].concat(Object(p.a)(n[a].rules),[t])})))}function A(e,t){k(Object(uu.a)((function(n){n[_.findIndex((function(t){return t.id===e}))].rules.splice(t,1)})))}var F=function(e){return _.filter((function(t){return t.parentId===e}))};function B(){return D.apply(this,arguments)}function D(){return(D=Object(f.a)(m.a.mark((function e(){var t,n,a,i,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y||"dmnModel"!==y.type){e.next=7;break}if(!((t=y.outputDmnFieldList.map((function(e){return e.id})))&&t.length>0)){e.next=7;break}return e.next=5,_p({data:{criteria:[{fieldName:"id",operator:"IN",value:t}]}});case 5:return n=e.sent,e.abrupt("return",n&&n.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{type:e.fieldType})})));case 7:return a=fp(d),e.next=10,dd(E,a);case 10:if(e.t0=e.sent,e.t0){e.next=13;break}e.t0=[];case 13:if(i=e.t0,!E||!h){e.next=19;break}return e.next=17,Rp([{model:E.name,type:E.type,modelFullName:"".concat(E.packageName,".").concat(E.name)}]);case 17:r=e.sent,i=[].concat(Object(p.a)(i||[]),Object(p.a)(r||[]));case 19:return e.abrupt("return",i.filter((function(e){return(h?[].concat(Object(p.a)(sp),["button"]):sp).includes((e.type||"").toLowerCase())&&(!a||!e.json)})));case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return(L=Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ep());case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){N(y||v),k(g)}),[g,y,v]),Object(r.useEffect)((function(){a({metaModals:E,rules:_},c)}),[c,a,E,_]),Object(i.jsx)("div",{style:{width:"100%"},children:Object(i.jsxs)(Kc.a,{variant:"outlined",className:M.paper,style:{border:fp(d)?"none":"1px solid rgba(0, 0, 0, 0.12)"},children:[!fp(d)&&Object(i.jsx)("div",{style:{display:"flex",width:"100%",flexDirection:"column"},children:Object(i.jsx)("div",{style:{display:"flex"},children:Object(i.jsx)(gp,{name:"metaModal",title:"Model",placeholder:"meta modal",fetchAPI:function(){return L.apply(this,arguments)},optionLabelKey:"name",onChange:function(e){N(e),k([Fd])},readOnly:!!v,value:E,classes:{root:M.MuiAutocompleteRoot}})})}),_.filter((function(e){return-1===e.parentId})).map((function(e){return Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsx)(Td,{onAddGroup:P,onRemoveGroup:T,onAddRule:R,onRemoveRule:A,getChildEditors:F,getMetaFields:B,onChange:function(e,t,n){return function(e,t,n){var a=e.name,i=e.value;k(Object(uu.a)((function(e){var r=_.findIndex((function(e){return e.id===t.id}));n>=0?Object.assign(e[r].rules[n]=Object(l.a)(Object(l.a)(Object(l.a)({},e[r].rules[n]),{},Object(Uc.a)({},a,i),"fieldName"===a?{operator:"",fieldValue:null,fieldValue2:null,isRelationalValue:null,relatedValueFieldName:null,relatedValueModal:null}:{}),"operator"===a?{fieldValue:null,fieldValue2:null,isRelationalValue:null,relatedValueFieldName:null,relatedValueModal:null}:{})):e[r][a]=i})))}(e,t,n)},editor:e,isDisable:!Boolean(E),expression:x,type:d,parentMetaModal:E,element:s,processConfigs:b,isAllowButtons:h}),Object(i.jsx)("br",{})]},e.id)}))]})})},Ld=Object($c.a)((function(e){return{paper:{margin:e.spacing(1),padding:e.spacing(3,2),width:"calc(100% - 50px)",display:"flex",height:"calc(100% - 50px)",overflow:"auto"},expressionContainer:{display:"flex",alignItems:"center",width:"100%"},dialogPaper:{maxWidth:"100%",maxHeight:"100%",resize:"both",width:"70%",height:650},dialog:{minWidth:300},root:{display:"flex",flexDirection:"column",alignItems:"flex-start",height:"100%",overflow:"hidden"},combinator:{width:"fit-content"},timelineConnector:{backgroundColor:"#0275d8"},save:{margin:e.spacing(1),backgroundColor:"#0275d8",borderColor:"#0267bf",color:"white","&:hover":{backgroundColor:"#025aa5",borderColor:"#014682",color:"white"}},timeline:{width:"100%",padding:0,margin:0,justifyContent:"flex-start"},timelineOppositeContent:{display:"flex",alignItems:"center",justifyContent:"flex-end",maxWidth:60,padding:0},checkbox:{color:"#0275d8","&.MuiCheckbox-colorSecondary.Mui-checked":{color:"#0275d8"}},timelineItem:{"&.MuiTimelineItem-missingOppositeContent:before":{padding:0}},expression:{height:"100%",width:"100%"}}}));var Id=function(e){var t=e.handleClose,n=e.open,a=e.element,c=e.setProperty,s=e.getExpression,d=e.type,b=void 0===d?"expressionBuilder":d,h=e.title,v=void 0===h?"Add Expression":h,y=e.processConfigs,g=e.isAllowButtons,j=void 0===g||g,x=e.allowAllModels,O=void 0!==x&&x,w=e.bpmnModeler,E=e.defaultModel,N=fp(b)?"BPM":"GROOVY",C=Object(r.useState)("and"),S=Object(u.a)(C,2),_=S[0],k=S[1],M=Object(r.useState)(!1),P=Object(u.a)(M,2),T=P[0],R=P[1],A=Object(r.useState)([{Component:Dd}]),F=Object(u.a)(A,2),B=F[0],D=F[1],L=Object(r.useState)(!1),I=Object(u.a)(L,2),V=I[0],$=I[1],z=Object(r.useState)({alertMessage:"Add all values",alertTitle:"Error"}),W=Object(u.a)(z,2),G=W[0],H=W[1],U=Object(r.useState)(!1),K=Object(u.a)(U,2),q=K[0],J=K[1],Y=Object(r.useState)(null),X=Object(u.a)(Y,2),Q=X[0],Z=X[1],ee=Ld();function te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,i=up[fp(b)?"BPM":N],r=e.fieldName,o=e.operator,c=e.allField,s=e.fieldValue,l=e.fieldValue2,u=e.isRelationalValue,p=e.relatedValueFieldName,d=e.relatedValueModal,m=e.relatedElseValueFieldName,f=e.relatedElseValueModal,h=e.parent,v=e.nameField,y=r,g=y.split(ip[fp(b)?"BPM":N]).filter((function(e){return""!==e})),j=g[0],x=c.find((function(e){return e.name===j})),O=x||{},w=O.targetName,E=O.selectionList,C=O.nameField,S=x&&x.type&&x.type.toLowerCase().replaceAll("-","_"),_=x&&x.typeName,k=g&&g.splice(1)||[];if(["many_to_many","one_to_many","json_many_to_many","json_one_to_many"].includes(S)){var M=t.match(/\$\$/g);if(M&&M.length>0){var P=k.length>=1?"".concat(j,".find{it->it.$$$$}").concat(op.includes(o)?" != null":" == null"):"".concat(j,".").concat(k.length>0?"find":"collect","{it->it$$$$}").concat(k.length>0?op.includes(o)?" != null":" == null":"");t=t.replace(/\$\$/g,P)}else{var T=k.length>=1?"".concat(j,".find{it->it.$$}").concat(op.includes(o)?" != null":" == null"):"".concat(j,".").concat(k.length>0?"find":"collect","{it->it$$}").concat(k.length>0?op.includes(o)?" != null":" == null":"");t+=T}var R=k.join(ip[N]);return te({fieldName:R,operator:o,allField:c,fieldValue:s,fieldValue2:l,isRelationalValue:u,relatedValueFieldName:p,relatedValueModal:d,relatedElseValueFieldName:m,relatedElseValueModal:f,parent:g&&g[0],nameField:C||v},t,k.length>1,a)}if(["json_many_to_one","json_one_to_one","many_to_one","one_to_one"].includes(S)){var A=k.join(ip[N]),F=t.match(/\$\$/g),B=k.length>=1?"".concat(j).concat(ip[N]):j;return F&&F.length>0?t=t.replace(/\$\$/g,"".concat(B,"$$$$")):t+="".concat(B,"$$"),te({fieldName:A,operator:o,allField:c,fieldValue:s,fieldValue2:l,isRelationalValue:u,relatedValueFieldName:p,relatedValueModal:d,relatedElseValueFieldName:m,relatedElseValueModal:f,nameField:C||v,parent:g&&g[0]},t,k.length>1,a)}var D=["long","integer","decimal","boolean","button","double"].includes(S),L=["date","time","datetime"].includes(S);if(D&&(s||!1===s||E||u||(s=0),["between","notBetween"].includes(o)&&!l&&(l=0)),u||D||"object"===typeof s||(s="'".concat(Jp()(s),"'"),l="'".concat(Jp()(l),"'")),L&&(u||(s=ne(S,s),l=ne(S,l)),y=_?"".concat(y,"?.toLocalDateTime()"):y),["in","notIn"].includes(o)){var I=t&&t.includes("{it->it$$}"),V=c.find((function(e){return e.name===h}))||{},$="string"===typeof e.fieldValue?e.fieldValue:e.fieldValue.map((function(e){return D?"".concat(e.nameField||e.targetName||e.fullName||e.name||e.id):e.nameField||e.targetName||e.fullName||e.name?"'".concat(e.nameField||e.targetName||e.fullName||e.name,"'"):e.id})).join(","),z=n||k.length>=1?"":"".concat(y).concat(E?"":"".concat(ip[N]).concat(v||V&&V.targetName||w||"fullName")),W="".concat("notIn"===o?"!":"","[".concat($,"]")).concat(ip[N]).concat(i[o]).concat(I?"All":"","(").concat(a).concat(ip[N]).concat(t.replace(/\$\$/g,z),")");return W}if(["contains","notContains"].includes(o)){var G=t&&t.includes("{it->it$$}"),H=c.find((function(e){return e.name===h}))||{},U="string"===typeof e.fieldValue?e.fieldValue:e.fieldValue.map((function(e){return D?"".concat(e.nameField||e.targetName||e.fullName||e.name||e.id):e.nameField||e.targetName||e.fullName||e.name?"'".concat(e.nameField||e.targetName||e.fullName||e.name,"'"):e.id})).join(","),K=n||k.length>=1?"":"".concat(y).concat(E?"":"".concat(ip[N]).concat(v||H&&H.targetName||w||"fullName")),q="".concat("notContains"===o?"!":"","(").concat(a).concat(ip[N]).concat(t.replace(/\$\$/g,K),")").concat(ip[N]).concat(i[o]).concat(G?"All":"","(","[".concat(U,"]"),")");return q}if(["between","notBetween"].includes(o)){var J=t.match(/it.\$\$/g);if(J&&J.length){var Y="(it.".concat(a).concat(ip[N]).concat(y," >= ").concat(s," && it.").concat(a).concat(ip[N]).concat(y," <= ").concat(l,")");return"notBetween"===o?"".concat(t.replace(/it.\$\$/g,"!".concat(Y))):t.replace(/it.\$\$/g,Y)}var X=function(e){var t=e&&e.replace(/\$\$/g,y)||y;return"notBetween"===o?"!(".concat(a).concat(ip[N]).concat(t," >= ").concat(s," && ").concat(a).concat(ip[N]).concat(t," <= ").concat(l,")"):"(".concat(a).concat(ip[N]).concat(t," >= ").concat(s," && ").concat(a).concat(ip[N]).concat(t," <= ").concat(l,")")};return X(t)}if(["isNotNull","isNull"].includes(o)){var Q="".concat(y," ").concat(i[o]),Z=c.find((function(e){return e.name===h}))||{},ee=t&&t.includes("{it->it$$}");if(ee){var ae=n||k.length>=1?"":"".concat(y).concat(E?"":"".concat(ip[N]).concat(Z&&Z.targetName||w||"fullName"));return"".concat(a).concat(ip[N]).concat(t.replace(/\$\$/g,"".concat(ae," ").concat(Q)))}return"".concat(a).concat(ip[N]).concat(t.replace(/\$\$/g,Q))}if(["isTrue","isFalse"].includes(o)){var ie="isTrue"===o,re="".concat(y," ").concat(i[o]," ").concat(ie);return"".concat(a).concat(ip[N]).concat(t.replace(/\$\$/g,re))}if(["like","notLike"].includes(o)){var oe="".concat(y).concat(ip[N]).concat(i[o],"(").concat(s,")");return"".concat("notLike"===o?"!":"").concat(a).concat(ip[N]).concat(t.replace(/\$\$/g,oe))}var ce=x||c.find((function(e){return e.name===h}))||{},se="object"===typeof s&&s?"'".concat(Jp()(s[v]||s[w]||s.fullName||s.name||s.id||""),"'"):s,le="".concat("object"===typeof s&&s?"".concat(y).concat(ip[N]).concat(v||ce.targetName||"fullName"):y," ").concat(i[o]," ").concat(se);return"button"===S?"".concat(t.replace(/\$\$/g,le)):"".concat(a).concat(ip[N]).concat(t.replace(/\$\$/g,le))}function ne(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("date"===e){var a='"'.concat(Is()(t,rp.date).format("YYYY-MM-DD"),'"');return n?a:"LocalDate.parse(".concat(a,")")}if("datetime"===e)return n?'"'.concat(Is()(t,rp.datetime).toISOString(),'"'):"LocalDateTime.of(".concat(Is()(t,rp.datetime).format("YYYY-M-D-H-m-s").split("-"),")");var i='"'.concat(Is()(t,rp.time).format("HH:mm:ss"),'"');return n?i:"LocalTime.parse(".concat(i,")")}function ae(e,t){for(var n=fp(b),a=n?"self":V?"$ctx.find('".concat(function(e){if(e)return e.charAt(0).toUpperCase()+e.slice(1)}(t),"', ").concat(t,"Id)"):t,i=up[n?"BPM":N],r=[],o=function(t){var o=e[t],c=o.fieldName,s=o.field,l=void 0===s?{}:s,u=o.operator,p=o.allField,d=l||{},m=d.targetName,f=d.selectionList,b=l&&l.type&&l.type.toLowerCase(),h=l&&l.typeName,v=["long","integer","decimal","boolean","button","double"].includes(b),y=["date","time","datetime"].includes(b),g=o.fieldValue,j=o.fieldValue2,x=o.isRelationalValue,O=c;!v||f||x||(g||!1===g||(g=0),["between","notBetween"].includes(u)&&!j&&(j=0));var w=isNaN(g)?g:"".concat(g);if(""===u||f&&!g&&!["isNull","isNotNull","isTrue","isFalse"].includes(u)||(!v&&!g||v&&x&&!g&&f||g&&g.length<=0||(!j||j&&j.length<=0)&&["between","notBetween"].includes(u))&&!["isNull","isNotNull","isTrue","isFalse"].includes(u))return"break";if(!O)return"break";if(Object(cl.isEmpty)(w)&&!["isNull","isNotNull","isTrue","isFalse"].includes(u))return"break";var E=O&&O.split(ip[N])[0],C=p&&p.find((function(e){return e.name===E}));if(["many_to_many","one_to_many","many_to_one","one_to_one","json_many_to_many","json_one_to_many","json_many_to_one","json_one_to_one"].includes(C&&C.type&&C.type.toLowerCase()&&C.type.toLowerCase().replaceAll("-","_")))r.push(te(o,void 0,!1,a));else{x||v||"object"===typeof g||(g="'".concat(Jp()(g),"'"),j="'".concat(Jp()(j),"'")),y&&(x||(g=ne(b,g),j=ne(b,j)),O=h?"".concat(O,"?.toLocalDateTime()"):O);var S=n?ap:np;if(["in","notIn"].includes(u)){var _=o.fieldValue.map((function(e){return v?"".concat(e.targetName||e.fullName||e.name):"'".concat(e.targetName||e.fullName||e.name,"'")})).filter((function(e){return""!==e})).join(",");r.push("".concat("notIn"===u?"!":"","[".concat(_,"]")).concat(ip[N]).concat(i[u],"(").concat(a).concat(ip[N]).concat(O).concat(f?" ":"".concat(ip[N]," ").concat(m||"fullName"),")"))}else if(["between","notBetween"].includes(u))"notBetween"===u&&r.push("!(".concat(a).concat(ip[N]).concat(O," >= ").concat(g," ").concat(S.and," ").concat(a).concat(ip[N]).concat(O," <= ").concat(j,")")),r.push("(".concat(a).concat(ip[N]).concat(O," >= ").concat(g," ").concat(S.and," ").concat(a).concat(ip[N]).concat(O," <= ").concat(j,")"));else if(["isNotNull","isNull"].includes(u))r.push("".concat(a).concat(ip[N]).concat(O," ").concat(i[u]));else if(["isTrue","isFalse"].includes(u)){var k="isTrue"===u;r.push("".concat(a).concat(ip[N]).concat(O," ").concat(i[u]," ").concat(k))}else if(["like","notLike"].includes(u))r.push("".concat("notLike"===u?"!":"").concat(a).concat(ip[N]).concat(O).concat(ip[N]).concat(i[u],"(").concat(g,")"));else{var M="object"===typeof g&&g?"'".concat(Jp()(g[m]||g.fullName||g.name||""),"'"):g;r.push("button"===b?"".concat(O," ").concat(i[u]," ").concat(M):"".concat(a).concat(ip[N]).concat("many_to_one"===b||"json_many_to_one"===b?"".concat(O).concat(ip[N]).concat(l.targetName||"fullName"):O," ").concat(i[u]," ").concat(M))}}},c=0;c<(e&&e.length);c++){if("break"===o(c))break}return r}function ie(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=fp(b),i=a?"self":t,r=up[a?"BPM":N],o=n,c=[],s=function(t){var n=e[t],s=n.fieldName,u=n.field,p=void 0===u?{}:u,d=n.operator,m=n.allField,f=p||{},b=f.targetName,h=f.selectionList,v=f.model,y=f.target,g=f.jsonField,j=p&&p.type&&p.type.toLowerCase(),x=["long","integer","double","decimal","boolean"].includes(j),O=["date","time","datetime"].includes(j),w="com.axelor.meta.db.MetaJsonRecord"===v||"com.axelor.meta.db.MetaJsonRecord"===y||g,E=void 0,C=s&&s.split(ip[N]);!w&&C&&C.length>1&&C.forEach((function(e){var t=m&&m.find((function(t){return t.name===e&&("com.axelor.meta.db.MetaJsonRecord"===t.model||"com.axelor.meta.db.MetaJsonRecord"===t.target||t.jsonField)}));t&&(w=!0,E=t)}));var S=w?"".concat(hp(E?Object(l.a)(Object(l.a)({},E),{},{targetName:p&&p.targetName}):p,i,s)):void 0,_=n||{},k=_.fieldValue,M=_.fieldValue2,P=_.isRelationalValue;!x||h||P||(k||(k=0),["between","notBetween"].includes(d)&&!M&&(M=0));var T=isNaN(k)?k:"".concat(k);if(""===d||h&&!k||x&&P&&!k||(!x&&!k||k&&k.length<=0||(!M||M&&M.length<=0)&&["between","notBetween"].includes(d))&&!["isNull","isNotNull","isTrue","isFalse"].includes(d))return"break";if(["isNotNull","isNull"].includes(d)||++o,!s)return"break";if(Object(cl.isEmpty)(T)&&!["isNull","isNotNull","isTrue","isFalse"].includes(d))return"break";P||x||"object"===typeof k||(k="'".concat(Jp()(k),"'"),M="'".concat(Jp()(M),"'")),O&&(P||(k=ne(j,k,w),M=ne(j,M,w)));var R=a?ap:np;if(["in","notIn"].includes(d)){var A=n&&n.fieldValue&&n.fieldValue.map((function(e){return x?"".concat(e.targetName||e.fullName||e.name):"'".concat(e.targetName||e.fullName||e.name,"'")})).filter((function(e){return""!==e}));c.push({condition:"".concat(S||"".concat(i,".").concat(s).concat(h?"":".".concat(b||"fullName"))," ").concat(r[d]," ").concat("?".concat(o)),values:[[A]]})}else if(["between","notBetween"].includes(d)){var F=[k,M];O&&a?("notBetween"===d&&c.push({condition:"".concat(S||"".concat(i,".").concat(s)," NOT BETWEEN ").concat("?".concat(o)," ").concat(R.and," ").concat("?".concat(++o)),values:F}),c.push({condition:"".concat(S||"".concat(i,".").concat(s)," BETWEEN ").concat("?".concat(o)," ").concat(R.and," ").concat("?".concat(++o)),values:F})):("notBetween"===d&&c.push({condition:"NOT (".concat(S||"".concat(i,".").concat(s)," >= ").concat("?".concat(o)," ").concat(R.and," ").concat(S||"".concat(i,".").concat(s)," <= ").concat("?".concat(++o),")"),values:F}),c.push({condition:"(".concat(S||"".concat(i,".").concat(s)," >= ").concat("?".concat(o)," ").concat(R.and," ").concat(S||"".concat(i,".").concat(s)," <= ").concat("?".concat(++o),")"),values:F}))}else if(["isNotNull","isNull"].includes(d))c.push({condition:"".concat(S||"".concat(i,".").concat(s)," ").concat(r[d])});else if(["isTrue","isFalse"].includes(d)){--o;var B="isTrue"===d;c.push({condition:"".concat(S||"".concat(i,".").concat(s)," ").concat(r[d]," ").concat(B),values:void 0})}else if(["contains","notContains"].includes(d)){var D="object"===typeof k&&k?"'".concat(Jp()(k[p.targetName]||""),"'"):k;c.push({condition:"".concat("?".concat(o)," ").concat(r[d]," ").concat(S||"".concat(i,".").concat(s)),values:[D]})}else{var L="object"===typeof k&&k?"'".concat(Jp()(k[p.targetName]||""),"'"):k;c.push({condition:"".concat(S||"".concat(i,".").concat(["many_to_one","json_many_to_one","one_to_one","json_one_to_one"].includes(j)&&!P?"".concat(s,".").concat(p.targetName||"fullName"):s)," ").concat(r[d]," ").concat(["like","notLike"].includes(d)?"CONCAT('%',?".concat(o,",'%')"):"?".concat(o)),values:[L]})}},u=0;u<(e&&e.length);u++){var p=s(u);if("break"===p)break}return c}function re(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e&&e[0]||{},r=i.rules,o=i.combinator,c=void 0===o?"and":o,s=i.children,l=i.parentId,u=ie(r,t,a),d=u&&u.filter((function(e){return e})),m=[];s&&s.length>0&&s.forEach((function(e){var n=d&&d.map((function(e){return e&&e.values})).filter((function(e){return e}))||[],a=m&&m.map((function(e){return e&&e.values})).filter((function(e){return e}))||[],i=re([e],t,!0,(n&&n.length)+(a&&a.length))||{},r=i.condition,o=i.values,c=[].concat.apply([],o);m.push({condition:r,values:c&&c.length>0?c:void 0})}));var f=fp(b)?ap:np,h=d&&d.map((function(e){return e&&e.condition})),v=h&&h.filter((function(e){return null!==e})),y=m&&(m.map((function(e){return e&&e.condition}))||[]).filter((function(e){return e})),g=m&&m.filter((function(e){return null!==e}));if(-1===l&&s.length>0){var j=y&&0!==y.length;return{condition:"".concat(j?"( ":"","(").concat(v?v.join(" "+f[c]+" "):""," ").concat(j?" ".concat(f[c]," ").concat(y.join(" "+f[c]+" ")):"",")").concat(j?" )":""),values:[].concat(Object(p.a)(d&&d.map((function(e){return e&&e.values})).filter((function(e){return e}))||[]),Object(p.a)(g&&g.map((function(e){return e&&e.values})).filter((function(e){return e}))||[]))}}return n&&d&&v&&0!==v.length?{condition:"(".concat(v.join(" "+f[c]+" "),")"),values:d&&d.map((function(e){return e&&e.values})).filter((function(e){return e}))}:v&&0!==v.length?{condition:"".concat(v.join(" "+f[c]+" ")),values:d&&d.map((function(e){return e&&e.values})).filter((function(e){return e}))}:void 0}function oe(e,t,n){var a=e[0],i=a.rules,r=a.combinator,o=void 0===r?"and":r,c=a.children,s=a.parentId,l=ae(i,t),u=l&&l.filter((function(e){return""!==e})),p=[];c&&c.length>0&&c.forEach((function(e){var n=oe([e],t,!0);n&&p.push(n)}));var d=fp(b)?ap:np;if(-1===s&&c.length>0&&u&&u.length>0){var m=p&&0!==p.length;return"".concat(m?"( ":"","(").concat(u?u.join(" "+d[o]+" "):""," ").concat(m?" ".concat(d[o]," ").concat(p.join(" "+d[o]+" ")):"",")").concat(m?")":"")}return n&&u&&u.length>0?" ("+u.join(" "+d[o]+" ")+") ":u&&u.length>0?u.join(" "+d[o]+" "):void 0}function ce(e){for(var t,n={},a=[],i=e.map((function(e,t){return n[e.id]=t,Object(l.a)(Object(l.a)({},e),{},{children:[]})})),r=0;r<i.length;r+=1)(t=i[r]).parentId>=0?i[n[t.parentId]]&&i[n[t.parentId]].children.push(t):a.push(t);return a}var se=o.a.useCallback((function(e,t){D(Object(uu.a)((function(n){n[t].value=e})))}),[]);function le(e,n){var a=[],i=[],r=function(){for(var e=!0,t=[],n=0;n<(B&&B.length);n++){var a=B[n].value||{},i=a.rules;if(!a.metaModals)return e;t.push(i)}for(var r=sl.a.flattenDeep(t||[]),o=r&&r.map((function(e){return e.rules})),c=sl.a.flattenDeep(o||[]),s=0;s<(c&&c.length);s++){var l=c&&c[s],u=l||{},p=u.fieldName,d=u.field,m=void 0===d?{}:d,f=u.operator,h=(m||{}).selectionList,v=m&&m.type&&m.type.toLowerCase(),y=["long","integer","decimal","boolean","button","double"].includes(v),g=l.fieldValue,j=l.fieldValue2,x=l.isRelationalValue,O=p;!y||h||x||(g||!1===g||(g=0),["between","notBetween"].includes(f)&&!j&&(j=0));var w=isNaN(g)?g:"".concat(g);if(!O&&!fp(b)){e=!1;break}if(Object(cl.isEmpty)(w)&&O&&!["isNull","isNotNull","isTrue","isFalse"].includes(f)){e=!1;break}if(O&&(""===f||h&&!g||y&&x&&!g||(!y&&!g||g&&g.length<=0||(!j||j&&j.length<=0)&&["between","notBetween"].includes(f))&&!["isNull","isNotNull","isTrue","isFalse"].includes(f))){e=!1;break}}return e}();if(!r)return R(!0),void H({alertMessage:"Add all values",alertTitle:"Error"});for(var o=[],s=0;s<B.length;s++){var l=B[s].value,u=l.rules,d=l.metaModals,m=d&&"dmnModel"===d.type?d.resultVariable:d&&d.name,f="",h=ce(u),v=fp(n)?re(h,bp(m),void 0):oe(h,bp(m),void 0);if(i.push.apply(i,Object(p.a)(v&&((v.values||[]).filter((function(e){return Array.isArray(e)}))||[])||[])),!d)break;fp(n)&&v&&v.condition?f+=v.condition:v&&(f+=v);var y={metaModalName:m,metaModalType:d.type,rules:u,generateWithId:V};d&&"dmnModel"===d.type&&(y.decisionId=d.decisionId,y.dmnNodeId=d.dmnNodeId),a.push(y),f&&o.push("".concat(f))}var g=fp(b)?ap:np,j=o.filter((function(e){return""!==e})).map((function(e){return o.length>1?"(".concat(e,")"):e})).join(" "+g[e]+" "),x=j;if(fp(n)){var O="";i&&i.forEach((function(e){e&&Array.isArray(e[0])&&e[0]?O+=", [".concat(e[0],"]"):(e&&Array.isArray(e)&&e.length>0&&(e=e.join(", ")),O=O+", "+e)})),x=j?'"'.concat(j,'"').concat(i&&i.length>0?"".concat(O):""):void 0}r&&(c({expression:x,value:a&&a.length>0?JSON.stringify(a):void 0,combinator:e}),t())}return Object(r.useEffect)((function(){var e=!0;function t(){return(t=Object(f.a)(m.a.mark((function t(){var n,a,i,r,o,c,u;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=s()||{},a=n.values,i=n.combinator,r=[],Z(a),a&&0!==a.length){t.next=6;break}return D([{Component:Dd,value:void 0}]),t.abrupt("return");case 6:o=m.a.mark((function e(t){var n,i,o,c,s,u,p,d,f,b,h,v,y;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a[t],i=n.metaModalName,o=n.decisionId,c=n.dmnNodeId,s=n.metaModalType,u=n.generateWithId,"dmnModel"!==s){e.next=16;break}if(o){e.next=5;break}return e.abrupt("return",{v:void 0});case 5:return e.next=7,Cp([{fieldName:"decisionId",operator:"=",value:o}]);case 7:if((p=e.sent)&&w){e.next=10;break}return e.abrupt("return",{v:void 0});case 10:d=w.get("elementRegistry"),f=d&&d.find((function(e){return e.id===c})),b={metaModals:p&&Object(l.a)(Object(l.a)({},p[0]),{},{dmnNodeId:f&&f.id,dmnNodeNameId:f&&f.businessObject&&f.businessObject.name,resultVariable:f&&f.businessObject&&f.businessObject.resultVariable,type:"dmnModel"}),rules:n.rules},r.push({Component:Dd,value:b}),e.next=24;break;case 16:return h={criteria:[{fieldName:"name",operator:"=",value:i}],operator:"and"},e.next=19,Ep(h,s);case 19:if(v=e.sent){e.next=22;break}return e.abrupt("return",{v:void 0});case 22:y={metaModals:v&&v[0],rules:n.rules},r.push({Component:Dd,value:y});case 24:$(u);case 25:case"end":return e.stop()}}),e)})),c=0;case 8:if(!(c<a.length)){t.next=16;break}return t.delegateYield(o(c),"t0",10);case 10:if("object"!==typeof(u=t.t0)){t.next=13;break}return t.abrupt("return",u.v);case 13:c++,t.next=8;break;case 16:e&&(D(r),k(i||"and"));case 17:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return function(){t.apply(this,arguments)}(),function(){return e=!1}}),[s,b,w]),Object(i.jsxs)(Fc.a,{onClose:function(e,n){"backdropClick"!==n&&t()},"aria-labelledby":"simple-dialog-title",open:n,classes:{paper:ee.dialogPaper},children:[Object(i.jsx)(Bc.a,{id:"simple-dialog-title",children:v}),Object(i.jsxs)("div",{className:ee.root,children:[Object(i.jsx)(Kc.a,{variant:"outlined",className:ee.paper,children:Object(i.jsx)("div",{style:{height:"100%",width:"100%"},children:Object(i.jsxs)("div",{className:ee.expression,children:[!fp(b)&&Object(i.jsx)(pl.a,{control:Object(i.jsx)(dl.a,{checked:V,onChange:function(e){return $(e.target.checked)},name:"generateWithId",className:ee.checkbox}),style:{color:"#0275d8",padding:"0px 15px"},label:"Generate with saved record"}),Object(i.jsx)(Yp.a,{align:"alternate",className:ee.timeline,style:{border:"BPM"===N?"none":"1px solid rgba(0, 0, 0, 0.12)"},children:fp(b)?Object(i.jsx)(Xp.a,{className:ee.timelineItem,style:{width:"100%"},children:Object(i.jsx)("div",{style:{width:"100%"},children:B&&B.map((function(e,t){var n=e.Component,r=e.value;return Object(i.jsx)("div",{className:ee.expressionContainer,children:Object(i.jsx)(n,{value:r,index:t,setValue:se,element:a,type:b,processConfigs:y,isAllowButtons:j,allowAllModels:O,bpmnModeler:w,defaultModel:E})},t)}))})}):Object(i.jsxs)(Xp.a,{style:{minHeight:"100%",width:"89%"},children:[Object(i.jsx)(Qp.a,{className:ee.timelineOppositeContent,style:{paddingLeft:16},children:Object(i.jsx)(qu,{name:"expression",options:tp,value:_||"and",disableUnderline:!0,className:ee.combinator,onChange:function(e){k(e)}})}),Object(i.jsxs)(Zp.a,{children:[Object(i.jsx)(ed.a,{variant:"outlined",style:{borderColor:"#0275d8"}}),Object(i.jsx)(td.a,{className:ee.timelineConnector})]}),Object(i.jsxs)(nd.a,{style:{width:"100%"},children:[Object(i.jsx)(Qu,{title:"Add Expression",Icon:Qc.a,onClick:function(){D(Object(uu.a)((function(e){e.push({Component:Dd.bind({})})})))}}),Object(i.jsx)("div",{children:B&&B.map((function(e,t){var n=e.Component,r=e.value;return Object(i.jsxs)("div",{className:ee.expressionContainer,children:[Object(i.jsx)(n,{value:r,index:t,setValue:se,element:a,type:b,processConfigs:y,isAllowButtons:j,allowAllModels:O,bpmnModeler:w,defaultModel:E}),!fp(b)&&Object(i.jsx)(Qu,{Icon:id.a,onClick:function(){return function(e){D(Object(uu.a)((function(t){t.splice(e,1)})))}(t)}})]},t)}))})]})]})})]})})}),Object(i.jsxs)("div",{children:[Object(i.jsx)(Qu,{title:"OK",className:ee.save,onClick:function(){return le(_,b)}}),Object(i.jsx)(Qu,{title:"Cancel",className:ee.save,onClick:function(){var e=function(){var e=[];return B&&B.forEach((function(t){var n=t.value||{},a=n.rules,i=n.metaModals,r=i&&i.name;i&&e.push({metaModalName:r,metaModalType:i&&i.type,rules:a,generateWithId:V})})),e}();e&&e.length<=0||JSON.stringify(e)===JSON.stringify(Q)?t():(J(!0),R(!0),H({alertMessage:"Current changes will be lost. Do you really want to proceed?",alertTitle:"Question"}))}})]})]}),T&&Object(i.jsxs)(Fc.a,{open:T,onClose:function(e,t){"backdropClick"!==t&&R(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",classes:{paper:ee.dialog},children:[Object(i.jsx)(Bc.a,{id:"alert-dialog-title",children:G.alertTitle}),Object(i.jsx)(Dc.a,{children:Object(i.jsx)(Lc.a,{id:"alert-dialog-description",children:G.alertMessage})}),Object(i.jsxs)(Ic.a,{children:[Object(i.jsx)(Vc.a,{onClick:function(){R(!1),q&&t()},color:"primary",autoFocus:!0,className:ee.save,children:"Ok"}),Object(i.jsx)(Vc.a,{onClick:function(){R(!1)},color:"primary",autoFocus:!0,style:{textTransform:"none"},className:ee.save,children:"Cancel"})]})]})]})},Vd=Object($c.a)((function(e){return{expressionBuilder:{display:"flex",alignItems:"center",justifyContent:"space-between"},newIcon:{color:"#58B423",marginLeft:5},new:{cursor:"pointer",marginTop:18.6,display:"flex"},textbox:{width:"100%"},dialog:{minWidth:300},title:{fontSize:18,fontWeight:"bold"},save:{margin:e.spacing(1),backgroundColor:"#0275d8",borderColor:"#0267bf",textTransform:"none",color:"white","&:hover":{backgroundColor:"#025aa5",borderColor:"#014682",color:"white"}}}}));function $d(e){var t=e.element,n=e.bpmnModeler,a=Object(r.useState)(!1),c=Object(u.a)(a,2),s=c[0],p=c[1],d=Object(r.useState)(!1),b=Object(u.a)(d,2),v=b[0],y=b[1],g=Object(r.useState)(!1),j=Object(u.a)(g,2),x=j[0],O=j[1],w=Object(r.useState)(!1),E=Object(u.a)(w,2),N=E[0],C=E[1],S=Object(r.useState)(null),_=Object(u.a)(S,2),k=_[0],M=_[1],P=Object(r.useState)(null),T=Object(u.a)(P,2),R=T[0],A=T[1],F=Object(r.useState)(null),B=Object(u.a)(F,2),D=B[0],L=B[1],I=Vd(),V=function(e,a){n&&n.get("modeling").updateProperties(t,Object(Uc.a)({},e,a))},$=o.a.useCallback((function(e){return t.businessObject[e]}),[t]);return Object(r.useEffect)((function(){function e(){return(e=Object(f.a)(m.a.mark((function e(){var t,n,a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=$("model"),n=$("isJson"),t){e.next=5;break}return L(null),e.abrupt("return");case 5:return a={criteria:[{fieldName:"name",operator:"=",value:t}],operator:"and"},e.next=8,Ep(a,n?"metaJsonModel":"metaModel");case 8:i=e.sent,L(i&&i[0]);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var t=$("isJson");p(t),y(!!$("expressionValue")),function(){e.apply(this,arguments)}()}),[$]),Object(i.jsxs)("div",{children:[Object(i.jsx)($u,{entry:{id:"isJson",label:ku("Is Json"),modelProperty:"isJson",widget:"checkbox",get:function(){return{isJson:Mu(s)}},set:function(e,t){var n=t.isJson;p(n),V("isJson",n)}},element:t}),Object(i.jsx)(Wu,{element:t,bpmnModeler:n,entry:{fetchMethod:function(){return s?Ip():Dp()},name:"model",label:ku("Model")},value:D,onChange:function(e){L(e?Object(l.a)(Object(l.a)({},e||{}),{},{type:s?"metaJsonModel":"metaModel"}):void 0)}}),Object(i.jsxs)("div",{className:I.expressionBuilder,children:[Object(i.jsx)(Fu,{element:t,className:I.textbox,readOnly:!(!v&&D&&""!==D),bpmnModeler:n,entry:{id:"expression",label:ku("Query"),modelProperty:"expression",name:"expression",get:function(){return{expression:($("expression")||"").replace(/[\u200B-\u200D\uFEFF]/g,"")}},set:function(e,t){V("expression",""===t.expression?void 0:t.expression)}}}),D&&Object(i.jsxs)("div",{className:I.new,children:[Object(i.jsx)(h.a,{title:"Enable","aria-label":"enable",children:Object(i.jsx)(zc.a,{className:I.newIcon,onClick:function(){v&&(A("Query can't be managed using builder once changed manually."),M("Warning"),O(!0))}})}),Object(i.jsx)(Wc.a,{className:I.newIcon,onClick:function(){C(!0)}}),N&&Object(i.jsx)(Id,{open:N,handleClose:function(){C(!1)},type:"bpmQuery",defaultModel:D,getExpression:function(){var e,t=$("expressionValue");if(void 0!==t)try{(e=JSON.parse(t)).length||(e=null)}catch(n){}return{values:e,combinator:void 0}},setProperty:function(e){var t=e.expression,n=e.value;V("expression",t),""!==t&&null!==t&&void 0!==t?n&&((n||"").replace(/[\u200B-\u200D\uFEFF]/g,""),V("expressionValue",n),y(!0)):V("expressionValue",void 0)},element:t,title:"Add Query"}),x&&Object(i.jsxs)(Fc.a,{open:x,onClose:function(e,t){"backdropClick"!==t&&O(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",classes:{paper:I.dialog},children:[Object(i.jsx)(Bc.a,{id:"alert-dialog-title",children:Object(i.jsx)("label",{className:I.title,children:ku(k)})}),Object(i.jsx)(Dc.a,{children:Object(i.jsx)(Lc.a,{id:"alert-dialog-description",children:ku(R)})}),Object(i.jsxs)(Ic.a,{children:[Object(i.jsx)(Vc.a,{onClick:function(){O(!1),A(null),M(null),y(!1),V("expressionValue",void 0)},color:"primary",className:I.save,autoFocus:!0,children:"Ok"}),Object(i.jsx)(Vc.a,{onClick:function(){O(!1)},color:"primary",className:I.save,children:"Cancel"})]})]})]})]})]})}var zd=Object($c.a)((function(e){return{expressionBuilder:{display:"flex",alignItems:"center",justifyContent:"space-between"},newIcon:{color:"#58B423",marginLeft:5},new:{cursor:"pointer",marginTop:18.6,display:"flex"},textbox:{width:"100%"},dialog:{minWidth:300},title:{fontSize:18,fontWeight:"bold"},save:{margin:e.spacing(1),backgroundColor:"#0275d8",borderColor:"#0267bf",textTransform:"none",color:"white","&:hover":{backgroundColor:"#025aa5",borderColor:"#014682",color:"white"}}}}));function Wd(e){var t=e.element,n=e.bpmnModeler,a=Object(r.useState)(!1),c=Object(u.a)(a,2),s=c[0],l=c[1],p=Object(r.useState)(!1),d=Object(u.a)(p,2),b=d[0],v=d[1],y=Object(r.useState)(!1),g=Object(u.a)(y,2),j=g[0],x=g[1],O=Object(r.useState)(null),w=Object(u.a)(O,2),E=w[0],N=w[1],C=Object(r.useState)(null),S=Object(u.a)(C,2),_=S[0],k=S[1],M=Object(r.useState)(null),P=Object(u.a)(M,2),T=P[0],R=P[1],A=zd(),F=function(e,a){n&&n.get("modeling").updateProperties(t,Object(Uc.a)({},e,a))},B=o.a.useCallback((function(e){return t.businessObject[e]}),[t]);return Object(r.useEffect)((function(){function e(){return(e=Object(f.a)(m.a.mark((function e(){var t,n,a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=B("model"),n=B("isJson"),t){e.next=5;break}return R(null),e.abrupt("return");case 5:return a={criteria:[{fieldName:"name",operator:"=",value:t}],operator:"and"},e.next=8,Ep(a,n?"metaJsonModel":"metaModel");case 8:i=e.sent,R(i&&i[0]);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}l(!!B("expressionValue")),function(){e.apply(this,arguments)}()}),[B]),Object(i.jsxs)("div",{className:A.expressionBuilder,children:[Object(i.jsx)(Fu,{element:t,className:A.textbox,readOnly:s,bpmnModeler:n,entry:{id:"expression",label:ku("Expression"),modelProperty:"expression",name:"expression",get:function(){return{expression:(B("expression")||"").replace(/[\u200B-\u200D\uFEFF]/g,"")}},set:function(e,t){F("expression",""===t.expression?void 0:t.expression)}}}),Object(i.jsxs)("div",{className:A.new,children:[Object(i.jsx)(h.a,{title:"Enable","aria-label":"enable",children:Object(i.jsx)(zc.a,{className:A.newIcon,onClick:function(){s&&(k("Query can't be managed using builder once changed manually."),N("Warning"),v(!0))}})}),Object(i.jsx)(Wc.a,{className:A.newIcon,onClick:function(){x(!0)}}),j&&Object(i.jsx)(Id,{open:j,handleClose:function(){x(!1)},defaultModel:T,getExpression:function(){var e,t=B("expressionValue");if(void 0!==t)try{(e=JSON.parse(t)).length||(e=null)}catch(n){}return{values:e,combinator:void 0}},setProperty:function(e){var t=e.expression,n=e.value;F("expression",t),""!==t&&null!==t&&void 0!==t?n&&((n||"").replace(/[\u200B-\u200D\uFEFF]/g,""),F("expressionValue",n),l(!0)):F("expressionValue",void 0)},element:t,title:ku("Add Expression")}),b&&Object(i.jsxs)(Fc.a,{open:b,onClose:function(e,t){"backdropClick"!==t&&v(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",classes:{paper:A.dialog},children:[Object(i.jsx)(Bc.a,{id:"alert-dialog-title",children:Object(i.jsx)("label",{className:A.title,children:ku(E)})}),Object(i.jsx)(Dc.a,{children:Object(i.jsx)(Lc.a,{id:"alert-dialog-description",children:ku(_)})}),Object(i.jsxs)(Ic.a,{children:[Object(i.jsx)(Vc.a,{onClick:function(){v(!1),k(null),N(null),l(!1),F("expressionValue",void 0)},color:"primary",className:A.save,autoFocus:!0,children:"Ok"}),Object(i.jsx)(Vc.a,{onClick:function(){v(!1)},color:"primary",className:A.save,children:"Cancel"})]})]})]})]})}var Gd=Object($c.a)((function(e){return{expressionBuilder:{display:"flex",alignItems:"center",justifyContent:"space-between"},newIcon:{color:"#58B423",marginLeft:5},new:{cursor:"pointer",marginTop:18.6,display:"flex"},textbox:{width:"100%"},dialog:{minWidth:300},title:{fontSize:18,fontWeight:"bold"},save:{margin:e.spacing(1),backgroundColor:"#0275d8",borderColor:"#0267bf",textTransform:"none",color:"white","&:hover":{backgroundColor:"#025aa5",borderColor:"#014682",color:"white"}},dialogContent:{display:"flex",alignItems:"flex-end"},MuiAutocompleteRoot:{width:"250px",marginRight:"10px"}}}));function Hd(e){var t=e.element,n=e.bpmnModeler,a=Object(r.useState)(!1),c=Object(u.a)(a,2),s=c[0],l=c[1],p=Object(r.useState)(!1),d=Object(u.a)(p,2),b=d[0],h=d[1],v=Object(r.useState)(null),y=Object(u.a)(v,2),g=y[0],j=y[1],x=Object(r.useState)(null),O=Object(u.a)(x,2),w=O[0],E=O[1],N=Object(r.useState)(null),C=Object(u.a)(N,2),S=C[0],_=C[1],k=Object(r.useState)(null),M=Object(u.a)(k,2),P=M[0],T=M[1],R=Object(r.useState)(null),A=Object(u.a)(R,2),F=A[0],B=A[1],D=Object(r.useState)(null),L=Object(u.a)(D,2),I=L[0],V=L[1],$=Gd(),z=function(e,a){n&&n.get("modeling").updateProperties(t,Object(Uc.a)({},e,a))},W=o.a.useCallback((function(e){return t.businessObject[e]}),[t]),G=function(){h(!1)};return Object(r.useEffect)((function(){function e(){return(e=Object(f.a)(m.a.mark((function e(){var t,n,a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=W("expression"),_(t),T(t),t&&B({type:"MANY_TO_MANY"}),n=t&&t.split("?.")&&t.split("?.")[0]){e.next=8;break}return V(null),e.abrupt("return");case 8:return a={criteria:[{fieldName:"name",operator:"like",value:n}],operator:"and"},e.next=11,Ep(a);case 11:i=e.sent,V(i&&i[0]);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[W]),Object(i.jsxs)("div",{className:$.expressionBuilder,children:[Object(i.jsx)(Fu,{element:t,className:$.textbox,bpmnModeler:n,entry:{id:"expression",label:ku("Expression"),modelProperty:"expression",name:"expression",get:function(){return{expression:(W("expression")||"").replace(/[\u200B-\u200D\uFEFF]/g,"")}},set:function(e,t){t.expression&&""!==t.expression||(_(null),V(null),T(null)),z("expression",""===t.expression?void 0:t.expression)}}}),Object(i.jsxs)("div",{className:$.new,children:[Object(i.jsx)(Wc.a,{className:$.newIcon,onClick:function(){h(!0)}}),b&&Object(i.jsxs)(Fc.a,{open:b,onClose:function(e,t){"backdropClick"!==t&&G()},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",classes:{paper:$.dialog},children:[Object(i.jsx)(Bc.a,{id:"alert-dialog-title",children:ku("Expression")}),Object(i.jsxs)(Dc.a,{className:$.dialogContent,children:[Object(i.jsx)(gp,{name:"model",title:"Model",placeholder:"Model",fetchAPI:function(){return Ep()},onChange:function(e){e||T(null),V(e)},optionLabelKey:"name",value:I,classes:{root:$.MuiAutocompleteRoot}}),I&&Object(i.jsx)(Gp,{getMetaFields:function(){return function(e){return wp.apply(this,arguments)}(I?{fullName:I.fullName,name:I.name,type:I.type}:void 0)},isCollection:!0,onChange:function(e,t){T(e&&""!==e?"".concat(I&&function(e){if(e)return e.charAt(0).toLowerCase()+e.slice(1)}(I.name),"?.").concat(e):null),B(t)},value:{fieldName:P&&P.split("?.")&&P.split("?.")[1]},isParent:!0})]}),Object(i.jsxs)(Ic.a,{children:[Object(i.jsx)(Vc.a,{onClick:function(){if(!["MANY_TO_MANY","ONE_TO_MANY"].includes(F&&F.type&&F.type.toUpperCase())&&I)return E("Last field selected  must be of O2M or M2M type"),void l(!0);_(P),z("expression",P),G()},color:"primary",autoFocus:!0,className:$.save,children:"OK"}),Object(i.jsx)(Vc.a,{onClick:function(){T(S),G()},color:"primary",className:$.save,children:"Cancel"})]})]}),s&&Object(i.jsxs)(Fc.a,{open:s,onClose:function(e,t){"backdropClick"!==t&&l(!1)},"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",classes:{paper:$.dialog},children:[Object(i.jsx)(Bc.a,{id:"alert-dialog-title",children:Object(i.jsx)("label",{className:$.title,children:ku(g)})}),Object(i.jsx)(Dc.a,{children:Object(i.jsx)(Lc.a,{id:"alert-dialog-description",children:ku(w)})}),Object(i.jsxs)(Ic.a,{children:[Object(i.jsx)(Vc.a,{onClick:function(){l(!1),E(null),j(null)},color:"primary",className:$.save,autoFocus:!0,children:"Ok"}),Object(i.jsx)(Vc.a,{onClick:function(){l(!1)},color:"primary",className:$.save,children:"Cancel"})]})]})]})]})}function Ud(e){return e&&e.businessObject||e}function Kd(e,t){var n=Ud(e);return n&&"function"===typeof n.$instanceOf&&n.$instanceOf(t)}var qd=Object($c.a)({groupLabel:{fontWeight:"bolder",display:"inline-block",verticalAlign:"middle",color:"#666",fontSize:"120%",margin:"10px 0px",transition:"margin 0.218s linear",fontStyle:"italic"},divider:{marginTop:15,borderTop:"1px dotted #ccc"}}),Jd="bpmn:Parameter";function Yd(e,t){return e&&function(e,t){var n=function(e){return e.get("values")}(e);if("undefined"!==typeof n){var a=n.filter((function(e){return Kd(e,t)}));if(a.length)return a}}(e,t)||[]}function Xd(e){var t,n=e.element,a=e.index,c=e.label,s=e.bpmnFactory,l=Object(r.useState)(null),p=Object(u.a)(l,2),d=p[0],m=p[1],f=Object(r.useState)(null),b=Object(u.a)(f,2),h=b[0],v=b[1],y=qd(),g=o.a.useCallback((function(){var e=Ud(n);return Kd(n,"bpmn:Participant")&&(e=e.get("processRef")),e}),[n]),j=o.a.useCallback((function(){var e=Yd(g(),"bpmn:Parameter");return e[d]||e&&e[0]}),[g,d]),x=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Ud(e),a=Yd(n,Jd),i=a&&a.map((function(e,t){return{id:t,text:e.id}}));v(i),t&&i.length>0&&m(i[0])};return Object(r.useEffect)((function(){x(n,!0)}),[n]),Object(i.jsxs)("div",{children:[Object(i.jsx)(o.a.Fragment,{children:a>0&&Object(i.jsx)("div",{className:y.divider})}),Object(i.jsx)("div",{className:y.groupLabel,children:c}),!!(Kd(n,"bpmn:FlowElement")||Kd(n,"bpmn:Process")||Kd(n,"bpmn:Participant"))&&!!g()&&Object(i.jsx)(Hu,{element:n,options:h,entry:{id:"parameter",label:ku("Parameter"),modelProperty:"name",idGeneration:"false",reference:"processRef",createExtensionElement:function(e,t){return function(n,a,i){var r=(new _.a).next(),o="parameter_".concat(r),c=function(e,t,n,a){var i=a.create(e,t);return i.$parent=n,i}(t,{id:o},a,s);return Ud(e).values?e.businessObject.values.push(c):e.businessObject.values=[c],c}}(n,Jd),removeExtensionElement:(t=Jd,function(e){var a,i=Ud(n),r=i&&i.values;r&&r.forEach((function(n,r){n.$type===t&&(a>-1?a++:a=0),a!==Number(e)||i.values.splice(r,1)})),x(n),r&&!r.find((function(e){return e.$type===t}))?t===Jd&&m(null):m(null)}),onSelectionChange:function(e){m(e)},setOptionLabelValue:function(e){var t=g();return function(n){var a=Yd(t,e)[n];return a?a.id:""}}(Jd)}}),(d||0===d)&&Object(i.jsxs)(o.a.Fragment,{children:[Object(i.jsx)(Du,{element:n,canRemove:!0,entry:{id:"target",label:ku("Target"),modelProperty:"target",get:function(){var e=j();if(e)return{target:e.target}},set:function(e,t){var n=j();n&&(n.target=t.target)}}}),Object(i.jsx)(Du,{element:n,canRemove:!0,entry:{id:"expression",label:ku("Expression"),modelProperty:"expression",get:function(){var e=j();if(e)return{expression:e.expression}},set:function(e,t){var n=j();n&&(n.expression=t.expression)}}})]})]})}var Qd=[{type:"bpmn:Process-action",properties:[{name:"name",label:"Name",widget:"textBox"},{name:"targetModel",isAttr:!0,type:"String",label:"Target model",widget:"many-to-one",fetchMethod:function(){return $p()}},{name:"sourceModel",isAttr:!0,type:"String",label:"Source model",widget:"many-to-one",fetchMethod:function(){return $p()}}]},{type:"bpmn:Query",properties:[{name:"name",label:"Name",widget:"textBox"},{name:"target",label:"Var",widget:"textField"},{name:"extendedQueryProperties",label:"",widget:"extendedQueryProperties"},{name:"returnType",label:"Return type",widget:"selectBox",emptyParameter:!0,selectOptions:[{name:"Map",value:"MAP"},{name:"Single",value:"SINGLE"},{name:"Multiple",value:"MULTIPLE"}]}]},{type:"bpmn:Conditional",properties:[{name:"name",label:"Name",widget:"textBox"},{name:"expression",label:"Expression",widget:"expressionBuilder"}]},{type:"bpmn:Loop",properties:[{name:"name",label:"Name",widget:"textBox"},{name:"target",label:"Variable",widget:"textField"},{name:"expression",label:"Expression",widget:"fieldBuilder"}]},{type:"bpmn:Function",properties:[{name:"name",label:"Name",widget:"textBox"},{name:"functionName",label:"Function Name",widget:"textBox"},{name:"returnType",label:"Return type",widget:"selectBox",emptyParameter:!0,selectOptions:[{name:"Map",value:"MAP"},{name:"Single",value:"SINGLE"},{name:"Multiple",value:"MULTIPLE"}]},{name:"parameter",label:"Parameter",widget:"parameterTable"}]},{type:"bpmn:Mapper",properties:[{name:"name",label:"Name",widget:"textBox"},{name:"script",label:"Script",widget:"scriptBox"}]},{type:"label",properties:[{name:"name",label:"Name",widget:"textBox"}]},{type:"bpmn:SequenceFlow",properties:[{name:"name",label:"Name",widget:"textBox"}]}],Zd=n(376),em=n(377),tm=n(378),nm=n(379),am=n(380),im=(n(290),n(291),n(292),{display:"flex",alignItems:"center",justifyContent:"center",borderLeft:"solid 1px #ddd",background:"#f0f0f0"}),rm=Object($c.a)((function(){return{drawer:{width:om,flexShrink:0},drawerPaper:{background:"#F8F8F8",width:"100%",position:"absolute",borderLeft:"1px solid #ccc",overflow:"auto",height:"100%",textAlign:"left"},drawerContainer:{padding:10,height:"100%"},nodeTitle:{fontSize:"120%",fontWeight:"bolder"},propertyLable:{fontSize:13,fontWeight:"bolder",margin:"10px 0px"},icon:{color:"black",width:"1.2em",height:"1.2em"},btnContainer:{border:"1px solid #dcdc",background:"#F8F8F8"},iconButton:{padding:"5px 15px"}}})),om=380,cm='<?xml version="1.0" encoding="UTF-8" ?>\n<process-actions \n  xmlns:xs="http://www.w3.org/2001/XMLSchema-instance" \n  xs:schemaLocation="http://www.omg.org/spec/BPMN/20100524/MODEL BPMN20.xsd"\n  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n  xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" \n  xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" \n  xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" \n  xmlns:di="http://www.omg.org/spec/DD/20100524/DI" \n  id="sample-diagram" targetNamespace="http://bpmn.io/schema/bpmn">\n  <process-action id="ProcessAction_1">\n  </process-action>\n  <bpmndi:BPMNDiagram id="BPMNDiagram_1">\n    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">\n    </bpmndi:BPMNPlane>\n  </bpmndi:BPMNDiagram>\n</process-actions>',sm=function(e,t,n){return n.filter((function(n){return n.element&&n.element.incoming&&0===n.element.incoming.length&&(n.element.parent&&n.element.parent.type)===e&&!["bpmn:Process-action","bpmn:SequenceFlow","bpmn:TextAnnotation","label"].concat(Object(p.a)(t)).includes(n.element.type)}))},lm=function(e,t,n){if(e)return e.forEach((function(e){var a=e.element&&e.element.businessObject;if(e.element&&("bpmn:Loop"===e.element.type||"bpmn:Conditional"===e.element.type)){var i=um(e.element&&e.element.businessObject,e.element.type);a=i||a}t.push(a);var r=n.find((function(t){return t.sourceRef.id===(e.element&&e.element.id)}));if(r){var o=r.targetRef,c=o;if("bpmn:Loop"===o.type||"bpmn:Loop"===o.$type||"bpmn:Conditional"===o.type||"bpmn:Conditional"===o.$type){var s=um(o,o.type||o.$type);c=s||c}t.push(c),t.push(r);var l=pm(t,n,o);t=l||t}})),t},um=function(e,t){if(e){var n=e.flowElements;if(n){var a=n.filter((function(e){return"bpmn:SequenceFlow"===(e.type||e.$type||e.element&&e.element.type)})),i=n.map((function(e){return e.id})),r=fm.get("elementRegistry"),o=r&&r._elements,c=(Object.values(o)||[]).filter((function(e){return i.includes(e.element&&e.element.id)})),s=sm(t,[t],c),l=lm(s,[],a);return e.flowElements=l,e}}},pm=function e(t,n,a){var i=n.find((function(e){return(e.sourceRef&&e.sourceRef.id||e.element.businessObject.sourceRef.id)===a.id}));if(!i)return t;var r=i.targetRef||i.element.businessObject.targetRef,o=r;if("bpmn:Loop"===r.type||"bpmn:Loop"===r.$type||"bpmn:Conditional"===r.type||"bpmn:Conditional"===r.$type){var c=um(r,r.type||r.$type);o=c||o}t.push(o),t.push(i.element&&i.element.businessObject||i),e(t,n,r)},dm=function(){var e=fm.get("elementRegistry"),t=e&&e._elements,n=Object.values(t)||[],a=[];if(n&&0!==n.length){var i=n&&n.filter((function(e){return"bpmn:SequenceFlow"===(e.element&&e.element.type)}));if(a=function(e,t,n){if(e)return e.forEach((function(e){var a=e.element&&e.element.businessObject;!e.element||"bpmn:Loop"!==e.element.type&&"bpmn:Conditional"!==e.element.type||(a=um(e.element&&e.element.businessObject,e.element.type)||a);t.push(a);var i=n.find((function(t){return(t.element&&t.element.businessObject&&t.element.businessObject.sourceRef&&t.element.businessObject.sourceRef.id)===(e.element&&e.element.id)}));if(i){var r=i.element&&i.element.businessObject&&i.element.businessObject.targetRef,o=r;if("bpmn:Loop"===r.type||"bpmn:Loop"===r.$type||"bpmn:Conditional"===r.type||"bpmn:Conditional"===r.$type)o=um(r,r.type||r.$type)||o;t.push(o),t.push(i.element&&i.element.businessObject);var c=pm(t,n,r);t=c||t}})),t}(sm("bpmn:Process-action",[],n),a,i)){var r=fm.get("canvas");r.zoom("fit-viewport"),r.getRootElement().businessObject.flowElements=a}}},mm=function(){document.getElementById("inputFile").click()},fm=null;var bm=function(){var e=Object(r.useState)(om),t=Object(u.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)("100%"),s=Object(u.a)(c,2),p=s[0],d=s[1],O=Object(r.useState)(!0),w=Object(u.a)(O,2),E=w[0],C=w[1],S=Object(r.useState)(null),_=Object(u.a)(S,2),k=_[0],M=_[1],P=Object(r.useState)(null),T=Object(u.a)(P,2),R=T[0],A=T[1],F=Object(r.useState)({open:!1,messageType:null,message:null}),B=Object(u.a)(F,2),D=B[0],L=B[1],I=rm(),V=function(e){document.documentElement.style.setProperty("--bpmn-container-width","".concat(e,"px")),C("0px"!==e)},$=function(){var e=Object(f.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:dm(),fm.saveXML({format:!0},function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a,i,r,o,c,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.add("com.axelor.apps.bpm.db.BamlModel",Object(l.a)(Object(l.a)({},R),{},{bamlXml:n}));case 2:if(!((a=e.sent)&&a.data&&a.data[0])){e.next=18;break}if(i=a.data[0]){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,N.action({model:"com.axelor.apps.bpm.db.BamlModel",action:"action-baml-model-method-generate-code",data:{context:Object(l.a)({},i||{})}});case 9:if((r=e.sent)&&-1!==r.status){e.next=12;break}return e.abrupt("return");case 12:return o=r.data,c=o[0]&&o[0].values&&o[0].values.resultScript,e.next=16,N.add("com.axelor.apps.bpm.db.BamlModel",Object(l.a)(Object(l.a)({},i),{},{resultScript:c}));case 16:(s=e.sent)&&s.data&&s.data[0]?(A(Object(l.a)({},s.data[0])),q("success","Operation successful")):q("error",s&&s.data&&(s.data.message||s.data.title)||"Error!");case 18:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(e,t){"clickaway"!==t&&L({open:!1,messageType:null,message:null})},W=[{name:"Save",icon:Object(i.jsx)(Zd.a,{className:I.icon}),tooltipText:"Save",onClick:function(){dm(),fm.saveXML({format:!0},function(){var e=Object(f.a)(m.a.mark((function e(t,n){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.add("com.axelor.apps.bpm.db.BamlModel",Object(l.a)(Object(l.a)({},R),{},{bamlXml:n}));case 2:(a=e.sent)&&a.data&&a.data[0]?(A(Object(l.a)({},a.data[0])),q("success","Saved Successfully")):q("error",a&&a.data&&(a.data.message||a.data.title)||"Error!");case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}},{name:"Image",icon:Object(i.jsx)(em.a,{className:I.icon}),tooltipText:"Download SVG",onClick:function(){fm.saveSVG({format:!0},function(){var e=Object(f.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Nu(n,"diagram.svg");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}},{name:"DownloadXml",icon:Object(i.jsx)(tm.a,{className:I.icon}),tooltipText:"Download",onClick:function(){return e=fm,dm(),void e.saveXML({format:!0},function(){var e=Object(f.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Nu(n,"diagram.baml");case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());var e}},{name:"UploadXml",icon:Object(i.jsx)(nm.a,{className:I.icon}),tooltipText:"Upload",onClick:mm},{name:"GenerateCode",icon:Object(i.jsx)(am.a,{className:I.icon}),tooltipText:"Generate Code",onClick:$}],G=function(e){e&&fm.importXML(e,(function(e){if(e)return console.error("could not import BPMN 2.0 diagram",e);var t=fm.get("canvas");t.zoom("fit-viewport");var n=t.getRootElement();M(n)}))},H=o.a.useCallback(function(){var e=Object(f.a)(m.a.mark((function e(t){var n,a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=10;break}return e.next=3,N.fetchId("com.axelor.apps.bpm.db.BamlModel",t,{fields:["bamlXml","name","resultScript"]});case 3:n=e.sent,a=n&&n.data&&n.data[0]||{},i=a.bamlXml,A(a),G(i||cm),e.next=11;break;case 10:G(cm);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]),U=function(e){var t=e.target.files,n=new FileReader;t&&t[0]&&t[0].name&&!t[0].name.includes(".baml")||(n.readAsText(t[0]),n.onload=function(e){G(e.target.result)})},K=function(e){if(e||!e.widget)switch(e.widget){case"textField":return Object(i.jsx)(Du,{entry:e,bpmnModeler:fm,element:k,canRemove:!0});case"textBox":return Object(i.jsx)(Fu,{entry:e,bpmnModeler:fm,element:k});case"selectBox":return Object(i.jsx)(Iu,{entry:e,element:k,bpmnModeler:fm});case"checkbox":return Object(i.jsx)($u,{entry:e,element:k});case"many-to-one":return Object(i.jsx)(Wu,{entry:e,element:k,bpmnModeler:fm});case"scriptBox":return Object(i.jsx)(Kp,{entry:e,element:k,bpmnModeler:fm,bpmnFactory:fm&&fm.get("bpmnFactory")});case"parameterTable":return Object(i.jsx)(Xd,{entry:e,element:k,bpmnModeler:fm,bpmnFactory:fm&&fm.get("bpmnFactory")});case"extendedQueryProperties":return Object(i.jsx)($d,{entry:e,element:k,bpmnModeler:fm});case"expressionBuilder":return Object(i.jsx)(Wd,{entry:e,element:k,bpmnModeler:fm});case"fieldBuilder":return Object(i.jsx)(Hd,{entry:e,element:k,bpmnModeler:fm});default:return Object(i.jsx)(Fu,{entry:e,element:k,bpmnModeler:fm})}},q=function(e,t){L({open:!0,messageType:e,message:t})};return Object(r.useEffect)((function(){fm=new _c({container:"#bpmnview",keyboard:{bindTo:document},additionalModules:[Ac]});var e=function(){for(var e,t=/[?&]id=([^&#]*)/g,n=window.location.href;e=t.exec(n);)return e[1]}();H(e)}),[H]),Object(r.useEffect)((function(){fm&&(fm.on("element.click",(function(e){M(e.element)})),fm.on("shape.changed",(function(e){M(e.element)})),fm.on("shape.removed",(function(){var e=fm.get("elementRegistry"),t=fm.getDefinitions(),n=t&&t.rootElements&&t.rootElements[0];if(n){var a=e.get(n.id);a&&M(a)}})))}),[]),Object(i.jsxs)("div",{id:"container",children:[Object(i.jsxs)("div",{id:"bpmncontainer",children:[Object(i.jsx)("div",{id:"propview"}),Object(i.jsx)("div",{id:"bpmnview",children:Object(i.jsx)("div",{className:"toolbar-buttons",children:W.map((function(e){return Object(i.jsxs)("div",{className:I.btnContainer,children:["UploadXml"===e.name&&Object(i.jsx)("input",{id:"inputFile",type:"file",name:"file",onChange:U,style:{display:"none"}}),Object(i.jsx)(h.a,{title:e.tooltipText,children:Object(i.jsx)(v.a,{fontSize:"large",onClick:e.onClick,className:I.iconButton,children:e.icon})})]},e.name)}))})})]}),Object(i.jsxs)("div",{children:[Object(i.jsx)("div",{className:"bpmn-property-toggle",onClick:function(){a((function(e){return 0===e?380:0})),V(0===n?380:0)},children:"Properties Panel"}),Object(i.jsx)(x.a,{style:im,size:{width:n,height:p},onResizeStop:function(e,t,i,r){a((function(e){return e+r.width})),d(p+r.height),V(n+r.width)},maxWidth:window.innerWidth-150,children:Object(i.jsx)(y.a,{variant:"persistent",anchor:"right",open:E,style:{width:om},classes:{paper:I.drawerPaper},id:"drawer",children:Object(i.jsxs)("div",{className:I.drawerContainer,children:[Object(i.jsx)(g.a,{className:I.nodeTitle,children:k&&k.id}),Object(i.jsx)(g.a,{className:I.propertyLable,children:"Properties"}),function(){var e=Qd.find((function(e){return e.type===(k&&k.type)}));return e?e.properties?e.properties:void 0:[]}().map((function(e,t){return Object(i.jsx)("div",{children:K(e)},t)}))]})})})]}),D.open&&Object(i.jsx)(j.a,{open:D.open,autoHideDuration:2e3,onClose:z,children:Object(i.jsx)(b.a,{elevation:6,variant:"filled",onClose:z,className:"snackbarAlert",severity:D.messageType,children:D.message})})]})};var hm=function(){return Object(i.jsx)("div",{className:"App",children:Object(i.jsx)(bm,{})})};n(293);s.a.render(Object(i.jsx)(hm,{}),document.getElementById("root"))}},[[294,1,2]]]);
//# sourceMappingURL=main.48b7d26c.chunk.js.map