<?xml version="1.0" encoding="UTF-8"?>
<domain-models xmlns="http://axelor.com/xml/ns/domain-models"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/domain-models http://axelor.com/xml/ns/domain-models/domain-models_7.4.xsd">

  <module name="studio" package="com.axelor.studio.db"/>

  <entity name="AppBudget" cacheable="true">

    <one-to-one ref="com.axelor.studio.db.App" name="app" unique="true"/>

    <boolean name="checkAvailableBudget" title="Check Available Budget"
      help="If this option is enabled, when linking a purchase order or purchase order line to a budget, the system automatically checks that based on the total planned budget amount there is still available budget and that everything has not yet been committed, or that the order will not exceed the planned amount. The user is alerted in case of overrun."/>
    <boolean name="manageMultiBudget" title="Manage multi budgets on lines"
      help="If enabled, this configuration allows at the purchase order line level to distribute the amount across multiple budgets."/>
    <integer name="missingBudgetCheckSelect" title="Missing budget alert" default="0"
      selection="app.budget.check.missing.select"
      help="Depending on the level chosen, the user will receive no alert (None), a warning message (Optional) or will be required to fill in the budget information to continue the process (Required)."/>
    <integer name="orderBudgetExceedSelect" title="Budget exceed alert for orders"
      default="0" selection="app.budget.check.exceed.order.select"
      help="Depending on the level chosen, the user will receive no alert (None), a warning message (Optional) or an error (Required) if one of the budgets exceeds the available amount."/>

    <extra-code>
      <![CDATA[
      //error check select
        public static final int APP_BUDGET_MISSING_CHECK_SELECT_NO = 0;
        public static final int APP_BUDGET_MISSING_CHECK_SELECT_OPTIONAL = 1;
        public static final int APP_BUDGET_MISSING_CHECK_SELECT_REQUIRED = 2;

        //exceed error in orders select
        public static final int APP_BUDGET_EXCEED_ORDERS_SELECT_NO = 0;
        public static final int APP_BUDGET_EXCEED_ORDERS_SELECT_OPTIONAL = 1;
        public static final int APP_BUDGET_EXCEED_ORDERS_SELECT_REQUIRED = 2;
		]]>
    </extra-code>

    <track>
      <field name="checkAvailableBudget" on="UPDATE"/>
      <field name="manageMultiBudget" on="UPDATE"/>
      <field name="missingBudgetCheckSelect" on="UPDATE"/>
      <field name="orderBudgetExceedSelect" on="UPDATE"/>
    </track>
  </entity>
</domain-models>
