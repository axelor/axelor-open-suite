"name";"reportTypeSelect";"queryTypeSelect";"rowFields";"aggregatelist";"query"
"Gestion budg√©taire - consultation analytique";"0";"1";"budget_global,budget_groupe,budget_section,budget_budget,details";"initial|disponible|engage|realise_sans_engagement|realise_avec_engagement";"SELECT bglobal.code as budget_global,
bgroupe.code as budget_groupe,
bsection.code as budget_section,
budget.code as budget_budget,
CONCAT((SELECT string_agg(account.code,',')
FROM account_budget budget1 
LEFT JOIN budget_budget_level bsection ON budget1.budget_level = bsection.id
LEFT JOIN budget_budget_level bgroupe ON bsection.parent_budget_level = bgroupe.id
LEFT JOIN budget_budget_level bglobal1 ON bgroupe.parent_budget_level = bglobal1.id
LEFT JOIN account_budget_account_set accounts ON budget1.id = accounts.account_budget
LEFT JOIN account_account account ON accounts.account_set = account.id
WHERE bglobal1.code = bglobal.code AND budget1.code = budget.code 
GROUP BY budget1.code),' - ',(SELECT string_agg(CONCAT(axis.code,' ',ROUND(distribution.percentage,0),'%:',analyticaccount.code),'|') as analytic
FROM account_budget budget1 
LEFT JOIN budget_budget_level bsection ON budget1.budget_level = bsection.id
LEFT JOIN budget_budget_level bgroupe ON bsection.parent_budget_level = bgroupe.id
LEFT JOIN budget_budget_level bglobal1 ON bgroupe.parent_budget_level = bglobal1.id
LEFT JOIN account_analytic_distribution_line distribution ON budget1.id = distribution.budget
LEFT JOIN account_analytic_axis axis ON distribution.analytic_axis = axis.id
LEFT JOIN account_analytic_account analyticaccount ON distribution.analytic_account = analyticaccount.id
WHERE bglobal1.code = bglobal.code AND budget1.code = budget.code 
GROUP BY budget1.code)) as details,
budget.total_amount_expected as initial,
budget.total_amount_committed as engage,
budget.realized_with_no_po as realise_sans_engagement,
budget.realized_with_po as realise_avec_engagement,
budget.available_amount as disponible,
budget.total_firm_gap as ecart,
budget.simulated_amount as simule,
budget.total_amount_realized as realise,
budget.total_amount_paid as paye
FROM account_budget budget 
LEFT JOIN budget_budget_level bsection ON budget.budget_level = bsection.id
LEFT JOIN budget_budget_level bgroupe ON bsection.parent_budget_level = bgroupe.id
LEFT JOIN budget_budget_level bglobal ON bgroupe.parent_budget_level = bglobal.id
WHERE budget.budget_key is not null
AND bglobal.status_select = 'valid'
AND bgroupe.status_select = 'valid'
AND bsection.status_select = 'valid'"