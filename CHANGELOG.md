## [6.2.0] (2022-05-11)

#### Features

* Account: Add financial discount feature.

The objective of this feature is to be able to manage financial discount. Financial discount has an impact on accounting (contrary to already existing commercial discount).
A financial discount can be created in Accounting/Configuration/Financial Discount and then set on the partner. On the invoice, the financial discount is selected and applied during the payment.

* Account: Add fiscal Position on purchase orders, sale orders and invoices.

* Account: Improve company tax number management.

Tax numbers can be configured for a company with a fiscal position. The correct tax number will be selected for sale and purchase orders according to fiscal position, and can be used for exports.

* Account: Add new status 'simulated' for move.

This is a new option that can be activated in accounting config. Simulated move will not be accounted, but can be used in accounting reports.

* Accounting: FEC import, fix the existing and add import FEC Type.

Fec import types can be configured form a csv file to choose separator, special fields and check moves.
Can now set a move description, company in fec import and a option to validate a move on import.
Also two panels have been added to see the generated move and generated anomalies.

* Analytic Accounting: Revamping analytic accounting for higher flexibility.

New panel to specify a default configuration that can be used in the movelines and billing lines. 
In the analytical axis, you can now select up to 10 groupings, and configure the values of the groupings for a more precise accounting management.

* Bank statement: automatic accounting of statements and automatic generation of moves related to these statements.

Moves based on the statement rules and query can be generated automatically. This feature must be activated from the bank payment application. 

* Bank statement line: Add ODS and xlsx export options for bank statement line.

New export option on bank statement line. ODS and xlsx export are available for bank statement line export.

* Purchase Order: Add advance payment feature.

The objective of this feature is to be able to manage advance payment. As it has already been done for sale order, it is now possible to make an advance payment for a purchase order. An advance payment can be invoiced on a purchase order.

* Sale Quotation: Selected lines in a sale quotation can be split into a new quotation.

* Complementary Product: Add generation type for partner complementary products.

Now complementary products can be configured on partner. Then it will be generated for every sales orders or sale order lines.

* Pricing: new engine on Sale.

Pricing is a new tool that allows you to define sales order lines' fields according to classification rules and result rules defined by groovy formulas.

* Project and Task: Main new features and changes in the project module.

The project module has been modified to provide more flexibility in the configuration of projects and tasks. It is now possible to customize the characteristics of a project and its tasks to display only what is necessary.
Project phases have been replaced by sub-projects.
An activity feed has also been added to track all the activities of a project.
A new "Current project" menu has been added to display only the data and activities of the user's current projects.

* Email Template: New button to test template.

* Partner: Add automatic blocking on customers.

Partners with late payments can now be blocked automatically by a batch.
In the configuration by company of the accounting application, in the tab "Receivables recovery", it is now possible to activate the blocking of customers with late payments.
It is possible to configure the number of days before the blocking. A respite can be configured on the debt recovery. 
When a partner is up to date on this payment, it is automatically unblocked. 
It the user is manually block, it will not be unblocked by the script.

* Processes that take too long now run in the background.

A process that exceeds the timeout configured in the base application continues in background. The user is notified when the process goes into background and when it is finished.
Implemented for MRP, closing period process, and all batches.

#### Changes

* Invoicing Project: update project invoicing batch with automatic invoicing.

Timesheet lines and tasks can be selected automatically to invoice following the configuration in app business project. For example, only tasks with configured status will be invoiced.

* Production: Timing of implementation on Work center.

Implementation time can be determined in absolute value or by script for the work center, in prod process line and prod process line configurators.

* Configurator: Add studio customs fields support.

* Configurator: Add workshop.

A workshop can be assigned to the elements (routing and BOM) generated by the configurator. The workshop can be defined by a script.

* Configurator: Manage consumed products on phase.

Add a new configurator "Configurator Prod Product" to manage consumed products on phases.
Configurators Prod Product can be added to Configurators Prod Process Line if Configurator Prod Process manage consumed products on phases.

* Configurator: Add access to parent sale order in configurator formula.

In a configurator script to fill a product (or sale order line) field, the variable `parentSaleOrderLine` can now be used to get the id of the sale order being updated.

* Configurator:
    - Prod Process Line: Add work center group
    - Prod Process Line: Add a use condition field
    - Prod Process Line: Allow to manage outsourcing depending on App Production config
    - Prod Process Line: Allow to define name, priority, stock location, description and work center with a formula
    - Prod Process: Allow to define name with a formula

* Sale Order Line and Manufacturing Order: New comment for the manufacturing order on the sale order line.

New comment can be added on the command line to be displayed when the manufacturing order is planned or started.

* Stock location: Add barcode.

Add barcode generation process to stock location:
Add related settings field for barcode generation on App Stock. Rename tracking number barcode fields in order to have a clear difference.

* Tracking number: Add barcode.

Barcodes are available for tracking numbers. Barcodes can be activated on tracking numbers from the Stock application.
It is possible to specify a barcode type for all tracking numbers or per tracking number.

* Manufacturing order: Add barcode.

Barcode is displayed in manufacturing order's reports.

* Purchase order: Reports.

Reports generated from a purchase order now display specific notes based on the purchase's lines' tax equivalences. The tax equivalences are determined from the fiscal position of the order. This behaviour was already present on sale orders and invoices and is now also available for purchase orders.

* Production: Add stock location on S&OP (PIC in french).

* Account: Employees can now be selected as compatible partner in the journal configuration.

* Traceback: Add printing option on traceback.

* MRP: Take in account subcategories.

MRP can be configured to take into account subcategories.

* DataBackup: Allow to create backup file even if no record exists.

Data backup can create a backup file even if no record exists by selecting "Generate csv file for empty tables".

* APP mobile - Stock: Add 'Inventory status select'.

Inventory status can be selected to filter which inventories must take into account in the stock mobile app.

* Inventory: Add option to include sub stock location.

* Product: Check expiration date on stock move realization.

* Mass update: Enable mass update on some fields of MetaMenu,MetaView and MetaAction.

* Sale order: Add new field to mark order as a one-off sale.

One-off sales can be excluded from MRP computation.

* Move: add a control to check if the currency is filled on the accounting move.

* Sale Order: add last reminder date and comments to sale order.

* Accounting Report: Manage subsidiary account by type for export journal entry.

* Declaration Of Exchanges: Adjustment to follow the changes in legislation (2022).

Add country origin code in the outgoing move filled with the country alpha2 code from adress linked to the original stock location of the stock move in the stock move lines.

* Invoice: Add payment delay reason.

Add payment delay reason in the accounting panel of the Invoice. This payment delay reason can be configured in Accounting > Debt recovery > Configuration > Payment delay reason.

* Printing Setting: The position of the address can be changed in the printing (right or left).

* Manufacturing Order: New tree view for multi-level planning.

* Bank Details: Add color indication on grid view.

If the balance updated date has a delai of 3 to 7 days, the field is in orange. If it's more than 7, it's in red.
If the balance is equal to 0, the field is in orange. If it's lower than 0, it's in red.

* Employee: Add Training Skill.

Training skills can be add to an employee to manage his skills.

* Move: New date of reversion entry for reverse move.

The reversion date can now be set for the next day during generating a reverse move.

* Studio: Add canSearch and height attribute to dashlet builder.

* Tracking Number Configuration: add a dashlet to show the concerned products.

* Project task: new editor.

* Purchase Order Line: Add tracking on desired and estimated delivery date.

* Purchase Order: Add tracking on delivery date.

* Partner: Add tags of Customer, Supplier, Subcontractor and others on card view.

* Account: Manage Partners DAS2 Activity and Accounts Service Types.

* Account: Add two new reports which help for DAS2 Fees declaration.

* User Preference: Display the today date in recipe mode.

* Partner: Add Tracking for some fields.

Tack partner category, industry sector, registration code, siren number, main activity, partner address list, fixed phone, email address, in payment mode, out payment mode, payment condition, financial discount, das2 activity, currency, umr activation.

* BankDetails: Add Tracking for some fields.

Tack partner, owner name, label, currency, bank account, journal, iban, bank, bank address, active.

Invoice : Add Tracking for some fields.

Tack pfp validator, pfp validate status, reason of refusal to pay, reason of refusal to pay (str).

* Stock Location: Valued.

The valuation of the stock location is displayed if the stock location is configured as valued instead of depending on the stock location type.

* Indicator generator: Query will now return result as a list of text instead of number.

* Move: fill the origin date from the invoice.

* User: Add update date of password in user-form.

* Stock detail by product: Allow to see stock history when no stock location is selected.

* Stock: New batch to update stock history.

* Stock detail by product : Allow to export result as a csv file.

* App base: Use open street map as the default map API.

* Invoice Printing: Display delivery dates on customer invoices/refunds reports.

* Product: Allow the configuration of a BOM by default per company.

* Product: Add column available quantity on variants panel on product form view.

* ManufOrder: Allowed user to select and discard multi-level planning orders.

* Partner: Add the create and the update date in blocking editor.

* Wap history: Add a new field to show the origin of a wap variation in a stock location line form view.

* Global tracking log line : Add new button that displays the record reference.

* Invoice: interco invoice is now generated after ventilation. Before this change, it was generated after validation.

* Manufacturing order: add buttons to use the reservation feature for consumed products.

* Payment delay reason: New demo data.

* User: change visibility condition of the Passed For Payment panel in user form view.

The panel is now displayed if at least one company in the set of companies is activated for the "Past due for payment" function, instead of using the active company.

* MRP: Add a configuration to choose whether to run the process only on given stock location or on every sub stock locations as well.

* Accounting report: Add order by in general balance with comparative periods report.

* Move line: Avoiding saving or validating a move line if account not allowed

When saving a move line, added a control on accounting account that checks if the account is allowed in the move's journal.

* Accounting Batch: merge existing batches annual accounting into one.

The batch to open annual accounts of the next year and the batch to close annual accounts of the last year are now replaced by a single batch that will do both.

* Invoice: fill more fields on supplier invoice generated from interco feature

When generating a supplier invoice from a customer invoice with interco feature, we now automatically fill origin date and supplier invoice number, and we copy the customer invoice printed PDF into supplier invoice files.

* Account: Improve error message when adding a payment mode that already exists.

* Fiscal position: Handle fiscal position and tax number when merging quotations

* Currency conversion line: Error handling if rates or currency cannot be retrieved.

* Payment voucher: Allow to choose the imputation order

Add sequence in pay voucher due element in order to choose the imputation order when loading lines. 
User can now change imputation order by changing sequence before loading lines.
Sequence can be change by moving line or by editing it.

* Forecast Recap: Display manual forecast reason on recap lines.

Forecast reason was replaced by Forecast recap line type: The name of the
forecast line type is now the reason. This way, the type displayed in recap
will be equal to the reason for manual forecasts.

#### Fixed

* HR: Day Planning - Rename weeklyPlann to weeklyPlanning.

`WRN :` Script need to be launch to upgrade version.

#### Removed

* Territory: Remove object


[6.2.0]: https://github.com/axelor/axelor-open-suite/compare/v6.1.11...v6.2.0
