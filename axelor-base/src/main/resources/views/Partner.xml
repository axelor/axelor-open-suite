<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_7.2.xsd">

  <grid name="partner-grid" title="Partners" model="com.axelor.apps.base.db.Partner"
    orderBy="name">
    <toolbar>
      <button name="printPhoneBookBtn" title="Contact PhoneBook" icon="fa-print"
        onClick="action-print-phonebook"/>
      <button name="printCompanyPhoneBookBtn" title="Company PhoneBook" icon="fa-print"
        onClick="action-print-company-phonebook" if="__config__.app.isApp('employee')"/>
      <button name="checkDuplicateBtn" title="Check Duplicate"
        onClick="action-general-check-duplicate-records"/>
      <button name="replaceDuplicateBtn" title="Merge duplicated"
        onClick="action-validate-select-object-message,action-duplicate-object-wizard-open"/>
      <button name="advancedExportBtn" title="Advanced export"
        onClick="action-method-advanced-export-wizard-view"/>
      <button name="sirenApiBtn" title="Create from Sirene API"
        onClick="action-partner-view-wizard-api-sirene-configuration"/>
    </toolbar>
    <field name="partnerSeq" width="120"/>
    <field name="simpleFullName"/>
    <field name="fixedPhone" widget="phone" x-placeholder-number-type="FIXED_LINE"/>
    <field name="emailAddress.address" title="Email"/>
    <field name="partnerCategory" grid-view="partner-category-grid"
      form-view="partner-category-form"/>
    <field name="fiscalPosition.code" title="Fiscal position"/>
    <field name="registrationCode"/>
    <field name="mainAddress"/>
    <field name="companySet" widget="TagSelect"
      if="__config__.app.getApp('base')?.getEnableMultiCompany()"/>
    <button name="scheduleEventBtn" title="Schedule Event" icon="fa-group"
      onClick="action-partner-view-schedule-event" if-module="axelor-crm"
      if="__config__.app.isApp('crm')"/>
    <button name="sendByEmailBtn" title="Send Email" icon="fa-envelope"
      onClick="action-send-by-email-with-template" if-module="axelor-crm"
      if="__config__.app.isApp('crm')"/>
  </grid>

  <grid name="partner-customer-grid" title="Customers" model="com.axelor.apps.base.db.Partner"
    orderBy="name">
    <menubar>
      <menu name="partnerReportsMenu" title="Reports" icon="fa-files-o" showTitle="true">
        <item name="contactPhoneBookItem" title="Contact PhoneBook"
          action="action-print-phonebook"/>
        <item name="companyPhoneBookItem" title="Company phoneBook"
          action="action-print-company-phonebook" if="__config__.app.isApp('employee')"/>
      </menu>
      <menu name="partnerToolsMenu" title="Tools" icon="fa-wrench" showTitle="true">
        <item name="checkDuplicateItem" title="Check Duplicate"
          action="action-general-check-duplicate-records"/>
        <item name="mergeDuplicatedItem" title="Merge duplicated"
          action="action-validate-select-object-message,action-duplicate-object-wizard-open"/>
      </menu>
    </menubar>
    <field name="partnerSeq" width="120"/>
    <field name="simpleFullName" width="300"/>
    <field name="fixedPhone" widget="phone" x-placeholder-number-type="FIXED_LINE"/>
    <field name="emailAddress.address" placeholder="whatever@example.com" title="Email"/>
    <field name="partnerCategory" grid-view="partner-category-grid"
      form-view="partner-category-form"/>
    <field name="user"/>
    <field name="companySet" widget="TagSelect"
      if="__config__.app.getApp('base')?.getEnableMultiCompany()"/>
    <button name="scheduleEventBtn" title="Schedule Event" icon="fa-group"
      onClick="action-partner-view-schedule-event" if-module="axelor-crm"
      if="__config__.app.isApp('crm')"/>
    <button name="sendByEmailBtn" title="Send Email" icon="fa-envelope"
      onClick="action-send-by-email-with-template" if-module="axelor-crm"
      if="__config__.app.isApp('crm')"/>
  </grid>

  <grid name="partner-supplier-grid" title="Suppliers" model="com.axelor.apps.base.db.Partner"
    orderBy="name">
    <menubar>
      <menu name="partnerReportsMenu" title="Reports" icon="fa-files-o" showTitle="true">
        <item name="contactPhoneBookItem" title="Contact PhoneBook"
          action="action-print-phonebook"/>
        <item name="companyPhoneBookItem" title="Company phoneBook"
          action="action-print-company-phonebook" if="__config__.app.isApp('employee')"/>
      </menu>
      <menu name="partnerToolsMenu" title="Tools" icon="fa-wrench" showTitle="true">
        <item name="checkDuplicateItem" title="Check Duplicate"
          action="action-general-check-duplicate-records"/>
        <item name="mergeDuplicatedItem" title="Merge duplicated"
          action="action-validate-select-object-message,action-duplicate-object-wizard-open"/>
      </menu>
    </menubar>
    <field name="partnerSeq" width="120"/>
    <field name="simpleFullName"/>
    <field name="fixedPhone" widget="phone" x-placeholder-number-type="FIXED_LINE"/>
    <field name="emailAddress.address" placeholder="whatever@example.com" title="Email"/>
    <field name="partnerCategory" grid-view="partner-category-grid"
      form-view="partner-category-form"/>
    <field name="fiscalPosition.code" title="Fiscal position"/>
    <field name="registrationCode"/>
    <field name="mainAddress"/>
    <field name="companySet" widget="TagSelect"
      if="__config__.app.getApp('base')?.getEnableMultiCompany()"/>
    <field name="das2Activity" hidden="true" if="__config__.app.isApp('account')"/>
    <button name="scheduleEventBtn" title="Schedule Event" icon="fa-group"
      onClick="action-partner-view-schedule-event" if-module="axelor-crm"
      if="__config__.app.isApp('crm')"/>
    <button name="sendByEmailBtn" title="Send Email" icon="fa-envelope"
      onClick="action-send-by-email-with-template" if-module="axelor-crm"
      if="__config__.app.isApp('crm')"/>
  </grid>

  <grid name="partner-contact-grid" title="Contacts" model="com.axelor.apps.base.db.Partner">
    <toolbar>
      <button name="checkDuplicateBtn" title="Check Duplicate"
        onClick="action-general-check-duplicate-records"/>
      <button name="replaceDuplicateBtn" title="Merge duplicated"
        onClick="action-validate-select-object-message,action-duplicate-object-wizard-open"/>
    </toolbar>
    <field name="partnerSeq" width="120"/>
    <field name="simpleFullName"/>
    <field name="fixedPhone" widget="phone" x-placeholder-number-type="FIXED_LINE"/>
    <field name="mobilePhone" widget="phone"/>
    <field name="emailAddress.address" placeholder="whatever@example.com" title="Email"/>
    <field name="mainPartner.simpleFullName" title="Main company"/>
    <field name="jobTitleFunction"/>
    <button name="scheduleEventBtn" title="Schedule Event" icon="fa-group"
      onClick="action-contact-partner-view-schedule-event" if-module="axelor-crm"
      if="__config__.app.isApp('crm')"/>
    <button name="sendByEmailBtn" title="Send Email" icon="fa-envelope"
      onClick="action-send-by-email-with-template" if-module="axelor-crm"
      if="__config__.app.isApp('crm')"/>
  </grid>

  <grid name="partner-grid-group" title="Partner" model="com.axelor.apps.base.db.Partner"
    groupBy="user">
    <field name="partnerSeq" width="120"/>
    <field name="simpleFullName"/>
    <field name="fixedPhone" widget="phone" x-placeholder-number-type="FIXED_LINE"/>
    <field name="mobilePhone" widget="phone"/>
    <field name="emailAddress.address" title="Email"/>
    <field name="user" form-view="user-form" grid-view="user-grid"/>
  </grid>

  <form name="partner-customer-form" title="Customer" model="com.axelor.apps.base.db.Partner"
    onNew="action-group-base-partner-onnew"
    onLoad="action-group-partner-onload,action-partner-attrs-hide-customer-recovery"
    onSave="action-partner-validate-partner-stock-settings-list" width="large">
    <panel-include view="partner-form"/>
  </form>

  <form name="partner-supplier-form" title="Supplier" model="com.axelor.apps.base.db.Partner"
    onNew="action-group-base-partner-onnew" onLoad="action-group-partner-onload" width="large">
    <panel-include view="partner-form"/>
  </form>

  <form name="incl-event-actions-partner-form" title="Partner"
    model="com.axelor.apps.base.db.Partner" id="incl-event-actions-base-partner-form">
    <menubar>
      <menu name="partnerToolsMenu" title="Tools" icon="fa-wrench" showTitle="true">
        <item name="sendEmailItem" title="Send email"
          action="save,action-send-by-email-with-template" readonlyIf="id == null"
          if-module="axelor-message"/>
        <item name="sirenApiBtn" title="Fill from Sirene API"
          action="save,action-partner-view-wizard-api-sirene-configuration"/>
      </menu>
    </menubar>
  </form>

  <form name="partner-form" title="Partner" model="com.axelor.apps.base.db.Partner"
    onNew="action-group-base-partner-onnew" onLoad="action-group-partner-onload"
    onSave="action-partner-group-onsave" width="large">
    <toolbar>
      <button name="showMapBtn" title="Map" icon="fa-map-marker"
        onClick="action-partner-method-show-on-map" readonlyIf="!id"/>
    </toolbar>
    <menubar>
      <menu name="partnerReportsMenu" title="Reports" icon="fa-files-o" showTitle="true">
        <item name="customerSituationItem" title="Customer Situation"
          action="save,action-partner-view-customer-situation-filters" readonlyIf="!id"
          showIf="isCustomer" if-module="axelor-account"/>
      </menu>
    </menubar>
    <panel-include view="incl-event-actions-partner-form"/>
    <panel name="mainPanel">
      <panel name="imagePanel" colSpan="2">
        <field name="picture" showTitle="false" widget="Image" colSpan="12">
          <viewer>
            <![CDATA[
            		<>
     					{id && <Image src={$image('id', 'content')} style={{ width: "80%" }}></Image>}
     					{!id && _parent.partnerTypeSelect != 2 && <Image src="img/company-default.jpg" style={{ width: "80%" }}></Image>}
     					{!id && _parent.partnerTypeSelect == 2 && _parent.titleSelect == 1 && <Image src="img/partner-m-default.png" style={{ width: "80%" }}></Image>}
     					{!id && _parent.partnerTypeSelect == 2 && _parent.titleSelect == 2 && <Image src="img/partner-w-default.png" style={{ width: "80%" }}></Image>}
     					{!id && _parent.partnerTypeSelect == 2 && (_parent.titleSelect > 2 || !_parent.titleSelect) && <Image src="img/partner-default.png" style={{ width: "80%" }}></Image>}
					</>
					]]>
          </viewer>
        </field>
        <panel name="socialNetworkPanel" colSpan="12" showIf="fullName != null">
          <label name="googleLabel"
            title="&lt;a class='fa fa-google' href='http://www.google.com' target='_blank' /&gt;"
            colSpan="2"/>
          <label name="facebookLabel"
            title="&lt;a class='fa fa-facebook' href='http://www.facebook.com' target='_blank' /&gt;"
            colSpan="2"/>
          <label name="twitterLabel"
            title="&lt;a class='fa fa-twitter' href='http://www.twitter.com' target='_blank' /&gt;"
            colSpan="2"/>
          <label name="linkedinLabel"
            title="&lt;a class='fa fa-linkedin' href='http://www.linkedin.com' target='_blank' /&gt;"
            colSpan="2"/>
          <label name="youtubeLabel"
            title="&lt;a class='fa fa-youtube' href='http://www.youtube.com' target='_blank' /&gt;"
            colSpan="2"/>
        </panel>
      </panel>
      <panel name="generalInfoPanel" colSpan="10">
        <panel name="partnerInfoPanel" colSpan="12">
          <field name="simpleFullName" colSpan="7" showTitle="false"
            css="label-bold bold large">
            <hilite strong="true" if="true" color="primary"/>
            <editor x-show-titles="false" x-viewer="true">
              <field name="partnerTypeSelect" showTitle="false"
                onChange="action-partner-group-type-select-onchange" colSpan="12"
                placeholder="Partner Type"/>
              <panel name="companyPartnerNamePanel" showIf="partnerTypeSelect == 1"
                colSpan="12">
                <field name="name" showTitle="false" css="highlight" placeholder="Name"
                  onChange="action-group-base-partner-contact-name-onchange" colSpan="12"/>
              </panel>
              <panel name="individualPartnerNamePanel" showIf="partnerTypeSelect == 2"
                colSpan="12">
                <field name="titleSelect" showTitle="false" placeholder="Civility" colSpan="2"/>
                <field name="name" showTitle="false" css="highlight" placeholder="Name"
                  onChange="action-group-base-partner-contact-name-onchange" colSpan="5"/>
                <field name="firstName" showTitle="false" css="highlight"
                  placeholder="First name"
                  onChange="action-group-base-partner-contact-name-onchange" colSpan="5"/>
              </panel>
            </editor>
          </field>
          <field name="partnerSeq" showTitle="false" colSpan="2" css="label-bold bold large"/>
          <button if="__config__.app.isApp('account')" name="$positiveBalanceBtn"
            title="Balance" colSpan="3" icon="balance" onClick="action-partner-view-show-move-lines"
            widget="info-button" showIf="id"/>
          <field name="$balance" hidden="true"/>
          <static name="duplicatePartnerText" hidden="true" colSpan="12">
              <![CDATA[<><Badge bg="warning">There is already a partner with this name.</Badge></>]]>
          </static>
          <field name="fullName" hidden="true"/>
        </panel>
        <field name="$viewerPartnerType" showTitle="false" hideIf="isContact || !$readonly()"
          colSpan="12">
          <viewer
            depends="isProspect,isEmployee,isCustomer,isSupplier,isSubcontractor,isFactor,isCarrier">
            <![CDATA[
						<>
							<Box d="flex" justifyContent="flex-end" gap="4">
								{isProspect && <Badge style={{ backgroundColor: "#FC6355" }}>{_t('Prospect')}</Badge>}
								{isEmployee && <Badge style={{ backgroundColor: "#5680FC" }}>{_t('Employee')}</Badge>}
								{isCustomer && <Badge style={{ backgroundColor: "#EF9D3F" }}>{_t('Customer')}</Badge>}
								{isSupplier && <Badge style={{ backgroundColor: "#7D54FC" }}>{_t('Supplier')}</Badge>}
								{isSubcontractor && <Badge style={{ backgroundColor: "#000080" }}>{_t('Subcontractor')}</Badge>}
								{isFactor && <Badge style={{ backgroundColor: "#54FC62" }}>{_t('Factor')}</Badge>}
								{isCarrier && <Badge style={{ backgroundColor: "#FF0000" }}>{_t('Carrier')}</Badge>}
							</Box>
						</>
                        ]]>
          </viewer>
        </field>
        <field name="isContact" hidden="true" colSpan="12"/>
        <panel name="blockingPanel" hideIf="!$readonly()" colSpan="12">
          <field name="$activeBlockings" showTitle="false" colSpan="12">
            <viewer><![CDATA[
                            <>
	                            <Box d="flex" flexDirection="column" justifyContent="flex-end" alignItems="end">
		                            {blockingList.map((b,index) => {
		                            	const selectMap = {
		                            	'1': _t('Remin._block'),
		                            	'2': _t('Inv._block'),
		                            	'3': _t('Reimb._block'),
		                            	'4': _t('Debit_block'),
		                            	'5': _t('Sale_block'),
		                            	'6': _t('Purch._block'),
		                            };
		                            return (
		                            ($moment(b.blockingToDate) > $moment(today)) &&
		                            	<Badge key={index} bg="danger" mt={2}>
		                            		<Icon icon="ban" fontSize="12px"/>{selectMap[b.blockingSelect]} <Icon icon="caret-right-fill" fontSize="12px"/> {$moment(b.blockingToDate).format('L')}
		                            	</Badge>
		                            );
		                           })}
		                    	</Box>
		                    </>
                        ]]></viewer>
          </field>
        </panel>
        <field name="$customerCantBeRemoved" hidden="true" type="boolean" showIf="false"/>
        <field name="$supplierCantBeRemoved" hidden="true" type="boolean" showIf="false"/>
        <field name="$factorCantBeRemoved" hidden="true" type="boolean" showIf="false"/>
      </panel>
    </panel>
    <panel name="propertiesPanel" title="Properties" canCollapse="true" collapseIf="id"
      hidden="true" showIf="!$readonly()" itemSpan="4">
      <panel name="leftPanel" itemSpan="12">
        <field name="isEmployee" widget="InlineCheckbox"
          hideIf="!_showIsEmployee || partnerTypeSelect != 2 || isCustomer || isSupplier || isCarrier || isFactor || isProspect || isCompensation || isContact || isInternal || isPartner || isSubcontractor"
          onChange="action-partner-account-attrs-hide-employee-account,action-partner-record-unset-factor"/>
        <field name="isProspect" widget="InlineCheckbox"
          hideIf="isContact || isCustomer || isEmployee || isSubcontractor || isInternal || isCarrier || isFactor"
          onChange="action-partner-group-unset-customer,action-partner-record-unset-factor"/>
        <field name="isCustomer" widget="InlineCheckbox" hideIf="isContact ||  isEmployee"
          onChange="action-partner-group-check-can-change-customer,action-partner-record-invoices-copy-default-value,action-partner-account-attrs-hide-customer-account,action-partner-attrs-unset-prospect,action-partner-record-unset-factor"/>
        <field name="isSupplier" widget="InlineCheckbox" hideIf="isContact ||  isEmployee"
          onChange="action-partner-group-check-can-change-supplier,action-partner-account-attrs-hide-supplier-account,action-partner-record-unset-factor"/>
      </panel>
      <panel name="middlePanel" itemSpan="12">
        <field name="isInternal" widget="InlineCheckbox"/>
        <field name="isFactor" widget="InlineCheckbox" hideIf="isContact ||  isEmployee"
          if="__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.manageFactors"
          if-module="axelor-account"
          onChange="action-partner-group-check-can-change-factor,action-partner-record-set-factor"/>
      </panel>
      <panel name="rightPanel" itemSpan="12">
        <field name="isCarrier" widget="InlineCheckbox" hideIf="isContact ||  isEmployee"
          if="__config__.app.isApp('stock')" onChange="action-partner-record-unset-factor"/>
        <field name="isSubcontractor" widget="InlineCheckbox" if-module="axelor-production"
          if="__config__.app.getApp('production')?.getManageOutsourcing()"/>
      </panel>
      <field name="isContact" hidden="true"/>
    </panel>
    <panel-related name="partnerRoleSetPanel" field="partnerRoleSet"
      form-view="partner-role-form" grid-view="partner-role-grid"
      showIf="isContact || partnerTypeSelect == 2" canNew="false"/>
    <panel name="partnerDetailsPanel" title="Partner Details" hideIf="isEmployee" colSpan="12">
      <panel colSpan="6" name="partnerCategoryPanel">
        <field name="partnerCategory" widget="SuggestBox" colSpan="6"
          form-view="partner-category-form" grid-view="partner-category-grid"/>
        <field name="industrySector" colSpan="6" widget="SuggestBox"
          hideIf="partnerTypeSelect== 2"/>

        <field name="source" canEdit="false" colSpan="6" widget="SuggestBox"
          form-view="source-form" grid-view="source-grid"/>
        <field name="department" colSpan="6" hideIf="partnerTypeSelect== 2"/>
        <panel name="functionPanel" colSpan="12" showIf="isContact || partnerTypeSelect == 2">
          <field name="jobTitleFunction"
            onChange="action-record-base-partner-set-business-card"/>
          <field name="functionBusinessCard"/>
        </panel>
        <field name="tagSet" widget="TagSelect" x-color-field="color"
          grid-view="tag-simplified-grid" form-view="tag-form"
          onSelect="action-partner-attrs-set-partner-tag-domain"/>
      </panel>
      <panel name="otherPartnerDetailsPanel">
        <field name="registrationCode" hideIf="partnerTypeSelect== 2" colSpan="4"
          onChange="action-group-partner-registration-code-onChange"/>
        <field name="siren" colSpan="4" readonly="true" hidden="true"/>
        <field name="nic" colSpan="4" readonly="true" hidden="true"/>
        <label name="isValidRegistrationCode" type="string" showTitle="false" x-dirty="false"
          hidden="true" css="label-danger"/>
        <spacer colSpan="8"/>
        <field name="saleTurnover" hideIf="partnerTypeSelect== 2"/>
        <field name="mainActivity" hideIf="partnerTypeSelect== 2" domain="self.isFinal = true"
          form-view="main-activity-form"/>
        <field name="taxNbr" hidden="true"/>
        <field name="paymentDelay" if-module="axelor-cash-management"
          if="__config__.app.isApp('cash-management')"/>
        <field name="parentPartner" hideIf="partnerTypeSelect != 1"
          if="__config__.app.getApp('base')?.getManageSubsidiaryPartner()" form-view="partner-form"
          grid-view="partner-grid" onSelect="action-partner-method-set-parent-partner-domain"/>
        <field name="sellerCode" showIf="isFactor"
          if="__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.getManageFactors()"
          if-module="axelor-account"/>
      </panel>
    </panel>
    <panel colSpan="12" name="partnerLinkPanel" showIf="isProspect || isCustomer"
      if="__config__.app.getApp('base')?.activatePartnerRelations">
      <panel-related field="managedByPartnerLinkList"
        grid-view="partner-link-partner-1-grid" form-view="partner-link-partner-1-form"/>
      <panel-related field="managedForPartnerLinkList"
        grid-view="partner-link-partner-2-grid" form-view="partner-link-partner-2-form"/>
    </panel>
    <panel-dashlet action="action-partner-view-subsidiary-partners"
      name="subsidiaryPartners" showIf="partnerTypeSelect == 1"
      if="__config__.app.getApp('base')?.getManageSubsidiaryPartner()"/>
    <panel-related name="contactPartnerSetPanel" field="contactPartnerSet"
      hideIf="!id || isContact || partnerTypeSelect == 2"
      domain="self.isContact = 'true' AND self in (SELECT p FROM Partner p join p.companySet c where c in :companySet)"
      form-view="partner-contact-form" grid-view="partner-contact-grid"/>
    <panel-tabs name="mainPanelTab">
      <panel name="informationPanel" title="Information">
        <panel name="employeeAddressPanel" title="Contact address" colSpan="12"
          showIf="isEmployee">
          <field name="mainAddress" form-view="address-form" grid-view="address-grid"
            canNew="true" colSpan="12"/>
        </panel>
        <panel name="postalAddressesPanel" title="Postal addresses" colSpan="12"
          hideIf="isEmployee">
          <static name="invoiceAndDeliveryAddressText" hidden="true" colSpan="12">
		  	  <![CDATA[<><Badge bg="warning">Please add an invoice address and a delivery address by default.</Badge></>]]>
          </static>
          <field name="partnerAddressList" colSpan="12" form-view="partner-address-form"
            grid-view="partner-address-grid">
            <editor x-show-titles="false" x-viewer="true">
              <panel colSpan="12" css="field-append">
                <label colSpan="12"
                  title="The following address is invalid. Please use '+' button to create a new one :"
                  showIf="address == null || address.addressL4 == null" hidden="true"
                  css="label-bold" name="addressHelperLabel"/>
                <panel colSpan="12" stacked="true" css="field-append">
                  <field name="address" canNew="true" form-view="address-form"
                    grid-view="address-grid" required="true"
                    if="__config__.app.getApp('base')?.getIsSharedAddress()"/>
                  <field name="address" canNew="true" canEdit="true" form-view="address-form"
                    grid-view="address-grid" canSelect="false" required="true"
                    if="!__config__.app.getApp('base')?.getIsSharedAddress()"/>
                  <field name="isInvoicingAddr" widget="toggle" hideIf="$readonly()"
                    x-icon="fa-list-alt"/>
                  <field name="isDeliveryAddr" widget="toggle" hideIf="$readonly()"
                    x-icon="fa-shopping-cart"/>
                  <field name="isDefaultAddr" widget="toggle" hideIf="$readonly()"
                    x-icon="fa-star-o"/>
                  <field name="address.addressL4" hidden="true"/>
                </panel>
              </panel>
            </editor>
          </field>
          <spacer/>
          <field name="headOfficeAddress" if-module="axelor-account"
            if="__user__.activeCompany?.accountConfig?.displayHeadOfficeAddrOnInvoicePrinting"
            colSpan="12"/>
        </panel>
        <panel name="generalContactDetailsPanel" title="General contact details" colSpan="12">
          <field name="fixedPhone" colSpan="3" widget="phone"
            x-placeholder-number-type="FIXED_LINE"/>
          <field name="mobilePhone" colSpan="3" hideIf="partnerTypeSelect == 1" widget="phone"/>
          <field name="emailAddress" canSelect="false" colSpan="6"
            form-view="email-address-simple-form" x-show-icons="false">
            <editor x-show-titles="false" x-viewer="true">
              <field name="address" colSpan="12" placeholder="whatever@example.com"
                pattern="^[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[a-z]{2,})$"/>
            </editor>
          </field>
          <field name="webSite" placeholder="http://www.url.com" widget="url"
            pattern="^(?:http(?:s)?://)?\S+(?:\.\S+)+$"/>
        </panel>

        <panel name="employeePanel" hidden="true">
          <button name="openEmployeeFormBtn" title="Open employee form" colSpan="6"
            onClick="action-partner-view-open-employee-form"/>
        </panel>

        <panel name="settingsPanel" title="Settings" colSpan="12">
          <field name="localization" colSpan="6" canEdit="false" grid-view="localization-grid"
            form-view="localization-form"/>
          <field name="groupProductsOnPrintings" showIf="(isCustomer || isSupplier)"
            if="__config__.app.getApp('base')?.getIsRegroupProductsOnPrintings()"
            widget="boolean-switch" colSpan="12"/>
          <panel name="assignedToPanel" title="Assigned to" colSpan="12">
            <field name="user" colSpan="6" form-view="user-form"
              onSelect="action-partner-attrs-user-group" grid-view="user-grid" hideIf="isEmployee"
              canNew="false" canEdit="false" canView="false"/>
            <field name="team" canEdit="false" colSpan="6" form-view="team-form"
              grid-view="team-grid" if="__config__.app.getApp('base')?.getTeamManagement()"
              hideIf="isEmployee"/>
            <field name="companySet" colSpan="12" widget="TagSelect" canNew="false"
              form-view="company-form" grid-view="company-grid"/>
          </panel>
        </panel>
        <panel name="notesPanel" title="Notes" colSpan="12">
          <field name="description" colSpan="12" height="8" showTitle="false" widget="Html"/>
        </panel>
      </panel>
      <panel name="eventPanel" title="Events" showIf="id != null &amp;&amp; !isEmployee"
        if-module="axelor-crm" hidden="true" if="__config__.app.isApp('crm')">
        <button name="meetingBtn" title="Create a meeting" link="" icon="fa-pencil-square-o"
          onClick="save,action-partner-view-meeting-event" colSpan="3"/>
        <button name="callBtn" title="Create a call" link="" icon="fa-phone"
          onClick="save,action-partner-view-call-event" colSpan="3"/>
        <button name="taskBtn" title="Create a task" link="" icon="fa-tasks"
          onClick="save,action-partner-view-task-event" colSpan="3"/>
        <button name="noteBtn" title="Create a note" link="" icon="fa-sticky-note-o"
          onClick="save,action-partner-view-note-event" colSpan="3"/>
        <button name="showAllEventsBtn" title="Show all events" css="btn-custom text-left"
          icon="fa-tasks" onClick="action-partner-view-events" readonlyIf="id == null"/>
        <panel-include view="incl-activities-partner-form"/>
      </panel>
      <panel name="opportunitiesPanel" title="Opportunities"
        showIf="id != null &amp;&amp; !isEmployee" if-module="axelor-crm"
        if="__config__.app.isApp('crm')">
        <button name="createOpportunityBtn" title="Create opportunity"
          onClick="save,action-partner-view-create-opportunity" link="" colSpan="3"/>
        <panel-include view="incl-opportunities-partner-form"/>
      </panel>
      <panel name="emailPanel" title="Emails" showIf="id != null &amp;&amp; !isEmployee"
        if-module="axelor-crm" if="__config__.app.isApp('crm')">
        <button name="emailBtn" title="Create an email" icon="fa-envelope-o" link=""
          onClick="save,action-send-by-email-with-template" colSpan="3"/>
        <panel-dashlet name="sentEmailsPanel" title="Sent emails"
          action="action-partner-method-view-sent-emails" colSpan="12" height="550"/>
        <panel-dashlet name="receivedEmailsPanel" title="Received emails"
          action="action-partner-method-view-received-emails" colSpan="12" height="550"/>
      </panel>
      <panel name="marketingCampaignPanel" title="Marketing campaigns"
        showIf="id != null &amp;&amp; !isEmployee" if-module="axelor-crm"
        if="__config__.app.isApp('marketing')">
        <panel-dashlet name="marketingCampaignsPanel"
          action="action-partner-view-marketing-campaigns" colSpan="12" height="800"/>
      </panel>
      <panel name="customerPanel" title="Customer" if-module="axelor-sale" showIf="isCustomer"
        if="__config__.app.isApp('sale')">
        <field name="saleOrderInformation"/>
        <field name="payerQuality" if-module="axelor-account"
          if="__config__.app.isApp('account')" hideIf="isEmployee"/>
        <field name="salePartnerPriceList" canEdit="false"
          domain="self.typeSelect = 1 AND self.currency = :currency"
          form-view="partner-price-list-form" grid-view="partner-price-list-grid"/>
        <field name="chargeBackPurchaseSelect" colSpan="3" if-module="axelor-business-project"
          if="__config__.app.isApp('business-project')"/>
        <field name="chargeBackPurchase" colSpan="3" showIf="chargeBackPurchaseSelect == 3"
          if-module="axelor-business-project" if="__config__.app.isApp('business-project')"/>
        <panel name="clientPortalAccessPanel" title="Client portal access"
          if-module="axelor-client-portal"
          if="__config__.app.isApp('portal') &amp;&amp; __config__.app.getApp('portal')?.getPortalSelect() == 2">
          <field name="password" widget="password"/>
        </panel>
        <field name="factorizedCustomer"
          if="__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.getManageFactors()"/>
        <field name="customerCatalogList" colSpan="12"
          form-view="customer-catalog-partner-form" grid-view="customer-catalog-partner-grid"
          if-module="axelor-sale"
          if="__config__.app.isApp('sale') &amp;&amp; __config__.app.getApp('sale')?.getEnableCustomerCatalogMgt()"/>
        <panel name="accountblockedPanel">
          <field name="hasBlockedAccount"
            onChange="action-attrs-update-manually-blocked-account"/>
          <field name="hasManuallyBlockedAccount" hidden="true"/>
        </panel>
        <panel name="saleOrderCommentsPanel" title="Comment to display on sale order"
          colSpan="12">
          <field name="saleOrderComments" widget="html" colSpan="12" showTitle="false"/>
        </panel>
        <panel name="saleOrderPanel" colSpan="12" if="__config__.app.isApp('sale')"
          if-module="axelor-sale">
          <button name="createSaleOrderBtn" title="Create sale quotation" colSpan="4"
            onClick="save,action-partner-view-create-order" readonlyIf="id == null || id &lt; 1"
            showIf="isCustomer"/>
          <panel-include view="incl-sales-partner-form"/>
        </panel>
      </panel>

      <panel name="supplierPanel" title="Supplier" if-module="axelor-purchase"
        showIf="isSupplier || isSubcontractor" if="__config__.app.isApp('purchase')">
        <field name="purchaseOrderInformation"/>
        <field name="purchasePartnerPriceList" canEdit="false"
          domain="self.typeSelect = 2 AND self.currency = :currency"
          form-view="partner-price-list-form" grid-view="partner-price-list-grid"/>
        <field name="supplierCatalogList" colSpan="12" x-can-copy="true"
          form-view="supplier-catalog-partner-form" grid-view="supplier-catalog-partner-grid"
          if-module="axelor-purchase"
          if="__config__.app.isApp('purchase') &amp;&amp; __config__.app.getApp('purchase')?.getManageSupplierCatalog()"/>
        <field name="supplierQualityRating" hidden="true"/>
        <field name="supplierQualityRatingSelect" widget="Rating"
          x-rating-color="black,black,black,black,black" colSpan="3"
          onChange="action-record-set-supplier-quality-rating"/>
        <field name="supplierArrivalProductQty" colSpan="3"/>
        <spacer name="supplierSpacer"/>
        <field name="partnerProductQualityRatingList" colSpan="12"
          grid-view="partner-product-quality-rating-grid"
          form-view="partner-product-quality-rating-form"/>
        <panel name="purchaseOrderCommentsPanel" title="Comment to display on purchase order"
          colSpan="12">
          <field name="purchaseOrderComments" widget="html" colSpan="12" showTitle="false"/>
        </panel>
        <panel name="purchaseOrderPanel" colSpan="12" if-module="axelor-purchase"
          if="__config__.app.isApp('purchase')">
          <button name="createPurchaseOrderBtn" title="Create purchase quotation" colSpan="4"
            onClick="save,action-partner-view-create-purchase-quotation"
            readonlyIf="id == null || id &lt; 1" showIf="isSupplier"/>
          <panel-include view="incl-purchases-partner-form"/>
        </panel>
      </panel>
      <panel name="carrierPanel" title="Carrier" showIf="isCarrier">
        <field name="freightCarrierModeList"
          form-view="freight-carrier-mode-freight-carrier-form"
          grid-view="freight-carrier-mode-freight-carrier-grid" colSpan="12"/>
      </panel>
      <panel name="deliveryPanel" title="Delivery"
        showIf="isSupplier || isCustomer || isSubcontractor" if="__config__.app.isApp('stock')"
        if-module="axelor-stock">
        <field name="deliveryDelay" showIf="isSupplier || isSubcontractor"/>
        <spacer name="deliveryDelaySpacer"/>
        <field name="shipmentMode" form-view="shipment-mode-form"
          grid-view="shipment-mode-grid" onChange="action-partner-record-empty-freight-carrier-mode"
          title="Shipment Mode"/>
        <field name="freightCarrierMode" domain="self.shipmentMode = :shipmentMode"
          onChange="action-partner-record-freight-carrier" form-view="freight-carrier-mode-form"
          grid-view="freight-carrier-mode-grid" readonlyIf="shipmentMode == null"/>
        <field name="carrierPartner" form-view="partner-form" grid-view="partner-grid"
          title="Freight Carrier" readonly="true"/>
        <field name="isIspmRequired" hidden="true" showIf="isCustomer || isProspect"/>
        <field name="isNeedingConformityCertificate" showIf="isCustomer || isProspect"/>
        <field name="partnerStockSettingsList" colSpan="12"
          form-view="partner-stock-settings-form" grid-view="partner-stock-settings-grid"/>
        <panel-include
          view="incl-freight-carrer-customer-account-number-list-partner-form"/>
        <panel name="deliveryCommentsPanel" title="Comment to display on delivery"
          colSpan="12">
          <field name="deliveryComments" widget="html" colSpan="12" showTitle="false"/>
        </panel>
        <panel name="pickingOrderCommentsPanel" title="Comment to display on picking order"
          colSpan="12">
          <field name="pickingOrderComments" widget="html" colSpan="12" showTitle="false"/>
        </panel>
      </panel>
      <panel name="projectPanel" title="Projects"
        if="__config__.app.isApp('business-project')" if-module="axelor-business-project">
        <panel-dashlet name="projectPanel" title="Projects"
          action="action-partner-view-related-projects" colSpan="12"/>
        <panel-dashlet name="invoicingProjectPanel" title="Invoicing projects"
          action="action-partner-view-related-invoicing-projects" colSpan="12"/>
      </panel>
    </panel-tabs>
    <panel name="partnerAttrsPanel">
      <field name="partnerAttrs" colSpan="12"/>
    </panel>
    <panel-mail name="mailsPanel">
      <mail-messages limit="4"/>
      <mail-followers/>
    </panel-mail>
  </form>

  <form name="partner-contact-form" title="Contact" model="com.axelor.apps.base.db.Partner"
    onNew="action-partner-contact-record-default,action-partner-attrs-partner-seq-editable"
    onLoad="action-group-partner-contact-onload"
    onSave="save,action-partner-method-set-user-partner,action-partner-method-add-contact-partner">
    <toolbar>
      <button name="convertToIndividualPartnerBtn" title="Convert into an individual partner"
        icon="fa-user" onClick="save,action-convert-into-individual-partner,close"
        showIf="id != null &amp;&amp; isContact == true &amp;&amp; mainPartner == null"/>
    </toolbar>
    <menubar>
      <menu name="partnerReportsMenu" title="Reports" icon="fa-files-o" showTitle="true">
        <item name="customerSituationItem" title="Customer Situation"
          action="save,action-partner-view-customer-situation-filters" readonlyIf="id == null"
          showIf="isContact == false" if-module="axelor-account"/>
      </menu>
    </menubar>
    <panel-include view="incl-event-actions-partner-form"/>
    <panel name="mainPanel">
      <panel name="imagePanel" colSpan="3">
        <field name="picture" widget="Image" showTitle="false" colSpan="12">
          <viewer>
            <![CDATA[
     					<>
	     					{id && <Image src={$image('id', 'content')} style={{ width: "80%" }}></Image>}
	     					{!id && _parent.titleSelect == 1 && <Image src="img/partner-m-default.png" style={{ width: "80%" }}></Image>}
	     					{!id && _parent.titleSelect == 2 && <Image src="img/partner-w-default.png" style={{ width: "80%" }}></Image>}
	     					{!id && (_parent.titleSelect > 2 || !_parent.titleSelect) && <Image src="img/partner-default.png" style={{ width: "80%" }}></Image>}
						</>
					]]>
          </viewer>
        </field>
        <panel name="socialNetworkPanel" colSpan="12">
          <label name="googleLabel"
            title="&lt;a class='fa fa-google' href='http://www.google.com' target='_blank' /&gt;"
            colSpan="2"/>
          <label name="facebookLabel"
            title="&lt;a class='fa fa-facebook' href='http://www.facebook.com' target='_blank' /&gt;"
            colSpan="2"/>
          <label name="twitterLabel"
            title="&lt;a class='fa fa-twitter' href='http://www.twitter.com' target='_blank' /&gt;"
            colSpan="2"/>
          <label name="linkedinLabel"
            title="&lt;a class='fa fa-linkedin' href='http://www.linkedin.com' target='_blank' /&gt;"
            colSpan="2"/>
          <label name="youtubeLabel"
            title="&lt;a class='fa fa-youtube' href='http://www.youtube.com' target='_blank' /&gt;"
            colSpan="2"/>
        </panel>
      </panel>
      <panel name="namePanel" colSpan="9">
        <field name="simpleFullName" css="bold" showTitle="false" colSpan="12">
          <editor x-show-titles="false" x-viewer="true">
            <field name="titleSelect" placeholder="Civility" colSpan="2"/>
            <field name="name" css="highlight" placeholder="Name"
              onChange="action-group-base-partner-contact-name-onchange" colSpan="5"/>
            <field name="firstName" css="highlight" placeholder="First name"
              onChange="action-group-base-partner-contact-name-onchange" colSpan="5"/>
          </editor>
        </field>
        <static name="duplicatePartnerText" hidden="true" colSpan="12">
          <![CDATA[<><Badge bg="warning">There is already a contact with this name.</Badge></>]]>
        </static>
        <field name="$duplicatePartnerInArchiveText" hidden="true" type="string"
          showTitle="false" readonly="true">
          <viewer depends="$duplicatePartnerInArchiveText">
            <![CDATA[<><Badge bg="warning">{_t('There is an archived partner with this name.')} ({$duplicatePartnerInArchiveText})</Badge></>]]>
          </viewer>
        </field>
        <panel name="companyPanel" title="Company" colSpan="12">
          <field name="mainPartner"
            domain="self.isContact = false  AND self in (SELECT p FROM Partner p join p.companySet c where c in :companySet AND p.partnerTypeSelect = 1)"
            form-view="partner-form" grid-view="partner-grid"/>
        </panel>
        <field name="isContact" hidden="true" colSpan="12"/>
      </panel>
    </panel>
    <panel-related name="partnerRoleSetPanel" field="partnerRoleSet"
      form-view="partner-role-form" grid-view="partner-role-grid" canNew="false"/>

    <panel-tabs name="mainPanelTab">
      <panel name="contactDetailsPanel" title="Contact details">
        <field name="jobTitleFunction" onChange="action-record-base-partner-set-business-card"/>
        <field name="functionBusinessCard"/>
        <field name="reportsTo" domain="self.isContact = true"/>
        <field name="fixedPhone" widget="phone" x-placeholder-number-type="FIXED_LINE"/>
        <field name="mobilePhone" widget="phone"/>
        <field name="emailAddress" canSelect="false" form-view="email-address-simple-form"
          x-show-icons="false">
          <editor x-show-titles="false" x-viewer="true">
            <field name="address" placeholder="whatever@example.com"
              pattern="^[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[a-z]{2,})$"
              colSpan="12"/>
          </editor>
        </field>
        <field name="mainAddress" canNew="true" form-view="address-form"
          grid-view="address-grid" colSpan="12"/>
      </panel>
      <panel name="eventPanel" title="Events" showIf="id != null" if-module="axelor-crm"
        if="__config__.app.isApp('crm')">
        <button name="meetingBtn" title="Create a meeting" icon="fa-pencil-square-o" link=""
          onClick="save,action-partner-view-meeting-event" colSpan="3"/>
        <button name="callBtn" title="Create a call" icon="fa-phone" link=""
          onClick="save,action-partner-view-call-event" colSpan="3"/>
        <button name="taskBtn" title="Create a task" icon="fa-tasks" link=""
          onClick="save,action-partner-view-task-event" colSpan="3"/>
        <button name="noteBtn" title="Create a note" icon="fa-sticky-note-o" link=""
          onClick="save,action-partner-view-note-event" colSpan="3"/>
        <button name="showAllEventsBtn" title="Show all events" css="btn-custom text-left"
          icon="fa-tasks" onClick="action-contact-view-events" readonlyIf="id == null"/>
        <panel-include view="incl-activities-contact-form"/>
      </panel>
      <panel-dashlet name="contactOpportunitiesPanel" title="Opportunity" colSpan="12"
        action="action-contact-view-opportunities" height="550"
        showIf="id != null &amp;&amp; !isEmployee" if-module="axelor-crm"
        if="__config__.app.isApp('crm')"/>
      <panel name="saleOrderContactPanel" title="Sales orders" showIf="id != null"
        if-module="axelor-supplychain" if="__config__.app.isApp('supplychain')">
        <panel-include view="incl-sales-contact-form"/>
      </panel>
      <panel name="emailPanel" title="Emails" showIf="id != null" if-module="axelor-crm"
        if="__config__.app.isApp('crm')">
        <button name="emailBtn" title="Create an email" icon="fa-envelope-o" link=""
          onClick="save,action-send-by-email-with-template" colSpan="3"/>
        <panel-dashlet name="sentEmailsPanel" title="Sent emails"
          action="action-partner-method-view-sent-emails" colSpan="12" height="550"/>
        <panel-dashlet name="receivedEmailsPanel" title="Received emails"
          action="action-partner-method-view-received-emails" colSpan="12" height="550"/>
      </panel>
      <panel-dashlet name="contactPartnerPanel"
        action="action-contact-partner-dashlet" title="Partners"/>
    </panel-tabs>

    <panel name="employeePanel" hidden="true" sidebar="true">
      <button name="openEmployeeFormBtn" title="Open employee form"
        onClick="action-partner-view-open-employee-form"/>
    </panel>

    <panel name="settingsPanel" sidebar="true" title="Settings">
      <field name="partnerSeq"/>
      <field name="localization" canEdit="false" grid-view="localization-grid"
        form-view="localization-form"/>
      <panel name="assignedToPanel" title="Assigned to" canCollapse="true" colSpan="12">
        <field name="user" colSpan="6" form-view="user-form" grid-view="user-grid"
          canNew="false" canEdit="false" canView="false"/>
        <field name="team" canEdit="false" colSpan="6" form-view="team-form"
          grid-view="team-grid" if="__config__.app.getApp('base')?.getTeamManagement()"/>
        <field name="companySet" colSpan="12" widget="TagSelect" canNew="false"
          form-view="company-form" grid-view="company-grid"/>
      </panel>
    </panel>
    <panel name="notesPanel" title="Notes" colSpan="12" sidebar="true">
      <field name="description" showTitle="false" colSpan="12" height="6" widget="Html"/>
    </panel>
    <panel name="contactAttrsPanel">
      <field name="contactAttrs" colSpan="12"/>
    </panel>
    <panel-mail name="mailsPanel">
      <mail-messages limit="4"/>
      <mail-followers/>
    </panel-mail>
  </form>

  <cards name="partner-cards" model="com.axelor.apps.base.db.Partner" title="Partners"
    css="rect-image">
    <toolbar>
      <button name="printPhoneBookBtn" title="Contact PhoneBook" icon="fa-print"
        onClick="action-print-phonebook"/>
      <button name="printCompanyPhoneBookBtn" title="Company PhoneBook" icon="fa-print"
        onClick="action-print-company-phonebook" if="__config__.app.isApp('employee')"/>
      <button name="checkDuplicateBtn" title="Check Duplicate"
        onClick="action-general-check-duplicate-records"/>
      <button name="replaceDuplicateBtn" title="Merge duplicated"
        onClick="action-validate-select-object-message,action-duplicate-object-wizard-open"/>
      <button name="advancedExportBtn" title="Advanced export"
        onClick="action-method-advanced-export-wizard-view"/>
      <button name="sirenApiBtn" title="Create from Sirene API"
        onClick="action-partner-view-wizard-api-sirene-configuration"/>
    </toolbar>
    <field name="fullName"/>
    <field name="picture"/>
    <field name="fixedPhone"/>
    <field name="emailAddress.address" title="Email"/>
    <field name="partnerCategory"/>
    <field name="partnerTypeSelect"/>
    <field name="titleSelect"/>
    <field name="mainAddress"/>
    <field name="isProspect"/>
    <field name="isEmployee"/>
    <field name="isCustomer"/>
    <field name="isSupplier"/>
    <field name="isSubcontractor"/>
    <field name="isFactor" if-module="axelor-account" if="__config__.app.isApp('account')"/>
    <field name="isCarrier"/>
    <template><![CDATA[
		<>
			<Box>
				<strong>{fullName}</strong>
				<Box d="grid" gridTemplateColumns="33% 67%" mt={2}>
					<Box d="flex" flexDirection="column" alignItems="center" style={{ width: 128, height: 64 }}>
						{picture && <Image src={$image('picture', 'content')} w={100} h={100}></Image>}
		     			{!picture && partnerTypeSelect != 2 && <Image src="img/company-default.jpg"></Image>}
		     			{!picture && partnerTypeSelect == 2 && titleSelect == 1 && <Image src="img/partner-m-default.png"></Image>}
		     			{!picture && partnerTypeSelect == 2 && titleSelect == 2 && <Image src="img/partner-w-default.png"></Image>}
		     			{!picture && partnerTypeSelect == 2 && (titleSelect > 2 || !titleSelect) && <Image src="img/partner-default.png"></Image>}
					</Box>
					<Box>
						{mainAddress.fullName} <Box/>
						{fixedPhone} <Box/>
						{emailAddress.address} <Box/>
						{partnerCategory.name}
					</Box>
				</Box>
				<Box d="flex" justifyContent="flex-end" gap="4" mt={3}>
					{isProspect && <Badge style={{ backgroundColor: "#FC6355" }}>{_t('Prospect')}</Badge>}
					{isEmployee && <Badge style={{ backgroundColor: "#5680FC" }}>{_t('Employee')}</Badge>}
					{isCustomer && <Badge style={{ backgroundColor: "#EF9D3F" }}>{_t('Customer')}</Badge>}
					{isSupplier && <Badge style={{ backgroundColor: "#7D54FC" }}>{_t('Supplier')}</Badge>}
					{isSubcontractor && <Badge style={{ backgroundColor: "#000080" }}>{_t('Subcontractor')}</Badge>}
					{isFactor && <Badge style={{ backgroundColor: "#54FC62" }}>{_t('Factor')}</Badge>}
					{isCarrier && <Badge style={{ backgroundColor: "#FF0000" }}>{_t('Carrier')}</Badge>}
				</Box>
			</Box>
		</>
		]]>
    </template>
  </cards>

  <cards name="partner-contact-cards" model="com.axelor.apps.base.db.Partner" title="Contacts"
    css="rect-image">
    <toolbar>
      <button name="checkDuplicateBtn" title="Check Duplicate"
        onClick="action-general-check-duplicate-records"/>
      <button name="replaceDuplicateBtn" title="Merge duplicated"
        onClick="action-validate-select-object-message,action-duplicate-object-wizard-open"/>
    </toolbar>
    <field name="fullName"/>
    <field name="picture"/>
    <field name="fixedPhone"/>
    <field name="mobilePhone"/>
    <field name="emailAddress.address" title="Email"/>
    <field name="mainPartner.simpleFullName"/>
    <field name="partnerCategory"/>
    <field name="mainAddress"/>
    <field name="titleSelect"/>
    <field name="partnerSeq"/>
    <field name="simpleFullName"/>
    <template><![CDATA[
		<>
			<Box style={{ height: 180 }}>
			    <Box d="grid" gridTemplateColumns="35% 65%" style={{ height: 150 }}>
			        <Box d="flex" flexDirection="column" alignItems="center" justifyContent="center">
						<Box d="flex" flexDirection="column" alignItems="center" style={{ width: 128, height: 64 }}>
							{picture && <Image src={$image('picture', 'content')} w={100} h={100}></Image>}
		     				{!picture && titleSelect == 1 && <Image src="img/partner-m-default.png"></Image>}
		     				{!picture && titleSelect == 2 && <Image src="img/partner-w-default.png"></Image>}
		     				{!picture && (titleSelect > 2 || !titleSelect) && <Image src="img/partner-default.png"></Image>}
						</Box>
						<Box as="strong" textAlign="center">{partnerSeq}</Box>
						<Box as="strong" textAlign="center">{simpleFullName}</Box>
			        </Box>
			        <Box position="absolute" ps={4} style={{ width: "60%", height: "100%", left: "35%", top: 0 }}>
			            <Box d="flex" alignItems="center" borderStart borderWidth={2} w={100} h={100} style={{ transform: "skew(-20deg, 0deg)" }}>
			                <Box style={{ height: "70%", width: "2rem", boxShadow: "rgb(0 0 0 / 25%) 3px 3px 8px", backgroundColor: "#20BCB5" }} />
			                <Box d="flex" alignItems="center" w={100} style={{ position: "absolute", top: "15%", left: "0.5rem", minHeight: "70%" }}>
			                    <Box as="ul" m={0} p={0} w={100} style={{ listStyle: "none" }}>
			                        {(() => {
			                            const renderItem = (icon, value) => {
			                                return value && String(value).trim() && (
			                                    <Box as="li" d="flex" gap={24} style={{ transform: "skew(20deg, 0deg)" }}>
			                                        <Icon icon={icon} color="white" fontSize="15px"/>
			                                        <Box as="span" style={{ fontSize: 15 }}> {value} </Box>
			                                    </Box>
			                                );
			                            };
			                            return (
			                                <>
			                                    {renderItem("telephone", fixedPhone)}
			                                    {renderItem("phone", mobilePhone)}
			                                    {renderItem("envelope-fill", emailAddress.address)}
			                                    {renderItem("building", mainPartner.simpleFullName)}
			                                    {renderItem("house-fill", mainAddress.fullName)}
			                                </>
			                            );
			                        })()}
			                    </Box>
			                </Box>
			            </Box>
			        </Box>
			    </Box>
			</Box>
		</>
		]]>
    </template>
  </cards>

  <grid title="Contacts list" name="partner-employee-grid"
    model="com.axelor.apps.base.db.Partner">
    <!-- name/firstName/fixedPhone/mobilePhone/emailAddress.address -->
    <field name="name"/>
    <field name="firstName"/>
    <field name="fixedPhone" widget="phone" x-placeholder-number-type="FIXED_LINE"/>
    <field name="mobilePhone" widget="phone"/>
    <field name="emailAddress.address" title="Email"/>
  </grid>

  <form name="partner-employee-form" title="Employee" model="com.axelor.apps.base.db.Partner"
    onNew="action-partner-employee-record-default"
    onLoad="action-group-base-partner-employee-onload"
    onSave="save,action-partner-method-set-user-partner">
    <menubar>
      <menu name="partnerReportsMenu" title="Reports" icon="fa-files-o" showTitle="true">
        <item name="customerSituationItem" title="Customer Situation"
          action="save,action-partner-view-customer-situation-filters" readonlyIf="id == null"
          showIf="isContact == false" if-module="axelor-account"/>
      </menu>
    </menubar>
    <panel-include view="incl-event-actions-partner-form"/>
    <panel name="mainPanel">
      <panel name="imagePanel" colSpan="3">
        <field name="picture" widget="Image" showTitle="false" colSpan="12"/>
        <panel colSpan="12" name="socialNetworkPanel">
          <label name="googleLabel"
            title="&lt;a class='fa fa-google' href='http://www.google.com' target='_blank' /&gt;"
            colSpan="2"/>
          <label name="facebookLabel"
            title="&lt;a class='fa fa-facebook' href='http://www.facebook.com' target='_blank' /&gt;"
            colSpan="2"/>
          <label name="twitterLabel"
            title="&lt;a class='fa fa-twitter' href='http://www.twitter.com' target='_blank' /&gt;"
            colSpan="2"/>
          <label name="linkedinLabel"
            title="&lt;a class='fa fa-linkedin' href='http://www.linkedin.com' target='_blank' /&gt;"
            colSpan="2"/>
          <label name="youtubeLabel"
            title="&lt;a class='fa fa-youtube' href='http://www.youtube.com' target='_blank' /&gt;"
            colSpan="2"/>
        </panel>
      </panel>
      <panel name="namePanel" colSpan="9">
        <field name="titleSelect" showTitle="false" placeholder="Civility" colSpan="2"/>
        <field name="name" showTitle="false" css="highlight" placeholder="Name"
          onChange="action-group-base-partner-contact-name-onchange" colSpan="5"/>
        <field name="firstName" showTitle="false" css="highlight" placeholder="First name"
          onChange="action-group-base-partner-contact-name-onchange" colSpan="5"/>
        <static name="duplicatePartnerText" hidden="true" colSpan="12">
          <![CDATA[<><Badge bg="warning">There is already a partner with this name.</Badge></>]]>
        </static>
        <panel name="companyPanel" title="Company" colSpan="12">
          <field name="mainPartner"
            domain="self.isContact = false  AND self in (SELECT p FROM Partner p join p.companySet c where c in :companySet AND p.partnerTypeSelect = 1)"
            form-view="partner-form" grid-view="partner-grid"/>
        </panel>
        <field name="isContact" hidden="true" colSpan="12"/>
        <field name="isEmployee" readonly="true" colSpan="12"/>
      </panel>
    </panel>
    <panel-tabs name="mainPanelTab">
      <panel name="contactDetailsPanel" title="Contact details">
        <field name="jobTitleFunction"/>
        <field name="reportsTo" domain="self.isContact = true"/>
        <field name="fixedPhone" widget="phone" x-placeholder-number-type="FIXED_LINE"/>
        <field name="mobilePhone" widget="phone"/>
        <field name="emailAddress" canSelect="false" form-view="email-address-simple-form"
          x-show-icons="false">
          <editor x-show-titles="false" x-viewer="true">
            <field name="address" placeholder="whatever@example.com"
              pattern="^[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[a-z]{2,})$"/>
          </editor>
        </field>
        <field name="mainAddress" canNew="true" form-view="address-form"
          grid-view="address-grid"/>
      </panel>
      <panel name="eventPanel" title="Events" showIf="id != null" if-module="axelor-crm"
        if="__config__.app.isApp('crm')">
        <panel-include view="incl-activities-contact-form"/>
      </panel>
      <panel name="saleOrderContactPanel" title="Sales orders" showIf="id != null"
        if-module="axelor-supplychain" if="__config__.app.isApp('supplychain')">
        <panel-include view="incl-sales-contact-form"/>
      </panel>
      <panel name="emailPanel" title="Emails" showIf="id != null" if-module="axelor-crm"
        if="__config__.app.isApp('crm')">
        <panel-dashlet name="sentEmailsPanel" title="Sent emails"
          action="action-partner-method-view-sent-emails" colSpan="12" height="500"/>
        <panel-dashlet name="receivedEmailsPanel" title="Received emails"
          action="action-partner-method-view-received-emails" colSpan="12" height="500"/>
      </panel>
      <panel-dashlet name="contactPartnerDetailsPanel"
        action="action-contact-partner-dashlet" title="Partners"/>
    </panel-tabs>
    <panel name="settingsPanel" sidebar="true" title="Settings">
      <field name="partnerSeq"/>
      <field name="localization" grid-view="localization-grid" form-view="localization-form"
        canEdit="false"/>
      <panel name="assignedToPanel" title="Assigned to" canCollapse="true" colSpan="12">
        <field name="user" colSpan="6" form-view="user-form" grid-view="user-grid"
          canNew="false" canEdit="false" canView="false"/>
        <field name="team" canEdit="false" colSpan="6" form-view="team-form"
          grid-view="team-grid" if="__config__.app.getApp('base')?.getTeamManagement()"/>
        <field name="companySet" colSpan="12" widget="TagSelect" canNew="false"
          form-view="company-form" grid-view="company-grid"/>
      </panel>
    </panel>
    <panel name="notesPanel" title="Notes" colSpan="12" sidebar="true">
      <field name="description" showTitle="false" colSpan="12" height="6" widget="Html"/>
    </panel>
  </form>

  <form model="com.axelor.apps.base.db.Partner" title="Customer situation filters"
    name="popup-customer-situation-form" onLoad="action-attrs-customer-situation-popup-on-load">
    <panel name="mainPanel">
      <panel name="filtersPanel" colSpan="12">
        <field name="$company" type="many-to-one" target="com.axelor.apps.base.db.Company"
          title="Company"/>
        <field name="$tradingName" title="Trading name" type="many-to-one"
          target="com.axelor.apps.base.db.TradingName"
          if="__config__.app.getApp('base')?.getEnableTradingNamesManagement()"/>
        <panel name="datePanel" colSpan="12">
          <field name="$fromDate" title="From Date" type="date"/>
          <field name="$toDate" title="To Date" type="date"/>
        </panel>
        <field name="$saleOrderStatus" title="Sale order status" type="selection"
          selection="sale.order.status.select" widget="MultiSelect"/>
        <field name="$invoiceStatus" title="Invoice status" type="selection"
          selection="iaccount.invoice.status.select" widget="MultiSelect"/>
        <field name="$stockMoveStatus" title="Delivery status" type="selection"
          selection="stock.move.status.select" widget="MultiSelect"/>
      </panel>
      <button onClick="action-partner-method-show-client-situation,close" name="printBtn"
        title="Print" colOffset="3"/>
    </panel>
  </form>

  <form name="partner-api-sirene-configuration-wizard-form" title="Sirene API call"
    model="com.axelor.utils.db.Wizard" onNew="action-api-sirene-configuration-group-on-new">
    <panel name="mainPanel">
      <field name="siretNumber" title="Siret number" type="string" required="true" colSpan="5"
        readonlyIf="$parentSiret"/>
      <button name="executeApiBtn" title="Fetch data"
        onClick="action-api-sirene-configuration-method-fetch-data" colSpan="2"
        readonlyIf="siretNumber == null"/>
      <field name="$parentSiret" type="string" hidden="true"/>
    </panel>
  </form>

  <action-method name="action-api-sirene-configuration-method-fetch-data">
    <call class="com.axelor.apps.base.web.PartnerController" method="apiSireneFetchData"/>
  </action-method>

  <action-group name="action-api-sirene-configuration-group-on-new">
    <action name="action-api-sirene-configuration-record-set-parent-siret"/>
    <action name="action-api-sirene-configuration-record-set-siret-number" if="parentSiret"/>
  </action-group>

  <action-record name="action-api-sirene-configuration-record-set-parent-siret"
    model="com.axelor.utils.db.Wizard">
    <field name="$parentSiret" expr="eval: _parentSiret"/>
  </action-record>

  <action-record name="action-api-sirene-configuration-record-set-siret-number"
    model="com.axelor.utils.db.Wizard">
    <field name="siretNumber" expr="eval: parentSiret"/>
  </action-record>

  <action-group name="action-group-partner-onload">
    <action name="action-partner-attrs-change-name"/>
    <action name="action-partner-attrs-show-specific-tax-note"/>
    <action name="action-partner-method-set-social-network-url"/>
    <action name="action-partner-attrs-hide-employee-panel"
      if="__config__.app.isApp('employee')"/>
    <action name="action-partner-account-attrs-hide-supplier-account"/>
    <action name="action-partner-account-attrs-hide-customer-account"/>
    <action name="action-partner-account-attrs-hide-employee-account"/>
    <action name="action-partner-record-set-balance" if="__config__.app.isApp('account')"/>
    <action name="action-partner-method-set-positive-balance"
      if="__config__.app.isApp('account')"/>
    <action name="action-partner-attrs-name-balance"/>
    <action name="action-partner-attrs-partner-seq-editable"/>
    <action name="action-partner-method-check-name"/>
    <action name="action-partner-attrs-hide-invoice-and-delivery-address-text"/>
    <action name="action-method-partner-siren-nic-onload"/>
    <action name="action-method-partner-check-registration-code"/>
  </action-group>

  <action-group name="action-group-base-partner-onnew">
    <action name="action-partner-record-partner-type-select"/>
    <action name="action-partner-record-set-default"/>
    <action name="action-partner-attrs-set-default"/>
    <action name="action-partner-record-set-default-cash-management"/>
    <action name="action-partner-record-set-payment-modes"/>
    <action name="action-partner-record-payment-condition"/>
    <action name="action-partner-attrs-partner-seq-editable"/>
  </action-group>

  <action-group name="action-group-base-partner-contact-name-onchange">
    <action name="action-partner-method-check-name"/>
    <action name="action-partner-method-check-name-in-archive"/>
    <action name="action-partner-record-simple-and-full-name"/>
    <action name="action-partner-method-set-social-network-url"
      if="!__config__.app.isApp('crm')"/>
  </action-group>

  <action-group name="action-group-base-partner-employee-onload">
    <action name="action-partner-attrs-change-name"/>
    <action name="action-partner-method-set-social-network-url"
      if="!__config__.app.isApp('crm')"/>
  </action-group>

  <action-group name="action-partner-group-type-select-onchange">
    <action name="action-partner-partner-type-select-change"/>
    <action name="action-partner-method-set-social-network-url"
      if="!__config__.app.isApp('crm')"/>
    <action name="action-partner-record-employee"/>
  </action-group>

  <action-group name="action-partner-group-check-can-change-factor"
    if-module="axelor-account">
    <action name="action-partner-record-factor-supplier-customer-no-error"/>
    <action name="action-partner-method-check-company-account-config"
      if="__config__.app.isApp('account')"/>
    <action name="action-partner-method-check-any-notification-attached"
      if="__config__.app.isApp('account')"/>
    <action name="action-partner-validate-factor-supplier-customer-show-error"/>
  </action-group>

  <action-group name="action-partner-group-check-can-change-supplier">
    <action name="action-partner-record-factor-supplier-customer-no-error"/>
    <action name="action-partner-method-check-any-purchase-order-attached"
      if="__config__.app.isApp('purchase')"/>
    <action name="action-partner-method-check-any-invoice-supplier-purchase-attached"
      if="__config__.app.isApp('invoice')"/>
    <action name="action-partner-method-check-any-payable-move-line-attached"
      if="__config__.app.isApp('account')"/>
    <action name="action-partner-validate-factor-supplier-customer-show-error"/>
  </action-group>

  <action-group name="action-partner-group-check-can-change-customer">
    <action name="action-partner-record-factor-supplier-customer-no-error"/>
    <action name="action-partner-method-check-any-sale-order-attached"
      if="__config__.app.isApp('sale')"/>
    <action name="action-partner-method-check-any-invoice-client-sale-attached"
      if="__config__.app.isApp('invoice')"/>
    <action name="action-partner-method-check-any-receivable-move-line-attached"
      if="__config__.app.isApp('account')"/>
    <action name="action-partner-validate-factor-supplier-customer-show-error"/>
  </action-group>

  <action-group name="action-partner-group-onsave">
    <action name="action-partner-iban-check-on-save"/>
    <action name="action-partner-method-check-if-registration-code-already-exists" if="!id"/>
    <action name="save"/>
    <action name="action-partner-method-set-user-partner"/>
  </action-group>

  <action-method
    name="action-partner-method-check-if-registration-code-already-exists">
    <call class="com.axelor.apps.base.web.PartnerController"
      method="checkIfRegistrationCodeExists"/>
  </action-method>

  <action-validate name="action-partner-validate-registration-code">
    <error message="Registration code is required."
      if="partnerAddressList?.findAll{it.address?.country?.alpha2Code == 'FR'}?.size() &gt; 0 &amp;&amp; partnerTypeSelect == 1 &amp;&amp; !registrationCode"/>
  </action-validate>

  <action-record name="action-partner-record-factor-supplier-customer-no-error"
    model="com.axelor.apps.base.db.Partner">
    <field name="customerCantBeRemoved" expr="eval:false"/>
    <field name="supplierCantBeRemoved" expr="eval:false"/>
    <field name="factorCantBeRemoved" expr="eval:false"/>
  </action-record>

  <action-validate
    name="action-partner-validate-factor-supplier-customer-show-error">
    <error
      message="This partner is categorized as a customer due to existing records in the database. This category can't be removed."
      action="action-partner-record-reset-customer-true" if="customerCantBeRemoved"/>
    <error
      message="This partner is categorized as a supplier due to existing records in the database. This category can't be removed."
      action="action-partner-record-reset-supplier-true" if="supplierCantBeRemoved"/>
    <error
      message="This partner is categorized as a factor due to existing records in the database. This category can't be removed."
      action="action-partner-record-reset-factor-true" if="factorCantBeRemoved"/>
  </action-validate>

  <action-record name="action-partner-record-reset-factor-true"
    model="com.axelor.apps.base.db.Partner">
    <field name="isFactor" expr="eval:true" if="__config__.app.isApp('account')"/>
    <field name="factorCantBeRemoved" expr="eval:false"/>
  </action-record>

  <action-record name="action-partner-record-reset-customer-true"
    model="com.axelor.apps.base.db.Partner">
    <field name="isCustomer" expr="eval:true"/>
    <field name="customerCantBeRemoved" expr="eval:false"/>
  </action-record>

  <action-record name="action-partner-record-reset-supplier-true"
    model="com.axelor.apps.base.db.Partner">
    <field name="isSupplier" expr="eval:true"/>
    <field name="supplierCantBeRemoved" expr="eval:false"/>
  </action-record>

  <action-method name="action-method-partner-siren-nic-onload">
    <call class="com.axelor.apps.base.web.PartnerController"
      method="getHideFieldOnPartnerTypeSelect"/>
  </action-method>

  <action-method name="action-partner-method-check-company-account-config">
    <call class="com.axelor.apps.account.web.PartnerController"
      method="checkAnyCompanyAccountConfigAttached"/>
  </action-method>

  <action-method name="action-partner-method-check-any-notification-attached">
    <call class="com.axelor.apps.account.web.PartnerController"
      method="checkAnyNotificationAttached"/>
  </action-method>

  <action-method name="action-partner-method-check-any-payable-move-line-attached">
    <call class="com.axelor.apps.account.web.PartnerController"
      method="checkAnyPayableMoveLineAttached"/>
  </action-method>

  <action-method
    name="action-partner-method-check-any-invoice-supplier-purchase-attached">
    <call class="com.axelor.apps.account.web.PartnerController"
      method="checkAnyInvoiceSupplierPurchaseAttached"/>
  </action-method>

  <action-method name="action-partner-method-check-any-purchase-order-attached">
    <call class="com.axelor.apps.purchase.web.PartnerPurchaseController"
      method="checkAnyPurchaseOrderAttached"/>
  </action-method>

  <action-method name="action-partner-method-check-any-sale-order-attached">
    <call class="com.axelor.apps.sale.web.PartnerSaleController"
      method="checkAnySaleOrderAttached"/>
  </action-method>

  <action-method name="action-partner-method-check-any-receivable-move-line-attached">
    <call class="com.axelor.apps.account.web.PartnerController"
      method="checkAnyReceivableMoveLineAttached"/>
  </action-method>

  <action-method name="action-partner-method-check-any-invoice-client-sale-attached">
    <call class="com.axelor.apps.account.web.PartnerController"
      method="checkAnyInvoiceClientSaleAttached"/>
  </action-method>

  <action-method name="action-partner-method-check-name">
    <call class="com.axelor.apps.base.web.PartnerController" method="checkPartnerName"/>
  </action-method>

  <action-method name="action-partner-method-check-name-in-archive">
    <call class="com.axelor.apps.base.web.PartnerController" method="checkPartnerNameArchived"/>
  </action-method>

  <action-method name="action-partner-method-set-social-network-url">
    <call class="com.axelor.apps.base.web.PartnerController" method="setSocialNetworkUrl"/>
  </action-method>

  <action-method name="action-partner-method-add-contact-partner">
    <call class="com.axelor.apps.base.web.PartnerController" method="addContactToPartner"/>
  </action-method>

  <action-method name="action-partner-method-set-user-partner">
    <call class="com.axelor.apps.base.web.UserController" method="setUserPartner"/>
  </action-method>
  <action-method name="action-partner-method-set-parent-partner-domain">
    <call class="com.axelor.apps.base.web.PartnerController" method="setParentPartnerDomain"/>
  </action-method>

  <action-attrs name="action-partner-attrs-partner-seq-editable">
    <attribute name="readonly" for="partnerSeq"
      expr="__config__.app.getApp('base')?.getGeneratePartnerSequence()"/>
    <attribute name="readonly" for="companyPanel"
      expr="#{__parent__ != null &amp;&amp; __parent__._model == 'com.axelor.apps.base.db.Partner'}"/>
  </action-attrs>

  <action-attrs name="action-partner-attrs-change-name">
    <attribute name="title" for="name" expr="Business name"
      if="partnerTypeSelect == __repo__(Partner).PARTNER_TYPE_COMPANY"/>
    <attribute name="title" for="name" expr="Name"
      if="partnerTypeSelect == __repo__(Partner).PARTNER_TYPE_INDIVIDUAL"/>
  </action-attrs>

  <action-attrs name="action-partner-attrs-hide-invoice-and-delivery-address-text">
    <attribute name="hidden" for="invoiceAndDeliveryAddressText"
      expr="eval: partnerAddressList?.findAll{it.isInvoicingAddr}?.size() &gt; 0 &amp;&amp; partnerAddressList?.findAll{it.isDeliveryAddr}?.size() &gt; 0"/>
  </action-attrs>

  <action-group name="action-partner-partner-type-select-change">
    <action name="action-partner-attrs-change-name"/>
    <action name="action-partner-empty-first-name"
      if="partnerTypeSelect != __repo__(Partner).PARTNER_TYPE_INDIVIDUAL"/>
  </action-group>

  <action-group name="action-group-partner-contact-onload">
    <action name="action-partner-attrs-hide-employee-panel"
      if="__config__.app.isApp('employee')"/>
    <action name="action-partner-method-check-name"/>
    <action name="action-partner-method-check-name-in-archive"/>
    <action name="action-partner-attrs-change-name"/>
    <action name="action-partner-method-set-social-network-url"/>
    <action name="action-partner-attrs-partner-seq-editable"/>
  </action-group>

  <action-group name="action-partner-group-unset-customer">
    <action name="action-partner-record-factor-supplier-customer-no-error"/>
    <action name="action-partner-attrs-unset-customer"/>
    <action name="action-partner-method-check-any-sale-order-attached"
      if="__config__.app.isApp('sale')"/>
    <action name="action-partner-method-check-any-invoice-client-sale-attached"
      if="__config__.app.isApp('invoice')"/>
    <action name="action-partner-method-check-any-receivable-move-line-attached"
      if="__config__.app.isApp('account')"/>
    <action name="action-partner-attrs-set-customer"/>
  </action-group>

  <action-group name="action-group-partner-registration-code-onChange">
    <action name="action-method-partner-check-registration-code"/>
    <action name="action-method-partner-registration-code-onChange"/>
  </action-group>

  <action-record name="action-partner-empty-first-name"
    model="com.axelor.apps.base.db.Partner">
    <field name="firstName" expr="eval: null"/>
  </action-record>

  <action-attrs name="action-partner-attrs-hide-contact-partner">
    <attribute name="hidden" for="contactPartner"
      expr="#{clientPartner != null &amp;&amp; clientPartner.partnerTypeSelect == 2}"/>
  </action-attrs>

  <action-attrs name="action-partner-attrs-unset-prospect">
    <attribute name="value" for="isProspect" expr="eval:false" if="isCustomer"/>
  </action-attrs>

  <action-attrs name="action-partner-attrs-unset-customer">
    <attribute name="value" for="isCustomer" expr="eval:false" if="isProspect"/>
  </action-attrs>

  <action-attrs name="action-partner-attrs-set-customer">
    <attribute name="value" for="isCustomer" expr="eval:true" if="customerCantBeRemoved"/>
  </action-attrs>

  <action-attrs name="action-partner-attrs-name-balance">
    <attribute name="title" for="$positiveBalanceBtn"
      expr="eval: com.axelor.i18n.I18n.get('Debit Balance')" if="balance &gt; 0"/>
    <attribute name="title" for="$positiveBalanceBtn"
      expr="eval: com.axelor.i18n.I18n.get('Credit Balance')" if="balance &lt; 0"/>
    <attribute name="title" for="$positiveBalanceBtn"
      expr="eval: com.axelor.i18n.I18n.get('Balance')" if="positiveBalanceBtn == 0"/>
  </action-attrs>

  <action-attrs name="action-partner-attrs-set-default">
    <attribute name="value:add"
      expr="call:com.axelor.apps.base.web.PartnerController:getActiveCompany()" for="companySet"/>
  </action-attrs>

  <action-attrs name="action-partner-attrs-set-domain">
    <attribute name="domain" for="partner"
      expr="eval: &quot; (self.isCustomer = true OR self.isSupplier = true OR self.isProspect = true) AND self.isEmployee = false &quot;"/>
  </action-attrs>

  <action-attrs name="action-partner-attrs-hide-customer-recovery">
    <attribute name="hidden" for="customerRecovery"
      expr="eval: accountingSituationList.every{accountingSituation -> accountingSituation.debtRecovery == null}"/>
  </action-attrs>

  <action-attrs name="action-partner-attrs-hide-employee-panel">
    <attribute name="hidden" for="employeePanel"
      expr="eval:!( __this__.employee != null &amp;&amp; __user__.employee != null  &amp;&amp;
		(__user__.employee.hrManager &amp;&amp;  __user__ == __this__.employee.managerUser))"/>
  </action-attrs>

  <action-record name="action-partner-record-set-balance"
    model="com.axelor.apps.base.db.Partner">
    <field name="$balance"
      expr="eval: accountingSituationList?.collect{
                    __config__.app.getApp('account').partnerBalConfigSelect == 3 ? it.balanceDueDebtRecoveryCustAccount
                    : __config__.app.getApp('account').partnerBalConfigSelect == 2 ? it.balanceDueCustAccount
                    : it.balanceCustAccount
                }.sum()"/>
  </action-record>

  <action-record name="action-partner-record-employee"
    model="com.axelor.apps.base.db.Partner">
    <field name="isEmployee" expr="eval: false" if="partnerTypeSelect == 1"/>
  </action-record>

  <action-record name="action-partner-record-invoices-copy-default-value"
    model="com.axelor.apps.base.db.Partner" if-module="axelor-account">
    <field name="invoicesCopySelect" expr="eval:1"
      if="isCustomer &amp;&amp; __config__.app.isApp('account')"/>
  </action-record>

  <action-record name="action-partner-record-partner-type-select"
    model="com.axelor.apps.base.db.Partner">
    <field name="partnerTypeSelect"
      expr="eval: __user__.activeCompany?.defaultPartnerTypeSelect"/>
  </action-record>

  <action-record name="action-partner-record-simple-and-full-name"
    model="com.axelor.apps.base.db.Partner">
    <field name="simpleFullName"
      expr="call:com.axelor.apps.base.service.PartnerService:computeSimpleFullName(__this__)"/>
    <field name="fullName"
      expr="call:com.axelor.apps.base.service.PartnerService:computeFullName(__this__)"/>
  </action-record>

  <action-record name="action-partner-record-set-default"
    model="com.axelor.apps.base.db.Partner">
    <field name="currency" expr="eval: __user__.activeCompany?.currency" if="#{!isContact}"/>
    <field name="invoiceSendingFormatSelect" expr="#{'emailpaper'}" if="#{!isContact}"/>
    <field name="user" expr="#{__user__}"/>
    <field name="team" expr="#{__user__.activeTeam}"/>
    <field name="localization"
      expr="eval: __config__.app.getApp('base')?.getDefaultPartnerLocalization()"/>
    <field name="isCustomer" expr="true"
      if="_isCustomer || (__user__?.activeCompany?.defaultPartnerCategorySelect == 1 &amp;&amp; !_isSupplier &amp;&amp; !_isCarrier &amp;&amp; !_isSubcontractor)"/>
    <field name="isSupplier" expr="true"
      if="_isSupplier || (__user__?.activeCompany?.defaultPartnerCategorySelect == 2 &amp;&amp; !_isCustomer &amp;&amp; !_isCarrier &amp;&amp; !_isSubcontractor)"/>
    <field name="isCarrier" expr="true" if="_isCarrier"/>
    <field name="isSubcontractor" expr="true" if="_isSubcontractor"/>
    <field name="partnerTypeSelect" expr="#{2}" if="created_from_user_id"/>
    <field name="agency" expr="eval:__user__.activeAgency"/>
  </action-record>

  <action-record name="action-partner-contact-record-default"
    model="com.axelor.apps.base.db.Partner">
    <field name="partnerTypeSelect" expr="#{2}"/>
    <field name="isContact" expr="#{true}"/>
    <field name="companySet" expr="#{__parent__.companySet}"/>
    <field name="localization"
      expr="eval: __parent__ != null ? __parent__.localization : __config__.app.getApp('base')?.getDefaultPartnerLocalization()"/>
    <field name="user" expr="#{__parent__.user}"
      if="#{__parent__ != null &amp;&amp; __parent__._model == 'com.axelor.apps.base.db.Partner'}"/>
    <field name="team" expr="#{__parent__.team}"
      if="#{__parent__ != null &amp;&amp; __parent__._model == 'com.axelor.apps.base.db.Partner'}"/>
    <field name="user" expr="#{__user__}"
      if="#{__parent__ == null || __parent__._model != 'com.axelor.apps.base.db.Partner'}"/>
    <field name="team" expr="#{__user__.activeTeam}"
      if="#{__parent__ == null || __parent__._model != 'com.axelor.apps.base.db.Partner'}"/>
    <field name="companySet" expr="eval: __repo__(Company).all().fetchOne()"
      if="!__config__.app.getApp('base')?.getEnableMultiCompany()"/>
    <field name="mainPartner" expr="eval: __parent__"
      if="#{__parent__ != null &amp;&amp; __parent__._model == 'com.axelor.apps.base.db.Partner'}"/>
  </action-record>

  <action-record name="action-partner-employee-record-default"
    model="com.axelor.apps.base.db.Partner">
    <field name="partnerTypeSelect" expr="#{2}"/>
    <field name="isContact" expr="#{false}"/>
    <field name="isEmployee" expr="#{true}"/>
    <field name="companySet" expr="#{__parent__.companySet}"/>
    <field name="localization"
      expr="eval: __parent__ != null ? __parent__.localization : __config__.app.getApp('base')?.getDefaultPartnerLocalization()"/>
    <field name="user" expr="#{__parent__.user}"
      if="#{__parent__ &amp;&amp; __parent__._model == 'com.axelor.apps.base.db.Partner'}"/>
    <field name="team" expr="#{__parent__.team}"
      if="#{__parent__ &amp;&amp; __parent__._model == 'com.axelor.apps.base.db.Partner'}"/>
    <field name="user" expr="#{__user__}"
      if="#{__parent__ == null || __parent__._model != 'com.axelor.apps.base.db.Partner'}"/>
    <field name="team" expr="#{__user__.activeTeam}"
      if="#{__parent__ == null || __parent__._model != 'com.axelor.apps.base.db.Partner'}"/>
    <field name="mainPartner" expr="#{__repo__(Partner).find(__parent__.id)}"
      if="#{__parent__ &amp;&amp; __parent__.id != null &amp;&amp; __parent__._model == 'com.axelor.apps.base.db.Partner'}"/>
  </action-record>

  <action-record name="action-record-set-supplier-quality-rating"
    model="com.axelor.apps.base.db.Partner">
    <field name="supplierQualityRating" expr="eval: supplierQualityRatingSelect"/>
  </action-record>

  <action-record name="action-partner-record-empty-freight-carrier-mode"
    model="com.axelor.apps.base.db.Partner">
    <field name="freightCarrierMode" expr="eval:null"/>
    <field name="carrierPartner" expr="eval:null"/>
  </action-record>

  <action-record name="action-partner-record-freight-carrier"
    model="com.axelor.apps.base.db.Partner">
    <field name="carrierPartner" expr="eval:freightCarrierMode?.carrierPartner"/>
  </action-record>

  <action-record name="action-partner-record-set-payment-modes"
    model="com.axelor.apps.base.db.Partner" if-module="axelor-account">
    <field name="inPaymentMode"
      expr="eval: __user__?.activeCompany?.accountConfig?.inPaymentMode"/>
    <field name="outPaymentMode"
      expr="eval: __user__?.activeCompany?.accountConfig?.outPaymentMode"/>
  </action-record>

  <action-record name="action-partner-record-payment-condition"
    model="com.axelor.apps.base.db.Partner" if-module="axelor-account">
    <field name="paymentCondition"
      expr="eval: __user__?.activeCompany?.accountConfig?.defPaymentCondition"/>
  </action-record>

  <action-method name="action-print-company-phonebook">
    <call class="com.axelor.apps.base.web.PartnerController" method="printCompanyPhonebook"/>
  </action-method>

  <action-method name="action-print-phonebook">
    <call class="com.axelor.apps.base.web.PartnerController" method="printContactPhonebook"/>
  </action-method>

  <action-method name="action-partner-method-view-sent-emails">
    <call class="com.axelor.apps.base.web.PartnerController" method="findSentMails"/>
  </action-method>

  <action-method name="action-partner-method-view-received-emails">
    <call class="com.axelor.apps.base.web.PartnerController" method="findReceivedMails"/>
  </action-method>

  <action-method name="action-partner-iban-check-on-save">
    <call class="com.axelor.apps.base.web.PartnerController" method="checkIbanValidity"/>
  </action-method>

  <action-method name="action-partner-method-show-on-map">
    <call class="com.axelor.apps.base.web.PartnerController" method="showPartnerOnMap"/>
  </action-method>

  <action-method name="action-method-partner-registration-code-onChange">
    <call class="com.axelor.apps.base.web.PartnerController" method="modifyRegistrationCode"/>
  </action-method>

  <action-method name="action-method-partner-check-registration-code">
    <call class="com.axelor.apps.base.web.PartnerController" method="checkRegistrationCode"/>
  </action-method>

  <action-method name="action-partner-method-set-positive-balance">
    <call class="com.axelor.apps.base.web.PartnerController" method="setPositiveBalance"/>
  </action-method>

  <action-view name="action-contact-partner-dashlet" title="Partners"
    model="com.axelor.apps.base.db.Partner">
    <view type="grid" name="partner-grid"/>
    <view type="form" name="partner-form"/>
    <domain>self.contactPartnerSet.id = :_contactId</domain>
    <context name="_contactId" expr="eval: id"/>
  </action-view>

  <action-view name="action-partner-view-show-move-lines" title="Move lines"
    model="com.axelor.apps.account.db.MoveLine">
    <view type="grid" name="move-line-grid"/>
    <view type="form" name="move-line-form"/>
    <domain>self.partner.id = :partnerId AND self.account.useForPartnerBalance = true</domain>
    <context name="partnerId" expr="eval: id"/>
  </action-view>

  <action-view name="action-partner-view-open-employee-form"
    model="com.axelor.apps.hr.db.Employee" title="Employee">
    <view name="employee-form" type="form"/>
    <view name="employee-grid" type="grid"/>
    <context name="_showRecord" expr="eval:employee.id"/>
  </action-view>

  <action-method name="action-convert-into-individual-partner">
    <call class="com.axelor.apps.base.web.PartnerController"
      method="convertToIndividualPartner"/>
  </action-method>

  <action-record name="action-partner-record-unset-factor"
    model="com.axelor.apps.base.db.Partner">
    <field name="isFactor" expr="eval: false" if="__config__.app.isApp('account')"/>
  </action-record>

  <action-record name="action-partner-record-set-factor"
    model="com.axelor.apps.base.db.Partner">
    <field name="isProspect" expr="eval: false"/>
    <field name="isEmployee" expr="eval: false"/>
    <field name="isCustomer" expr="eval: false"/>
    <field name="isSupplier" expr="eval: false"/>
    <field name="isCarrier" expr="eval: false"/>
    <field name="isThirdPartyPayer" expr="eval: false" if="__config__.app.isApp('account')"/>
  </action-record>

  <action-validate name="action-partner-validate-partner-stock-settings-list">
    <alert message="Partner has duplicate stock settings for same company"
      if="partnerStockSettingsList != null &amp;&amp; partnerStockSettingsList.collect{it->it.company}.unique().size() &lt; partnerStockSettingsList.size"/>
  </action-validate>

  <action-attrs name="action-partner-attrs-user-group" if-module="axelor-crm">
    <attribute name="domain" for="user"
      expr="eval: &quot;self.group IN (${__config__.app.getApp('crm')?.groupsAssignable?.collect{it.id}.join(',')})&quot;"
      if="__config__.app.getApp('crm')?.assignableUsers == 1"/>
  </action-attrs>


  <action-view name="action-partner-view-subsidiary-partners" title="Subsidiaries"
    model="com.axelor.apps.base.db.Partner">
    <view type="grid" name="partner-grid"/>
    <view type="form" name="partner-form"/>
    <domain>self.parentPartner = :id</domain>
  </action-view>

  <action-record name="action-record-base-partner-set-business-card"
    model="com.axelor.apps.base.db.Partner">
    <field name="functionBusinessCard" expr="eval: jobTitleFunction.name"
      if="jobTitleFunction != null"/>
  </action-record>

  <search-filters name="partner-filters" model="com.axelor.apps.base.db.Partner"
    title="Partner filters">
    <field name="companySet" hidden="true"
      if="!__config__.app.getApp('base')?.getEnableMultiCompany()"/>
    <field name="isFactor" hidden="true"
      if="!(__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.manageFactors)"/>
    <field name="sellerCode" hidden="true"
      if="!(__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.getManageFactors())"/>
    <field name="team" hidden="true" if="!__config__.app.getApp('base')?.getTeamManagement()"/>
    <field name="password" hidden="true"
      if="!(__config__.app.isApp('portal') &amp;&amp; __config__.app.getApp('portal')?.getPortalSelect() == 2)"/>
    <field name="factorizedCustomer" hidden="true"
      if="!(__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.getManageFactors())"/>
    <field name="customerCatalogList" hidden="true"
      if="!(__config__.app.isApp('sale') &amp;&amp; __config__.app.getApp('sale')?.getEnableCustomerCatalogMgt())"/>
    <field name="supplierCatalogList" hidden="true"
      if="!(__config__.app.isApp('purchase') &amp;&amp; __config__.app.getApp('purchase')?.getManageSupplierCatalog())"/>
    <field name="paymentDelay" hidden="true" if="!__config__.app.isApp('cash-management')"/>
    <field name="invoiceComments" hidden="true" if="!__config__.app.isApp('invoice')"/>
    <field name="accountingSituationList" hidden="true" if="!__config__.app.isApp('account')"/>
    <field name="saleOrderInformation" hidden="true" if="!__config__.app.isApp('sale')"/>
    <field name="payerQuality" hidden="true" if="!__config__.app.isApp('account')"/>
    <field name="salePartnerPriceList" hidden="true" if="!__config__.app.isApp('sale')"/>
    <field name="chargeBackPurchaseSelect" hidden="true"
      if="!__config__.app.isApp('business-project')"/>
    <field name="chargeBackPurchase" hidden="true"
      if="!__config__.app.isApp('business-project')"/>
    <field name="saleOrderComments" hidden="true" if="!__config__.app.isApp('sale')"/>
    <field name="purchaseOrderInformation" hidden="true"
      if="!__config__.app.isApp('purchase')"/>
    <field name="purchasePartnerPriceList" hidden="true"
      if="!__config__.app.isApp('purchase')"/>
    <field name="supplierQualityRatingSelect" hidden="true"
      if="!__config__.app.isApp('purchase')"/>
    <field name="supplierArrivalProductQty" hidden="true"
      if="!__config__.app.isApp('purchase')"/>
    <field name="partnerProductQualityRatingList" hidden="true"
      if="!__config__.app.isApp('purchase')"/>
    <field name="purchaseOrderComments" hidden="true" if="!__config__.app.isApp('purchase')"/>
    <field name="deliveryDelay" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="shipmentMode" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="freightCarrierMode" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="carrierPartner" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="isIspmRequired" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="isNeedingConformityCertificate" hidden="true"
      if="!__config__.app.isApp('stock')"/>
    <field name="partnerStockSettingsList" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="deliveryComments" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="pickingOrderComments" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="partnerAddressList" hidden="true"/>
    <field name="mainAddress" title="Main address"/>
    <field name="isContact" title="Is a contact"/>
    <field name="simpleFullName" hidden="true"/>
    <field name="isCarrier" title="Is a carrier" hidden="true"
      if="!__config__.app.isApp('stock')"/>
    <filter name="partner-filters-all-enterprises" title="All Enterprises">
      <domain>self.partnerTypeSelect = 1 AND self.isContact = false</domain>
    </filter>
    <filter name="partner-filters-all-individuals" title="All Individuals">
      <domain>self.partnerTypeSelect = 2 AND self.isContact = false</domain>
    </filter>
    <filter name="partner-filters-all-prospects" title="All Prospects">
      <domain>self.isProspect = true AND self.isContact = false</domain>
    </filter>
    <filter name="partner-filters-all-clients" title="All Clients">
      <domain>self.isCustomer = true AND self.isContact = false</domain>
    </filter>
    <filter name="partner-filters-all-suppliers" title="All Suppliers">
      <domain>self.isSupplier = true AND self.isContact = false</domain>
    </filter>
    <filter name="partner-filters-all-employees" title="All Employees">
      <domain>self.isEmployee = true AND self.isContact = false</domain>
    </filter>
  </search-filters>

  <search-filters name="contact-filters" model="com.axelor.apps.base.db.Partner"
    title="Contact filters">
    <field name="companySet" hidden="true"
      if="!__config__.app.getApp('base')?.getEnableMultiCompany()"/>
    <field name="isFactor" hidden="true"
      if="!(__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.manageFactors)"/>
    <field name="sellerCode" hidden="true"
      if="!(__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.getManageFactors())"/>
    <field name="team" hidden="true" if="!__config__.app.getApp('base')?.getTeamManagement()"/>
    <field name="password" hidden="true"
      if="!(__config__.app.isApp('portal') &amp;&amp; __config__.app.getApp('portal')?.getPortalSelect() == 2)"/>
    <field name="factorizedCustomer" hidden="true"
      if="!(__config__.app.isApp('account') &amp;&amp; __config__.app.getApp('account')?.getManageFactors())"/>
    <field name="customerCatalogList" hidden="true"
      if="!(__config__.app.isApp('sale') &amp;&amp; __config__.app.getApp('sale')?.getEnableCustomerCatalogMgt())"/>
    <field name="supplierCatalogList" hidden="true"
      if="!(__config__.app.isApp('purchase') &amp;&amp; __config__.app.getApp('purchase')?.getManageSupplierCatalog())"/>
    <field name="paymentDelay" hidden="true" if="!__config__.app.isApp('cash-management')"/>
    <field name="invoiceComments" hidden="true" if="!__config__.app.isApp('invoice')"/>
    <field name="accountingSituationList" hidden="true" if="!__config__.app.isApp('account')"/>
    <field name="saleOrderInformation" hidden="true" if="!__config__.app.isApp('sale')"/>
    <field name="payerQuality" hidden="true" if="!__config__.app.isApp('account')"/>
    <field name="salePartnerPriceList" hidden="true" if="!__config__.app.isApp('sale')"/>
    <field name="chargeBackPurchaseSelect" hidden="true"
      if="!__config__.app.isApp('business-project')"/>
    <field name="chargeBackPurchase" hidden="true"
      if="!__config__.app.isApp('business-project')"/>
    <field name="saleOrderComments" hidden="true" if="!__config__.app.isApp('sale')"/>
    <field name="purchaseOrderInformation" hidden="true"
      if="!__config__.app.isApp('purchase')"/>
    <field name="purchasePartnerPriceList" hidden="true"
      if="!__config__.app.isApp('purchase')"/>
    <field name="supplierQualityRatingSelect" hidden="true"
      if="!__config__.app.isApp('purchase')"/>
    <field name="supplierArrivalProductQty" hidden="true"
      if="!__config__.app.isApp('purchase')"/>
    <field name="partnerProductQualityRatingList" hidden="true"
      if="!__config__.app.isApp('purchase')"/>
    <field name="purchaseOrderComments" hidden="true" if="!__config__.app.isApp('purchase')"/>
    <field name="deliveryDelay" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="shipmentMode" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="freightCarrierMode" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="carrierPartner" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="isIspmRequired" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="isNeedingConformityCertificate" hidden="true"
      if="!__config__.app.isApp('stock')"/>
    <field name="partnerStockSettingsList" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="deliveryComments" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="pickingOrderComments" hidden="true" if="!__config__.app.isApp('stock')"/>
    <field name="partnerAddressList" hidden="true"/>
    <field name="mainAddress" title="Main address"/>
    <field name="isContact" title="Is a contact"/>
    <field name="simpleFullName" hidden="true"/>
    <field name="isCarrier" title="Is a carrier" hidden="true"
      if="!__config__.app.isApp('stock')"/>
    <filter name="contact-filters-all-prospects-clients" title="All prospects and clients">
      <domain>self.mainPartner.isProspect = true OR self.mainPartner.isCustomer = true</domain>
    </filter>
    <filter name="contact-filters-all-prospects" title="All prospects">
      <domain>self.mainPartner.isProspect = true</domain>
    </filter>
    <filter name="contact-filters-all-clients" title="All clients">
      <domain>self.mainPartner.isCustomer = true</domain>
    </filter>
    <filter name="contact-filters-all-supplier" title="All suppliers">
      <domain>self.isSupplier = true</domain>
    </filter>
  </search-filters>

  <action-attrs name="action-attrs-update-manually-blocked-account">
    <attribute name="value" for="hasManuallyBlockedAccount" expr="eval: hasBlockedAccount"/>
  </action-attrs>

  <action-view name="action-partner-view-customer-situation-filters"
    title="Customer situation filters" model="com.axelor.apps.base.db.Partner">
    <view name="popup-customer-situation-form" type="form"/>
    <view-param name="popup" value="true"/>
    <view-param name="popup-save" value="false"/>
    <view-param name="show-toolbar" value="false"/>
    <view-param name="show-confirm" value="false"/>
    <view-param name="forceEdit" value="true"/>
    <context name="_showRecord" expr="eval: id"/>
  </action-view>

  <action-attrs name="action-attrs-customer-situation-popup-on-load">
    <attribute name="hidden" for="$company"
      expr="eval: __repo__(Company).all().count() == 1"/>
  </action-attrs>

  <action-attrs name="action-partner-attrs-set-partner-tag-domain">
    <attribute name="domain" for="tagSet"
      expr="eval: &quot; (${__repo__(MetaModel).findByName('Partner')?.id} MEMBER OF self.concernedModelSet OR self.concernedModelSet IS EMPTY) AND (self.companySet IS EMPTY OR EXISTS(SELECT 1 FROM Company c WHERE c MEMBER OF self.companySet AND c.id IN (${(companySet?.collect{it.id}+[0]).join(',')}))) &quot;"/>
  </action-attrs>

  <action-view name="action-partner-view-related-projects" title="Projects"
    model="com.axelor.apps.project.db.Project">
    <view type="grid" name="project-grid"/>
    <view type="form" name="business-project-form"/>
    <domain>self.clientPartner = :id</domain>
  </action-view>

  <action-view name="action-partner-view-related-invoicing-projects"
    title="Invoicing projects" model="com.axelor.apps.businessproject.db.InvoicingProject">
    <view type="grid" name="invoicing-project-grid"/>
    <view type="form" name="invoicing-project-form"/>
    <domain>self.project.clientPartner = :id</domain>
  </action-view>

  <action-view name="action-partner-view-wizard-api-sirene-configuration"
    title="Sirene API call" model="com.axelor.utils.db.Wizard">
    <view type="form" name="partner-api-sirene-configuration-wizard-form"/>
    <view-param name="popup" value="reload"/>
    <view-param name="forceEdit" value="true"/>
    <view-param name="show-confirm" value="false"/>
    <view-param name="show-toolbar" value="false"/>
    <view-param name="popup-save" value="false"/>
    <context name="_parentSiret" expr="eval: __this__.registrationCode"/>
  </action-view>

</object-views>
