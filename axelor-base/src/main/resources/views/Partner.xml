<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_4.0.xsd">
    
    <grid name="partner-grid" title="Partners" model="com.axelor.apps.base.db.Partner" orderBy="name">
	    <toolbar>
	        <button name="printPhoneBook" title="PhoneBook" icon="fa-print" onClick="action-print-phonebook"/>
	        <button name="printCompanyPhoneBook" title="Company phoneBook" icon="fa-print" onClick="action-print-compnay-phonebook"/>
	        <button name="checkDuplicate" title="Check Duplicate" onClick="action-general-method-show-duplicate"/>
	    </toolbar>
	    <field name="fullName"/>
	    <field name="fixedPhone"/>
		<field name="emailAddress.address"/>
	    <field name="partnerCategory" grid-view="partner-category-grid" form-view="partner-category-form"/>
		<button name="logCall" title="Log Call"   icon="fa-phone" help="Log Call" onClick="action-partner-view-create-call"  if-module="axelor-crm"/>
		<button name="scheduleMeeting" title="Schedule Meeting"   help="Schedule Meeting" icon="fa-group" onClick="action-partner-view-create-meeting" if-module="axelor-crm"/>
		<button name="sendByEmail" title="Send Email"   help="Send Email" icon="fa-envelope" onClick="action-send-by-email-with-template" if-module="axelor-crm"/>
	</grid>
	
	<grid name="partner-customer-grid" title="Customers" model="com.axelor.apps.base.db.Partner" orderBy="name">
	    <toolbar>
	        <button name="printPhoneBook" title="PhoneBook" icon="fa-print" onClick="action-print-phonebook"/>
	        <button name="printCompanyPhoneBook" title="Company phoneBook" icon="fa-print" onClick="action-print-compnay-phonebook"/>
	        <button name="checkDuplicate" title="Check Duplicate" onClick="action-general-method-show-duplicate"/>
	    </toolbar>
	    <field name="fullName"/>
	    <field name="fixedPhone"/>
		<field name="emailAddress.address" placeholder="whatever@example.com"/>
	    <field name="partnerCategory" grid-view="partner-category-grid" form-view="partner-category-form"/>
		<button name="logCall" title="Log Call"   icon="fa-phone" help="Log Call" onClick="action-partner-view-create-call"  if-module="axelor-crm"/>
		<button name="scheduleMeeting" title="Schedule Meeting"   help="Schedule Meeting" icon="fa-group" onClick="action-partner-view-create-meeting" if-module="axelor-crm"/>
		<button name="sendByEmail" title="Send Email"   help="Send Email" icon="fa-envelope" onClick="action-send-by-email-with-template" if-module="axelor-crm"/>
	</grid>
	
	<grid name="partner-supplier-grid" title="Suppliers" model="com.axelor.apps.base.db.Partner" orderBy="name">
	    <toolbar>
	        <button name="printPhoneBook" title="PhoneBook" icon="fa-print" onClick="action-print-phonebook"/>
	        <button name="printCompanyPhoneBook" title="Company phoneBook" icon="fa-print" onClick="action-print-compnay-phonebook"/>
	        <button name="checkDuplicate" title="Check Duplicate" onClick="action-general-method-show-duplicate"/>
	    </toolbar>
	    <field name="fullName"/>
	    <field name="fixedPhone"/>
		<field name="emailAddress.address" placeholder="whatever@example.com"/>
	    <field name="partnerCategory" grid-view="partner-category-grid" form-view="partner-category-form"/>
		<button name="logCall" title="Log Call"   icon="fa-phone" help="Log Call" onClick="action-partner-view-create-call"  if-module="axelor-crm"/>
		<button name="scheduleMeeting" title="Schedule Meeting"   help="Schedule Meeting" icon="fa-group" onClick="action-partner-view-create-meeting" if-module="axelor-crm"/>
		<button name="sendByEmail" title="Send Email"   help="Send Email" icon="fa-envelope" onClick="action-send-by-email-with-template" if-module="axelor-crm"/>
	</grid>
    
    <grid name="partner-contact-grid" title="Contacts" model="com.axelor.apps.base.db.Partner">
	    <field name="fullName"/>
	    <field name="fixedPhone"/>
	    <field name="mobilePhone"/>
	    <field name="emailAddress.address" placeholder="whatever@example.com"/>
	    <button name="logCall" title="Log Call" icon="fa-phone" help="Log Call" onClick="action-partner-view-create-call" if-module="axelor-crm"/>
		<button name="scheduleMeeting" title="Schedule Meeting"   help="Schedule Meeting" icon="fa-group" onClick="action-partner-view-create-meeting" if-module="axelor-crm"/>
		<button name="sendByEmail" title="Send Email"   help="Send Email" icon="fa-envelope" onClick="action-send-by-email-with-template" if-module="axelor-crm"/>
	</grid>
    
     <grid name="partner-grid-group" title="Partner" model="com.axelor.apps.base.db.Partner" groupBy="user">
        <field name="fullName"/>
        <field name="fixedPhone"/>
		<field name="mobilePhone"/>
        <field name="emailAddress.address"/>
        <field name="user" form-view="user-form" grid-view="user-grid"/>
    </grid>
    
     <form name="partner-customer-form"  title="Customer" model="com.axelor.apps.base.db.Partner"    
    onNew="action-group-base-partner-onnew" 
    onLoad="action-group-partner-onload" width="large" canCopy="false">
    	<panel-include view="partner-form" from="axelor-base"/>
    </form>
    
    <form name="partner-supplier-form"  title="Supplier" model="com.axelor.apps.base.db.Partner"    
    onNew="action-group-base-partner-onnew" 
    onLoad="action-group-partner-onload" width="large" canCopy="false">
    	<panel-include view="partner-form" from="axelor-base"/>
    </form>
    
    <form name="partner-form"  title="Partner" model="com.axelor.apps.base.db.Partner"    
    onNew="action-group-base-partner-onnew" 
    onLoad="action-group-partner-onload" 
    onSave="action-partner-iban-check-on-save" width="large" canCopy="false">
	    <toolbar>
	        <button name="sendByEmail" title="Send email" icon="fa-envelope" onClick="save,action-send-by-email-with-template" readonlyIf="id == null" if-module="axelor-message"/>
	        <button name="showPartnerInfo" title="Print Informations" icon="fa-print" onClick="save,action-partner-method-show-partner-info" readonlyIf="id == null"/>
	        <button name="showClientSituationForm" title="Client Situation" icon="fa-print" onClick="save,action-partner-method-show-client-situation" showIf="isContact == false" readonlyIf="id == null" if-module="axelor-account"/>
	    </toolbar>
	    <panel-include view="incl-event-actions-partner-form" from="axelor-crm" />
	    <panel name="main" >
	    	<panel colSpan="3">
	        	<field name="picture" showTitle="false" widget="Image" colSpan="12"/>
	        	<panel colSpan="8" showIf="fullName != null">
				    <label name="google" title="&lt;a class='fa fa-google-plus' href='http://www.google.com' target='_blank' /&gt;" colSpan="2"/>
				    <label name="facebook" title="&lt;a class='fa fa-facebook' href='http://www.facebook.com' target='_blank' /&gt;" colSpan="2"/>
				    <label name="twitter" title="&lt;a class='fa fa-twitter' href='http://www.twitter.com' target='_blank' /&gt;" colSpan="2"/>
				    <label name="linkedin" title="&lt;a class='fa fa-linkedin' href='http://www.linkedin.com' target='_blank' /&gt;" colSpan="2"/>
				    <label name="youtube" title="&lt;a class='fa fa-youtube' href='http://www.youtube.com' target='_blank' /&gt;" colSpan="2"/>
				</panel>
	      	</panel>
	      	<panel colSpan="9">
	      	<field name="fullName" colSpan="9" showTitle="false">
	      		<hilite strong="true" if="true" color="primary"/>        
		        <editor x-show-titles="false">
		            <field name="partnerTypeSelect" showTitle="false" onChange="action-partner-attrs-change-name,action-partner-method-set-social-network-url" colSpan="4"/>
		            <spacer colSpan="8"/>
		            <field name="name" showTitle="false" css="highlight" placeholder="Name" x-bind="{{code|uppercase}}" onChange="action-partner-record-full-name,action-partner-method-set-social-network-url" colSpan="4"/>
		            <field name="firstName" showTitle="false" hideIf="partnerTypeSelect != 2" x-bind="{{code|uppercase}}" css="highlight" placeholder="First name" onChange="action-partner-record-full-name,action-partner-method-set-social-network-url" colSpan="3"/>            
		            <field name="titleSelect" showTitle="false" hideIf="partnerTypeSelect != 2" placeholder="Civility" colSpan="2"/>
		        </editor>
		    </field>
			<field name="isContact" hidden="true" colSpan="12" />
		</panel>
  		</panel>
  		<panel-related field="contactPartnerSet" hideIf="isContact || partnerTypeSelect == 2" domain="self.isContact = 'true'" form-view="partner-contact-form" grid-view="partner-contact-grid" />
  		<panel-tabs>
  			<panel name="information" title="Informations">
				<panel hideIf="isContact" colSpan="12">
					<field name="isCustomer"/>
					<field name="hasOrdered" showIf="isCustomer"/>
					<field name="isSupplier"/>
				</panel>
				<panel name="postalAddresses" title="Postal addresses" colSpan="12">
					<field name="partnerAddressList" colSpan="12" onChange="action-partner-address-list-change" x-can-reload="true" >
				        <editor layout="table" x-show-titles="false" >
				        	<label title="The following address is invalid. Please use '+' button to create a new one :" colSpan="12" css="label-bold" name="addressHelper" hidden="true" showIf="address == null || address.addressL4 == null" />
            				<field name="address.addressL4" hidden="true" colSpan="12"/>
							<field name="address" colSpan="3" canNew="true"/>
							<field name="isInvoicingAddr" widget="toggle" x-icon="fa-list-alt" colSpan="1" hideIf="$readonly()"/>
							<field name="isDeliveryAddr" widget="toggle" x-icon="fa-shopping-cart" colSpan="1" hideIf="$readonly()" />
							<field name="isDefaultAddr" widget="toggle" x-icon="fa-star-o" colSpan="1" hideIf="$readonly()"  x-can-reload="true" onChange="action-partner-address-set-default"/>
				        </editor>
					</field>
					<field name="deliveryDelay" showIf="isSupplier"/>
				</panel>
				<panel name="generalContactDetails" title="General contact details" colSpan="12">
					<field name="fixedPhone" colSpan="3" placeholder="+33100000000" pattern="^\+?(?:[0-9]{2,3}(?:\s|\.)?){3,6}[0-9]{2,3}$" onChange="action-partner-record-normalize-fixed-phone-number"/>
					<field name="fax" colSpan="3" pattern="^\+?(?:[0-9]{2,3}(?:\s|\.)?){3,6}[0-9]{2,3}$" placeholder="+33000000000" onChange="action-partner-record-normalize-fax-phone-number"/>
					<field name="mobilePhone" colSpan="3" hideIf="partnerTypeSelect == 1" placeholder="+33100000000" pattern="^\+?(?:[0-9]{2,3}(?:\s|\.)?){3,6}[0-9]{2,3}$" onChange="action-partner-record-normalize-mobile-phone-number"/>
					<field name="emailAddress" canSelect="false" colSpan="6" form-view="email-address-simple-form" x-show-icons="false">
						<editor x-show-titles="false">
							<field name="address" colSpan="12" placeholder="whatever@example.com" pattern="^[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[a-z]{2,})$"/>
						</editor>
					</field>
					<field name="webSite" placeholder="www.url.com" pattern="([^\s]+\.[^\s]+\.[^\s]{2,})"/>
				</panel>
				<panel name="partnerDetails" title="Partner Details" hideIf="partnerTypeSelect == 2" colSpan="12" >
					<panel colSpan="6">
						<field name="partnerCategory" widget="SuggestBox" colSpan="6" form-view="partner-category-form" grid-view="partner-category-grid"/>
						<field name="industrySector" colSpan="6" widget="SuggestBox"/>
						<field name="source" colSpan="6" form-view="source-form" grid-view="source-grid"/>
						<field name="department" colSpan="6"/>
					</panel>
					<panel  colSpan="6">
						<field name="saleTurnover" colSpan="6"/>
						<field name="nbrEmployees" colSpan="6"/>
						<field name="registrationCode" colSpan="6"/>
						<field name="taxNbr" colSpan="6"/>
						<field name="paymentDelay" if-module="axelor-cash-management"/>
						<field name="parentPartner" hideIf="partnerTypeSelect != 1" domain="self.isContact = false AND self.partnerTypeSelect = 1" colSpan="6" form-view="partner-form"  grid-view="partner-grid"/>
					</panel>
		      	</panel>
		      	<panel name="settings" title="Settings" colSpan="12">
					<field name="partnerSeq" colSpan="6"/>
					<field name="languageSelect" colSpan="6"/>
					<panel title="Assigned to" colSpan="12">
						<field name="user" colSpan="6" form-view="user-form" grid-view="user-grid"/>
						<field name="team" colSpan="6" form-view="team-form" grid-view="team-grid" if="__config__.general.getTeamManagement()"/>
						<field name="companySet" colSpan="12" widget="TagSelect" onChange="action-partner-method-generate-customer-credit-line" canNew="false" form-view="company-form" grid-view="company-grid"/>
					</panel>
				</panel>
				<panel name="notes" title="Notes" colSpan="12">
					<field name="description" colSpan="12" height="8" showTitle="false"/>
				</panel>
	    	</panel>
			<panel name="payment" title="Invoicing/Payment" hideIf="isContact" if-module="axelor-account" colSpan="12" >
				<panel if-module="axelor-cash-management" if="__config__.general.getManageMultiBanks()">
					<field name="bankDetails"/>
				</panel>
		    	<panel-include view="incl-invoice-payment-partner-form" from="axelor-account"/>
				<panel-include if-module="axelor-account" if="__config__.general.getManageDirectDebitPayment()"  view="incl-sepa-direct-debit-partner-form" from="axelor-account"/>
		    </panel>
			<panel name="balance" title="Accounting balance" hideIf="isContact" if-module="axelor-account" colSpan="12">
				<panel-include if-module="axelor-account" view="incl-customer-balance-partner-form" from="axelor-account" />
				<panel-include if-module="axelor-account" view="incl-reported-balance-partner-form" from="axelor-account" />
			</panel>
			
			<panel-include if-module="axelor-account" view="incl-blocking-partner-form" from="axelor-account" />
			<panel name="activities" title="Activities" showIf="id != null" if-module="axelor-crm" onTabSelect="action-partner-method-view-emails">
				<panel-include if-module="axelor-organisation" view="incl-show-project-partner-form" from="axelor-organisation"/>
		        <panel-include view="incl-activities-partner-form" from="axelor-crm" />
		        <panel-include if-module="axelor-supplychain" view="incl-sales-partner-form" from="axelor-supplychain"/>
		        <field name="$emailsList" colSpan="12" type="many-to-many" target="com.axelor.apps.message.db.Message" title="Emails" canNew="false" canSelect="false" canRemove="false"/>
			</panel>
			<panel name="customerCredit" title="Customer Credit" if-module="axelor-supplychain" colSpan="12" hideIf="isContact || !isCustomer" if="__config__.general.getManageCustomerCredit()">
				<panel-include if-module="axelor-supplychain" view="incl-customer-credit-partner-form" from="axelor-supplychain" />
			</panel>
			<panel name="saleOrder" title="Sale Order" if-module="axelor-sale" showIf="isCustomer">
				<field name="saleOrderInformation" colSpan="12"/>
			</panel>
			<panel name="purchaseOrder" title="Purchase Order" if-module="axelor-purchase" showIf="isSupplier">
				<field name="purchaseOrderInformation" colSpan="12"/>
			</panel>
			<panel name="clientPortalAccess" title="Client portal access" if-module="axelor-client-portal" if="__config__.general.getClientPortalManagement()">
				<field name="password" widget="password"/>
			</panel>
		</panel-tabs>
	</form>
	
	<grid name="partner-light-grid" title="Contacts" model="com.axelor.apps.base.db.Partner">
        <field name="fullName"/>
        <field name="fixedPhone"/>
		<field name="mobilePhone"/>
        <field name="email"/>
    </grid>
    
    <form name="partner-light-form" title="Partner" model="com.axelor.apps.base.db.Partner"
	    onNew="action-group-base-partner-onnew" 
    	onLoad="action-group-partner-onload" width="large" canCopy="false">
	    <toolbar>
    		<button name="sendByEmail" title="Send email" onClick="save,action-send-by-email-with-template"   readonlyIf="id == null"/>
    	</toolbar>
	    <panel name="main" >
	        <field name="picture" widget="Image" colSpan="4"/>
		    <panel colSpan="8">
		        <field name="titleSelect" hideIf="partnerTypeSelect != 2" css="highlight" />
		        <spacer/>
		        <field name="name" css="highlight" onChange="action-partner-record-full-name"/>
		        <field name="firstName" hideIf="partnerTypeSelect != 2" css="highlight" onChange="action-partner-record-full-name"/>
		        <field name="partnerCategory" widget="SuggestBox"/>
		        <field name="partnerTypeSelect" onChange="action-partner-attrs-change-name"/>
		        <field name="isContact" hideIf="partnerTypeSelect != 2"/>
		        <spacer/>
		        <field name="mainPartner" hideIf="!isContact" form-view="partner-form" grid-view="partner-grid"/>
		    </panel>
		</panel>
	    <panel-tabs>
	        <panel name="information" title="Informations">
	            <panel title="Partner details" colSpan="12"  hideIf="partnerTypeSelect == 2">
	                <field name="department" form-view="department-form" grid-view="department-grid"/>
	                <field name="source" hideIf="isContact" form-view="source-form" grid-view="source-grid"/>
	            </panel>
	            <panel colSpan="12" name="postalAddresses" title="Postal addresses" hideIf="isContact">
	                <field name="partnerAddressList" colSpan="12" onChange="action-partner-address-list-change">
				        <editor layout="table" x-show-titles="false">
							<field name="address" canNew="true"/>
							<field name="isInvoicingAddr" widget="toggle" x-icon="fa-list-alt" colSpan="1"/>
							<field name="isDeliveryAddr" widget="toggle" x-icon="fa-shopping-cart" colSpan="1"/>
							<field name="isDefaultAddr" widget="toggle" x-icon="fa-star-o" colSpan="1"/>
				        </editor>
					</field>
	            </panel>
	            <panel name="contact" title="Contact" colSpan="12">
	                <field name="emailAddress" canSelect="false" form-view="email-address-simple-form" x-show-icons="false" placeholder="whatever@example.com" pattern="^[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[a-z]{2,})$">
						<editor x-show-titles="false">
							<field name="address"/>
						</editor>
					</field>
	                <field name="fax" pattern="^\+?(?:[0-9]{2,3}(?:\s|\.)?){3,6}[0-9]{2,3}$" placeholder="+33000000000" onChange="action-partner-record-normalize-fax-phone-number"/>
	                <field name="fixedPhone" placeholder="+33100000000" pattern="^\+?(?:[0-9]{2,3}(?:\s|\.)?){3,6}[0-9]{2,3}$" onChange="action-partner-record-normalize-fixed-phone-number"/>
					<field name="mobilePhone" placeholder="+33100000000" pattern="^\+?(?:[0-9]{2,3}(?:\s|\.)?){3,6}[0-9]{2,3}$" onChange="action-partner-record-normalize-mobile-phone-number"/>
	                <field name="webSite"/>
	            </panel>
	       </panel>
	    </panel-tabs>
    </form>
	

	<form name="partner-contact-form" title="Contact" model="com.axelor.apps.base.db.Partner" 
	onNew="action-partner-contact-record-default" 
	onLoad="action-partner-attrs-change-name,action-partner-method-set-social-network-url" onSave="save,action-partner-method-set-user-partner" canCopy="false">
	    <toolbar>
	        <button name="sendByEmail" title="Send email" icon="fa-envelope" onClick="save,action-send-by-email-with-template" readonlyIf="id == null"/>
	        <button name="showPartnerInfo" title="Print Informations" icon="fa-print" onClick="save,action-partner-method-show-partner-info"  readonlyIf="id == null"/>
	        <button name="showClientSituationForm" title="Client Situation" icon="fa-print" onClick="save,action-partner-method-show-client-situation" showIf="isContact == false"  readonlyIf="id == null" if-module="axelor-account"/>
	    </toolbar>
	    <panel-include view="incl-event-actions-partner-form" from="axelor-crm" />
	    <panel name="main" >
	    	<panel colSpan="3">
	    		<field name="picture" widget="Image" showTitle="false" colSpan="12"/>
	    		<panel colSpan="12">
	           		<label name="google" title="&lt;a class='fa fa-google-plus' href='http://www.google.com' target='_blank' /&gt;" colSpan="2"/>
				    <label name="facebook" title="&lt;a class='fa fa-facebook' href='http://www.facebook.com' target='_blank' /&gt;" colSpan="2"/>
				    <label name="twitter" title="&lt;a class='fa fa-twitter' href='http://www.twitter.com' target='_blank' /&gt;" colSpan="2"/>
				    <label name="linkedin" title="&lt;a class='fa fa-linkedin' href='http://www.linkedin.com' target='_blank' /&gt;" colSpan="2"/>
				    <label name="youtube" title="&lt;a class='fa fa-youtube' href='http://www.youtube.com' target='_blank' /&gt;" colSpan="2"/>
	        	</panel>
	      	</panel>
	        <panel colSpan="9">
	            <field name="titleSelect" showTitle="false" placeholder="Civility" colSpan="2" />
	            <field name="name" showTitle="false" css="highlight" placeholder="Name" x-bind="{{code|uppercase}}"  onChange="action-partner-record-full-name,action-partner-method-set-social-network-url" colSpan="5" />
	            <field name="firstName" showTitle="false" css="highlight" placeholder="First name" x-bind="{{code|uppercase}}" onChange="action-partner-record-full-name,action-partner-method-set-social-network-url" colSpan="5" />
	            <panel name="company" title="Company" colSpan="12" >
	            	<field name="mainPartner" domain="self.isContact = false" form-view="partner-form" grid-view="partner-grid"/>
	           	</panel>
	           	<field name="isContact" hidden="true" colSpan="12"/>
	        </panel>
         </panel>
        <panel-tabs>
	        <panel name="contactDetails" title="Contact details">
	            <field name="jobTitle"/>
	            <field name="reportsTo" domain="self.isContact = true"/>
	            <field name="fixedPhone" placeholder="+33100000000" pattern="^\+?(?:[0-9]{2,3}(?:\s|\.)?){3,6}[0-9]{2,3}$" onChange="action-partner-record-normalize-fixed-phone-number"/>
	            <field name="mobilePhone" placeholder="+33100000000" pattern="^\+?(?:[0-9]{2,3}(?:\s|\.)?){3,6}[0-9]{2,3}$" onChange="action-partner-record-normalize-mobile-phone-number"/>
	            <field name="emailAddress" canSelect="false" form-view="email-address-simple-form" x-show-icons="false">
					<editor x-show-titles="false">
						<field name="address" placeholder="whatever@example.com" pattern="^[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[a-z]{2,})$"/>
					</editor>
				</field>
	            <field name="fax" pattern="^\+?(?:[0-9]{2,3}(?:\s|\.)?){3,6}[0-9]{2,3}$" placeholder="+33000000000" onChange="action-partner-record-normalize-fax-phone-number"/>
	            <field name="contactAddress" title="Address" canNew="true" form-view="address-form" grid-view="address-grid"/>     
	        </panel>
	        <panel name="activities" title="Activities" showIf="id != null" if-module="axelor-crm" onTabSelect="action-partner-method-view-emails-contact">
				<panel-include if-module="axelor-organisation" view="incl-show-project-partner-form" from="axelor-organisation"/>
		        <panel-include view="incl-activities-contact-form" from="axelor-crm" />
		        <panel-include if-module="axelor-supplychain" view="incl-sales-contact-form" from="axelor-supplychain"/>
		        <field name="$emailsList" colSpan="12" type="many-to-many" target="com.axelor.apps.message.db.Message" title="Emails" canNew="false" canSelect="false" canRemove="false"/>
			</panel>
			<panel-dashlet action="action-contact-partner-dashlet" title="Partners"/>
		</panel-tabs>
        <panel name="settings" sidebar="true" title="Settings">
            <field name="partnerSeq"/>
            <field name="languageSelect"/>
            <panel title="Assigned to" canCollapse="true" colSpan="12">
				<field name="user" colSpan="6" form-view="user-form" grid-view="user-grid"/>
                <field name="team" colSpan="6" form-view="team-form" grid-view="team-grid" if="__config__.general.getTeamManagement()"/>
                <field name="companySet" colSpan="12" widget="TagSelect" canNew="false" form-view="company-form" grid-view="company-grid"/>
            </panel>
        </panel>
		<panel name="notes" title="Notes" colSpan="12" sidebar="true">
            <field name="description" showTitle="false" colSpan="12" height="6"/>
        </panel>
<!--         <panel title="Activities" showIf="id != null" if-module="axelor-crm"> -->
<!-- 			<panel-include view="incl-show-project-partner-form" from="axelor-organisation" if-module="axelor-organisation" /> -->
<!-- 	        <panel-include view="incl-activities-partner-form" from="axelor-crm" /> -->
<!-- 	        <panel-include if-module="axelor-supplychain" view="incl-sales-partner-form" from="axelor-supplychain"/> -->
<!-- 		</panel> -->
	</form>
	
	<form name="partner-contact-summary-form" title="Contact" model="com.axelor.apps.base.db.Partner" canCopy="false"> 
	    <panel name="main" >
	        <field name="emailAddress" canSelect="false" form-view="email-address-simple-form" x-show-icons="false">
				<editor>
					<field name="address" placeholder="whatever@example.com" pattern="^[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+(?:\.[a-z0-9A-ZáàâäãåçéèêëíìîïñóòôöõúùûüýÿæœÁÀÂÄÃÅÇÉÈÊËÍÌÎÏÑÓÒÔÖÕÚÙÛÜÝŸÆŒ!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+(?:[a-z]{2,})$"/>
				</editor>
			</field>
			<field name="fax" pattern="^\+?(?:[0-9]{2,3}(?:\s|\.)?){3,6}[0-9]{2,3}$" placeholder="+33000000000" onChange="action-partner-record-normalize-fax-phone-number"/>
			<field name="fixedPhone" placeholder="+33100000000" pattern="^\+?(?:[0-9]{2,3}(?:\s|\.)?){3,6}[0-9]{2,3}$" onChange="action-partner-record-normalize-fixed-phone-number"/>
			<field name="mobilePhone" placeholder="+33100000000" pattern="^\+?(?:[0-9]{2,3}(?:\s|\.)?){3,6}[0-9]{2,3}$" onChange="action-partner-record-normalize-mobile-phone-number"/>
           <field name="webSite" placeholder="www.url.com" pattern="([^\s]+\.[^\s]+\.[^\s]{2,})"/>
	     </panel>
	</form>
	
	<cards name="partner-cards" model="com.axelor.apps.base.db.Partner" title="Partners" css="rect-image">
	     <toolbar>
	        <button name="printPhoneBook" title="PhoneBook" icon="fa-print" onClick="action-print-phonebook"/>
	        <button name="printCompanyPhoneBook" title="Company phoneBook" icon="fa-print" onClick="action-print-compnay-phonebook"/>
	        <button name="checkDuplicate" title="Check Duplicate" onClick="action-general-method-show-duplicate"/>
	    </toolbar>
		<field name="fullName" />
		<field name="picture" />
		<field name="fixedPhone"/>
		<field name="emailAddress.address" />
		<field name="partnerCategory" />
		<template><![CDATA[
		    <div class="span12"><strong>{{fullName}}</strong></div>
			<div>
			  <div class="span4 card-image">
			    <img ng-src="{{$image('picture', 'content')}}" />
			  </div>
			  <div class="span8">
			  	<address>
			  	{{address.fullName}}
			  	</address>
			    <span>
			    {{fixedPhone}}<br/>
			    {{emailAddress.address}}<br/>
			    {{partnerCategory.name}}</span>
			  </div>
			</div>
		]]>
		</template>
	</cards>
	
	<cards name="partner-contact-cards" model="com.axelor.apps.base.db.Partner" title="Contacts" css="rect-image">
		<field name="fullName" />
		<field name="picture" />
		<field name="fixedPhone"/>
		<field name="emailAddress.address" />
		<field name="partnerCategory" />
		<field name="contactAddress" />
		<template><![CDATA[
		    <div class="span12"><strong>{{fullName}}</strong></div>
			<div>
			  <div class="span4 card-image">
			    <img ng-src="{{$image('picture', 'content')}}" />
			  </div>
			  <div class="span8">
			    <span>{{contactAddress.fullName}}<br/>
			    {{fixedPhone}}<br/>
			    {{emailAddress.address}}<br/>
			    {{partnerCategory.name}}</span>
			  </div>
			</div>
		]]>
		</template>
	</cards>
		
	<action-group name="action-group-partner-onload">
    	<action name="action-partner-method-update-customer-credit-line-from-partner" if="!isContact &amp;&amp; isCustomer &amp;&amp; __config__.general.getManageCustomerCredit()"/>
    	<action name="save"/>
    	<action name="action-partner-attrs-change-name"/>
    	<action name="action-partner-method-set-social-network-url"/>
    </action-group>
	
	<action-group name="action-group-base-partner-onnew">
		<action name="action-partner-record-partner-type-select"/>
		<action name="action-partner-record-set-default"/>
	</action-group>
	
	<action-group name="action-group-base-partner-contact-name-onchange">
		<action name="action-partner-record-full-name"/>
	</action-group>
	
	<action-record name="action-partner-record-get-lead-converted-context" model="com.axelor.apps.base.db.Partner">
		<field name="name" expr="#{__repo__(Lead).find(_parent._lead).name}"/>
	</action-record>
	
    <action-method name="action-partner-method-show-partner-info">
		<call class="com.axelor.apps.base.web.PartnerController" method="showPartnerInfo"/>
	</action-method>
	
    <action-method name="action-partner-method-set-social-network-url">
    	<call class="com.axelor.apps.base.web.PartnerController" method="setSocialNetworkUrl" />
    </action-method>
    
     <action-method name="action-partner-method-set-user-partner">
		<call class="com.axelor.apps.base.web.UserController" method="setUserPartner"/>
	</action-method>
	
	<action-attrs name="action-partner-attrs-change-name">
		<attribute name="title" for="name" expr="Raison sociale" if="partnerTypeSelect != 2"/>
    	<attribute name="title" for="name" expr="Nom" if="partnerTypeSelect == 2"/>
		<attribute name="required" for="name" expr="true"/>
		<attribute name="value" for="firstName" expr="eval:null" if="partnerTypeSelect != 2"/>
	</action-attrs>
	
	<action-attrs name="action-partner-attrs-hide-contact-partner">
        <attribute name="hidden" for="contactPartner" expr="#{clientPartner != null &amp;&amp; clientPartner.partnerTypeSelect == 2}" />
    </action-attrs>
    
	<action-record name="action-partner-record-partner-type-select" model="com.axelor.apps.base.db.Partner" >
    	<field name="partnerTypeSelect" expr="#{__user__.activeCompany.defaultPartnerTypeSelect}"/>
    </action-record>
    
    <action-record name="action-partner-record-full-name" model="com.axelor.apps.base.db.Partner" >
    	<field name="fullName" expr="#{name += ' ' += firstName}" if="#{name != null &amp;&amp; firstName != null}"/>
    	<field name="fullName" expr="#{name}" if="#{name != null &amp;&amp; firstName == null}"/>
    	<field name="fullName" expr="#{firstName}" if="#{firstName != null &amp;&amp; name == null}"/>
    	<field name="fullName" expr="#{id}" if="#{firstName == null &amp;&amp; name == null}"/>
    </action-record>
    
    
    <action-record name="action-partner-record-set-default" model="com.axelor.apps.base.db.Partner">
    	<field name="currency" expr="#{__user__.activeCompany.currency}" if="#{!isContact}"/>
    	<field name="invoiceSendingFormatSelect" expr="#{'emailpaper'}" if="#{!isContact}" />
    	<field name="user"  expr="#{__user__}"/>
    	<field name="team"  expr="#{__user__.activeTeam}"/>
    	<field name="companySet" expr="call:com.axelor.apps.base.web.PartnerController:getActiveCompany()"/>
    	<field name="languageSelect" expr="#{__config__.general.getDefaultPartnerLanguage()}" />
    	<field name="isCustomer" expr="true" if="_isCustomer"/>
  		<field name="isSupplier" expr="true" if="_isSupplier"/>
    	<field name="paymentDelay" expr="eval: __user__.activeCompany?.customerPaymentDelay" if="_isCustomer"/>
    	<field name="paymentDelay" expr="eval: __user__.activeCompany?.supplierPaymentDelay" if="_isSupplier"/>
    	<field name="bankDetails" expr="eval: __user__.activeCompany?.defaultBankDetails"/>
    </action-record>
    
    <action-record name="action-partner-contact-record-default" model="com.axelor.apps.base.db.Partner">
    	<field name="partnerTypeSelect" expr="#{2}" />
    	<field name="isContact" expr="#{true}"/>
    	<field name="companySet" expr="#{_parent.companySet}"/>
    	<field name="languageSelect" expr="#{_parent != null ? _parent.languageSelect : __config__.general.getDefaultPartnerLanguage()}"/>
    	<field name="user"  expr="#{_parent.user}" if="#{_parent._model == 'com.axelor.apps.base.db.Partner'}"/>
    	<field name="team"  expr="#{_parent.team}" if="#{_parent._model == 'com.axelor.apps.base.db.Partner'}"/>
    	<field name="user"  expr="#{__user__}" if="#{_parent == null || _parent._model != 'com.axelor.apps.base.db.Partner'}"/>
    	<field name="team"  expr="#{__user__.activeTeam}" if="#{_parent == null || _parent._model != 'com.axelor.apps.base.db.Partner'}"/>
    	<field name="mainPartner" expr="#{__repo__(Partner).find(_parent.id)}" if="#{_parent.id != null &amp;&amp; _parent._model == 'com.axelor.apps.base.db.Partner'}"/>
    </action-record>
    
    <action-record name="action-partner-set-non-contact-fields" model="com.axelor.apps.base.db.Partner">
    	<field name="currency" expr="#{null}" if="#{!isContact}"/>
    	<field name="invoiceSendingFormatSelect" expr="#{null}" if="#{!isContact}"/>
    </action-record>

	<action-record name="action-partner-record-normalize-fixed-phone-number" model="com.axelor.apps.base.db.Partner">
		<field name="fixedPhone" expr="call:com.axelor.apps.base.web.PartnerController:normalizePhoneNumber(fixedPhone)"/>
	</action-record>

	<action-record name="action-partner-record-normalize-fax-phone-number" model="com.axelor.apps.base.db.Partner">
		<field name="fax" expr="call:com.axelor.apps.base.web.PartnerController:normalizePhoneNumber(fax)"/>
	</action-record>

	<action-record name="action-partner-record-normalize-mobile-phone-number" model="com.axelor.apps.base.db.Partner">
		<field name="mobilePhone" expr="call:com.axelor.apps.base.web.PartnerController:normalizePhoneNumber(mobilePhone)"/>
	</action-record>

    <action-method name="action-set-partner-seq" >
		<call class="com.axelor.apps.base.web.PartnerController" method="setPartnerSequence"/>
	</action-method>
    
    <action-method name="action-print-compnay-phonebook" >
		<call class="com.axelor.apps.base.web.PartnerController" method="printCompanyPhonebook"/>
	</action-method>
	
	<action-method name="action-print-phonebook" >
		<call class="com.axelor.apps.base.web.PartnerController" method="printContactPhonebook"/>
	</action-method>

	<action-method name="action-partner-method-generate-customer-credit-line" if-module="axelor-supplychain">
		<call class="com.axelor.apps.supplychain.web.CustomerCreditLineController" method="generateLines"/>
	</action-method>
	
	<action-method name="action-partner-method-update-customer-credit-line-from-partner" if-module="axelor-supplychain">
		<call class="com.axelor.apps.supplychain.web.CustomerCreditLineController" method="updateLinesFromPartner"/>
	</action-method>
	
	
	<action-method name="action-partner-method-view-emails">
		<call class="com.axelor.apps.base.web.PartnerController" method="findPartnerMails"/>
	</action-method>
	
	<action-method name="action-partner-method-view-emails-contact">
		<call class="com.axelor.apps.base.web.PartnerController" method="findContactMails"/>
	</action-method>
	
	<action-method name="action-partner-address-list-change">
	    <call class="com.axelor.apps.base.web.PartnerController" method="partnerAddressListChange"/>
	</action-method>
	
	<action-method name="action-partner-iban-check-on-save">
		<call class="com.axelor.apps.base.web.PartnerController" method="checkIbanValidity"/>
	</action-method>

	
	<action-view name="action-partner-view-generate-project" title="Generated Project" model="com.axelor.apps.project.db.ProjectTask">
    	<view type="form" name="project-form"/>
		<view type="grid" name="project-grid"/>
    	<context name="_idPartner" expr="eval: id"/>
    </action-view>
    
	<action-view name="action-contact-partner-dashlet" title="Partners"  model="com.axelor.apps.base.db.Partner">
		<view type="grid" name="partner-grid"/>
		<view type="form" name="partner-form"/>
		<domain>self.contactPartnerSet.id = :_contactId</domain>
		<context name="_contactId" expr="eval: id"/>
	</action-view>
	
	<action-method name="action-partner-address-set-default">
		<call class="com.axelor.apps.base.web.PartnerController" method="setAddressDefault"/>	
	</action-method>
	
	<search-filters name="partner-filters" model="com.axelor.apps.base.db.Partner" title="Partner filters">
		<filter title="All Enterprises">
			<domain>self.partnerTypeSelect = 1 AND self.isContact = false</domain>
		</filter>
		<filter title="All Individuals">
			<domain>self.partnerTypeSelect = 2 AND self.isContact = false</domain>
		</filter>
		<filter title="All Prospects">
			<domain>self.hasOrdered = false AND self.isCustomer = true AND self.isContact = false</domain>
		</filter>
		<filter title="All Clients">
			<domain>self.isCustomer = true AND self.hasOrdered = true AND self.isContact = false</domain>
		</filter>
		<filter title="All Suppliers">
			<domain>self.isSupplier = true AND self.isContact = false</domain>
		</filter>
	</search-filters>
	
	
</object-views>
