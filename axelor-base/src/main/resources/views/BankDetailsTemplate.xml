<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_6.1.xsd">

  <grid name="bank-details-template-grid" title="Bank details templates"
    model="com.axelor.apps.base.db.BankDetailsTemplate">
    <field name="name" title="Name" required="true"/>
    <field name="bankDetailsTypeSelect" title="Type of Bank Details Id" required="true"/>
  </grid>

  <form name="bank-details-template-form" title="Bank details template"
    model="com.axelor.apps.base.db.BankDetailsTemplate"
    onSave="action-bank-details-template-validate-check-duplicate-or-null-bank-details-fields">
    <panel name="mainPanel" colSpan="12">
      <field name="name" title="Name" required="true" colSpan="6"/>
      <field name="bankDetailsTypeSelect" title="Type of Bank Details Id" required="true"
        colSpan="6"/>
      <panel-related name="bankDetailsTemplateLineListNonIbanPanel"
        field="bankDetailsTemplateLineList" title="Fields to use" colSpan="12"
        form-view="bank-details-template-line-form"
        grid-view="bank-details-template-line-non-iban-grid" hideIf="bankDetailsTypeSelect == 1"/>
      <panel-related name="bankDetailsTemplateLineListIbanPanel"
        field="bankDetailsTemplateLineList" title="Fields to use" colSpan="12"
        form-view="bank-details-template-line-form" grid-view="bank-details-template-line-iban-grid"
        hideIf="bankDetailsTypeSelect != 1"/>
    </panel>
  </form>

  <action-validate
    name="action-bank-details-template-validate-check-duplicate-or-null-bank-details-fields">
    <error message="Error: an empty bank details field is selected."
      if="bankDetailsTemplateLineList?.findAll{it.metaField == null}?.size() &gt; 0"/>
    <error message="Error: duplicate bank details fields are selected."
      if="bankDetailsTemplateLineList?.findAll{it.metaField.name == 'bankCode'}?.size() &gt; 1
      || bankDetailsTemplateLineList?.findAll{it.metaField.name == 'sortCode'}?.size() &gt; 1
      || bankDetailsTemplateLineList?.findAll{it.metaField.name == 'accountNbr'}?.size() &gt; 1
      || bankDetailsTemplateLineList?.findAll{it.metaField.name == 'bbanKey'}?.size() &gt; 1 "/>
  </action-validate>
</object-views>
