<?xml version="1.0" encoding="UTF-8"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_7.4.xsd">

  <form id="business-support-project-dashboard-form" name="project-dashboard-form"
    title="Project dashboard" model="com.axelor.utils.db.Wizard" extension="true">

    <extend target="//panel[@name='spentTimePanel']">
      <insert position="after">
        <panel name="announcementPanel" title="Latest announcement" icon="fa-newspaper-o"
          if="__config__.app.isApp('business-support')" if-module="axelor-business-support"
          hideIf="$announcementList.length == 0">
          <field name="$announcementList" showTitle="false" colSpan="12">
            <viewer>
              <![CDATA[
						 <>
						 	 {$announcementList.map((item,index) => (
								 <p key={index}>
                                     <Button variant="link" p={0} style={{verticalAlign: "unset"}} onClick={() => $execute("project.announcement", {announcementId : item.id})}>{item.title}</Button><br/>
							         <span>{_t('Added by')}</span>
                                     <Button variant="link" p={0} style={{verticalAlign: "unset"}} onClick={() => $execute("action-auth-users", {userId : item.createdById})}>{item.createdBy}</Button>
							         <Button variant="link" p={0} style={{verticalAlign: "unset"}} title="{$moment(item.announcementDate).format('MM/DD/YYYY')}" onClick={$action("com.axelor.apps.businesssupport.service.ProjectActivityDashboardBusinessSupportService:getProjectActivityView("+item.id+")")}>{$moment(item.announcementDate).fromNow()}</Button>
							     </p>
						     ))}
						 <Button variant="link" p={0} style={{verticalAlign: "unset"}} onClick={() => $execute("project.announcement")}>View all announcement</Button>
					     </>
				        ]]>
            </viewer>
          </field>
        </panel>
      </insert>
    </extend>

  </form>

  <form name="project-activity-announcement-dashboard-form" title="Project Activity"
    model="com.axelor.utils.db.Wizard"
    onNew="action-project-activity-announcement-dashboard-method-on-new" width="large"
    canNew="false" canEdit="false" canDelete="false">
    <panel-include view="project-activity-dashboard-form"/>
  </form>

  <action-method name="action-project-activity-announcement-dashboard-method-on-new">
    <call class="com.axelor.apps.businesssupport.web.ProjectActivityDashboardController"
      method="getData"/>
  </action-method>

</object-views>

