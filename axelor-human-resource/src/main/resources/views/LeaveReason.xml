<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_6.1.xsd">

  <grid name="leave-reason-grid" title="Leave reason" model="com.axelor.apps.hr.db.LeaveReason">
    <field name="name"/>
    <field name="allowNegativeValue"/>
    <field name="allowInjection"/>
    <field name="isActive"/>
  </grid>

  <form name="leave-reason-form" title="Leave reason" model="com.axelor.apps.hr.db.LeaveReason"
    onNew="action-leave-reason-group-onnew">
    <panel name="mainPanel">
      <field name="$viewerTags" showTitle="false" readonly="true" showIf="$readonly()"
        colSpan="9" depends="isActive">
        <viewer>
          <![CDATA[
            <>
                  {!isActive && <Badge as="span" bg="danger">{_t('Inactive')}</Badge>}
                  {isActive && <Badge as="span" bg="success">{_t('Active')}</Badge>}
            </>
          ]]>
        </viewer>
      </field>

      <field name="name" colSpan="4"/>
      <field name="leaveReasonTypeSelect" colSpan="4"/>
      <field name="defaultDayNumberGain" colSpan="4" showIf="leaveReasonTypeSelect != 2"/>
      <field name="isActive" widget="boolean-switch" colSpan="3"/>
      <field name="selectedByMgtOnly" widget="boolean-switch" colSpan="3"/>
      <field name="planningSet" colSpan="6" canNew="false" widget="TagSelect"
        placeholder="All"/>
      <field name="allowNegativeValue" widget="boolean-switch" colSpan="4"
        showIf="leaveReasonTypeSelect != 2"/>
      <field name="isDaysAddedProrated" widget="boolean-switch" colSpan="4"/>
      <field name="isToBeResetYearly" widget="boolean-switch" readonlyIf="recoveryLeaveReason"
        showIf="leaveReasonTypeSelect != 2"/>
      <field name="recoveryLeaveReason"
        showIf="isToBeResetYearly &amp;&amp; leaveReasonTypeSelect != 2"
        onSelect="action-leave-reason-attrs-recovery-leave-reason-onselect"/>
      <field name="instruction" colSpan="12" widget="html"/>

      <panel name="planningPanel" colSpan="12" hideIf="leaveReasonTypeSelect == 2"
        if="__config__.app.getApp('leave')?.getUseWeeklyPlanningCoefficientSelect() == 2">
        <field name="useWeeklyPlanningCoef" widget="boolean-switch" colSpan="6"/>
      </panel>
    </panel>

    <panel name="exportsPanel"
      if="__config__.app.getApp('leave')?.getIsPayrollPreparationExportEnabled()">
      <field name="payrollPreprationExport"/>
      <field name="exportCode" requiredIf="payrollPreprationExport"
        hideIf="!payrollPreprationExport"/>
    </panel>

  </form>

  <action-group name="action-leave-reason-group-onnew">
    <action name="action-leave-reason-record-set-unit"/>
  </action-group>

  <action-record name="action-leave-reason-record-set-unit"
    model="com.axelor.apps.hr.db.LeaveReason">
    <field name="unitSelect" expr="eval: 1"/>
  </action-record>

  <action-attrs name="action-leave-reason-attrs-recovery-leave-reason-onselect">
    <attribute for="recoveryLeaveReason" name="domain"
      expr="eval: &quot; self.leaveReasonTypeSelect != 2 &quot;" if="!__id__"/>
    <attribute for="recoveryLeaveReason" name="domain"
      expr="eval: &quot; self.leaveReasonTypeSelect != 2 AND self.id != ${__this__.id} AND (self.recoveryLeaveReason.id != ${__this__.id} OR self.recoveryLeaveReason IS null)&quot;"
      if="__id__"/>
  </action-attrs>

</object-views>
