<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_6.1.xsd">

  <grid name="subscription-so-invoice-grid" title="Invoices"
    model="com.axelor.apps.account.db.Invoice" orderBy="-invoiceDate">
    <field name="subscriptionFromDate"/>
    <field name="subscriptionToDate"/>
    <field name="statusSelect"/>
    <field name="exTaxTotal" aggregate="sum"/>
    <field name="inTaxTotal" aggregate="sum"/>
  </grid>

  <form name="invoice-form" title="Invoice" model="com.axelor.apps.account.db.Invoice"
    id="supplychain-invoice-form" extension="true">
    <extend target="//button[@name='ventilateBtn']">
      <attribute name="onClick" value="supplychain-action-invoice-group-ventilate-button"/>
    </extend>
  </form>

  <form name="invoice-client-form" title="Invoice" model="com.axelor.apps.account.db.Invoice"
    id="supplychain-invoice-client-form" extension="true">
    <extend target="//button[@name='ventilateBtn']">
      <attribute name="onClick" value="supplychain-action-invoice-group-ventilate-button"/>
    </extend>
  </form>

  <action-group name="supplychain-action-invoice-group-ventilate-button">
    <action name="action-invoice-method-check-existing-invoice-on-order"/>
    <action name="action-invoice-group-ventilate-button"/>
  </action-group>

  <action-method name="action-supplychain-method-generate-subscription-invoice">
    <call class="com.axelor.apps.supplychain.web.InvoiceController"
      method="generateSubscriptionInvoices"/>
  </action-method>

  <action-method name="action-invoice-method-update-product-qty-with-pack-header-qty">
    <call class="com.axelor.apps.supplychain.web.InvoiceController"
      method="updateProductQtyWithPackHeaderQty"/>
  </action-method>

  <action-method name="action-invoice-method-check-existing-invoice-on-order">
    <call class="com.axelor.apps.supplychain.web.InvoiceController" method="checkOrders"/>
  </action-method>

  <action-validate name="action-invoice-validate-pfp-stock-move">
    <alert
      message="At least one stock move is in litigation, do you really want to validate passed for payment ?"
      if="__repo__(StockMove).all().filter(' ? MEMBER OF self.invoiceSet and self.pfpValidateStatusSelect = 3',id).fetch().size &gt;= 1"/>
  </action-validate>

  <action-record
    name="action-invoice-record-set-display-stock-move-on-invoice-printing"
    model="com.axelor.apps.account.db.Invoice">
    <field name="displayStockMoveOnInvoicePrinting"
      expr="eval: __user__.activeCompany?.accountConfig?.displayStockMoveOnInvoicePrinting"/>
  </action-record>

</object-views>
